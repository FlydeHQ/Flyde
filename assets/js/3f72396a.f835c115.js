(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6007],{8541:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cappedArrayDebounce=void 0;e.cappedArrayDebounce=function(t,e,n,r){void 0===r&&(r=500);var o=[],i=null,a=null;return{addItem:function(u){clearTimeout(i),o.push(u),a||(a=setTimeout((function(){t(o),clearTimeout(i),a=null}),r)),o.length>=n?(t(o),clearTimeout(a),a=null,o=[]):i=setTimeout((function(){t(o),clearTimeout(a),a=null,o=[]}),e)},flush:function(){o.length&&(t(o),o=[],clearTimeout(a))}}}},96615:function(t,e){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.dataShaper=e.DataShapeType=void 0,function(t){t[t.STRING=0]="STRING",t[t.NUMBER=1]="NUMBER",t[t.BOOLEAN=2]="BOOLEAN",t[t.ARRAY=3]="ARRAY",t[t.OBJECT=4]="OBJECT",t[t.NULL=5]="NULL"}(n=e.DataShapeType||(e.DataShapeType={}));var r={string:n.STRING,number:n.NUMBER,boolean:n.BOOLEAN,object:n.OBJECT,array:n.ARRAY,null:n.NULL};e.dataShaper=function(t,n,o){void 0===n&&(n=5),void 0===o&&(o=5);var i,a,u=null===(i=t)?"null":typeof i;if("object"===u){if(Array.isArray(t))return n>1?t.filter((function(t,e){return e<o})).map((function(t){return(0,e.dataShaper)(t,n-1,o)})):r.array;if(n>1){var s={};for(var c in t)s[c]=(0,e.dataShaper)(t[c],n-1,o);return a=s,Object.keys(a).sort().reduce((function(t,e){return t[e]=a[e],t}),{})}return r.object}return r[u]}},40189:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.debugLogger=void 0;var r=(0,n(96292).default)("flyde");e.debugLogger=function(t){return r.extend(t)}},68132:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},i=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.hashFlow=e.hashPart=void 0;var a=n(61586),u=n(18265),s=function(t){return a(t)};e.hashPart=function(t,e){void 0===e&&(e=!0);var n={id:t.id,completionOutputs:t.completionOutputs,reactiveInputs:t.reactiveInputs,inputs:t.inputs,outputs:t.outputs};if((0,u.isVisualPart)(t)){var a=t.instances,c=t.id,l=t.connections,p=t.inputsPosition,d=t.outputsPosition,f=a.map((function(t){t.pos;return o(t,["pos"])})),v=e?{}:{inputsPosition:p,outputsPosition:d},y=e?f:a;y.sort((function(t,e){return t.id.localeCompare(e.id)}));var m=i([],l,!0);m.sort((function(t,e){var n="".concat(t.from.insId,".").concat(t.from.pinId),r="".concat(e.from.insId,".").concat(e.from.pinId);return n.localeCompare(r)}));var h=JSON.stringify(r(r({id:c,instancesToUse:y,conns:m},n),{maybeIoPos:v}));return s(h)}if((0,u.isInlineValuePart)(t)){var g=t.fnCode,b=t.customViewCode;h=JSON.stringify(r({fnCode:g,customViewCode:b},n));return s(h)}throw new Error("Hashing code parts unsupported")};e.hashFlow=function(t,n){void 0===n&&(n=!0);var o=t.part,i=t.imports,a=(0,e.hashPart)(o,!1),u=Object.entries(i).sort((function(t,e){var n=t[0],r=e[0];return n.localeCompare(r)})).map((function(t){return[t[0],t[1].sort()]})).reduce((function(t,e){var n,o=e[0],i=e[1];return r(r({},t),((n={})[o]=i,n))}),{}),c=JSON.stringify(u);return s(a+c)}},45821:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.DepGraph=void 0,o(n(69985),e),o(n(94919),e),o(n(40189),e),o(n(8541),e),o(n(94919),e),o(n(68132),e),o(n(67748),e),o(n(96615),e),e.DepGraph=n(59280).DepGraph},69985:function(t,e){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.testDataCreator=void 0;e.testDataCreator=function(t){return function(e){void 0===e&&(e={});var r="function"==typeof t?t():t,o=e;return n(n({},r),o)}}},94919:function(t,e){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)},r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},i=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.eventually=e.delay=e.noop=e.removeDupes=e.ensure=e.isOptionalType=e.callFnOrFnPromise=e.isPromise=e.isDefined=e.containsAll=e.shuffle=e.randomInts=e.repeat=e.pickRandom=e.randomPos=e.randomInt=e.pickSecond=e.pickFirst=e.fromEntries=e.entries=e.okeys=e.values=e.keys=e.filterOMap=e.mapOMap=e.middlePos=e.calcCenter=e.intersectRect=void 0;e.intersectRect=function(t,e){var n=t.x+t.w,r=e.x+e.w;return!(e.x>n||r<t.x||e.y>t.y+t.h||e.y+e.h<t.y)};e.calcCenter=function(t){var e=t.w,n=t.h;return{x:t.x+e/2,y:t.y+n/2}};e.middlePos=function(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}};e.mapOMap=function(t,r){return(0,e.entries)(t).map((function(t){var e=t[0],n=t[1];return[e,r(e,n)]})).reduce((function(t,e){var r,o=e[0],i=e[1];return n(n({},t),((r={})[o]=i,r))}),{})};e.filterOMap=function(t,r){return(0,e.entries)(t).filter((function(t){var e=t[0],n=t[1];return r(e,n)})).reduce((function(t,e){var r,o=e[0],i=e[1];return n(n({},t),((r={})[o]=i,r))}),{})};e.keys=function(t){return Object.keys(t)};e.values=function(t){return Object.values(t)},e.okeys=e.keys;e.entries=function(t){return(0,e.okeys)(t).map((function(e){return[e,t[e]]}))};e.fromEntries=function(t){return t.reduce((function(t,e){var r,o=e[0],i=e[1];return n(n({},t),((r={})[o]=i,r))}),{})};e.pickFirst=function(t){return t[0]};e.pickSecond=function(t){return t[1]};e.randomInt=function(t,e){void 0===e&&(e=0);var n=Math.random();return e+Math.floor((t-e)*n)};e.randomPos=function(t,n){return void 0===t&&(t=1e3),void 0===n&&(n=0),{x:(0,e.randomInt)(t,n),y:(0,e.randomInt)(t,n)}};e.pickRandom=function(t){return t[(0,e.randomInt)(t.length)]};e.repeat=function(t,e){return"x".repeat(t).split("").map((function(t,n){return e(n)}))};e.randomInts=function(t,n,r){return void 0===n&&(n=100),void 0===r&&(r=0),(0,e.repeat)(t,(function(){return(0,e.randomInt)(n,r)}))};e.shuffle=function(t){for(var e,n=i([],t,!0),r=n.length-1;r>=0;r--){var o=Math.floor(Math.random()*(r+1));e=[n[o],n[r]],n[r]=e[0],n[o]=e[1]}return n};e.containsAll=function(t,e){return e.every((function(e){return t.includes(e)}))};e.isDefined=function(t){return void 0!==t};e.isPromise=function(t){return t&&"function"==typeof t.then};e.callFnOrFnPromise=function(t,n){if((0,e.isDefined)(t)){var r=function(t){try{t()}catch(e){console.error(e)}};"function"==typeof t?r(t):Promise.resolve(t).then((function(t){"function"==typeof t&&r(t)}))}};e.isOptionalType=function(t){return/\?$/.test(t)};e.ensure=function(t,e){if(void 0===t)throw new Error(e||"Undefined value passed");return t};e.removeDupes=function(t){return Array.from(new Set(t))};e.noop=function(){};e.delay=function(t){return new Promise((function(e){return setTimeout(e,t)}))};e.eventually=function(t,n,i,a){return void 0===n&&(n=3e3),void 0===i&&(i=100),void 0===a&&(a=new Set),r(void 0,void 0,void 0,(function(){var r,u,s,c;return o(this,(function(o){switch(o.label){case 0:if(n<0)throw r=Array.from(a).reduce((function(t,e,n){return"".concat(t,"\n\t\t").concat(n+1,". ").concat(e)}),""),new Error("[Eventually timeout exceeded after: timeout with error]: ".concat(r));o.label=1;case 1:return o.trys.push([1,3,,5]),[4,t()];case 2:return o.sent(),[3,5];case 3:return u=o.sent(),s=Date.now(),[4,(0,e.delay)(i)];case 4:return o.sent(),c=Date.now()-s,a.add(u.message),[2,(0,e.eventually)(t,n-c,i,a)];case 5:return[2]}}))}))}},67748:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.compileObjectTemplate=e.compileStringTemplate=void 0;e.compileStringTemplate=function(t,e){var n=decodeURIComponent(t);return Object.keys(e).forEach((function(t){var r=e[t],o=new RegExp("\\$\\{"+t+"\\}","g");n=n.replace(o,r)})),n};e.compileObjectTemplate=function(t,e){var n=decodeURIComponent(t);return Object.keys(e).forEach((function(t){var r=e[t],o=JSON.stringify(r),i=new RegExp('"\\$\\$\\{'+t+'\\}"',"g"),a=new RegExp("\\$\\{"+t+"\\}","g"),u="string"==typeof r?r.replace(/"/g,(function(t,e,n){return"\\"!==n[e-1]?'\\"':n[e]})):r;n=n.replace(i,o).replace(a,u).replace(/\n/g,"\\n")})),JSON.parse(n)}},1076:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.connection=e.connectionData=e.connectionDataEquals=e.connectionNodeEquals=e.connectionNode=e.externalConnectionNode=e.isInternalConnection=e.isExternalConnection=e.isInternalConnectionNode=e.isExternalConnectionNode=e.getPartOutputs=e.getOutputName=e.getInputName=e.getPartInputs=e.TRIGGER_PIN_ID=e.ERROR_PIN_ID=e.THIS_INS_ID=void 0;var o=n(18265);e.THIS_INS_ID="__this",e.ERROR_PIN_ID="__error",e.TRIGGER_PIN_ID="__trigger";e.getPartInputs=function(t){var n;return r(r({},t.inputs),((n={})[e.TRIGGER_PIN_ID]=(0,o.partInput)(),n))};e.getInputName=function(t){return t===e.TRIGGER_PIN_ID?"Trigger Part":t};e.getOutputName=function(t){return t===e.ERROR_PIN_ID?"Error":t};e.getPartOutputs=function(t){var n;return r(r({},t.outputs),((n={})[e.ERROR_PIN_ID]=(0,o.partOutput)(),n))};e.isExternalConnectionNode=function(t){return t.insId===e.THIS_INS_ID};e.isInternalConnectionNode=function(t){return t.insId!==e.THIS_INS_ID};e.isExternalConnection=function(t){var n=t.from,r=t.to;return(0,e.isExternalConnectionNode)(n)||(0,e.isExternalConnectionNode)(r)};e.isInternalConnection=function(t){return!(0,e.isExternalConnection)(t)};e.externalConnectionNode=function(t){return{insId:e.THIS_INS_ID,pinId:t}};e.connectionNode=function(t,e){return{insId:t,pinId:e}};e.connectionNodeEquals=function(t,e){return t.insId===e.insId&&t.pinId===e.pinId};e.connectionDataEquals=function(t,n){return!(!t||!n)&&((0,e.connectionNodeEquals)(t.from,n.from)&&(0,e.connectionNodeEquals)(t.to,n.to))},e.connectionData=function(t,n,r){var o="string"==typeof t?t.split("."):t,i="string"==typeof n?n.split("."):n;if(o.length>2||i.length>2)throw new Error("invalid source or target to connection data - ".concat(t," / ").concat(n));return{from:2===o.length?(0,e.connectionNode)(o[0],o[1]):(0,e.externalConnectionNode)(o[0]),to:2===i.length?(0,e.connectionNode)(i[0],i[1]):(0,e.externalConnectionNode)(i[0]),delayed:r}};e.connection=function(t,e,n){return void 0===n&&(n=!1),{from:t,to:e,delayed:n}}},6485:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.connect=void 0;var u=n(24048),s=n(30385),c=n(45821),l=n(1076);o(n(1076),e);e.connect=function(t,e,n,r,o,p,d,f){void 0===n&&(n={}),void 0===r&&(r="root"),void 0===o&&(o={bob:new Map}),void 0===p&&(p=c.noop),void 0===d&&(d={}),void 0===f&&(f={});var v=t.id,y=t.connections,m=t.instances,h=v||"connected-part"+(0,c.randomInt)(999);return{inputs:t.inputs,outputs:t.outputs,id:h,completionOutputs:t.completionOutputs,reactiveInputs:t.reactiveInputs,fn:function(v,g){var b,I=[],P=new c.DepGraph({}),_=new Map,C=new Map,O=new Map,x=new Map,w=new Map,j=new Map,E=new Set;m.forEach((function(t){var n=(0,u.getPart)(t,e),r=t.id;_.set(t,r),C.set(r,t),P.addNode(r);var o=Object.keys(n.inputs),i=Object.keys(n.outputs),a={},s={};if(o.forEach((function(e){var n=(t.inputConfig||{})[e]||(0,u.queueInputPinConfig)();(0,u.isStaticInputPinConfig)(n)?a[e]=(0,u.staticPartInput)(n.value):a[e]=(0,u.dynamicPartInput)({config:n})})),a[l.TRIGGER_PIN_ID]=(0,u.dynamicPartInput)({config:(0,u.queueInputPinConfig)()}),y.some((function(e){return(0,l.isInternalConnectionNode)(e.to)&&e.to.insId===t.id&&e.to.pinId===l.TRIGGER_PIN_ID}))&&t.inputConfig&&t.inputConfig[l.TRIGGER_PIN_ID])throw"Trigger connection can not be configured";i.forEach((function(t){var e=(0,u.dynamicOutput)();s[t]=e})),y.some((function(e){return(0,l.isInternalConnectionNode)(e.from)&&e.from.insId===t.id&&e.from.pinId===l.ERROR_PIN_ID}))&&(s[l.ERROR_PIN_ID]=(0,u.dynamicOutput)()),O.set(r,a),x.set(r,s)}));var D=new Set;return y.forEach((function(n){var r=n.from,o=n.to,s=r.insId,c=r.pinId,p=o.insId,d=o.pinId,f=x.get(s),v=O.get(p);if((0,l.isInternalConnectionNode)(o)&&D.add("".concat(o.insId,".").concat(o.pinId)),(0,l.isExternalConnection)(n))if((0,l.isExternalConnectionNode)(r)){var y=v[o.pinId];if(!y)throw new Error("Input ".concat(o.pinId," of instance ").concat(p," not found"));(m=w.get(r.pinId)||[]).push(y),w.set(r.pinId,m)}else{var m,g=f[r.pinId];if(!g)throw new Error("Output ".concat(r.pinId," of instance ").concat(s," not found"));(m=j.get(o.pinId)||[]).push(g),j.set(o.pinId,m)}else{if(!f)throw new Error("No outputs found for instance [".concat(s,"]"));if(!v)throw C.has(p)?new Error("No inputs found for instance [".concat(p,"]")):new Error("Instance with id [".concat(p,"] does not exist!"));var b=f[c];if(!b)throw console.log(c),new Error("Output source - [".concat(c,"] not found in part [").concat(h,"]"));var _=v[d],E=C.get(s);if(!E&&s!==l.THIS_INS_ID)throw new Error("Instance [".concat(s,"] does not exist! failed to connect [").concat(r,"] -> [").concat(o,"]"));var S=(E?(0,u.getPart)(E,e):t).outputs[c];if(S&&S.delayed||n.delayed||s!==l.THIS_INS_ID&&p!==l.THIS_INS_ID&&P.addDependency(s,p),!_)throw new Error("Target arg - [".concat(o,"] not found in part [").concat(h,"]"));var T=b.subscribe((function(t){return i(void 0,void 0,void 0,(function(){return a(this,(function(e){if(!(0,u.isDynamicInput)(_))throw console.info(_),new Error("Impossible state listening to non dynamic input - ".concat(p,".").concat(d));return _.subject.next(t),[2]}))}))}));I.push((function(){return T.unsubscribe()}))}})),(0,c.okeys)(g).forEach((function(t){(j.get(t)||[]).forEach((function(e){var n=e.subscribe((function(e){return i(void 0,void 0,void 0,(function(){return a(this,(function(n){return g[t].next(e),[2]}))}))}));I.push((function(){return n.unsubscribe()}))}))})),P.overallOrder().map((function(t){return C.get(t)})).forEach((function(t){var i=O.get(t.id),a=x.get(t.id),c=(0,u.getPart)(t,e);if(!i)throw new Error("Unexpected error - args not found when running ".concat(t));if(!a)throw new Error("Unexpected error - outputs not found when running ".concat(t));for(var l in i){var v=t.inputConfig[l];D.has("".concat(t.id,".").concat(l))||(0,u.isStaticInputPinConfig)(v)||delete i[l]}var y=(0,s.execute)({part:c,inputs:i,outputs:a,partsRepo:e,_debugger:n,insId:t.id,extraContext:f,mainState:o,parentInsId:r,onBubbleError:p,onCompleted:function(){return e=t.id,E.delete(e),void(0===E.size&&b&&b());var e},onStarted:function(){return e=t.id,void E.add(e);var e},env:d});I.push(y)})),Object.keys(v).forEach((function(t){return i(void 0,void 0,void 0,(function(){return a(this,(function(e){return(w.get(t)||[]).forEach((function(e){var n=v[t];if(!(0,u.isDynamicInput)(e))throw new Error("Unsure what to do with key ".concat(t,", input: ").concat(e," of ins ").concat(r));(0,c.isDefined)(n)&&e.subject.next(n)})),[2]}))}))})),void 0===t.completionOutputs&&E.size>0?new Promise((function(t){b=t})):function(){return I.forEach((function(t){try{t()}catch(e){console.error("error unsubscribing",e)}}))}}}}},28674:function(t,e){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.MINOR_DEBUGGER_EVENT_TYPES=e.MAJOR_DEBUGGER_EVENT_TYPES=e.DebuggerEventType=void 0,function(t){t.INPUT_CHANGE="i",t.OUTPUT_CHANGE="o",t.PROCESSING_CHANGE="pc",t.ERROR="err",t.INPUTS_STATE_CHANGE="isc"}(n=e.DebuggerEventType||(e.DebuggerEventType={})),e.MAJOR_DEBUGGER_EVENT_TYPES=[n.INPUT_CHANGE,n.OUTPUT_CHANGE,n.ERROR],e.MINOR_DEBUGGER_EVENT_TYPES=[n.PROCESSING_CHANGE,n.INPUTS_STATE_CHANGE]},76296:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(28674),e)},30385:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||o(e,t,n)},a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},u=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.execute=e.INPUTS_STATE_SUFFIX=e.INNER_STATE_SUFFIX=void 0;var s=n(71542),c=n(21730);i(n(76296),e);var l=n(24048),p=n(6485),d=n(23939),f=n(45821),v=n(40189),y=n(24048),m=n(18265),h=n(76296);e.INNER_STATE_SUFFIX="_inner",e.INPUTS_STATE_SUFFIX="_inputs";e.execute=function(t){var n=t.part,o=t.inputs,i=t.outputs,g=t.partsRepo,b=t._debugger,I=void 0===b?{}:b,P=t.insId,_=void 0===P?n.id:P,C=t.extraContext,O=void 0===C?{}:C,x=t.mainState,w=void 0===x?{}:x,j=t.parentInsId,E=void 0===j?"root":j,D=t.onBubbleError,S=void 0===D?s.noop:D,T=t.env,N=void 0===T?{}:T,k=t.onCompleted,M=void 0===k?s.noop:k,R=t.onStarted,A=void 0===R?s.noop:R,V=[],H=r(r({},O),{ENV:N}),z=(0,m.customRepoToPartRepo)(g,H),G=function(t){var e=t instanceof Error?t:new Error("Raw error: ".concat(t.toString()));if(e.message="error in child instance ".concat(_,": ").concat(e.message),i[p.ERROR_PIN_ID]?i[p.ERROR_PIN_ID].next(t):(e.insId=_,S(e)),I.onEvent){var n=e;n.insId="".concat(E,".").concat(_),I.onEvent({type:h.DebuggerEventType.ERROR,val:n,insId:_,parentInsId:E})}},F=function(t){return(0,l.isVisualPart)(t)?(0,p.connect)(t,z,I,"".concat(E,".").concat(_),w,G,N,O):(0,l.isInlineValuePart)(t)?(0,m.inlineValuePartToPart)(t,H):t}(n),B=I.onEvent||s.noop,U={},L={};(0,f.entries)(o).forEach((function(t){var e=t[0],n=t[1];if((0,l.isDynamicInput)(n)){var r=(0,l.dynamicPartInput)({config:n.config}),o=n.subject.subscribe((function(t){return a(void 0,void 0,void 0,(function(){var n,o;return u(this,(function(i){switch(i.label){case 0:return(n=B({type:h.DebuggerEventType.INPUT_CHANGE,insId:_,pinId:e,val:t,parentInsId:E}))?[4,n.valuePromise]:[3,2];case 1:return o=i.sent(),r.subject.next(o),[3,5];case 2:return I.debugDelay?[4,(0,f.delay)(I.debugDelay)]:[3,4];case 3:i.sent(),i.label=4;case 4:r.subject.next(t),i.label=5;case 5:return[2]}}))}))}));V.push((function(){return o.unsubscribe()})),L[e]=r}else{B({type:h.DebuggerEventType.INPUT_CHANGE,insId:_,pinId:e,val:n.config.value,parentInsId:E});var i=(0,l.staticPartInput)((0,l.getStaticValue)(n.config.value,z,_));L[e]=i}})),(0,f.entries)(i).forEach((function(t){var e=t[0],n=t[1],r=(0,l.dynamicOutput)(),o=r.subscribe((function(t){return a(void 0,void 0,void 0,(function(){var r,o;return u(this,(function(i){switch(i.label){case 0:return(r=B({type:h.DebuggerEventType.OUTPUT_CHANGE,insId:_,pinId:e,val:t,parentInsId:E}))?[4,r.valuePromise]:[3,2];case 1:return o=i.sent(),n.next(o),[3,3];case 2:n.next(t),i.label=3;case 3:return[2]}}))}))}));V.push((function(){return o.unsubscribe()})),U[e]=r}));var q=function(t){var n,o=t.part,i=t.inputs,a=t.outputs,u=t.repo,p=t._debugger,g=t.insId,b=t.parentInsId,I=t.mainState,P=t.onError,_=t.onStarted,C=t.onCompleted,O=t.env,x=t.extraContext,w=o.fn,j=(0,v.debugLogger)("core"),E=[],D=p.onEvent||s.noop,S="".concat(b||"root",".").concat(g),T="".concat(S).concat(e.INNER_STATE_SUFFIX),N="".concat(S).concat(e.INPUTS_STATE_SUFFIX),k=j.extend(S);I[T]||(I[T]=new Map),I[N]||(I[N]=new Map),I[T];var M,R=I[N],A=function(){var t=Array.from(R.entries()).reduce((function(t,e){var n,o=e[0],a=e[1],u=(0,l.isQueueInputPinConfig)(i[o].config,i[o]);return r(r({},t),((n={})[o]=u?null==a?void 0:a.length:1,n))}),{});D({type:h.DebuggerEventType.INPUTS_STATE_CHANGE,val:t,insId:g,parentInsId:b})},V={execute:function(t,n,r,o){return(0,e.execute)({part:t,inputs:n,outputs:r,partsRepo:u,_debugger:p,insId:o,onCompleted:C,onStarted:_})},insId:g,state:I[T],onCleanup:function(t){E.push(t)},onError:function(t){P(t)},context:x},H=!1,z=(o.reactiveInputs||[]).filter((function(t){return!(0,y.isStaticInputPinConfig)(i[t].config)})),G=function(){I[T].clear(),(0,f.keys)(I).filter((function(t){return t.startsWith("".concat(S,"."))})).forEach((function(t){I[t]=new Map}))},F=function t(e){var u,s=z.includes(null==e?void 0:e.key);if(H&&!s);else{var p=H&&s;if((0,d.isPartStateValid)(i,R,o)||p){var v=void 0;if(H){if(!e)throw new Error("Unexpected state,  got reactive part while not processing and not valid");var y=(0,d.pullValueForExecution)(e.key,i[e.key],R,O);v=r(r({},M),((u={})[e.key]=y,u)),A()}else v=(0,d.pullValuesForExecution)(i,R,O),M=v,A();var I=new Set,x={};if(H=!0,D({type:h.DebuggerEventType.PROCESSING_CHANGE,val:H,insId:g,parentInsId:b}),o.completionOutputs){var j=o.completionOutputs.map((function(t){return t.split("+")})).reduce((function(t,e){return e.forEach((function(n){t.set(n,e)})),t}),new Map);(0,f.entries)(a).forEach((function(e){var r=e[0];e[1].pipe((0,c.first)()).subscribe((function(e){I.add(r),x[r]=e;var a=j.get(r);a&&(a.splice(a.indexOf(r),1),0===a.length&&(H=!1,D({type:h.DebuggerEventType.PROCESSING_CHANGE,val:H,insId:g,parentInsId:b}),C&&C(x),G(),(0,m.callFnOrFnPromise)(n,"Error with cleanup function of ".concat(o.id)),n=void 0,I.clear(),x={},(0,d.hasNewSignificantValues)(i,R,O,o.id)&&t()))}))}))}else G();try{k("Running part %s with values %o",o.id,v),_&&_(),n=w(v,a,V),(0,m.isPromise)(n)?n.then((function(){void 0===o.completionOutputs&&C&&(H=!1,D({type:h.DebuggerEventType.PROCESSING_CHANGE,val:H,insId:g,parentInsId:b}),C(x))})):void 0===o.completionOutputs&&C&&(H=!1,D({type:h.DebuggerEventType.PROCESSING_CHANGE,val:H,insId:g,parentInsId:b}),C(x))}catch(F){console.log(F),H=!1,k("Error in part %s - value %e",o.id,F),D({type:h.DebuggerEventType.PROCESSING_CHANGE,val:H,insId:g,parentInsId:b}),P(F)}var E=z.find((function(t){return i[t]&&(0,d.peekValueForExecution)(t,i[t],R,O,o.id)}));if(E)y=(0,d.peekValueForExecution)(E,i[E],R,O,o.id),t({key:E,value:y});else{var S=(0,f.entries)(i).find((function(t){var e=t[0],n=t[1],r=(0,l.isQueueInputPinConfig)(n.config,n),i=(0,d.peekValueForExecution)(e,n,R,O,o.id);if(r)return(0,f.isDefined)(i)}));if(S){var T=S[0],N=S[1];y=(0,d.peekValueForExecution)(T,N,R,O,o.id),t({key:T,value:y})}}}}};F();var B=(0,d.subscribeInputsToState)(i,R,u,g,(function(t,e){j("Got input %s - value is [%o]",t,e),A();try{F({key:t,value:e})}catch(n){P(n)}}));return E.push(B),function(){(0,m.callFnOrFnPromise)(n,"Error with cleanup function of ".concat(o.id)),E.forEach((function(t){return t()}))}}({part:F,inputs:L,outputs:U,repo:z,_debugger:I,insId:_,mainState:w,parentInsId:E,onError:G,onBubbleError:S,env:N,extraContext:O,onCompleted:M,onStarted:A});return function(){V.forEach((function(t){return t()})),q()}}},23939:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.subscribeInputsToState=e.isPartStateValid=e.hasNewSignificantValues=e.peekValuesForExecution=e.pullValuesForExecution=e.pullValueForExecution=e.peekValueForExecution=void 0;var i=n(24048),a=n(45821),u=n(6485),s=function(t,e){var n=(0,i.extractStaticValue)(t);return(0,i.isEnvValue)(n)?function(t,e){for(var n=t.split("."),o=r({},e),i=0,u=n;i<u.length;i++){var s=u[i];if(!o||!(0,a.isDefined)(o[s])||null===o[s])throw new Error("Cannot find key ".concat(t," inside obj ").concat(e));o=o[s]}return o}((0,i.getEnvKeyFromValue)(n),e):n};e.peekValueForExecution=function(t,e,n,r,a){var u=n.get(t);if(!e)throw new Error('Trying to peek value of inexsting input in key "'.concat(t,'" in part "').concat(a,'"'));return(0,i.isStaticInput)(e)?s(e,r):(0,i.isQueueInputPinConfig)(e.config,e)?u?o([],u,!0).shift():void 0:u};e.pullValueForExecution=function(t,e,n,r){var o,a=n.get(t);return(0,i.isStaticInput)(e)?o=s(e,r):(0,i.isQueueInputPinConfig)(e.config,e)?(o=(a||[]).shift(),n.set(t,a)):(o=a,(0,i.isStickyInputPinConfig)(e.config)||n.delete(t)),o};e.pullValuesForExecution=function(t,n,r){return(0,a.entries)(t).reduce((function(t,o){var i=o[0],a=o[1];return t[i]=(0,e.pullValueForExecution)(i,a,n,r),t}),{})};e.peekValuesForExecution=function(t,n,r,o){return(0,a.entries)(t).reduce((function(t,i){var a=i[0],u=i[1];return t[a]=(0,e.peekValueForExecution)(a,u,n,r,o),t}),{})};e.hasNewSignificantValues=function(t,n,r,o){return(0,a.entries)(t).some((function(t){var u=t[0],s=t[1],c=(0,i.isQueueInputPinConfig)(s.config,s),l=(0,e.peekValueForExecution)(u,s,n,r,o);return(0,a.isDefined)(l)&&c}))};e.isPartStateValid=function(t,e,n){var r=(0,a.keys)(t),o=(0,a.keys)(n.inputs).filter((function(t){return"required"===n.inputs[t].mode}));return r.includes(u.TRIGGER_PIN_ID)&&o.push(u.TRIGGER_PIN_ID),!!(0,a.containsAll)(r,o)&&(0,a.entries)(t).filter((function(t){var e=t[0];return!!n.inputs[e]||e===u.TRIGGER_PIN_ID})).every((function(t){var r,o=t[0],u=t[1],s=e.get(o);return"optional"===((null===(r=n.inputs[o])||void 0===r?void 0:r.mode)||"required")||(!!(0,i.isStaticInput)(u)||((0,i.isQueueInputPinConfig)(u.config,u)?(0,a.isDefined)(s)&&s.length>0:(0,a.isDefined)(s)))}))};e.subscribeInputsToState=function(t,e,n,r,o){var u=[];return(0,a.entries)(t).forEach((function(t){var n=t[0],r=t[1];if(r&&!(0,i.isStaticInput)(r)){var a=r.subject.subscribe((function(t){if((0,i.isQueueInputPinConfig)(r.config,r)){var a=e.get(n)||[];if(!Array.isArray(a))throw new Error("impossible state - state of key ".concat(n," is set but not an array"));a.push(t),e.set(n,a),o(n,t)}else e.set(n,t),o(n,t)}));u.push((function(){return a.unsubscribe()}))}})),function(){return u.forEach((function(t){return t()}))}}},19735:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flydeFlowSchema=void 0;var r=n(89510),o=r.z.record(r.z.string(),r.z.string().or(r.z.array(r.z.string()))),i=r.z.strictObject({x:r.z.number(),y:r.z.number()}),a=r.z.discriminatedUnion("mode",[r.z.strictObject({mode:r.z.literal("static"),value:r.z.any()}),r.z.strictObject({mode:r.z.literal("queue")}),r.z.strictObject({mode:r.z.literal("sticky")})]),u=r.z.object({size:r.z.optional(r.z.enum(["small","regular","large"])),icon:r.z.optional(r.z.any()),color:r.z.optional(r.z.string()),cssOverride:r.z.optional(r.z.record(r.z.string()))}),s=r.z.object({pos:i.default({x:0,y:0}),id:r.z.string(),inputConfig:r.z.optional(r.z.record(r.z.string(),a)).default({}),visibleInputs:r.z.optional(r.z.array(r.z.string())),visibleOutputs:r.z.optional(r.z.array(r.z.string())),partId:r.z.optional(r.z.string()),part:r.z.optional(r.z.any()),style:r.z.optional(u)}).refine((function(t){return t.part||t.partId}),{message:"Instance must have either an inline part or refer to a partId"}),c=r.z.union([r.z.string(),r.z.object({mode:r.z.enum(["required","optional","required-if-connected"]),type:r.z.string(),description:r.z.optional(r.z.string()),defaultValue:r.z.optional(r.z.any())})]),l=r.z.object({type:r.z.string(),optional:r.z.optional(r.z.boolean()),delayed:r.z.optional(r.z.boolean()),description:r.z.optional(r.z.string())}),p=r.z.object({id:r.z.optional(r.z.string()),inputs:r.z.record(r.z.string(),c),outputs:r.z.record(r.z.string(),l),inputsPosition:r.z.optional(r.z.record(r.z.string(),i)),outputsPosition:r.z.optional(r.z.record(r.z.string(),i)),customViewCode:r.z.optional(r.z.string()),dataBuilderSource:r.z.optional(r.z.string()),templateType:r.z.optional(r.z.string()),completionOutputs:r.z.optional(r.z.array(r.z.string())),reactiveInputs:r.z.optional(r.z.array(r.z.string())),defaultStyle:r.z.optional(u),description:r.z.optional(r.z.string())}),d=r.z.object({instances:r.z.array(s),connections:r.z.array(r.z.strictObject({from:r.z.strictObject({insId:r.z.string(),pinId:r.z.string()}),to:r.z.strictObject({insId:r.z.string(),pinId:r.z.string()}),delayed:r.z.optional(r.z.boolean()),hidden:r.z.optional(r.z.boolean())}))}).and(p);e.flydeFlowSchema=r.z.strictObject({imports:r.z.optional(o).default({}),part:d})},18265:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.isStaticValueVisualPart=void 0,o(n(45821),e);var i=n(24048);o(n(6485),e),o(n(30385),e),o(n(69789),e),o(n(24048),e),o(n(90163),e),o(n(51922),e),o(n(11302),e),o(n(55281),e),o(n(19735),e);e.isStaticValueVisualPart=function(t){return t&&!!(0,i.maybeGetStaticValuePartId)("".concat(t))}},88004:function(t,e,n){"use strict";var r=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.fakeVm=e.VM=e.VMScript=void 0;var o=n(18265),i=function(t){this.script=t};e.VMScript=i;var a=function(){function t(t){this.context=t}return t.prototype.run=function(t){var e=(0,o.okeys)(this.context.sandbox),n=Object.values(this.context.sandbox);Function.apply(void 0,r(r([],e,!1),[t.script],!1)).apply(void 0,n)},t}();e.VM=a,e.fakeVm={VMScript:i,VM:a}},58725:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getVM2Instance=void 0;var r=n(88004);e.getVM2Instance=function(){return r.fakeVm}},11302:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},i=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.customRepoToPartRepo=e.inlineValuePartToPart=void 0;var a=n(14206),u=n(18265),s=n(24048),c=n(18265),l=(0,n(58725).getVM2Instance)();e.inlineValuePartToPart=function(t,e){void 0===e&&(e={});var n=t.fnCode,p=o(t,["fnCode"]),d=(0,u.debugLogger)("code-part:".concat(t.id)),f="\n  try {\n    ".concat(n,"\n  } catch (e) {\n    adv.onError(e);\n  }\n  "),v=new l.VMScript(f),y=r(r({},p),{fn:function(n,o,p){var f=new l.VM({sandbox:r({inputs:n,outputs:o,setInterval:setInterval,clearInterval:clearInterval,setTimeout:setTimeout,clearTimeout:clearTimeout,encodeURIComponent:encodeURIComponent,adv:p,log:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];d.apply(void 0,i(["Log from code part ".concat(t.id," [").concat(p.insId,"]")],e,!1))},axios:a.default,DEFAULT_AXIOS_TIMEOUT:15e3,dynamicPartInput:s.dynamicPartInput,dynamicPartArg:s.dynamicPartInput,dynamicOutput:c.dynamicOutput,isDefined:c.isDefined,compileStringTemplate:u.compileStringTemplate,compileObjectTemplate:u.compileObjectTemplate,__FLYDE_MODE:"production"},e)});f.run(v)}});return y};e.customRepoToPartRepo=function(t,n){void 0===n&&(n={});var r={};for(var o in t){var i=t[o];r[o]=(0,s.isInlineValuePart)(i)?(0,e.inlineValuePartToPart)(i,n):i}return r}},90163:function(t,e,n){"use strict";var r=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.getPartWithDependencies=void 0;var o=n(24048),i=n(18265),a=n(93471);e.getPartWithDependencies=function(t,n,u){if(void 0===u&&(u=[]),(0,o.isInlineValuePart)(t))return[t];if(u.includes(t.id))return[];var s=(0,i.removeDupes)(t.instances.filter((function(t){return(0,a.isRefPartInstance)(t)})).map((function(t){return t.partId})).filter((function(t){return n[t]}))),c=s.map((function(t){return n[t]})).reduce((function(t,o){return r(r([],t,!0),(0,e.getPartWithDependencies)(o,n,r(r([],u,!0),s,!0)),!0)}),[]);return r([t],c,!0)}},24048:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||o(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.codeFromFunction=e.getPartDef=e.getPart=e.getStaticValue=e.maybeGetStaticValuePartId=e.fromSimplified=e.inlineValuePart=e.codePart=e.visualPart=e.isInlineValuePart=e.isVisualPart=e.isCodePart=e.InlineValuePartType=void 0;var a=n(45821),u=n(18265),s=n(93471);i(n(93471),e),i(n(85089),e),i(n(34702),e),function(t){t.VALUE="value",t.FUNCTION="function"}(e.InlineValuePartType||(e.InlineValuePartType={}));e.isCodePart=function(t){return!(0,e.isVisualPart)(t)};e.isVisualPart=function(t){return!!t.instances};e.isInlineValuePart=function(t){return(0,a.isDefined)(t)&&(0,a.isDefined)(t.fnCode)},e.visualPart=(0,a.testDataCreator)({id:"visual-part",inputs:{},outputs:{},instances:[],connections:[],outputsPosition:{},inputsPosition:{}}),e.codePart=(0,a.testDataCreator)({id:"part",inputs:{},outputs:{},fn:a.noop}),e.inlineValuePart=(0,a.testDataCreator)({id:"part",inputs:{},outputs:{},fnCode:""});e.fromSimplified=function(t){var e=t.fn,n=t.inputTypes,o=t.outputTypes,i=t.id,u=(0,a.entries)(n).reduce((function(t,e){var n,o=e[0];e[1];return r(r({},t),((n={})[o]={},n))}),{}),s=(0,a.entries)(o).reduce((function(t,e){var n,o=e[0];e[1];return r(r({},t),((n={})[o]={},n))}),{});return{id:i,inputs:u,outputs:s,fn:e}};e.maybeGetStaticValuePartId=function(t){var e="string"==typeof t&&t.match(/^__part\:(.*)/);return e?e[1]:null};e.getStaticValue=function(t,n,r){var o=(0,e.maybeGetStaticValuePartId)(t);if(o){var i=n[o];if(!i)throw new Error("Instance ".concat(r," referrer to a part reference ").concat(o," that does not exist"));return i}return t};e.getPart=function(t,e){if("string"!=typeof t&&(0,s.isInlinePartInstance)(t))return t.part;var n="string"==typeof t?t:t.partId,r=e[n];if(!r)throw new Error("Part with id ".concat(n," not found"));return r};e.getPartDef=function(t,e){if("string"!=typeof t&&(0,s.isInlinePartInstance)(t))return t.part;var n="string"==typeof t?t:t.partId,r=e[n];if(!r)throw console.error("Part with id ".concat(n," not found")),new Error("Part with id ".concat(n," not found"));return r};e.codeFromFunction=function(t){var e,n=t.id,o=t.fn,i=t.inputNames,a=t.outputName,s=t.defaultStyle;return{id:n,inputs:i.reduce((function(t,e){var n;return r(r({},t),((n={})[e]=(0,u.partInput)(),n))}),{}),outputs:(e={},e[a]=(0,u.partOutput)(),e),fn:function(t,e){var n=i.map((function(e){return t[e]})),r=e[a],u=o.apply(void 0,n);return Promise.resolve(u).then((function(t){return r.next(t)}))},completionOutputs:[a],defaultStyle:s}}},93471:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PartInstance=e.isRefPartInstance=e.isInlinePartInstance=e.inlinePartInstance=e.partInstance=void 0;e.partInstance=function(t,e,n,r){return{id:t,partId:e,inputConfig:n||{},pos:r||{x:0,y:0}}};e.inlinePartInstance=function(t,e,n,r){return{id:t,part:e,inputConfig:n||{},pos:r||{x:0,y:0}}};e.isInlinePartInstance=function(t){return!!t.part};e.isRefPartInstance=function(t){return!(0,e.isInlinePartInstance)(t)};e.PartInstance=function(t,e,n,r){return{id:t,partId:e.id,inputConfig:n||{},pos:r||{x:0,y:0}}}},85089:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getEnvKeyFromValue=e.toEnvValue=e.isEnvValue=e.extractStaticValue=e.isStaticInput=e.isDynamicInput=e.staticPartInput=e.dynamicPartInputs=e.dynamicPartInput=e.dynamicOutput=e.partOutputs=e.partOutput=e.partInputs=e.isInputPinOptional=e.partInput=void 0;var r=n(71542),o=n(24048),i=n(45821),a=n(34702);e.partInput=function(t){return void 0===t&&(t="required"),{mode:t}};e.isInputPinOptional=function(t){return"optional"===t.mode};e.partInputs=function(t,n){return(0,i.repeat)(t,(function(t){return(0,e.partInput)(n[t]||"required")}))};e.partOutput=function(t){return void 0===t&&(t=!1),{delayed:t}};e.partOutputs=function(t){return(0,i.repeat)(t,(function(){return(0,e.partOutput)()}))};e.dynamicOutput=function(){return new r.Subject},e.dynamicPartInput=(0,i.testDataCreator)((function(){return{subject:new r.Subject,config:(0,a.queueInputPinConfig)()}}));e.dynamicPartInputs=function(t){return void 0===t&&(t=10),(0,i.repeat)(t,(function(){return(0,i.testDataCreator)((function(){return{subject:new r.Subject,config:(0,a.queueInputPinConfig)()}}))()}))};e.staticPartInput=function(t){return{config:(0,a.staticInputPinConfig)(t)}};e.isDynamicInput=function(t){var e=t;return e&&e.subject&&!!e.subject.next};e.isStaticInput=function(t){return(0,o.isStaticInputPinConfig)(t.config)};e.extractStaticValue=function(t){if((0,e.isStaticInput)(t))return t.config.value;throw new Error("Cannot extract static value from non static arg")};e.isEnvValue=function(t){return"string"==typeof t&&t.startsWith("$ENV.")};e.toEnvValue=function(t){return"$ENV.".concat(t)};e.getEnvKeyFromValue=function(t){return"string"==typeof t?t.replace(/^\$ENV\./,""):t}},34702:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isStaticInputPinConfig=e.isStickyInputPinConfig=e.isQueueInputPinConfig=e.staticInputPinConfig=e.stickyInputPinConfig=e.queueInputPinConfig=e.INPUT_MODES=void 0,e.INPUT_MODES=["queue","sticky","static"];e.queueInputPinConfig=function(){return{mode:"queue"}};e.stickyInputPinConfig=function(){return{mode:"sticky"}};e.staticInputPinConfig=function(t){return{mode:"static",value:t}};e.isQueueInputPinConfig=function(t,e){return"queue"===t.mode};e.isStickyInputPinConfig=function(t){return t&&"sticky"===t.mode},e.isStaticInputPinConfig=function(t){return t&&"static"===t.mode}},69789:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.simplifiedExecute=void 0;var o=n(18265),i=n(30385);e.simplifiedExecute=function(t,e,n,a,u){void 0===u&&(u={});var s=(0,o.keys)(t.outputs),c=Object.keys(n).reduce((function(t,e){var i,a=n[e];return r(r({},t),((i={})[e]=(0,o.isDynamicInput)(a)?a:(0,o.staticPartInput)(a),i))}),{}),l=s.reduce((function(t,e){var n,i=(0,o.dynamicOutput)();return a&&i.subscribe((function(t){a(e,t)})),r(r({},t),((n={})[e]=i,n))}),{});return(0,i.execute)(r({part:t,inputs:c,outputs:l,partsRepo:e,onBubbleError:function(t){throw t}},u))}},51922:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},55281:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isScheduledTrigger=e.isRestApiTrigger=e.isWebAppTrigger=void 0;e.isWebAppTrigger=function(t){return"web-app"===t.type};e.isRestApiTrigger=function(t){return"rest-api"===t.type};e.isScheduledTrigger=function(t){return"scheduled"===t.type}},23489:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.PartPreview=void 0;var o=n(24246),i=n(18265),a=n(57768);e.PartPreview=function(t){var e=t.part,n={part:e,instance:(0,i.partInstance)("bob",e.id,{}),connections:[],connectionsPerInput:{},connectionsPerOutput:{},viewPort:{pos:{x:0,y:0},zoom:1},partDefRepo:{},onUngroup:i.noop,onDblClick:i.noop,onDragEnd:i.noop,onDragMove:i.noop,onDragStart:i.noop,onPinClick:i.noop,onPinDblClick:i.noop,onSelect:i.noop,onTogglePinBreakpoint:i.noop,onTogglePinLog:i.noop,onToggleSticky:i.noop,displayMode:!0,onInspectPin:i.noop,onDetachConstValue:i.noop,onCopyConstValue:i.noop,onPasteConstValue:i.noop,onRequestHistory:i.noop,parentInsId:"",onChangeVisibleInputs:i.noop,onChangeVisibleOutputs:i.noop,onConvertConstToEnv:i.noop,forceShowMinimized:"both",onExtractInlinePart:i.noop,onCloseInlineEditor:i.noop,isConnectedInstanceSelected:!1,inlineEditorPortalDomNode:null,onChangeStyle:i.noop,onDeleteInstance:i.noop,onGroupSelected:i.noop,onSetDisplayName:i.noop};return(0,o.jsx)("div",r({className:"part-preview"},{children:(0,o.jsx)(a.InstanceView,r({},n))}))}},90412:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},u=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||o(e,t,n)},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},c=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},l=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},p=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.FlowEditor=void 0;var d=n(24246),f=a(n(27378)),v=n(18265),y=n(41304),m=p(n(63300)),h=n(14648),g=n(13011),b=n(40232),I=n(51424),P=n(24935),_=n(91312),C=n(30537),O=n(31425),x=n(44370),w=n(96149);u(n(91312),e),C.library.add(O.fab,x.fas);var j=["select","drag-move","order-step"],E=function(t){var e;return r(r({},t.dependencies),((e={})[t.main.id]=t.main,e))};e.FlowEditor=f.memo(f.forwardRef((function(t,e){var n=t.state,o=t.resolvedRepoWithDeps,i=t.onChangeEditorState,a=t.onImportPart,u=f.useState([]),p=u[0],C=u[1],O=f.useState([]),x=O[0],D=O[1],S=n.flow,T=n.boardData,N=n.flow.part,k=(0,_.usePorts)().openFile,M=f.useCallback((function(t,e){console.log("onChangeFlow",e.type),"functional"===e.type&&(C(l([{flow:t}],p.slice(0,50),!0)),D([])),i((function(e){return r(r({},e),{flow:t})}))}),[i,p]),R=f.useState({instances:[],connections:[]}),A=R[0],V=R[1],H=f.useState(!1),z=H[0],G=H[1],F=f.useCallback((function(){return G(!1)}),[]),B=f.useCallback((function(){return G(!0)}),[]),U=f.useCallback((function(t){i((function(e){return r(r({},e),{boardData:r(r({},e.boardData),t)})}))}),[i]);f.useEffect((function(){U({selected:[],viewPort:y.defaultViewPort,from:void 0,to:void 0,lastMousePos:{x:0,y:0}})}),[N.id]),(0,h.useHotkeys)("cmd+z",(function(t){D(l(l([],x,!0),[n],!1));var e=p[0],o=p.slice(1);e&&(i((function(t){return r(r({},t),e)})),C(o)),t.preventDefault()}),void 0,[n,p,x]),(0,h.useHotkeys)("a",(function(t){t.preventDefault(),B()}));var L=f.useCallback((function(t,e){j.some((function(t){return e.message.includes(t)}))||D([]);var n=(0,m.default)(S,(function(e){e.part=t}));M(n,e)}),[S,M]),q=f.useCallback((function(t){k({absPath:t.importPath})}),[k]),W=f.useCallback((function(t,e){void 0===e&&(e=-1*y.PART_HEIGHT*1.5);var n=(0,g.createNewPartInstance)(t,e,T.lastMousePos,E(o));if(n){var r=(0,m.default)(S,(function(t){var e=t.part;if(!(0,v.isVisualPart)(e))throw new Error("Impossible state, adding part to non visual part");e.instances.push(n)}));return M(r,(0,I.functionalChange)("add-part")),F(),n}}),[T.lastMousePos,S,M,F,o]),$=f.useCallback((function(t){return s(void 0,void 0,void 0,(function(){var e,n,r;return c(this,(function(i){switch(i.label){case 0:switch(t.type){case P.OmniBarCmdType.ADD:return[3,1];case P.OmniBarCmdType.ADD_VALUE:return[3,2];case P.OmniBarCmdType.CREATE_CODE_PART:return[3,3];case P.OmniBarCmdType.CREATE_GROUPED_PART:return[3,4];case P.OmniBarCmdType.IMPORT:return[3,5]}return[3,7];case 1:return[2,W(t.data)];case 2:return(0,g.domToViewPort)(T.lastMousePos,T.viewPort,y.defaultViewPort),(0,b.toastMsg)("TODO"),[3,8];case 3:case 4:return(0,b.toastMsg)("TODO"),[3,8];case 5:return[4,a(t.data,{pos:T.lastMousePos})];case 6:return i.sent(),e=(0,w.vAdd)({x:0,y:0},T.lastMousePos),n=(0,g.createNewPartInstance)(t.data.part,0,e,E(o)),r=(0,m.default)(S,(function(t){t.part.instances.push(n)})),M(r,(0,I.functionalChange)("add-imported-part")),[3,8];case 7:b.AppToaster.show({intent:"warning",message:"Not supported yet"}),i.label=8;case 8:return F(),[2]}}))}))}),[F,W,T.lastMousePos,T.viewPort,a,o,S,M]);return(0,d.jsx)("div",r({className:"project-editor"},{children:function(){if((0,v.isInlineValuePart)(N))throw new Error("Impossible state");return(0,d.jsxs)(f.Fragment,{children:[(0,d.jsx)(y.VisualPartEditor,{insId:"root.".concat(N.id),ref:e,boardData:T,onChangeBoardData:U,part:N,onGoToPartDef:q,onChangePart:L,resolvedFlow:o,clipboardData:A,onCopy:V,partIoEditable:!N.id.startsWith("Trigger"),onInspectPin:t.onInspectPin,onRequestHistory:t.onRequestHistory,onRequestImportables:t.onQueryImportables,onImportPart:t.onImportPart,onShowOmnibar:B,onExtractInlinePart:t.onExtractInlinePart},N.id),z?(0,d.jsx)(P.Omnibar,{flow:S,repo:o.dependencies,onCommand:$,visible:z,onClose:F,onRequestImportables:t.onQueryImportables}):null]})}()}))})))},57779:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.BasePartEditor=e.renderCreateIOOption=void 0;var i=n(24246),a=o(n(27378)),u=n(18265),s=n(42272),c=o(n(63300)),l=n(18185),p=n(23489);e.renderCreateIOOption=function(t,e,n){return(0,i.jsx)(s.MenuItem,{icon:"add",text:'Create "'.concat(t,'"'),active:e,onClick:n,shouldDismissPopover:!1})};var d=l.MultiSelect.ofType();e.BasePartEditor=function(t){var n,o,l=t.part,f=t.onChange,v=(0,u.entries)(l.inputs),y=v.filter((function(t){return"required"===t[1].mode})).map((function(t){return t[0]})),m=v.filter((function(t){return"optional"===t[1].mode})).map((function(t){return t[0]})),h=v.filter((function(t){return"required-if-connected"===t[1].mode})).map((function(t){return t[0]})),g=a.default.useState(!1),b=g[0],I=g[1],P=(0,u.okeys)(l.outputs),_=a.default.useCallback((function(t){f(r(r({},l),{id:t}))}),[l,f]),C=a.default.useCallback((function(t){var e=t?t.split(","):void 0;"[]"===t&&(e=[]),console.log(t,e),f(r(r({},l),{completionOutputs:e}))}),[l,f]),O=a.default.useCallback((function(t){var e=t?t.split(","):void 0;f(r(r({},l),{reactiveInputs:e}))}),[l,f]),x=a.default.useCallback((function(t,e){var n=(0,c.default)(l,(function(n){n.inputs[t]=(0,u.partInput)(e)}));f(n)}),[l,f]),w=a.default.useCallback((function(t){var e=(0,c.default)(l,(function(e){delete e.inputs[t]}));f(e)}),[l,f]),j=a.default.useCallback((function(t){var e=(0,c.default)(l,(function(e){e.outputs[t]=(0,u.partOutput)()}));f(e)}),[l,f]),E=a.default.useCallback((function(t){var e=(0,c.default)(l,(function(e){delete e.outputs[t]}));f(e)}),[l,f]);a.default.useCallback((function(t){try{var e=JSON.parse(t),n=(0,c.default)(l,(function(t){Object.entries(e).forEach((function(e){var n=e[0],o=(e[1],t.inputs[n]),i=t.outputs[n];o?t.inputs[n]=r({},o):i&&(t.outputs[n]=r({},i))}))}));f(n)}catch(o){console.error("cannot parse")}}),[f,l]);return(0,i.jsxs)("div",r({className:"base-part-editor"},{children:[(0,i.jsx)("div",r({className:"form-row"},{children:(0,i.jsx)(s.FormGroup,r({label:"Part Name",labelFor:"text-input",labelInfo:"(required)"},{children:(0,i.jsx)(s.InputGroup,{id:"part-name",disabled:t.idDisabled,placeholder:"Part ID",value:l.id,onChange:function(t){return _(t.target.value)}})}))})),(0,i.jsx)(s.FormGroup,r({label:"Required Inputs"},{children:(0,i.jsx)(d,{selectedItems:y,placeholder:"Enter input names here",items:[],tagRenderer:function(t){return t},onItemSelect:function(t){return x(t,"required")},onRemove:w,resetOnSelect:!0,itemRenderer:function(t){return(0,i.jsx)("span",{children:t})},createNewItemFromQuery:function(t){return t},createNewItemRenderer:e.renderCreateIOOption,fill:!0})})),!0!==t.hiddenOutputs?(0,i.jsx)(s.FormGroup,r({label:"Outputs"},{children:(0,i.jsx)(d,{selectedItems:P,placeholder:"Enter output names here",items:[],tagRenderer:function(t){return t},onItemSelect:j,onRemove:E,resetOnSelect:!0,itemRenderer:function(t){return(0,i.jsx)("span",{children:t})},createNewItemFromQuery:function(t){return t},createNewItemRenderer:e.renderCreateIOOption,fill:!0})})):null,(0,i.jsx)(s.Checkbox,r({checked:b,onChange:function(t){return I(t.target.checked)}},{children:"Show advanced options"})),(0,i.jsxs)(s.Collapse,r({isOpen:b},{children:[(0,i.jsx)(s.FormGroup,r({label:"Optional Inputs"},{children:(0,i.jsx)(d,{selectedItems:m,placeholder:"Enter input names here",items:[],tagRenderer:function(t){return t},onItemSelect:function(t){return x(t,"optional")},onRemove:w,resetOnSelect:!0,itemRenderer:function(t){return(0,i.jsx)("span",{children:t})},createNewItemFromQuery:function(t){return t},createNewItemRenderer:e.renderCreateIOOption,fill:!0})})),(0,i.jsx)(s.FormGroup,r({label:"Required-if-connected Inputs"},{children:(0,i.jsx)(d,{selectedItems:h,placeholder:"Enter input names here",items:[],tagRenderer:function(t){return t},onItemSelect:function(t){return x(t,"required-if-connected")},onRemove:w,resetOnSelect:!0,itemRenderer:function(t){return(0,i.jsx)("span",{children:t})},createNewItemFromQuery:function(t){return t},createNewItemRenderer:e.renderCreateIOOption,fill:!0})})),(0,i.jsx)(s.FormGroup,r({label:"Completion Outputs"},{children:(0,i.jsx)(s.InputGroup,{id:"completion-outputs",placeholder:"completion outputs",value:(null===(n=l.completionOutputs)||void 0===n?void 0:n.join(","))||"",onChange:function(t){return C(t.target.value)}})})),(0,i.jsx)(s.FormGroup,r({label:"Reactive Inputs"},{children:(0,i.jsx)(s.InputGroup,{id:"reactive-inputs",placeholder:"Reactive inputs",value:(null===(o=l.reactiveInputs)||void 0===o?void 0:o.join(","))||"",onChange:function(t){return O(t.target.value)}})}))]})),(0,i.jsx)(s.FormGroup,r({label:"Preview"},{children:(0,i.jsx)("div",r({className:"preview-wrapper"},{children:(0,i.jsx)(p.PartPreview,{part:l})}))}))]}))}},51424:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.metaChange=e.functionalChange=void 0;e.functionalChange=function(t){return{type:"functional",message:t}};e.metaChange=function(t){return void 0===t&&(t="n/a"),{type:"meta",message:t}}},63213:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.InlineCodeModal=void 0;var s=n(24246),c=a(n(27378)),l=u(n(77324)),p=n(42272),d=u(n(60042)),f=n(52178),v=n(18265),y=n(28983),m="`Result is ${inputs.a + inputs.b}`";e.InlineCodeModal=c.memo((function(t){var e,n=t.initialValue,o=t.initialType,i=c.useState((0,v.isDefined)(n)?n:m),a=i[0],u=i[1],h=c.useState(o||v.InlineValuePartType.VALUE),g=h[0],b=h[1],I=(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{children:['You can add variables to by referrencing the "inputs" object.',(0,s.jsx)("br",{})," For example:",(0,s.jsx)(p.Code,{children:"`Hello {inputs.name}`"}),' will expose an input pin named "name"']}),(0,s.jsxs)("p",{children:["You can also use ternery expressions, arithmetic operators and more!",(0,s.jsx)("br",{}),"For example:",(0,s.jsx)(p.Code,{children:"inputs.a > inputs.b ? inputs.a + 42 : Math.random() * inputs.b"})]})]}),P=(0,s.jsxs)("span",{children:["Type in any valid JS value, such as ",(0,s.jsx)(p.Code,{children:"true"}),", ",(0,s.jsx)(p.Code,{children:"42"}),","," ",(0,s.jsx)(p.Code,{children:'["bob", "alice", "dave"]'}),".",(0,s.jsx)("br",{})," Dynamic inputs may also be used"]}),_=(0,s.jsxs)("span",{children:["Write any JS code and return a value.",(0,s.jsx)("br",{})," The returned value will be the output.",(0,s.jsx)("br",{})," Example:",(0,s.jsx)(p.Code,{children:"const a = inputs.a; const b = inputs.b; return Math.floor(a/b);"})]}),C=(0,f.getVariables)(a);return c.useEffect((function(){a===m&&g===v.InlineValuePartType.FUNCTION&&u("return ".concat(m)),a==="return ".concat(m)&&g===v.InlineValuePartType.VALUE&&u(m)}),[a,g]),(0,s.jsxs)(p.Dialog,r({isOpen:!0,title:"Inline Value / Code",onClose:t.onCancel,canEscapeKeyClose:!1,className:"inline-code-modal"},{children:[(0,s.jsxs)("main",r({className:(0,d.default)(p.Classes.DIALOG_BODY),onKeyDown:function(e){"Enter"===e.key&&e.metaKey&&t.onSubmit(g,a)},tabIndex:0},{children:[(0,s.jsxs)(p.RadioGroup,r({inline:!0,onChange:function(t){return b(t.target.value)},selectedValue:g},{children:[(0,s.jsx)(p.Radio,{labelElement:(0,s.jsxs)(c.Fragment,{children:["Value"," ",(0,s.jsx)(y.Tooltip2,r({content:P,placement:"top"},{children:(0,s.jsx)(p.Icon,{icon:"info-sign",intent:"primary"})}))]}),value:v.InlineValuePartType.VALUE}),(0,s.jsx)(p.Radio,{labelElement:(0,s.jsxs)(c.Fragment,{children:["Function"," ",(0,s.jsx)(y.Tooltip2,r({content:_,placement:"top"},{children:(0,s.jsx)(p.Icon,{icon:"info-sign",intent:"primary"})}))]}),value:v.InlineValuePartType.FUNCTION})]})),(0,s.jsx)(l.default,{height:"80px",theme:"vs-dark",defaultLanguage:"javascript",value:a,onChange:function(t){return u(t||"")},onMount:function(t){t&&t.updateOptions({lineNumbers:"off",minimap:{enabled:!1}})}}),(e=a.includes("return"),e&&g===v.InlineValuePartType.VALUE?(0,s.jsx)(p.Callout,r({intent:p.Intent.WARNING},{children:'When using the "value" type you are not expected to return anything'})):e||g!==v.InlineValuePartType.FUNCTION?null:(0,s.jsxs)(p.Callout,r({intent:p.Intent.DANGER},{children:['When using the "function" type you are expected to'," ",(0,s.jsx)(p.Code,{children:"return"})," a value.",(0,s.jsx)("br",{}),"Example: ",(0,s.jsx)(p.Code,{children:"return 42 + Date.now();"})]}))),(0,s.jsxs)(p.Callout,r({intent:p.Intent.NONE},{children:["Input pins detected:"," ",C.length?C.map((function(t){return(0,s.jsx)(p.Code,{children:t},t)})):"None",(0,s.jsx)(y.Tooltip2,r({content:I},{children:(0,s.jsx)(p.Icon,{icon:"info-sign",intent:p.Intent.PRIMARY})}))]}))]})),(0,s.jsx)("div",r({className:p.Classes.DIALOG_FOOTER},{children:(0,s.jsxs)("div",r({className:p.Classes.DIALOG_FOOTER_ACTIONS},{children:[(0,s.jsx)(p.Button,r({onClick:t.onCancel},{children:"Cancel"})),(0,s.jsx)(p.Button,r({onClick:function(){return t.onSubmit(g,a)},intent:p.Intent.PRIMARY,className:"save-btn"},{children:"Save"}))]}))}))]}))}))},52178:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.createInlineValuePart=e.getVariables=void 0;var o=n(18265),i=n(18265);e.getVariables=function(t){return(t.match(/inputs\.([a-zA-Z]\w*)/g)||[]).map((function(t){return t.replace(/inputs\./,"")}))};e.createInlineValuePart=function(t){var n=t.code,a=t.customView,u=t.partId,s=t.type,c=(0,e.getVariables)(n).reduce((function(t,e){var n;return r(r({},t),((n={})[e]=(0,o.partInput)(),n))}),{}),l={value:(0,o.partOutput)()},p=s===o.InlineValuePartType.FUNCTION?"const result = (function() { ".concat(n,"}());\n  Promise.resolve(result).then(val => outputs.value.next(val))"):"const result = (".concat(n,"); Promise.resolve(result).then(val => outputs.value.next(val))"),d=btoa(n);return(0,i.inlineValuePart)({id:u||"Inline Code ".concat((0,o.randomInt)(99999)),inputs:c,outputs:l,fnCode:p,customViewCode:a||n,dataBuilderSource:d,templateType:s,completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}},description:"Custom inline ".concat(s===o.InlineValuePartType.VALUE?"value":"function")})}},24935:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},u=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Omnibar=e.OmniBarCmdType=void 0;var c,l=n(24246),p=a(n(27378)),d=n(18185),f=n(18265),v=n(42272),y=s(n(60042));!function(t){t.ADD="add",t.ADD_VALUE="add-value",t.CREATE_CODE_PART="create-core-part",t.CREATE_GROUPED_PART="create-visual-part",t.IMPORT="import"}(c=e.OmniBarCmdType||(e.OmniBarCmdType={}));var m=[];e.Omnibar=function(t){var e=t.repo,n=p.useState(""),o=n[0],i=n[1],a=p.useState(null),s=a[0],h=a[1],g=p.useState([]),b=g[0],I=g[1];p.useEffect((function(){var t=(0,f.keys)(e).map((function(t){var n=e[t];return{title:"".concat(n.id),cmd:{type:c.ADD,data:t},extra:"current flow"}})),n=b.map((function(t){return{title:"".concat(t.part.id),description:t.part.description,cmd:{type:c.IMPORT,data:t},extra:"".concat(t.module)}})),r={title:"Add inline value or code",suggestOnEmpty:!0,cmd:{type:c.ADD_VALUE}},o=u(u(u(u([],m,!0),n,!0),[r],!1),t,!0);h(o)}),[e,b]),p.useEffect((function(){t.onRequestImportables&&t.onRequestImportables(o).then((function(t){I(t)}))}),[t,o]);var P=p.useCallback((function(t,e){var n=e.handleClick,o=e.modifiers,i=(e.query,e.index);if(!o.matchesPredicate)return null;var a="".concat(t.title);return(0,l.jsx)(v.MenuItem,{active:o.active,disabled:o.disabled,onClick:n,text:(0,l.jsxs)("div",r({className:(0,y.default)("omnibar-item",{active:o.active})},{children:[(0,l.jsxs)("div",r({className:"title"},{children:[a," ",t.extra?(0,l.jsx)("span",r({className:"extra"},{children:t.extra})):null]})),t.description?(0,l.jsx)("div",r({className:"description"},{children:t.description})):null]}))},i)}),[]),_=p.useCallback((function(t,e){var n=t.toLowerCase().split("").map((function(t){return"".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),".*")})).join(""),r=new RegExp(n);return!!e.title.toLowerCase().match(r)}),[]),C=p.useCallback((function(e){t.onCommand(e.cmd),t.onClose()}),[t]);return s?(0,l.jsx)(d.Omnibar,{query:o,onQueryChange:i,onClose:t.onClose,noResults:(0,l.jsx)(v.MenuItem,{disabled:!0,text:"No results."}),itemPredicate:_,isOpen:t.visible,items:s,initialContent:void 0,onItemSelect:C,itemRenderer:P,inputProps:{placeholder:"Search for parts or commands.."}}):null}},91312:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(2297),e)},2297:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.usePorts=e.useConfirm=e.usePrompt=e.PortsContext=e.defaultPorts=void 0;var i=n(40232),a=n(27378),u=function(){return r(void 0,void 0,void 0,(function(){return o(this,(function(t){throw new Error("Not implemented")}))}))};e.defaultPorts={prompt:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e=t.text,n=t.defaultValue;return r(void 0,void 0,void 0,(function(){return o(this,(function(t){return[2,prompt("".concat(e),n)]}))}))})),openFile:function(t){return r(void 0,void 0,void 0,(function(){return o(this,(function(e){return(0,i.toastMsg)("Open ".concat(t)),[2]}))}))},confirm:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e=t.text;return r(void 0,void 0,void 0,(function(){return o(this,(function(t){return[2,confirm(e)]}))}))})),readFlow:u,saveFlow:u,resolveDeps:u,getImportables:u,onFlowChange:u},e.PortsContext=(0,a.createContext)(e.defaultPorts);e.usePrompt=function(){var t=(0,a.useContext)(e.PortsContext).prompt;return function(e,n){return t({text:e,defaultValue:n})}};e.useConfirm=function(){var t=(0,a.useContext)(e.PortsContext).confirm;return function(e){return t({text:e})}};e.usePorts=function(){return(0,a.useContext)(e.PortsContext)}},27234:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},a=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.groupSelected=void 0;var s=n(18265),c=u(n(63300)),l=n(78504);e.groupSelected=function(t,e,n,u,p){return o(void 0,void 0,void 0,(function(){var o,d,f,v,y,m,h,g,b,I,P,_;return i(this,(function(i){switch(i.label){case 0:if(o=e.instances,d=e.connections,f=o.filter((function(e){return t.includes(e.id)})),v=d.filter((function(e){var n=e.from,r=e.to;return-1!==t.indexOf(n.insId)||-1!==t.indexOf(r.insId)})),!f.length)throw new Error("visual without selections");return[4,(0,l.createGroup)(f,v,n,p)];case 1:return y=i.sent(),m=y.visualPart,h=y.renamedInputs,g=y.renamedOutputs,b=f.reduce((function(t,e){return(0,s.middlePos)(e.pos,t)}),o[0].pos),I="ref"===u?(0,s.partInstance)("".concat(m.id,"-ins"),m.id,{},b):(0,s.inlinePartInstance)("".concat(m.id,"-ins"),m,{},b),P=o.filter((function(e){return-1===t.indexOf(e.id)})),_=d.map((function(t){var e="".concat(t.from.insId,".").concat(t.from.pinId),n="".concat(t.to.insId,".").concat(t.to.pinId);return h[n]?r(r({},t),{to:{insId:I.id,pinId:h[n]}}):g[e]?r(r({},t),{from:{insId:I.id,pinId:g[e]}}):t})).filter((function(e){return-1===t.indexOf(e.from.insId)&&-1===t.indexOf(e.to.insId)})),[2,{newPart:m,currentPart:(0,c.default)(e,(function(t){t.instances=a(a([],P,!0),[I],!1),t.connections=_}))}]}}))}))}},96149:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(90412),e),o(n(12901),e),o(n(77437),e),o(n(40232),e),o(n(99457),e),o(n(51424),e),o(n(23489),e),o(n(69385),e),o(n(10934),e),o(n(4824),e),o(n(14648),e),o(n(26013),e),o(n(76298),e),o(n(11897),e),o(n(99743),e),o(n(57779),e),o(n(13011),e),o(n(12887),e)},60614:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.BrowserOnlyReactJson=void 0;var o=n(24246);e.BrowserOnlyReactJson=function(t){if("undefined"==typeof window)return null;var e=n(51366).default;return(0,o.jsx)(e,r({},t))}},26013:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AnalyticsValueRenderer=void 0;var r=n(24246),o=n(18265),i=n(60614);e.AnalyticsValueRenderer=function(t){var e=t.val;try{var n=JSON.parse(e),a="object"==typeof n?n:{value:n},u=n&&[n.type,n.key,n.props,n.ref].every(o.isDefined),s=u?{jsxValue:n}:a;return(0,r.jsx)(i.BrowserOnlyReactJson,{src:s,name:!1,collapseStringsAfterLength:50,groupArraysAfterLength:5,collapsed:u})}catch(c){return(0,r.jsx)(i.BrowserOnlyReactJson,{src:{value:e},name:!1,collapseStringsAfterLength:50,groupArraysAfterLength:5})}}},78504:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},a=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.createGroup=void 0;var u=n(18265),s=n(18265),c=n(99743);e.createGroup=function(t,e,n,l){return o(void 0,void 0,void 0,(function(){var o,p,d,f,v,y,m,h,g,b,I,P,_,C,O,x,w,j,E,D,S,T,N,k;return i(this,(function(i){switch(i.label){case 0:if(0===t.length)throw new Error("cannot create group without instances");o=t.map((function(t){return t.id})),p=e.filter((function(t){var e=o.includes(t.from.insId),n=o.includes(t.to.insId);return!e&&n})).filter((function(t,e,n){return n.findIndex((function(e){return(0,s.connectionNodeEquals)(e.to,t.to)}))===e})),d=e.filter((function(t){var e=o.includes(t.from.insId),n=o.includes(t.to.insId);return e&&!n})).filter((function(t,e,n){return n.findIndex((function(e){return(0,s.connectionNodeEquals)(e.from,t.from)}))===e})),f={},v={},y={},m={},h=[],g={},b=0,I=p,i.label=1;case 1:return b<I.length?(w=I[b],j="".concat(w.to.insId,".").concat(w.to.pinId),E="".concat(w.from.insId,".").concat(w.from.pinId),D=w.to.pinId,y[E]?(h.push({from:(0,s.externalConnectionNode)(y[E]),to:(0,s.connectionNode)(w.to.insId,w.to.pinId)}),[3,5]):g[D]?[4,l("Name this input (".concat(D," of ").concat(w.to.insId,") is already taken:"))]:[3,3]):[3,6];case 2:return _=i.sent()||"i".concat((0,c.rnd)()),[3,4];case 3:_=D,i.label=4;case 4:P=_,f[j]=P,y[E]=P,h.push({from:(0,s.externalConnectionNode)(P),to:(0,s.connectionNode)(w.to.insId,w.to.pinId)}),g[P]=(0,s.partInput)(),i.label=5;case 5:return b++,[3,1];case 6:C={},O=0,x=d,i.label=7;case 7:return O<x.length?(w=x[O],j="".concat(w.to.insId,".").concat(w.to.pinId),E="".concat(w.from.insId,".").concat(w.from.pinId),D=w.from.pinId,m[j]?(h.push({from:(0,s.connectionNode)(w.from.insId,w.from.pinId),to:(0,s.externalConnectionNode)(m[j])}),[3,11]):C[D]?[4,l("Name this output (".concat(D," of ").concat(w.from.insId," is already taken:"))]:[3,9]):[3,12];case 8:return T=i.sent()||"i".concat((0,c.rnd)()),[3,10];case 9:T=D,i.label=10;case 10:S=T,v[E]=S,m[j]=S,h.push({from:(0,s.connectionNode)(w.from.insId,w.from.pinId),to:(0,s.externalConnectionNode)(S)}),C[S]=(0,u.partOutput)(),i.label=11;case 11:return O++,[3,7];case 12:return t.reduce((function(t,e){return(0,s.middlePos)(e.pos,t)}),t[0].pos),N=e.filter((function(t){return o.includes(t.from.insId)&&o.includes(t.to.insId)})),k={id:n,inputs:g,outputs:C,instances:t,inputsPosition:(0,u.okeys)(g).reduce((function(t,e,n){var o;return r(r({},t),((o={})[e]={x:0+100*n,y:0},o))}),{}),outputsPosition:(0,u.okeys)(C).reduce((function(t,e,n){var o;return r(r({},t),((o={})[e]={x:0+100*n,y:400},o))}),{}),connections:a(a([],N,!0),h,!0),completionOutputs:(0,u.okeys)(C)},[2,{visualPart:k,renamedInputs:f,renamedOutputs:v}]}}))}))}},10934:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.highlightText=void 0;var r=n(24246);function o(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}e.highlightText=function(t,e){var n=0,i=e.split(/\s+/).filter((function(t){return t.length>0})).map(o);if(0===i.length)return[t];for(var a=new RegExp(i.join("|"),"gi"),u=[];;){var s=a.exec(t);if(!s)break;var c=s[0].length,l=t.slice(n,a.lastIndex-c);l.length>0&&u.push(l),n=a.lastIndex,u.push((0,r.jsx)("strong",{children:s[0]},n))}var p=t.slice(n);return p.length>0&&u.push(p),u}},99457:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Loader=void 0;var o=n(24246),i=r(n(44271));e.Loader=function(){return(0,o.jsx)(i.default,{type:"ball-clip-rotate",active:!0})}},12887:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.logger=void 0;var r=n(18265);e.logger=(0,r.debugLogger)("editor")},14264:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.preloadMonaco=void 0;var r=n(77324),o=n(12887),i=!1;e.preloadMonaco=function(){i||r.loader.init().then((function(){(0,o.logger)("monaco preloaded"),i=!0}))}},4824:function(t,e){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.appHotkeysConfig=e.hotkey=e.EditorHotkeyCmd=e.AppHotkeyCmd=void 0,function(t){t.SAVE_PART="save-part",t.NEW_PROJECT="new-project",t.SAVE_PROJECT="save-project",t.TOGGLE_SIDE="toggle-side",t.RUN="run",t.UNDO="undo"}(n=e.AppHotkeyCmd||(e.AppHotkeyCmd={})),function(t){t.SHOW_OMNIBAR="show-omnibar",t.CLEAR_SELECTION="clear-selection",t.DELETE_COMP="delete-comp",t.DUPLICATE_COMP="duplicate-comp",t.GROUP="group",t.SELECT_ALL="select-all",t.SELECT_CLOSEST="select-closest"}(e.EditorHotkeyCmd||(e.EditorHotkeyCmd={}));e.hotkey=function(t,e,n,r,o){return{combo:t,label:e,cmd:n,global:r,preventDefault:o}},e.appHotkeysConfig=[(0,e.hotkey)("shift+p","Save part",n.SAVE_PART,!0,!0),(0,e.hotkey)("shift+t","New project",n.NEW_PROJECT,!0,!0),(0,e.hotkey)("cmd+shift+s","Toggle side",n.TOGGLE_SIDE,!0,!0),(0,e.hotkey)("cmd+s","Toggle side",n.SAVE_PROJECT,!0,!0),(0,e.hotkey)("shift+r","Run",n.RUN,!0,!0),(0,e.hotkey)("cmd+z","Undo",n.UNDO,!0,!0)]},14648:function(t,e,n){"use strict";var r=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.useHotkeys=void 0;var i=o(n(34618)),a=n(27378);e.useHotkeys=function(t,e,n,o,u){void 0===o&&(o=[]),void 0===u&&(u={});var s=(0,a.useCallback)((function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];n&&!n.current||e.apply(void 0,t)}),r(r([],o,!0),[e],!1));(0,a.useEffect)((function(){return(0,i.default)(t,u,s),function(){return i.default.unbind(t,s)}}),[t,s,u])}},11897:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.safeSessionStorage=e.safeLocalstorage=void 0,e.safeLocalstorage={getItem:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return localStorage.getItem.apply(localStorage,t)}catch(n){return null}},setItem:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return localStorage.setItem.apply(localStorage,t)}catch(n){return null}}},e.safeSessionStorage={getItem:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return sessionStorage.getItem.apply(sessionStorage,t)}catch(n){return null}},setItem:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return sessionStorage.setItem.apply(sessionStorage,t)}catch(n){return null}}}},49040:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.CustomReactTooltip=void 0;var i=n(24246),a=n(27378),u=o(n(31542)),s=o(n(87661));function c(t){var e=t.children,n=t.domNode;return u.default.createPortal(e,n)}e.CustomReactTooltip=function(t){var e=(0,a.useRef)();return(0,a.useEffect)((function(){e.current=document.createElement("div"),document.body.appendChild(e.current)}),[]),e.current?(0,i.jsx)(c,r({domNode:e.current},{children:(0,i.jsx)(s.default,r({},t))})):null},e.default=e.CustomReactTooltip},77437:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.useLocalStorage=e.useResizePref=e.userPreferences=e.useUserPref=void 0;var a,u=i(n(27378)),s=n(12901),c=n(11897);e.useUserPref=function(t,n){var r=u.useState((function(){var r=e.userPreferences.getItem(t);return(0,s.isDefined)(r)?r:n})),o=r[0],i=r[1];u.useEffect((function(){var r=e.userPreferences.getItem(t),o=(0,s.isDefined)(r)?r:n;i(o)}),[t]);return[o,function(n){e.userPreferences.setItem(t,n),console.log("Saved",t,n),i(n)}]},e.userPreferences=(a=function(t){return"up.".concat(t)},{getItem:function(t){var e=c.safeLocalstorage.getItem(a(t))||"",n=c.safeSessionStorage.getItem(a(t))||"";try{return JSON.parse(n||e).value}catch(r){return}},setItem:function(t,e,n){void 0===n&&(n=!1);var r=n?sessionStorage:c.safeLocalstorage;try{var o=JSON.stringify({value:e});return r.setItem(a(t),o),!0}catch(i){return console.error("Error saving user preference",i),!1}}});e.useResizePref=function(t,n){var r="resize.".concat(t);return(0,e.useUserPref)(r,n)};var l=function(t){var e=c.safeLocalstorage.getItem(t);if(!e)return null;try{return JSON.parse(e).value}catch(n){return null}};e.useLocalStorage=function(t,e){var n=u.useState(l(t)||e),r=n[0],o=n[1],i=u.useCallback((function(e){c.safeLocalstorage.setItem(t,JSON.stringify({value:e})),o(e)}),[t]);return u.useEffect((function(){l(t)||c.safeLocalstorage.setItem(t,JSON.stringify({value:e}))}),[t,e,i]),[r,i]}},99743:function(t,e){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.totalEnergy=e.itrPhysics=e.hookes=e.coulombs=e.vToStr=e.vNorm=e.vLen=e.vSub=e.vAdd=e.vDiv=e.vMul=e.vZero=e.rnd=e.vec=e.size=void 0;e.size=function(t,e){return{width:t,height:e}};e.vec=function(t,e){return{x:t,y:e}};e.rnd=function(t,e){return void 0===t&&(t=100),void 0===e&&(e=0),Math.floor(Math.random()*(t-e))+e},e.vZero={x:0,y:0};e.vMul=function(t,e){return{x:t.x*e,y:t.y*e}};e.vDiv=function(t,n){var r=t.x,o=t.y;return(0,e.vMul)({x:r,y:o},1/n)};e.vAdd=function(t,e){return{x:t.x+e.x,y:t.y+e.y}};e.vSub=function(t,n){return(0,e.vAdd)(t,(0,e.vMul)(n,-1))};e.vLen=function(t){var e=t.x,n=t.y;return Math.sqrt(e*e+n*n)};e.vNorm=function(t){return(0,e.vDiv)(t,(0,e.vLen)(t)||1)};e.vToStr=function(t){var e=t.x,n=t.y;return"".concat(e.toFixed(1),",").concat(n.toFixed(1))};e.coulombs=function(t,n,r){var o=(0,e.vLen)((0,e.vSub)(t.p,n.p));if(0===o){var i=(0,e.vec)(2*Math.random()-1,2*Math.random()-1),a=t.m*n.m/Math.pow(10,2);return(0,e.vMul)(i,a*r)}i=(0,e.vNorm)((0,e.vSub)(n.p,t.p)),a=t.m*n.m/Math.pow(o+.1,2);return(0,e.vMul)(i,a*r)};e.hookes=function(t,n,r,o,i){var a=(0,e.vLen)((0,e.vSub)(t.p,n.p)),u=(0,e.vNorm)((0,e.vSub)(t.p,n.p)),s=0;return a<r?s=r-a:a>o&&(s=o-a),(0,e.vMul)(u,i*s)};e.itrPhysics=function(t,r){var o=r.p,i=r.v,a=r.f,u=r.m,s=(0,e.vDiv)(a,u),c=t/1e3,l=(0,e.vAdd)((0,e.vMul)(s,c),i),p=(0,e.vAdd)((0,e.vMul)(l,c),o);return n(n({},r),{p:p,v:l,f:(0,e.vec)(0,0)})};e.totalEnergy=function(t){return t.reduce((function(t,n){var r=(0,e.vLen)(n.v);return t+.5*n.m*r*r}),0)}},40232:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.updateToast=e.toastMsg=e.AppToaster=void 0;var r=n(42272);e.AppToaster=function(){try{return r.Toaster.create({className:"app-toaster",position:r.Position.BOTTOM_RIGHT})}catch(t){return{}}}();e.toastMsg=function(t,n,r){return e.AppToaster.show({message:t,intent:n,timeout:r})};e.updateToast=function(t,n,r){return e.AppToaster.show({message:n,intent:r},t)}},12901:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.preventDefaultAnd=e.isLocal=e.fullTime=e.timeAgoFromDt=e.timeAgo=e.toString=e.isDefined=e.set=e.createOmap=e.toOmap=e.values=e.keys=e.entries=void 0;var i=n(13011),a=n(18265),u=o(n(61320));e.entries=function(t){return Object.keys(t).map((function(e){return[e,t[e]]}))};e.keys=function(t){return Object.keys(t)};e.values=function(t){return Object.keys(t).map((function(e){return t[e]}))};e.toOmap=function(t){return Array.from(t.entries()).reduce((function(t,e){var n,o=e[0],i=e[1];return r(r({},t),((n={})[o]=i,n))}),{})};e.createOmap=function(t){return void 0===t&&(t=[]),t.reduce((function(t,e){var n;return r(r({},t),((n={})[e[0]]=e[1],n))}),{})};e.set=function(t,e,n){t[e]=n};e.isDefined=function(t){return void 0!==t};e.toString=function(t){var e=typeof t;if(""===t)return"(empty string)";if((0,i.isJsxValue)(t))return"JSX Value";if((0,a.isStaticValueVisualPart)(t))return"Embedded Part";if((0,a.isEnvValue)(t))return(0,a.getEnvKeyFromValue)(t);if("object"===e)try{var n=JSON.stringify(t);return"{}"===n?"Empty object":n}catch(r){return"Object (cannot stringify)"}return"".concat(t)};e.timeAgo=function(t){return(0,u.default)(new Date(t)).fromNow()};e.timeAgoFromDt=function(t){return(0,u.default)(Date.now()-t).fromNow()};e.fullTime=function(t){return(0,u.default)(new Date(t)).toString()};e.isLocal=function(){return location.href.includes(":300")};e.preventDefaultAnd=function(t){return function(e){e.preventDefault(),t(e)}}},41304:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},u=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},c=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.VisualPartEditor=e.defaultBoardData=e.defaultViewPort=e.PART_HEIGHT=void 0;var p=n(24246),d=a(n(27378)),f=l(n(98739)),v=n(18265),y=n(57768),m=n(95160),h=n(12901),g=n(87944),b=n(13011),I=n(63300),P=n(27378),_=n(14648),C=l(n(54037)),O=n(42272),x=n(43318),w=n(99743),j=n(29841),E=n(18265),D=n(5681),S=n(94e3),T=n(14264),N=n(40232),k=n(51424),M=n(63213),R=n(52178),A=l(n(98784)),V=n(27234),H=n(91312),z=l(n(60042)),G=n(24398),F=n(75012),B=n(97841),U=n(3065),L=n(41978),q=d.memo(O.Slider),W=function(t){return null};e.PART_HEIGHT=28;e.defaultViewPort={pos:{x:0,y:0},zoom:1},e.defaultBoardData={selected:[],viewPort:e.defaultViewPort,lastMousePos:{x:0,y:0}},e.VisualPartEditor=d.memo(d.forwardRef((function(t,n){var o,i=t.onChangePart,a=t.partIoEditable,l=t.onCopy,Y=t.onGoToPartDef,J=t.onRequestHistory,X=t.onInspectPin,K=t.boardData,Q=t.onChangeBoardData,Z=t.insId,tt=t.part,et=t.onShowOmnibar,nt=t.resolvedFlow,rt=t.onImportPart,ot=t.parentViewport||e.defaultViewPort,it=(0,P.useState)(r(r({},nt.dependencies),((o={})[nt.main.id]=nt.main,o))),at=it[0],ut=it[1];(0,P.useEffect)((function(){var t;ut(r(r({},nt.dependencies),((t={})[nt.main.id]=nt.main,t)))}),[nt]);var st=K.selected,ct=K.from,lt=K.to,pt=tt.instances,dt=tt.connections,ft=tt.inputsPosition,vt=tt.outputsPosition,yt=tt.inputs,mt=tt.outputs,ht=(0,P.useState)(),gt=ht[0],bt=ht[1],It=(0,P.useState)(),Pt=It[0],_t=It[1],Ct=(0,P.useState)(0),Ot=Ct[0],xt=Ct[1],wt=(0,P.useState)(),jt=wt[0],Et=wt[1],Dt=(0,P.useState)(!1),St=Dt[0],Tt=Dt[1],Nt=(0,P.useState)(),kt=Nt[0],Mt=Nt[1],Rt=(0,P.useState)(),At=Rt[0],Vt=Rt[1],Ht=(0,P.useState)(),zt=Ht[0],Gt=Ht[1],Ft=(0,P.useState)(),Bt=Ft[0],Ut=Ft[1],Lt=(0,P.useRef)();(0,g.useDidMount)((function(){Lt.current=re.current.querySelector(".inline-editor-portal-root")}));var qt=(0,H.useConfirm)(),Wt=(0,H.usePrompt)(),$t=K.viewPort,Yt=(0,P.useRef)(!0),Jt=d.useCallback((function(t){Q({viewPort:t})}),[Q]),Xt=d.useCallback((function(t,e,n){return J(t,e,n)}),[J]),Kt=d.useCallback((function(t,e,n){return X("".concat(Z,".").concat(t),e,n)}),[X,Z]),Qt=d.useCallback((function(t,e){var n=(0,F.handleConnectionCloseEditorCommand)(tt,{from:t,to:e}),r=(0,v.isInternalConnectionNode)(e)?pt.find((function(t){return t.id===e.insId})):null,o=(r?r.inputConfig:{})[e.pinId],a=(0,v.isStaticInputPinConfig)(o)?(0,B.handleDetachConstEditorCommand)(n,e.insId,e.pinId):n;i(a,(0,k.functionalChange)("close-connection")),Q({from:void 0,to:void 0})}),[pt,i,Q,tt]),Zt=d.useCallback((function(){return u(void 0,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return[4,Wt("New visual part name?")];case 1:return t=n.sent(),[4,(0,V.groupSelected)(K.selected,tt,t,"inline",Wt)];case 2:return e=n.sent().currentPart,i(e,(0,k.functionalChange)("group part")),(0,N.toastMsg)("Part visual!"),[2]}}))}))}),[Wt,K.selected,i,tt]);(0,P.useEffect)((function(){if(jt){var t=setTimeout((function(){Et(void 0)}),350);return function(){return clearTimeout(t)}}}),[jt]);var te=(0,P.useState)(),ee=te[0],ne=te[1];(0,P.useEffect)((function(){(0,T.preloadMonaco)()}),[]);var re=(0,P.useRef)(),oe=(0,C.default)(re),ie=d.useRef({x:400,y:400}),ae=(0,g.useBoundingclientrect)(re)||w.vZero,ue=function(){var t=(0,b.fitViewPortToPart)(tt,at,oe);(0,b.animateViewPort)($t,t,500,(function(t){Jt(t)}))},se=d.useCallback((function(t,e){var n=K.to,r=K.from,o="input"===e?r:n,i="input"===e?n:r,a={pinId:t,insId:v.THIS_INS_ID},u="input"===e?{from:a}:{to:a};o&&o.pinId===t?Q({from:void 0,to:void 0}):i?"input"===e&&n?Qt(a,n):r&&Qt(r,a):Q(u)}),[K,Q,Qt]),ce=d.useCallback((function(t,e,n){var r=(0,I.produce)(tt,(function(r){"input"===t?r.inputs[e].description=n:r.outputs[e].description=n}));i(r,(0,k.functionalChange)("Part io description"))}),[i,tt]),le=d.useCallback((function(t,e,n){var r=K.from,o=K.to;if(ct&&ct.insId===t.id||lt&&lt.insId===t.id)Q({from:void 0,to:void 0});else if("input"===n){var i={insId:t.id,pinId:e};!o||o.pinId!==e||(0,v.isInternalConnectionNode)(o)&&o.insId!==t.id?ct?Qt(ct,i):Q({to:i,selected:[]}):Q({to:void 0})}else{var a={insId:t.id,pinId:e};!r||r.pinId!==e||(0,v.isInternalConnectionNode)(r)&&r.insId!==t.id?lt?Qt(a,lt):Q({from:a,selected:[]}):Q({from:void 0})}}),[K,ct,Q,Qt,lt]);(0,P.useEffect)((function(){if(!St&&oe.width){var e=(0,b.fitViewPortToPart)(tt,at,oe);t.thumbnailMode||Jt(e);var n=setTimeout((function(){var e=(0,b.fitViewPortToPart)(tt,at,oe);t.thumbnailMode||Jt(e),Tt(!0)}),100);return function(){return clearTimeout(n)}}}),[tt,oe,t.thumbnailMode,St,at,Jt]);var pe=d.useCallback((function(){var t=K.selected,e=tt.instances.filter((function(e){return t.includes(e.id)})).map((function(t){return r(r({},t),{id:t.id+"-copy"})})),n=tt.connections.filter((function(e){var n=e.from,r=e.to;return t.includes(n.insId)&&t.includes(r.insId)}));l({instances:e,connections:n})}),[K,l,tt]),de=d.useCallback((function(){var e=(0,G.pasteInstancesCommand)(tt,ie.current,t.clipboardData),n=e.newPart,r=e.newInstances;i(n,(0,k.functionalChange)("paste instances")),Q({selected:r.map((function(t){return t.id}))})}),[i,Q,tt,t.clipboardData]),fe=d.useCallback((function(){var t=tt.id;ee?"input"===ee.type?ee.ins.id===t?se(ee.pin,"input"):le(ee.ins,ee.pin,"input"):ee.ins.id===t?se(ee.pin,"output"):le(ee.ins,ee.pin,"output"):console.warn("tried selecting closest with no pin nearby")}),[tt.id,ee,se,le]),ve=d.useCallback((function(t,e){var n="mouse"===e?ie.current:{x:$t.pos.x+oe.width/2,y:$t.pos.y+oe.height/2},o=(0,b.centerBoardPosOnTarget)(n,oe,t,$t);Jt(r(r({},$t),{zoom:t,pos:o}))}),[Jt,$t,oe]);(0,_.useHotkeys)("cmd+=",(function(t){ve($t.zoom+.1,"hotkey"),t.preventDefault()}),Yt,[$t,ve]),(0,_.useHotkeys)("cmd+-",(function(t){ve($t.zoom-.1,"hotkey"),t.preventDefault()}),Yt,[ve,$t.zoom]),(0,_.useHotkeys)("cmd+o",(function(t){t.preventDefault(),(0,N.toastMsg)("Ordering");var e=[];(0,D.orderVisualPart)(tt,at,200,(function(t,n){n%3==0&&e.push(t)})),u(void 0,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return e.length?(t=e.shift(),(0,N.toastMsg)("Step ".concat(e.length,"!")),[4,(0,v.delay)(200)]):[3,2];case 1:return n.sent(),i(t,(0,k.metaChange)("order-step")),(0,N.toastMsg)("Step ".concat(e.length,"! done")),[3,0];case 2:return[2]}}))}))}),Yt,[i,tt,nt]),(0,_.useHotkeys)("cmd+0",(function(t){ve(1),t.preventDefault()}),Yt,[$t,ve]);var ye=function(){Q({from:void 0,to:void 0,selected:[]})},me=d.useCallback((function(t,e){bt(t.id),i(r({},tt),(0,k.metaChange)("drag-start"))}),[i,tt]),he=d.useCallback((function(t,e,n){var r=(0,b.handleInstanceDrag)(tt,t,n,e,st,gt),o=r.newValue,a=r.newSelected;i(o,(0,k.metaChange)("drag-move")),a&&Q({selected:a})}),[gt,i,Q,st,tt]),ge=d.useCallback((function(t,e){e.preventDefault(),e.stopPropagation(),bt(void 0)}),[]),be=d.useCallback((function(t,e){e.preventDefault(),e.stopPropagation(),bt(v.THIS_INS_ID)}),[]),Ie=d.useCallback((function(e,n,r,o){return u(void 0,void 0,void 0,(function(){var i,a,u;return s(this,(function(s){return r.preventDefault(),r.stopPropagation(),i=o.x,a=o.y,u=(0,I.produce)(tt,(function(t){"input"===e?t.inputsPosition[n]={x:i,y:a}:t.outputsPosition[n]={x:i,y:a}})),t.onChangePart(u,(0,k.metaChange)("part-io-drag-move")),[2]}))}))}),[t,tt]),Pe=d.useCallback((function(t,e,n,r){return u(void 0,void 0,void 0,(function(){return s(this,(function(t){return n.preventDefault(),n.stopPropagation(),bt(void 0),[2]}))}))}),[]),_e=d.useCallback((function(t,e){var n=t.id,r=e.shiftKey?st.filter((function(t){return t!==n})):[],o=e.shiftKey?c(c([],st,!0),[n],!1):[n],i=st.includes(n)?r:o;Q({selected:i,from:void 0,to:void 0})}),[Q,st]),Ce=d.useCallback((function(){var t=tt.instances.map((function(t){return t.id}));Q({selected:t,from:void 0,to:void 0})}),[Q,tt.instances]),Oe=d.useCallback((function(t){var e=dt.filter((function(e){var n=e.from,r=e.to;return-1===t.indexOf(n.insId)&&-1===t.indexOf(r.insId)})),n=(0,I.produce)(tt,(function(n){n.connections=e,n.instances=n.instances.filter((function(e){return!t.includes(e.id)}))}));i(n,(0,k.functionalChange)("delete-ins")),Q({selected:[]})}),[dt,i,Q,tt]),xe=d.useCallback((function(t){Oe([t.id])}),[Oe]),we=d.useCallback((function(t,e){var n=(0,I.produce)(tt,(function(n){"input"===t?(delete n.inputs[e],n.connections=n.connections.filter((function(t){return!((0,v.isExternalConnectionNode)(t.from)&&t.from.pinId===e)}))):(n.connections=n.connections.filter((function(t){return!((0,v.isExternalConnectionNode)(t.to)&&t.to.pinId===e)})),n.completionOutputs=(n.completionOutputs||[]).map((function(t){return t.split("+").filter((function(t){return t!==e})).join("+")})).filter((function(t){return!!t})),delete n.outputs[e])}));ct.insId===v.THIS_INS_ID&&ct.pinId===e?Q({from:void 0}):lt.insId===v.THIS_INS_ID&&lt.pinId===e&&Q({to:void 0}),i(n,(0,k.functionalChange)("remove io pin"))}),[tt,ct,lt,i,Q]),je=d.useCallback((function(){return u(void 0,void 0,void 0,(function(){var t,e,n;return s(this,(function(r){switch(r.label){case 0:return t=K.selected,e=K.from,n=K.to,0!==t.length?[3,5]:(0,v.isExternalConnectionNode)(e)?[4,qt("Are you sure you want to remove main input ".concat(e.pinId,"?"))]:[3,2];case 1:return r.sent()&&we("input",e.pinId),[3,4];case 2:return(0,v.isExternalConnectionNode)(n)?[4,qt("Are you sure you want to remove main output ".concat(n.pinId,"?"))]:[3,4];case 3:r.sent()&&we("output",n.pinId),r.label=4;case 4:return[3,6];case 5:Oe(t),r.label=6;case 6:return[2]}}))}))}),[qt,K,Oe,we]),Ee=d.useCallback((function(t,e,n){i((0,b.toggleStickyPin)(tt,t.id,e,n),(0,k.functionalChange)("toggle-sticky"))}),[i,tt]),De=d.useCallback((function(){var t=(0,U.handleDuplicateSelectedEditorCommand)(tt,st),e=t.newPart,n=t.newInstances;i(e,(0,k.functionalChange)("duplicated instances")),Q({selected:n.map((function(t){return t.id}))})}),[i,Q,tt,st]),Se=d.useCallback((function(t){var e=t.nativeEvent.target;if(0===t.button&&$(t.nativeEvent,tt.id)&&e&&"board-editor-inner"===e.className){if(Date.now()-Ot<300)return void et(t);xt(Date.now());var n={x:t.clientX,y:t.clientY},r=(0,w.vSub)(n,ae),o=(0,b.domToViewPort)(r,$t,ot);_t({from:o,to:o})}}),[tt.id,$t,Ot,ae,ot,et]),Te=d.useCallback((function(t){if($(t.nativeEvent,tt.id)&&Pt){if((0,b.calcSelectionBoxArea)(Pt)>50){var e=(0,b.getInstancesInRect)(Pt,at,$t,Qe.current,tt.instances,ae,ot);console.log({toSelect:e,selectionBox:Pt});var n=t.shiftKey?c(c([],st,!0),e,!0):e;Q({selected:n})}_t(void 0)}}),[tt.id,tt.instances,Pt,at,$t,ae,ot,st,Q]),Ne=d.useCallback((function(t){if($(t.nativeEvent,tt.id)){Yt.current=!0;var e={x:t.clientX,y:t.clientY},n=(0,w.vSub)(e,(0,w.vAdd)(ae,w.vZero)),o=(0,b.domToViewPort)(n,$t,ot);Pt&&_t(r(r({},Pt),{to:o}));var i=(0,b.findClosestPin)(tt,at,n,ae,Z,$t),a=ee;if(i)(!a||a.ins!==i.ins||a.ins===i.ins&&a.pin!==i.pin)&&ne({ins:i.ins,type:i.type,pin:i.id});ie.current=o,Q({lastMousePos:ie.current})}else Yt.current=!1}),[tt,ae,$t,ot,Pt,at,Z,ee,Q]),ke=d.useCallback((function(){ne(void 0),Yt.current=!1}),[]),Me=d.useCallback((function(t,e){if(e){var n=(0,v.isInlinePartInstance)(t)?t.part:(0,v.getPartDef)(t.partId,at);if(!n)throw new Error("Impossible state inspecting inexisting part");if(!(0,v.isVisualPart)(n))return void(0,N.toastMsg)("Cannot inspect a non visual part","warning");Ut({insId:"".concat(Z,".").concat(t.id),part:n})}else if((0,v.isRefPartInstance)(t)){var r=(0,v.getPartDef)(t,at);Y(r)}else{var o=t.part;if(!(0,v.isInlineValuePart)(o))return void((0,v.isVisualPart)(o)?Ut({insId:t.id,part:o}):(0,N.toastMsg)("Editing this type of part is not supported"));var i=atob(o.dataBuilderSource);Gt({insId:t.id,templateType:o.templateType,value:i,type:"existing"}),(0,N.toastMsg)("Editing inline visual part not supported yet")}}),[Y,at,Z]),Re=d.useCallback((function(t){if((0,v.isInlinePartInstance)(t)){var e=t.part;if(!(0,v.isVisualPart)(e))return void(0,N.toastMsg)("Not supported","warning");var n=(0,I.produce)(tt,(function(n){var r,o;n.instances=n.instances.filter((function(e){return e.id!==t.id})),n.connections=n.connections.filter((function(e){var n=e.from,r=e.to;return n.insId!==t.id&&r.insId!==t.id})),(r=n.instances).push.apply(r,e.instances),(o=n.connections).push.apply(o,e.connections.filter((function(t){return(0,v.isInternalConnectionNode)(t.from)&&(0,v.isInternalConnectionNode)(t.to)})))}));i(n,{type:"functional",message:"ungroup"}),Q({selected:[]})}else{var r=(0,v.getPartDef)(t.partId,at);if(!(0,v.isVisualPart)(r))return void(0,N.toastMsg)("Not supported","warning")}}),[tt,i,Q,at]),Ae=d.useCallback((function(t){return u(void 0,void 0,void 0,(function(){return s(this,(function(t){return[2]}))}))}),[]),Ve=d.useCallback((function(t,e){var n=(0,B.handleDetachConstEditorCommand)(tt,t.id,e);i(n,(0,k.functionalChange)("detach-const"))}),[i,tt]),He=d.useCallback((function(t,e){var n=t.inputConfig[e]||(0,E.queueInputPinConfig)();(0,v.isStaticInputPinConfig)(n)&&(Vt(n.value),N.AppToaster.show({message:"Value copied"}))}),[]),ze=d.useCallback((function(t,e){var n=(0,I.produce)(tt,(function(n){var r=n.instances.find((function(e){return e.id===t.id}));if(!r)throw new Error("Impossible state");r.inputConfig[e]=(0,v.staticInputPinConfig)(At),n.connections=n.connections.filter((function(n){return!(0,v.isInternalConnectionNode)(n.to)||!(n.to.insId===t.id&&n.to.pinId===e)}))}));i(n,(0,k.functionalChange)("paste const value"))}),[tt,i,At]),Ge=d.useCallback((function(t){return u(void 0,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return[4,Wt("New name?")];case 1:return(e=r.sent())?(n=(0,I.produce)(tt,(function(n){if("input"===t)tt.inputs||(n.inputs={}),n.inputs[e]=(0,v.partInput)(),n.inputsPosition[e]=ie.current;else{tt.outputs||(n.outputs={}),n.outputs[e]=(0,v.partOutput)(),n.outputsPosition[e]=ie.current;var r=(n.completionOutputs||[])[0];if(r){var o=r.split("+");n.completionOutputs[0]=c(c([],o,!0),[e],!1).join("+")}else n.completionOutputs=[e]}})),i(n,(0,k.functionalChange)("add new io pin")),[2]):[2]}}))}))}),[Wt,tt,i]),Fe=d.useCallback((function(){return u(void 0,void 0,void 0,(function(){var t,e,n,r;return s(this,(function(o){switch(o.label){case 0:return t=null===(r=tt.completionOutputs)||void 0===r?void 0:r.join(","),[4,Wt("Edit completion outputs",t)];case 1:return e=o.sent(),(0,h.isDefined)(e)&&null!==e&&(n=(0,I.produce)(tt,(function(t){t.completionOutputs=""===e?void 0:e.split(",")})),i(n,(0,k.functionalChange)("change part completions"))),[2]}}))}))}),[Wt,i,tt]),Be=d.useCallback((function(){return u(void 0,void 0,void 0,(function(){var t,e,n,r;return s(this,(function(o){switch(o.label){case 0:return t=null===(r=tt.reactiveInputs)||void 0===r?void 0:r.join(","),[4,Wt("Edit reactive inputs",t)];case 1:return e=o.sent(),(0,h.isDefined)(e)&&null!==e&&(n=(0,I.produce)(tt,(function(t){t.reactiveInputs=""===e?void 0:e.split(",")})),i(n,(0,k.functionalChange)("change reactive inputs"))),[2]}}))}))}),[Wt,i,tt]),Ue=d.useCallback((function(){return u(void 0,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return[4,Wt("Description?",tt.description)];case 1:return t=n.sent(),e=(0,I.produce)(tt,(function(e){e.description=t})),i(e,(0,k.functionalChange)("Edit part description")),[2]}}))}))}),[Wt,i,tt]),Le=d.useCallback((function(t){var e=(0,I.produce)(tt,(function(e){e.defaultStyle=t}));i(e,(0,k.functionalChange)("change default style"))}),[i,tt]),qe=d.useCallback((function(t,e){return u(void 0,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return[4,Wt("New name?",e)];case 1:return n=o.sent()||e,r=(0,b.handleIoPinRename)(tt,t,e,n),i(r,(0,k.functionalChange)("rename io pin")),[2]}}))}))}),[tt,i,Wt]),We=d.useCallback((function(t,e){var n=(0,b.handleChangePartInputType)(tt,t,e);i(n,(0,k.functionalChange)("toggle io pin optional"))}),[tt,i]),$e=d.useCallback((function(t,e){var n=Z.split(".").reverse()[0];return J(n,t,e)}),[J,Z]),Ye=d.useCallback((function(t,e,n,r){return u(void 0,void 0,void 0,(function(){var o,i,a,u;return s(this,(function(s){if("input"===n)o=t.inputConfig[e],i=(0,v.isStaticInputPinConfig)(o)?JSON.stringify(o.value):void 0,Gt({type:"static-input",insId:t.id,pinId:e,value:i});else{if(a=(0,v.getPartDef)(t,at),u=(0,v.getPartOutputs)(a),!u[e])throw new Error("Dbl clicked on un-existing pin");Mt({pos:{x:r.clientX,y:r.clientY},ins:t,part:a,pinId:e,pinType:n})}return[2]}))}))}),[at]),Je=d.useCallback((function(t,e){return u(void 0,void 0,void 0,(function(){return s(this,(function(n){if(!tt.inputs[t])throw new Error("Dbl clicked on un-existing pin");return Mt({pos:{x:e.clientX,y:e.clientY},pinId:t,pinType:"input",part:tt}),[2]}))}))}),[tt]),Xe=d.useCallback((function(t){if(t.metaKey||t.ctrlKey){var e=-.005*t.deltaY;ve($t.zoom+e,"mouse"),t.preventDefault(),t.stopPropagation()}else{var n=t.deltaX,r=t.deltaY,o=(0,I.produce)($t,(function(t){t.pos.x=t.pos.x+n/t.zoom,t.pos.y=t.pos.y+r/t.zoom}));Jt(o),t.stopPropagation(),t.preventDefault()}}),[ve,Jt,$t]);(0,P.useEffect)((function(){var t=re.current;if(t)return t.addEventListener("wheel",Xe),function(){t.removeEventListener("wheel",Xe)}}),[Xe]);var Ke={backgroundPositionX:(0,b.roundNumber)(-$t.pos.x*$t.zoom),backgroundPositionY:(0,b.roundNumber)(-$t.pos.y*$t.zoom),backgroundSize:(0,b.roundNumber)(25*$t.zoom)+"px"},Qe=d.useRef(new Map);d.useEffect((function(){var t=pt.reduce((function(t,e){var n=(0,v.getPartDef)(e,at);return n&&t.set(e.id,(0,v.keys)(n.inputs)),t}),new Map),e=pt.reduce((function(t,e){var n=(0,v.getPartDef)(e,at);return n&&t.set(e.id,(0,v.keys)(n.outputs)),t}),new Map);t.set(v.THIS_INS_ID,(0,v.keys)(tt.outputs)),e.set(v.THIS_INS_ID,(0,v.keys)(tt.inputs));var n=dt.filter((function(n){if(n.to.pinId===v.TRIGGER_PIN_ID||n.from.pinId===v.ERROR_PIN_ID)return!1;var r=t.get(n.to.insId)&&t.get(n.to.insId).includes(n.to.pinId),o=e.get(n.from.insId)&&e.get(n.from.insId).includes(n.from.pinId);return!(r&&o)}));if(n.length>0){(0,N.toastMsg)("".concat(n.length," orphan connections removed"),"warning"),console.log("".concat(n.length," orphan connections removed"),n);var r=(0,I.produce)(tt,(function(t){t.connections=tt.connections.filter((function(t){return!n.includes(t)}))}));i(r,(0,k.functionalChange)("prune orphan connections"))}}),[pt,i,dt,nt,tt,at]),(0,P.useEffect)((function(){var t=new Map(pt.map((function(t){return[t.id,t]})));Qe.current=dt.reduce((function(e,n){var o,i=e.get(n.to.insId)||{},a=i[n.to.pinId]||[],u=r(r({},i),((o={})[n.to.pinId]=c(c([],a,!0),[t.get(n.from.insId)],!1),o));return e.set(n.to.insId,u),e}),new Map)}),[dt,pt]);var Ze=d.useCallback((function(){Mt(void 0)}),[]),tn=d.useCallback((function(t){return u(void 0,void 0,void 0,(function(){var e,n,r,o;return s(this,(function(a){switch(a.label){case 0:if(!kt)throw new Error("impossible state - quick add menu invoked but not available");switch(e=kt.ins,n=kt.pinId,t.type){case"part":return[3,1];case"import":return[3,2];case"value":return[3,4]}return[3,5];case 1:return(r=(0,b.createNewPartInstance)(t.part.id,100,ie.current,at))&&(o=(0,I.produce)(tt,(function(t){t.instances.push(r),t.connections.push({from:{insId:e?e.id:v.THIS_INS_ID,pinId:n},to:{insId:r.id,pinId:v.TRIGGER_PIN_ID}})})),i(o,(0,k.functionalChange)("add-item-quick-menu")),Ze()),[3,5];case 2:return[4,rt(t.importablePart,{pos:ie.current,connectTo:{insId:e.id,outputId:n}})];case 3:return a.sent(),Ze(),[3,5];case 4:if(!e)return(0,N.toastMsg)("Cannot add value to main input"),[2];Gt({type:"new-output",insId:e.id,pinId:n}),a.label=5;case 5:return[2]}}))}))}),[kt,at,tt,i,Ze,rt]),en=d.useCallback((function(){return u(void 0,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return t=JSON.stringify(tt),[4,navigator.clipboard.writeText(t)];case 1:return e.sent(),N.AppToaster.show({message:"Copied!"}),[2]}}))}))}),[tt]),nn=d.useCallback((function(t){var e,n,o=a?"":" (cannot edit main part, only visual)";return(0,p.jsxs)(O.Menu,{children:[(0,p.jsx)(O.MenuItem,{onMouseDown:function(t){return t.stopPropagation()},text:"New Value",onClick:(0,h.preventDefaultAnd)((function(){return Gt({type:"new-floating",pos:ie.current})}))}),(0,p.jsx)(O.MenuItem,{text:"New input ".concat(o),onMouseDown:function(t){return t.stopPropagation()},onClick:(0,h.preventDefaultAnd)((function(){return Ge("input")})),disabled:!a}),(0,p.jsx)(O.MenuItem,{onMouseDown:function(t){return t.stopPropagation()},text:"New output ".concat(o),onClick:(0,h.preventDefaultAnd)((function(){return Ge("output")})),disabled:!a}),(0,p.jsx)(O.MenuItem,{onMouseDown:function(t){return t.stopPropagation()},text:"Copy part to clipboard",onClick:(0,h.preventDefaultAnd)(en)}),(0,p.jsx)(O.MenuItem,{onMouseDown:function(t){return t.stopPropagation()},text:"Edit Completion Outputs (".concat((null===(e=tt.completionOutputs)||void 0===e?void 0:e.join(","))||"n/a",")"),onClick:(0,h.preventDefaultAnd)((function(){return Fe()}))}),(0,p.jsx)(O.MenuItem,{onMouseDown:function(t){return t.stopPropagation()},text:"Edit Reactive inputs (".concat((null===(n=tt.reactiveInputs)||void 0===n?void 0:n.join(","))||"n/a",")"),onClick:(0,h.preventDefaultAnd)((function(){return Be()}))}),(0,p.jsx)(O.MenuItem,{onMouseDown:function(t){return t.stopPropagation()},text:"Edit description",onClick:(0,h.preventDefaultAnd)((function(){return Ue()}))}),(0,p.jsx)(O.MenuDivider,{}),(0,p.jsx)(O.MenuItem,r({text:"Default Style"},{children:(0,p.jsx)(L.PartStyleMenu,{style:tt.defaultStyle,onChange:Le,promptFn:Wt})}))]})}),[a,en,tt.completionOutputs,tt.reactiveInputs,tt.defaultStyle,Le,Wt,Ge,Fe,Be,Ue]),rn=d.useCallback((function(t){if(t.preventDefault(),Yt.current){var e=(0,b.domToViewPort)({x:t.clientX,y:t.clientY},$t,ot),n=nn(e);O.ContextMenu.show(n,{left:t.clientX,top:t.clientY})}}),[nn,ot,$t]);(0,_.useHotkeys)("shift+c",ue,Yt),(0,_.useHotkeys)("cmd+c",pe,Yt),(0,_.useHotkeys)("cmd+v",de,Yt),(0,_.useHotkeys)("esc",ye,Yt),(0,_.useHotkeys)("backspace",je,Yt),(0,_.useHotkeys)("shift+g",Zt,Yt),(0,_.useHotkeys)("shift+d",De,Yt),(0,_.useHotkeys)("cmd+a",Ce,Yt),(0,_.useHotkeys)("s",fe,Yt);var on=d.useCallback((function(t,e){if(!Bt)throw new Error("impossible state");var n=(0,I.produce)(tt,(function(e){var n=e.instances.find((function(t){return t.id===Bt.insId}));if(!n||!(0,v.isInlinePartInstance)(n))throw new Error("impossible state");n.part=t}));i(n,(0,k.functionalChange)("Inner change: "+e.message)),Ut((function(e){return r(r({},e),{part:t})}))}),[i,Bt,tt]),an=(0,P.useState)({selected:[],viewPort:e.defaultViewPort,lastMousePos:{x:0,y:0}}),un=an[0],sn=an[1],cn=d.useCallback((function(t){return sn((function(e){return r(r({},e),t)}))}),[]),ln=function(n){return Bt&&Bt.insId===n.id?{insId:"".concat(Z,".").concat(Bt.insId),boardData:un,onChangeBoardData:cn,resolvedFlow:nt,onCopy:l,clipboardData:t.clipboardData,onInspectPin:t.onInspectPin,onGoToPartDef:t.onGoToPartDef,partIoEditable:t.partIoEditable,onRequestHistory:J,part:Bt.part,onChangePart:on,onShowOmnibar:et,parentViewport:e.defaultViewPort,parentBoardPos:ae,onExtractInlinePart:t.onExtractInlinePart,onImportPart:t.onImportPart}:void 0},pn=function(){if(ct&&("input"===(null==ee?void 0:ee.type)&&(null==ee?void 0:ee.ins.id)!==tt.id||(null==ee?void 0:ee.ins.id)===tt.id&&"output"===(null==ee?void 0:ee.type))){var t=ee.ins.id===tt.id?{pinId:ee.pin,insId:v.THIS_INS_ID}:{insId:ee.ins.id,pinId:ee.pin};if(!(0,v.isInternalConnectionNode)(t)&&!(0,v.isInternalConnectionNode)(ct))return;return{from:ct,to:t}}if(lt&&("output"===(null==ee?void 0:ee.type)&&(null==ee?void 0:ee.ins.id)!==tt.id||(null==ee?void 0:ee.ins.id)===tt.id&&"input"===(null==ee?void 0:ee.type))){var e=ee.ins.id===tt.id?{pinId:ee.pin,insId:v.THIS_INS_ID}:{insId:ee.ins.id,pinId:ee.pin};if(!(0,v.isInternalConnectionNode)(lt)&&!(0,v.isInternalConnectionNode)(e))return;return{from:e,to:lt}}},dn=d.useCallback((function(t,e){var n=(0,I.produce)(tt,(function(n){n.instances=n.instances.map((function(n){return n.id===t.id?r(r({},n),{visibleInputs:e}):n}))}));i(n,(0,k.functionalChange)("change instance visible inputs"))}),[tt,i]),fn=d.useCallback((function(t,e){var n=(0,I.produce)(tt,(function(n){n.instances=n.instances.map((function(n){return n.id===t.id?r(r({},n),{style:e}):n}))}));i(n,(0,k.functionalChange)("change instance style"))}),[i,tt]),vn=d.useCallback((function(t,e){var n=(0,I.produce)(tt,(function(n){n.instances=n.instances.map((function(n){return n.id===t.id?r(r({},n),{visibleOutputs:e}):n}))}));i(n,(0,k.functionalChange)("change instance visible outputs"))}),[tt,i]),yn=d.useCallback((function(t,e){var n=(0,I.produce)(tt,(function(n){n.instances=n.instances.map((function(n){return n.id===t.id?r(r({},n),{displayName:e}):n}))}));i(n,(0,k.functionalChange)("change instance display name"))}),[tt,i]);d.useImperativeHandle(n,(function(){return{centerInstance:function(t){var e=tt.instances.find((function(e){return e.id===t}));if(e){var n=(0,w.vSub)(e.pos,(0,w.vec)(oe.width/2,oe.height/2));Jt(r(r({},$t),{pos:n}))}},centerViewPort:function(){ue()},getViewPort:function(){return $t},clearSelection:function(){ye()}}}));d.useCallback((function(t,e){var n={visibleInputs:t.visibleInputs,visibleOutputs:t.visibleOutputs,inputConfig:t.inputConfig,displayName:t.displayName},o=(0,I.produce)(tt,(function(e){e.instances=e.instances.map((function(e){return e.id===t.id?r(r({},e),n):e}))}));i(o,(0,k.functionalChange)("change instance config - "+e))}),[i,tt]);var mn=d.useState([]),hn=(mn[0],mn[1],d.useCallback((function(t,e){var n=e.trim().substr(0,100),r="Inline-value-".concat(n.substr(0,15).replace(/["'`]/g,"")),o=(0,R.createInlineValuePart)({code:e,customView:n,partId:r,type:t});switch(zt.type){case"existing":var a=tt.instances.filter((function(t){return t.id===zt.insId})).filter((function(t){return(0,v.isInlinePartInstance)(t)})).map((function(t){return t.part}))[0];if(!a)throw new Error("Unable to find inline part to save to");var u=(0,v.keys)(a.inputs),s=(0,v.keys)(o.inputs),c=new Set(A.default.difference(u,s)),l=(0,I.produce)(tt,(function(t){t.instances=t.instances.map((function(t){return t.id===zt.insId?(0,v.inlinePartInstance)(t.id,o,t.inputConfig,t.pos):t})),t.connections=t.connections.filter((function(t){return!(t.to.insId===zt.insId&&c.has(t.to.pinId))}))}));i(l,(0,k.functionalChange)("change inline value")),Gt(void 0);break;case"static-input":var p;try{var d=e.replace(/^['`]/,'"').replace(/['`]$/,'"');p=JSON.parse(d)}catch(P){return void(0,N.toastMsg)("Input values must not be formulas or code")}l=(0,I.produce)(tt,(function(t){t.instances.find((function(t){return t.id===zt.insId})).inputConfig[zt.pinId]=(0,v.staticInputPinConfig)(p)}));i(l,(0,k.functionalChange)("set static input value")),Gt(void 0);break;case"new-floating":var y=(0,v.inlinePartInstance)((0,f.default)(),o,{},zt.pos);l=(0,I.produce)(tt,(function(t){t.instances.push(y)}));i(l,(0,k.functionalChange)("new floating value")),Gt(void 0);break;case"new-output":var m=zt.insId,h=zt.pinId,g=tt.instances.find((function(t){return t.id===m}));if(!g)throw new Error("Impossible state");var b=(0,v.inlinePartInstance)((0,f.default)(),o,{},(0,w.vAdd)(g.pos,{x:-50,y:150}));l=(0,I.produce)(tt,(function(t){t.instances.push(b),t.connections.push({from:(0,v.connectionNode)(m,h),to:(0,v.connectionNode)(b.id,v.TRIGGER_PIN_ID)})}));i(l,(0,k.functionalChange)("new value connected to output")),Gt(void 0)}}),[zt,i,tt])),gn=dt.filter((function(t){var e=pn();return!e||!(0,v.connectionDataEquals)(e,t)})),bn=d.useCallback((function(){Ut(void 0),sn(e.defaultBoardData)}),[]),In=d.useCallback((function(t){var e=(0,I.produce)(tt,(function(e){var n=e.connections.find((function(e){return(0,v.connectionDataEquals)(e,t)}));n.hidden=!n.hidden}));i(e,(0,k.functionalChange)("toggle connection hidden"))}),[i,tt]),Pn=d.useCallback((function(t){var e=(0,I.produce)(tt,(function(e){e.connections=e.connections.filter((function(e){return!(0,v.connectionDataEquals)(e,t)}))}));i(e,(0,k.functionalChange)("remove connection"))}),[i,tt]);try{return(0,p.jsx)("div",r({className:(0,z.default)("visual-part-editor",t.className),"data-id":tt.id,onContextMenu:rn},{children:(0,p.jsxs)("main",r({className:"board-editor-inner",onMouseDown:Se,onMouseUp:Te,onMouseMove:Ne,onMouseLeave:ke,ref:re,style:Ke},{children:[(0,p.jsx)(d.Fragment,{children:(0,p.jsx)(S.LayoutDebugger,{vp:$t,part:tt,extraDebug:b.emptyList,mousePos:ie.current})}),(0,p.jsx)(m.ConnectionView,{repo:at,parentInsId:Z,size:oe,part:tt,boardPos:ae,instances:pt,connections:gn,futureConnection:function(){var t=pn();if(t)return{connection:{from:t.from,to:t.to},type:dt.some((function(e){return(0,v.connectionDataEquals)(e,t)}))?"future-remove":"future-add"}}(),onDblClick:v.noop,viewPort:$t,parentVp:ot,selectedInstances:st,toggleHidden:In,removeConnection:Pn}),function(){var t=K.from;return(0,h.entries)(yt).map((function(e){var n=e[0],r=e[1];return(0,p.jsx)(x.PartIoView,{insId:Z,type:"input",pos:ft[n]||{x:0,y:0},id:n,onDelete:a?we:void 0,onRename:a?qe:void 0,onDblClick:Je,closest:!(!ee||"input"!==ee.type||ee.ins.id!==tt.id||ee.pin!==n),connected:!1,inputMode:r.mode,onChangeInputMode:We,viewPort:$t,onDragStart:be,onDragEnd:Pe,onDragMove:Ie,onSelect:se,onSetDescription:ce,selected:(null==t?void 0:t.pinId)===n,description:r.description,onRequestHistory:$e},n)}))}(),pt.map((function(t){return(0,p.jsx)(y.InstanceView,{onUngroup:Re,onExtractInlinePart:Ae,onDetachConstValue:Ve,onCopyConstValue:He,onPasteConstValue:ze,copiedConstValue:At,connectionsPerInput:Qe.current.get(t.id)||b.emptyObj,connectionsPerOutput:b.emptyObj,part:(0,v.getPartDef)(t,at),parentInsId:Z,onPinClick:le,onPinDblClick:Ye,onDragStart:me,onDragEnd:ge,partDefRepo:at,onDragMove:he,onDblClick:Me,onSelect:_e,onToggleSticky:Ee,selected:-1!==st.indexOf(t.id),dragged:gt===t.id,onInspectPin:Kt,selectedInput:lt&&(0,v.isInternalConnectionNode)(lt)&&lt.insId===t.id?lt.pinId:void 0,selectedOutput:ct&&(0,v.isInternalConnectionNode)(ct)&&ct.insId===t.id?ct.pinId:void 0,closestPin:ee&&ee.ins.id===t.id?ee:void 0,instance:t,connections:dt,onTogglePinBreakpoint:v.noop,onTogglePinLog:v.noop,viewPort:$t,onRequestHistory:Xt,onChangeVisibleInputs:dn,onChangeVisibleOutputs:vn,onSetDisplayName:yn,onDeleteInstance:xe,forceShowMinimized:ct?"input":lt?"output":void 0,isConnectedInstanceSelected:st.some((function(e){return dt.some((function(n){var r=n.from,o=n.to;return r.insId===t.id&&o.insId===e||r.insId===e&&o.insId===t.id}))})),inlineGroupProps:ln(t),onCloseInlineEditor:bn,inlineEditorPortalDomNode:Lt.current,onChangeStyle:fn,onGroupSelected:Zt},t.id)})),function(){if(Pt){var t=Pt.from,e=Pt.to,n=(0,b.logicalPosToRenderedPos)(t,$t),r=(0,b.logicalPosToRenderedPos)(e,$t);console.log(t.x,e.x," | ",n.x,r.x);var o=(0,b.getSelectionBoxRect)(n,r),i=o.x,a=o.y,u=o.w,s=o.h;return(0,p.jsx)("div",{className:"selection-box",style:{top:a,left:i,width:u,height:s}})}return null}(),function(){var t=K.to;return(0,h.entries)(mt).map((function(e){var n=e[0],r=e[1];return(0,p.jsx)(x.PartIoView,{insId:Z,type:"output",pos:vt[n]||{x:0,y:0},id:n,onDelete:a?we:void 0,onRename:a?qe:void 0,closest:!(!ee||"output"!==ee.type||ee.ins.id!==tt.id||ee.pin!==n),connected:!1,viewPort:$t,onDragStart:be,onDragEnd:Pe,onDragMove:Ie,onSelect:se,onSetDescription:ce,description:r.description,selected:(null==t?void 0:t.pinId)===n,onRequestHistory:$e},n)}))}(),kt?(0,p.jsx)(j.QuickAddMenu,{part:kt.part,pinId:kt.pinId,pinType:kt.pinType,pos:kt.pos,resolvedFlow:nt,onRequestImportables:t.onRequestImportables,onAdd:tn,onClose:Ze}):null,(0,p.jsxs)("div",r({className:"viewport-controls"},{children:[(0,p.jsx)(O.Button,r({small:!0,onClick:ue},{children:"Reset view"})),(0,p.jsx)(q,{min:.05,max:3,stepSize:.05,labelStepSize:10,labelRenderer:W,onChange:ve,value:$t.zoom})]})),zt?(0,p.jsx)(M.InlineCodeModal,{env:b.emptyObj,initialValue:zt.value,initialType:"existing"===zt.type?zt.templateType:void 0,onCancel:function(){return Gt(void 0)},onSubmit:hn}):null,(0,p.jsx)("div",{className:"inline-editor-portal-root"})]}))}))}catch(_n){return console.error(_n),(0,p.jsxs)("div",{children:["Error rendering board - ",_n.toString()]})}})));var $=function(t,e){var n=t.target.closest(".visual-part-editor");return n&&n.getAttribute("data-id")===e}},12589:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.BasePartView=void 0;var s=n(24246),c=a(n(27378)),l=u(n(60042)),p=u(n(48304));e.BasePartView=function(t){var e=t.dragged,n=t.viewPort,o=t.pos,i=t.onDragEnd,a=t.onDragMove,u=t.onDragStart,d=t.displayMode,f=c.useCallback((function(t,e){u(t,e)}),[u]),v=c.useCallback((function(t,e){var a=o,u=(e.x-a.x)/n.zoom,s=(e.y-a.y)/n.zoom,c=a.x+u,l=a.y+s;i(t,r(r({},e),{x:c,y:l}))}),[o,i,n]),y=c.useCallback((function(t,e){a(t,{x:e.x,y:e.y})}),[a]),m={transform:"scale(".concat(n.zoom,")")},h=(0,l.default)("base-part-view",t.className,{dragged:e,"display-mode":d}),g=o.x*n.zoom-n.pos.x*n.zoom,b=o.y*n.zoom-n.pos.y*n.zoom,I=g-o.x,P=b-o.y,_={transform:"translate(".concat(I,"px, ").concat(P,"px)")},C=(0,l.default)("base-part-view-vp-fixer",{"display-mode":d});return(0,s.jsx)("div",r({className:C,style:_},{children:(0,s.jsx)(p.default,r({onStop:v,onStart:f,onDrag:y,position:o,cancel:".no-drag"},{children:(0,s.jsx)("span",r({className:"base-part-view-wrapper"},{children:(0,s.jsx)("div",r({className:h,style:m,id:t.domId},{children:t.children}))}))}))}))}},75012:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.handleConnectionCloseEditorCommand=void 0;var o=n(18265),i=r(n(63300));e.handleConnectionCloseEditorCommand=function(t,e){var n=e.from,r=e.to;return(0,i.default)(t,(function(t){var e=t.connections.find((function(t){var e=(0,o.connectionNodeEquals)(n,t.from),i=(0,o.connectionNodeEquals)(r,t.to);return e&&i}));e?t.connections=t.connections.filter((function(t){return t!==e})):t.connections.push({from:n,to:r})}))}},97841:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.handleDetachConstEditorCommand=void 0;var o=n(18265),i=r(n(63300)),a=n(52178);e.handleDetachConstEditorCommand=function(t,e,n){return(0,i.default)(t,(function(t){var r=t.instances.find((function(t){return t.id===e}));if(!r)throw new Error("Impossible state ins id with no matching instance");var i=r.inputConfig[n];if(!i)throw new Error("impossible state detaching const from unexistent config");if(!(0,o.isStaticInputPinConfig)(i))throw new Error("impossible state detaching const with no value");var u=i.value,s=(0,a.createInlineValuePart)({code:"".concat(u),type:o.InlineValuePartType.VALUE}),c=(0,o.inlinePartInstance)("value-".concat((0,o.randomInt)(999)),s,{},{x:r.pos.x,y:r.pos.y-100});if(!t.instances.find((function(t){return t.id===r.id})))throw new Error("impossible state instance not found");r.inputConfig[n]=(0,o.queueInputPinConfig)(),t.instances.push(c),t.connections.push((0,o.connectionData)("".concat(c.id,".r"),"".concat(r.id,".").concat(n)))}))}},3065:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.handleDuplicateSelectedEditorCommand=void 0;var i=o(n(98739)),a=o(n(63300));e.handleDuplicateSelectedEditorCommand=function(t,e){var n=[];return{newPart:(0,a.default)(t,(function(t){var o=t.instances;e.forEach((function(t){var e=o.find((function(e){return e.id===t}));if(!e)throw new Error("impossible state duplicate selected no matching instance");if(e){var a=e.pos,u=r(r({},e),{pos:{x:a.x+20,y:a.y+20},id:(0,i.default)()});o.push(u),n.push(u.id)}}))})),newInstances:n}}},24398:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.pasteInstancesCommand=void 0;var i=o(n(63300)),a=o(n(98739));e.pasteInstancesCommand=function(t,e,n){var o=n.instances.map((function(t){return r(r({},t),{pos:e,id:(0,a.default)()})})),u=new Map(o.map((function(t,e){return[n.instances[e].id,t.id]})));return{newPart:(0,i.default)(t,(function(t){var e,i;(e=t.instances).push.apply(e,o);var a=n.connections.map((function(t){var e=t.from,n=t.to;return{from:r(r({},e),{insId:u.get(e.insId)||e.insId}),to:r(r({},n),{insId:u.get(n.insId)||n.insId})}}));(i=t.connections).push.apply(i,a)})),newInstances:o}}},95160:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionView=e.SingleConnectionView=void 0;var s=n(27378),c=n(24246),l=a(n(27378)),p=u(n(60042)),d=n(18265),f=n(68488),v=n(64452),y=n(29768),m=n(99743),h=n(42272);e.SingleConnectionView=function(t){var e=(0,y.useSsr)().isBrowser,n=t.connection,o=t.part,i=t.repo,a=t.instances,u=t.type,s=t.viewPort,g=t.toggleHidden,b=t.parentSelected,I=t.removeConnection,P=n.from,_=(0,d.isInternalConnectionNode)(P)&&a.find((function(t){return t.id===P.insId}));if(!_&&(0,d.isInternalConnectionNode)(P))throw new Error('impossible state  - "from instance id - ['.concat(P.insId,'] does not exist"'));var C=((0,d.isInternalConnectionNode)(P)&&_?(0,d.getPartDef)(_,i):o).outputs[P.pinId],O=C&&C.delayed,x=e?function(t){var e=t.connection,n=t.boardPos,r=t.parentInsId,o=t.viewPort,i=e.from;return(0,d.isExternalConnectionNode)(i)?(0,f.calcMainInputPosition)(i.pinId,r,"input",n,o):(0,f.calcPinPosition)(r,i.insId,i.pinId,"output",n,o)}(t):{x:0,y:0},w=e?function(t){var e=t.connection,n=t.boardPos,r=t.parentInsId,o=t.viewPort,i=e.to;return(0,d.isExternalConnectionNode)(i)?(0,f.calcMainOutputPosition)(i.pinId,r,"output",n,o):(0,f.calcPinPosition)(r,i.insId,i.pinId,"input",n,o)}(t):{x:0,y:0},j=(0,m.vDiv)(x,t.parentVp.zoom),E=j.x,D=j.y,S=(0,m.vDiv)(w,t.parentVp.zoom),T=S.x,N=S.y,k=(0,p.default)("connection",{delayed:O,hidden:n.hidden,"parent-selected":b},u),M=(0,v.calcBezierPath)({sourceX:E,sourceY:D,targetX:T,targetY:N,curvature:.15}),R=2*s.zoom,A="regular"===u?void 0:6*s.zoom,V=(E+T)/2,H=(D+N)/2,z=l.useCallback((function(t){t.preventDefault(),t.stopPropagation();var e=(0,c.jsxs)(h.Menu,{children:[(0,c.jsx)(h.MenuItem,{text:n.hidden?"Show connection":"Hide connection",onClick:function(){return g(n)}}),(0,c.jsx)(h.MenuItem,{text:"Remove connection",onClick:function(){return I(n)}})]});h.ContextMenu.show(e,{left:t.pageX,top:t.pageY})}),[n,I,g]);return(0,c.jsxs)(l.Fragment,{children:[(0,c.jsx)("path",{d:M,className:k,style:{strokeWidth:R,strokeDasharray:A},onContextMenu:z}),"future-add"===u?(0,c.jsx)("text",r({className:"label",x:V,y:H,fontSize:"12px"},{children:"Add connection"})):null,"future-remove"===u?(0,c.jsx)("text",r({className:"label",x:V,y:H,fontSize:"12"},{children:"Remove connection"})):null]})};e.ConnectionView=function(t){var n=t.viewPort,o=t.futureConnection,i=t.toggleHidden,a=t.selectedInstances,u=l.useState(0),p=u[0],d=u[1],f=l.useCallback((function(t){return requestAnimationFrame((function(){d((function(t){return(t+1)%9})),t>0&&f(t-1)}))}),[]);l.useEffect((function(){var t=f(10);return function(){cancelAnimationFrame(t)}}),[f]),l.useEffect((function(){var t=function(){f(3)};return window.addEventListener("scroll",t),window.addEventListener("resize",t),function(){window.removeEventListener("scroll",t),window.removeEventListener("resize",t)}}),[f,p]);var v=t.connections.map((function(n){var o=a.includes(n.from.insId)||a.includes(n.to.insId);return(0,s.createElement)(e.SingleConnectionView,r({},t,{connection:n,type:"regular",parentSelected:o,key:n.from.insId+n.from.pinId+n.to.insId+n.to.pinId}))}));return o&&v.push((0,c.jsx)(e.SingleConnectionView,r({},t,{connection:o.connection,type:o.type,toggleHidden:i,parentSelected:!1}))),(0,c.jsx)("span",r({className:"connections-view",style:{opacity:n.zoom}},{children:(0,c.jsx)("svg",r({style:{width:"100%"}},{children:v}))}))}},64452:function(t,e){"use strict";var n;function r(t,e){return t>=0?.5*t:25*e*Math.sqrt(-t)}function o(t){var e,o,i=t.pos,a=t.x1,u=t.y1,s=t.x2,c=t.y2,l=t.c;switch(i){case n.Left:e=a-r(a-s,l),o=u;break;case n.Right:e=a+r(s-a,l),o=u;break;case n.Top:e=a,o=u-r(u-c,l);break;case n.Bottom:e=a,o=u+r(c-u,l)}return[e,o]}Object.defineProperty(e,"__esModule",{value:!0}),e.getBezierCenter=e.calcBezierPath=e.Position=void 0,function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"}(n=e.Position||(e.Position={}));e.calcBezierPath=function(t){var e=t.sourceX,r=t.sourceY,i=t.sourcePosition,a=void 0===i?n.Bottom:i,u=t.targetX,s=t.targetY,c=t.targetPosition,l=void 0===c?n.Top:c,p=t.curvature,d=void 0===p?.25:p,f=o({pos:a,x1:e,y1:r,x2:u,y2:s,c:d}),v=f[0],y=f[1],m=o({pos:l,x1:u,y1:s,x2:e,y2:r,c:d}),h=m[0],g=m[1];return"M".concat(e,",").concat(r," C").concat(v,",").concat(y," ").concat(h,",").concat(g," ").concat(u,",").concat(s)},e.getBezierCenter=function(t){var e=t.sourceX,r=t.sourceY,i=t.sourcePosition,a=void 0===i?n.Bottom:i,u=t.targetX,s=t.targetY,c=t.targetPosition,l=void 0===c?n.Top:c,p=t.curvature,d=void 0===p?.25:p,f=o({pos:a,x1:e,y1:r,x2:u,y2:s,c:d}),v=f[0],y=f[1],m=o({pos:l,x1:u,y1:s,x2:e,y2:r,c:d}),h=.125*e+.375*v+.375*m[0]+.125*u,g=.125*r+.375*y+.375*m[1]+.125*s;return[h,g,Math.abs(h-e),Math.abs(g-r)]}},68488:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.calcMainOutputPosition=e.calcMainInputPosition=e.calcPinPosition=void 0;var r=n(90095),o={x:99999,y:99999},i=function(t,e,n,r){if(!t)return console.warn("Cannot find element ".concat(n," to render connection")),o;var i=t.getBoundingClientRect(),a=i.x,u=i.y,s=i.width,c=u+i.height/2;return{x:a+s/2-e.x,y:c-e.y}};e.calcPinPosition=function(t,e,n,o,a,u){var s=(0,r.getPinDomId)(t,e,n,o),c=document.getElementById(s);return i(c,a,s)};e.calcMainInputPosition=function(t,e,n,o,a){var u=(0,r.getMainPinDomId)(e,t,n),s=document.getElementById(u);return i(s,o,u)};e.calcMainOutputPosition=function(t,e,n,o,a){var u=(0,r.getMainPinDomId)(e,t,n),s=document.getElementById(u);return i(s,o,u)}},90095:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getMainPinDomId=e.getPinDomId=e.getInstanceDomId=void 0;e.getInstanceDomId=function(t,e){return"ins-view-".concat(t,".").concat(e).replace(/\s+/g,"-")};e.getPinDomId=function(t,e,n,r){return"pin-".concat(t,".").concat(e,"-").concat(n,"-").concat(r).replace(/\s+/g,"-")};e.getMainPinDomId=function(t,e,n){return"pin-".concat(t,"-").concat(e,"-").concat(n).replace(/\s+/g,"-")}},57768:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},u=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},c=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.InstanceView=e.getVisibleOutputs=e.getVisibleInputs=e.INSTANCE_INFO_TOOLTIP_DELAY=e.MAX_INSTANCE_WIDTH=e.MIN_WIDTH_PER_PIN=e.PIECE_CHAR_WIDTH=e.PIECE_HORIZONTAL_PADDING=void 0;var p=n(24246),d=a(n(27378)),f=n(92739),v=n(18265),y=l(n(60042)),m=n(57076),h=n(18265),g=n(18265),b=n(71462),I=n(12589),P=n(18265),_=n(90095),C=n(41304),O=n(96149),x=n(42272),w=l(n(31542)),j=n(41978),E=l(n(49040));e.PIECE_HORIZONTAL_PADDING=25,e.PIECE_CHAR_WIDTH=11,e.MIN_WIDTH_PER_PIN=40,e.MAX_INSTANCE_WIDTH=400,e.INSTANCE_INFO_TOOLTIP_DELAY=400;e.getVisibleInputs=function(t,e,n){var r=t.visibleInputs;if(r)return r;var o=(0,v.keys)((0,g.getPartInputs)(e)).filter((function(r,o){var i,a=n.some((function(e){return e.to.insId===t.id&&e.to.pinId===r})),u=e.inputs[r]&&"optional"===(null===(i=e.inputs[r])||void 0===i?void 0:i.mode);return a||!u&&r!==h.TRIGGER_PIN_ID}));return 0===o.length?[h.TRIGGER_PIN_ID]:o};e.getVisibleOutputs=function(t,e,n){var r=t.visibleOutputs;if(r)return r;var o=Object.keys(e.outputs);return n.some((function(e){return e.from.insId===t.id&&e.from.pinId===h.ERROR_PIN_ID}))?c(c([],o,!0),[h.ERROR_PIN_ID],!1):o};e.InstanceView=function(t){var n=this,o=t.selected,i=t.selectedInput,a=t.selectedOutput,l=t.closestPin,D=t.dragged,S=t.onTogglePinLog,T=t.onTogglePinBreakpoint,N=t.onDetachConstValue,k=t.onCopyConstValue,M=t.onPasteConstValue,R=t.displayMode,A=t.connections,V=t.instance,H=t.viewPort,z=t.part,G=t.onPinClick,F=t.onPinDblClick,B=t.onDragStart,U=t.onRequestHistory,L=t.onDragEnd,q=t.onDragMove,W=t.onToggleSticky,$=t.onSelect,Y=t.onDblClick,J=t.onChangeVisibleInputs,X=t.onChangeVisibleOutputs,K=t.onConvertConstToEnv,Q=t.inlineGroupProps,Z=t.onUngroup,tt=t.onExtractInlinePart,et=t.onGroupSelected,nt=t.isConnectedInstanceSelected,rt=t.inlineEditorPortalDomNode,ot=t.onChangeStyle,it=t.onDeleteInstance,at=t.onSetDisplayName,ut=V.id,st=d.useMemo((function(){var t=(0,v.randomInt)(6,1);return{icon:(0,v.pickRandom)([["fab","discord"],["fab","slack"],"bug","cube"]),color:t,size:(0,v.randomInt)(3,1),variation:(0,v.randomInt)(5,1)}}),[]),ct=d.useRef(),lt=d.useMemo((function(){return V.style||z.defaultStyle||{}}),[z,V]),pt=lt.size||"regular",dt=d.useMemo((function(){return new Map(A.filter((function(t){return t.to.insId===ut})).map((function(t){var e=t.to,n=t.hidden;return[e.pinId,n]})))}),[A,ut]),ft=d.useMemo((function(){return new Map(A.filter((function(t){return t.from.insId===ut})).map((function(t){var e=t.from,n=t.hidden;return[e.pinId,n]})))}),[A,ut]),vt=(0,O.usePrompt)(),yt=d.useCallback((function(t){return G(V,t,"input")}),[V,G]),mt=d.useCallback((function(t,e){return F(V,t,"input",e)}),[V,F]),ht=d.useCallback((function(t,e){return F(V,t,"output",e)}),[V,F]),gt=d.useCallback((function(t){return G(V,t,"output")}),[V,G]),bt=d.useCallback((function(t,e){B(V,t,e)}),[V,B]),It=d.useCallback((function(t,e){var n=V.pos,o=(e.x-n.x)/H.zoom,i=(e.y-n.y)/H.zoom,a=n.x+o,u=n.y+i;L(V,t,r(r({},e),{x:a,y:u}))}),[V,L,H.zoom]),Pt=d.useCallback((function(t,e){q(V,t,{x:e.x,y:e.y})}),[V,q]),_t=d.useCallback((function(t){return W(V,t)}),[V,W]),Ct=d.useCallback((function(t){return N(V,t)}),[V,N]),Ot=d.useCallback((function(t){return k(V,t)}),[V,k]),xt=d.useCallback((function(t){return M(V,t)}),[V,M]),wt=d.useCallback((function(t){return $(V,t)}),[V,$]),jt=d.useCallback((function(t){return Y(V,t.shiftKey)}),[V,Y]),Et=(0,v.entries)(z.inputs),Dt=V.visibleInputs,St=V.visibleOutputs;Dt&&Et.sort((function(t,e){return Dt.indexOf(t[0])-Dt.indexOf(e[0])}));var Tt=(0,v.entries)(z.outputs);St&&Tt.sort((function(t,e){return St.indexOf(t[0])-St.indexOf(e[0])}));var Nt=(0,e.getVisibleInputs)(V,z,A),kt=(0,e.getVisibleOutputs)(V,z,A);Et.push([h.TRIGGER_PIN_ID,(0,v.partInput)()]),Tt.push([h.ERROR_PIN_ID,(0,h.partOutput)()]);var Mt=Et.filter((function(t){var e=t[0];return Nt.includes(e)||(o||nt)&&dt.has(e)})),Rt=Tt.filter((function(t){var e=t[0];return kt.includes(e)||(o||nt)&&ft.has(e)})),At=(0,y.default)("ins-view",{"no-inputs":0===Et.length,"no-outputs":0===Tt.length,"display-mode":R,"force-minimized-input":"input"===t.forceShowMinimized||"both"===t.forceShowMinimized,"force-minimized-output":"output"===t.forceShowMinimized||"both"===t.forceShowMinimized,"inline-part-edited":!!Q}),Vt=(0,y.default)({selected:o,dragged:D,closest:l&&l.ins.id===V.id},"size-".concat(pt)),Ht=new Set((0,v.entries)(z.inputs).filter((function(t){t[0];var e=t[1];return(0,h.isInputPinOptional)(e)})).map(v.pickFirst)),zt=(0,v.entries)(V.inputConfig).reduce((function(t,e){var n,o=e[0],i=e[1];return(0,h.isStickyInputPinConfig)(i)||i.sticky?r(r({},t),((n={})[o]=!0,n)):t}),{}),Gt=(0,b.calcPartContent)(V,z),Ft=function(t){var e=V.inputConfig[t];if((0,P.isStaticInputPinConfig)(e))return e.value},Bt=d.useCallback((function(){return u(n,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return t=(0,v.okeys)(z.inputs),[4,vt("New order?",(V.visibleInputs||t).join(","))];case 1:return(e=n.sent())&&J(V,e.split(",")),[2]}}))}))}),[z.inputs,vt,V,J]),Ut=d.useCallback((function(){return u(n,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return t=(0,v.okeys)(z.outputs),[4,vt("New order?",(V.visibleOutputs||t).join(","))];case 1:return(e=n.sent())&&X(V,e.split(",")),[2]}}))}))}),[z.outputs,vt,V,X]),Lt=d.useCallback((function(){it(V)}),[it,V]),qt=d.useCallback((function(){return u(n,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,vt("Set custom display name",V.displayName||z.id)];case 1:return t=e.sent(),at(V,t),[2]}}))}))}),[vt,V,at,z.id]),Wt=Object.keys((0,g.getPartInputs)(z)),$t=Object.keys((0,v.getPartOutputs)(z)),Yt=d.useCallback((function(t,e){return U(V.id,t,e)}),[V,U]),Jt=d.useCallback((function(t){K&&K(V,t)}),[V,K]),Xt=function(){return(0,p.jsx)("div",r({className:"inputs no-drag"},{children:Mt.map((function(e){var n=e[0],r=e[1];return(0,p.jsx)(m.PinView,{type:"input",insId:V.id,parentInsId:t.parentInsId,id:n,optional:Ht.has(n),connected:dt.has(n),isSticky:zt[n],minimized:!o&&1===Mt.length,onToggleSticky:_t,onDetachConstValue:Ct,onCopyConstValue:Ot,onPasteConstValue:xt,copiedConstValue:t.copiedConstValue,selected:n===i,onClick:yt,onDoubleClick:mt,isClosestToMouse:!!l&&"input"===l.type&&l.pin===n,onToggleLogged:S,onToggleBreakpoint:T,onInspect:t.onInspectPin,constValue:Ft(n),onRequestHistory:Yt,onConvertConstToEnv:t.onConvertConstToEnv?Jt:void 0,description:r.description},n)}))}))},Kt=function(){return(0,p.jsx)("div",r({className:"outputs no-drag"},{children:Rt.map((function(e){var n=e[0],r=e[1];return(0,p.jsx)(m.PinView,{insId:V.id,parentInsId:t.parentInsId,connected:ft.has(n),type:"output",id:n,minimized:!o&&1===Rt.length,isClosestToMouse:!!l&&"output"===l.type&&l.pin===n,selected:n===a,onClick:gt,onDoubleClick:ht,onToggleLogged:S,onToggleBreakpoint:T,onInspect:t.onInspectPin,onRequestHistory:Yt,description:r.description},n)}))}))},Qt=d.useCallback((function(t){ot(V,t)}),[V,ot]),Zt=d.useCallback((function(){var t=Wt.map((function(t){var e=Nt.includes(t),n=dt.has(t)&&!0!==dt.get(t),r=(0,v.getInputName)(t);return{text:e?'Hide input "'.concat(r,n?'" (disconnect first)':'"'):'Show input "'.concat(r,'"'),onClick:function(){return J(V,e?Nt.filter((function(e){return e!==t})):c(c([],Nt,!0),[t],!1))},disabled:n&&e}})),e=$t.map((function(t){var e=kt.includes(t),n=ft.has(t),r=(0,v.getOutputName)(t);return{text:e?'Hide output "'.concat(r,n?'" (disconnect first)':'"'):'Show output "'.concat(r,'"'),onClick:function(){return X(V,e?kt.filter((function(e){return e!==t})):c(c([],kt,!0),[t],!1))},disabled:n&&e}})),n=c(c(c(c(c([],t,!0),e,!0),(0,v.isInlinePartInstance)(V)&&(0,g.isVisualPart)(V.part)?[{text:"Ungroup inline part",onClick:function(){return Z(V)}}]:[],!0),(0,v.isInlinePartInstance)(V)?[{text:"Extract inline part to file",onClick:function(){return tt(V)}}]:[],!0),[{text:"Reorder inputs",onClick:Bt},{text:"Reorder outputs",onClick:Ut},{text:"Set display name",onClick:qt},{text:"Group selected instances",onClick:et},{text:"Delete instance",intent:"danger",onClick:Lt}],!1);return(0,p.jsxs)(x.Menu,{children:[(0,p.jsx)(x.MenuItem,r({text:"Style"},{children:(0,p.jsx)(j.PartStyleMenu,{style:lt,onChange:Qt,promptFn:vt})})),n.map((function(t){return(0,p.jsx)(x.MenuItem,r({},t))}))]})}),[Wt,$t,V,Bt,Ut,qt,Lt,lt,Qt,vt,Nt,dt,J,kt,ft,X,Z,tt,et]),te=d.useCallback((function(t){t.preventDefault(),t.stopPropagation();var e=Zt();x.ContextMenu.show(e,{left:t.clientX,top:t.clientY})}),[Zt]),ee=r({"--part-color":lt.color},lt.cssOverride||{}),ne=(0,_.getInstanceDomId)(t.parentInsId,V.id);return(0,p.jsx)("div",r({className:At},{children:(0,p.jsxs)(I.BasePartView,r({pos:V.pos,viewPort:H,onDragStart:bt,onDragMove:Pt,onDragEnd:It,upperRenderer:Xt,bottomRenderer:Kt,displayMode:R,domId:ne},{children:[(0,p.jsx)(E.default,{className:"instance-info-tooltip",html:!0,id:ne+"__tooltip",delayShow:e.INSTANCE_INFO_TOOLTIP_DELAY}),Xt(),Q?w.default.createPortal((0,p.jsxs)("div",r({className:"inline-group-editor-container no-drag"},{children:[(0,p.jsxs)("header",{children:[Gt," ",(0,p.jsx)("button",r({onClick:t.onCloseInlineEditor},{children:"close"}))]}),(0,p.jsx)(C.VisualPartEditor,r({},t.inlineGroupProps,{className:"no-drag",ref:ct}))]})),rt):(0,p.jsxs)("div",r({className:(0,y.default)("ins-view-inner",Vt,"size-".concat(st.size)),onClick:wt,onDoubleClick:jt,onContextMenu:te,style:ee,"data-tip":z.description,"data-for":ne+"__tooltip"},{children:[lt.icon?(0,p.jsx)(f.FontAwesomeIcon,{icon:lt.icon}):null," ",Gt]})),Kt()]}))}))}},91530:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},u=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.PartStyleMenu=void 0;var c=n(24246),l=n(42272),p=a(n(27378)),d=n(40232),f={size:"regular"};e.PartStyleMenu=function(t){var e=t.onChange,n=t.style||f,o=t.promptFn,i=p.default.useCallback((function(t,o){var i;e(r(r({},n),((i={})[t]=o,i)))}),[n,e]),a=p.default.useCallback((function(){return u(void 0,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return[4,o("Icon name? (Font Awesome conventions)","rocket")];case 1:return t=n.sent(),e=t.includes(",")?t.split(","):t,i("icon",e),[2]}}))}))}),[o,i]),v=(0,p.useCallback)((function(){return u(void 0,void 0,void 0,(function(){var t,e;return s(this,(function(r){switch(r.label){case 0:return[4,o("Enter a custom style (valid JSON representing a React CSS object)",n.cssOverride?JSON.stringify(n.cssOverride):"")];case 1:t=r.sent();try{e=JSON.parse(t),i("cssOverride",e)}catch(a){console.error(a),(0,d.toastMsg)("Invalid object","danger")}return[2]}}))}))}),[o,i,n.cssOverride]);return(0,c.jsxs)(p.default.Fragment,{children:[(0,c.jsxs)(l.MenuItem,r({text:"Color"},{children:[(0,c.jsx)(l.MenuItem,{text:"Amethyst",onClick:function(){return i("color","#9b5de5")}}),(0,c.jsx)(l.MenuItem,{text:"Magenta",onClick:function(){return i("color","#f15bb5")}}),(0,c.jsx)(l.MenuItem,{text:"Yellow",onClick:function(){return i("color","#fee440")}}),(0,c.jsx)(l.MenuItem,{text:"Capri",onClick:function(){return i("color","#00bbf9")}}),(0,c.jsx)(l.MenuItem,{text:"Sea Green",onClick:function(){return i("color","#00f5d4")}}),(0,c.jsx)(l.MenuDivider,{}),(0,c.jsx)(l.MenuItem,{text:"Remove Color",onClick:function(){return i("color",void 0)}})]})),(0,c.jsxs)(l.MenuItem,r({text:"Size (".concat(n.size,")")},{children:[(0,c.jsx)(l.MenuItem,{text:"Small",onClick:function(){return i("size","small")}}),(0,c.jsx)(l.MenuItem,{text:"Regular",onClick:function(){return i("size","regular")}}),(0,c.jsx)(l.MenuItem,{text:"Large",onClick:function(){return i("size","large")}})]})),(0,c.jsxs)(l.MenuItem,r({text:"Icon"},{children:[(0,c.jsx)(l.MenuItem,{text:"Choose Icon",onClick:a}),(0,c.jsx)(l.MenuItem,{text:"Remove Icon",onClick:function(){return i("icon",void 0)}})]})),(0,c.jsx)(l.MenuItem,{text:"Custom Styling",onClick:v})]})}},41978:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(91530),e)},41756:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(57768),e)},71462:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.calcInstancePosition=e.calcPartWidth=e.calcPartContent=void 0;var u=n(18265),s=a(n(78284)),c=n(12901),l=n(57768),p=n(98784),d=n(90095);e.calcPartContent=function(t,e){if(t.displayName)return t.displayName;if(e.customViewCode)try{var n=Object.entries(t.inputConfig).filter((function(t){var e=t[1];return(0,u.isStaticInputPinConfig)(e)})).reduce((function(t,e){var n,o=e[0],i=e[1];return r(r({},t),((n={})[o]=i.value,n))}),{});return s.render(e.customViewCode,{inputs:n,isDefined:c.isDefined}).trim()}catch(o){return console.error("Error with custom view",o),"Error in custom view [".concat(e.id,"]")}return e.id};e.calcPartWidth=function(t,n){var r=(0,u.okeys)(n.inputs).length*l.MIN_WIDTH_PER_PIN,o=(0,e.calcPartContent)(t,n),i=l.PIECE_CHAR_WIDTH;return(0,p.clamp)(o.length*i+2*l.PIECE_HORIZONTAL_PADDING,r,l.MAX_INSTANCE_WIDTH)};e.calcInstancePosition=function(t,e,n){var r=(0,d.getInstanceDomId)(e,t),o=document.getElementById(r);if(o){var i=o.getBoundingClientRect(),a=i.x,u=i.y,s=i.width,c=u+i.height/2;return{x:a+s/2-n.x,y:c-n.y}}return console.warn("Cannot find element to draw connection to",r),{x:99999,y:99999}}},10616:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.LayoutDebugger=e.LayoutDebuggerItem=e.PosDebugger=void 0;var a=n(27378),u=n(24246),s=n(18265),c=i(n(27378)),l=n(13011),p=function(t){var e=t.pos;return(0,u.jsxs)("span",{children:[e.x.toFixed(1),", ",e.y.toFixed(1)]})};e.PosDebugger=function(t){return(0,u.jsx)("span",r({className:"pos-debugger"},{children:(0,u.jsx)(p,{pos:t.pos})}))};e.LayoutDebuggerItem=function(t){var n=t.pos,o=t.viewPort,i=t.size,a=t.color,s=o.zoom,c=n.x*s-o.pos.x*s,l=n.y*s-o.pos.y*s,p=c-n.x,d=l-n.y,f={transform:"translate(".concat(p,"px, ").concat(d,"px)")},v={transform:"scale(".concat(o.zoom,")")},y={transform:"translate(".concat(n.x,"px, ").concat(n.y,"px)")},m={width:"".concat(i.width,"px"),height:"".concat(i.height,"px"),backgroundColor:a};return(0,u.jsx)("div",r({className:"layout-debugger",style:f},{children:(0,u.jsxs)("span",r({className:"drag-sim",style:y},{children:[(0,u.jsx)(e.PosDebugger,{pos:n}),(0,u.jsx)("div",r({className:"layout-debugger-zoom-wrapper",style:v},{children:(0,u.jsx)("div",{className:"layout-debugger-inner",style:m})}))]}))}))};var d=function(){try{return"true"===localStorage.getItem("pos-debugger")}catch(t){return!1}}();e.LayoutDebugger=function(t){var n=t.extraDebug,i=t.vp,f=t.part,v=t.mousePos;if(!d)return null;var y=n.map((function(t,n){return(0,a.createElement)(e.LayoutDebuggerItem,r({},t,{key:n}))})),m=o(o(o([],f.instances.map((function(t){return t.pos})),!0),(0,s.values)(f.inputsPosition),!0),(0,s.values)(f.outputsPosition),!0).map((function(t){return(0,u.jsx)(e.LayoutDebuggerItem,{pos:t,viewPort:i,size:{width:0,height:0},color:"red"})})),h=(0,l.logicalPosToRenderedPos)(v,i),g=(0,u.jsxs)("div",r({className:"viewport-data"},{children:[(0,u.jsxs)("div",{children:["Pos: ",(0,u.jsx)(p,{pos:i.pos})]}),(0,u.jsxs)("div",{children:["Zoom: ",i.zoom.toFixed(2)," "]}),(0,u.jsxs)("div",{children:["Mouse (logical): ",(0,u.jsx)(p,{pos:v})]}),(0,u.jsxs)("div",{children:["Rendered (rendered): ",(0,u.jsx)(p,{pos:h})]})]}));return(0,u.jsxs)(c.default.Fragment,{children:[g,y,m]})}},94e3:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(10616),e)},5681:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.orderVisualPart=e.layoutToInstances=void 0;var i=n(41304),a=n(18265),u=n(72913),s=o(n(63300)),c=n(80807),l=n(99743),p=n(71462);e.layoutToInstances=function(t,e){return(0,s.default)(e,(function(e){(0,a.entries)(t.nodes).forEach((function(t){var n=t[0],r=t[1];if(n.startsWith("ins-")){var o=n.replace("ins-",""),i=e.instances.find((function(t){return t.id===o}));i?i.pos=r.p:console.warn("WAT")}if(n.startsWith("part-input-")){var a=n.replace("part-input-","");e.inputsPosition[a]=r.p}if(n.startsWith("part-output-")){a=n.replace("part-output-","");e.outputsPosition[a]=r.p}}))}))};e.orderVisualPart=function(t,n,o,s){var d=t.instances,f=t.connections,v=d.reduce((function(t,e){var o,u=(0,l.size)((0,p.calcPartWidth)(e,(0,a.getPartDef)(e,n)),i.PART_HEIGHT);return r(r({},t),((o={})["ins-".concat(e.id)]={p:e.pos,s:u},o))}),{}),y=(0,a.okeys)(t.inputsPosition).reduce((function(e,n){var o,a=t.inputsPosition[n],u=(0,l.size)((0,c.calcPartIoWidth)(n),i.PART_HEIGHT);return r(r({},e),((o={})["part-input-".concat(n)]={p:a,s:u},o))}),{}),m=(0,a.okeys)(t.outputsPosition).reduce((function(e,n){var o,a=t.outputsPosition[n],u=(0,l.size)((0,c.calcPartIoWidth)(n),i.PART_HEIGHT);return r(r({},e),((o={})["part-output-".concat(n)]={p:a,s:u},o))}),{}),h=r(r(r({},v),y),m),g=f.map((function(t){return[(0,a.isExternalConnectionNode)(t.from)?"part-input-".concat(t.from.pinId):"ins-".concat(t.from.insId),(0,a.isExternalConnectionNode)(t.to)?"part-output-".concat(t.to.pinId):"ins-".concat(t.to.insId)]})),b=(0,u.orderLayout)({nodes:h,edges:g},o,(function(n,r){s&&s((0,e.layoutToInstances)(n,t),r)}));return(0,e.layoutToInstances)(b,t)}},72913:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.orderLayout=void 0;var o=n(99743),i=400,a=function(t){return t.reduce((function(t,e){var n,i=(0,o.vSub)(e.p,(0,o.vec)(e.s.width/2,e.s.height/2));return r(r({},t),((n={})[e.id]={p:i,s:e.s},n))}),{})};e.orderLayout=function(t,e,n){for(var u=t.nodes,s=t.edges,c=Object.entries(u).map((function(t){var e=t[0],n=t[1];return{id:e,p:(0,o.vAdd)(n.p,(0,o.vec)(n.s.width/2,n.s.height/2)),f:(0,o.vec)(0,0),v:(0,o.vec)(0,0),m:1,s:n.s}})),l=0,p=function(){for(var t=c,e=0;e<t.length;e++)for(var u=e+1;u<t.length;u++)if(e!==u){var p=t[e],d=t[u],f=(0,o.vSub)(p.p,d.p),v=Math.abs(f.x),y=Math.abs(f.y),m=p.id.startsWith("part-input"),h=p.id.startsWith("part-output"),g=d.id.startsWith("part-input"),b=d.id.startsWith("part-output");if(v<i&&y<80){var I=1e3*(i-v);p.f=(0,o.vAdd)(p.f,(0,o.vec)(.5*I,0)),d.f=(0,o.vAdd)(d.f,(0,o.vec)(-.5*I,0))}if(y<50){var P=100*f.y;p.f=(0,o.vAdd)(p.f,(0,o.vec)(0,.5*P)),d.f=(0,o.vAdd)(d.f,(0,o.vec)(0,-.5*P))}if(m&&b){var _=(0,o.vSub)(p.p,d.p).y;if(_<-500){var C=100*(i-_);p.f=(0,o.vAdd)(p.f,(0,o.vec)(0,-.5*C)),d.f=(0,o.vAdd)(d.f,(0,o.vec)(0,.5*C))}}else if(h&&g){var O=(0,o.vSub)(p.p,d.p).y;if(O<500){var x=100*(i-O);p.f=(0,o.vAdd)(p.f,(0,o.vec)(0,-.5*x)),d.f=(0,o.vAdd)(d.f,(0,o.vec)(0,.5*x))}}var w=(0,o.vSub)(p.p,(0,o.vec)(0,p.p.y)),j=(0,o.vLen)(w),E=(0,o.vMul)((0,o.vNorm)(w),-50*j);p.f=(0,o.vAdd)(p.f,E)}s.forEach((function(e){var n=t.find((function(t){return t.id===e[0]})),r=t.find((function(t){return t.id===e[1]}));if(n&&r){var i=(0,o.vec)(0,-200),a=(0,o.vSub)(n.p,r.p),u=(0,o.vSub)(i,a),s=1e3*(0,o.vLen)(u),c=(0,o.vMul)((0,o.vNorm)(u),.5*s),l=(0,o.vMul)((0,o.vNorm)(u),-.5*s);n.f=(0,o.vAdd)(n.f,c),r.f=(0,o.vAdd)(r.f,l)}else console.warn("weoops",e[0],e[1])})),t=(t=t.map((function(t){return(0,o.itrPhysics)(15,t)}))).map((function(t){var e=(0,o.vMul)(t.v,.5),n=(0,o.vLen)(e)>100?(0,o.vMul)((0,o.vNorm)(e),100):e;return r(r({},t),{v:n})})),c=t,n&&n({nodes:a(t),edges:s},l),l++};l<e&&(l<2||(0,o.totalEnergy)(c)>.01);)p();return{nodes:a(c),edges:s,itrs:l,timeout:l>=e,total:(0,o.totalEnergy)(c)}}},52688:function(t,e){"use strict";var n=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.calculateInstancesWithSingleConstPinsMap=e.getLeafInstancesOfSelection=void 0;e.getLeafInstancesOfSelection=function(t,e,r){return t.reduce((function(t,o){var i=r.filter((function(t){return t.to.insId===o.id})).map((function(t){return e.find((function(e){return e.id===t.from.insId}))})).filter((function(t){return!!t}));return n(n([],t,!0),i,!0)}),[]).filter((function(e){return 1===r.filter((function(t){return t.from.insId===e.id||t.to.insId===e.id})).length&&!t.includes(e)}))};e.calculateInstancesWithSingleConstPinsMap=function(t,e){return t.connections.filter((function(t){return e.has(t.from.insId)})).reduce((function(t,n){var r=e.get(n.from.insId),o=n.to.insId,i=t.get(o)||new Map;return i.set(n.to.pinId,{val:r,insId:n.from.insId}),t.set(o,i),t}),new Map)}},16914:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},u=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},c=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PartIoView=void 0;var p=n(24246),d=a(n(27378)),f=n(18265),v=n(12589),y=n(90095),m=l(n(60042)),h=n(42272),g=n(91312),b=n(40411),I=n(18265),P=l(n(49040));e.PartIoView=d.memo((function(t){var e=this,n=t.viewPort,o=t.selected,i=t.pos,a=t.type,l=t.id,_=t.onDblClick,C=t.onRename,O=t.onDelete,x=t.onChangeInputMode,w=t.inputMode,j=t.onSelect,E=t.closest,D=t.onSetDescription,S=t.description,T=t.onRequestHistory,N=(0,b.useHistoryHelpers)(T,l,a),k=N.history,M=N.resetHistory,R=N.refreshHistory,A=(0,g.usePrompt)(),V=d.useCallback((function(){return u(e,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,A("Description?",S)];case 1:return t=e.sent(),D(a,l,t),[2]}}))}))}),[A,S,D,a,l]),H=d.useCallback((function(){O&&O(a,l)}),[a,l,O]),z=d.useCallback((function(){C&&C(a,l)}),[a,l,C]),G=d.useCallback((function(t){x&&x(l,t)}),[l,x]),F=d.useCallback((function(){return c(c([{text:"Current mode - ".concat(w),onClick:f.noop},{text:"Make required",onClick:function(){return G("required")}},{text:"Make optional",onClick:function(){return G("optional")}},{text:"Make required-if-connected",onClick:function(){return G("required-if-connected")}},{text:"Set description",onClick:V}],t.onRename?[{text:"Rename",onClick:z}]:[],!0),t.onDelete?[{text:"Delete",onClick:H}]:[],!0)}),[V,w,G,H,z,t.onDelete,t.onRename]),B=d.useCallback((function(e){_&&_(t.id,e)}),[_,t.id]),U=d.useCallback((function(){j(l,a)}),[l,a,j]),L=d.useCallback((function(){return(0,p.jsx)(h.Menu,{children:F().map((function(t){return(0,p.jsx)(h.MenuItem,r({},t))}))})}),[F]),q=d.useCallback((function(t){t.preventDefault(),t.stopPropagation();var e=L();h.ContextMenu.show(e,{left:t.clientX,top:t.clientY})}),[L]),W="input"===a?(0,I.getInputName)(l):(0,f.getOutputName)(l);return(0,p.jsxs)(v.BasePartView,r({className:(0,m.default)("part-io-view",a),pos:i,onDragEnd:function(e,o){var i=t.pos,u=(o.x-i.x)/n.zoom,s=(o.y-i.y)/n.zoom,c=i.x+u,p=i.y+s;t.onDragEnd(a,l,e,r(r({},o),{x:c,y:p}))},onDragStart:function(e,n){t.onDragStart(l,e,n)},onDragMove:function(e,o){var i=t.pos,u=(o.x-i.x)/n.zoom,s=(o.y-i.y)/n.zoom,c=i.x+u,p=i.y+s;t.onDragMove(a,l,e,r(r({},o),{x:c,y:p}))},viewPort:n},{children:[(0,p.jsx)(P.default,{className:"pin-info-tooltip",html:!0,id:l+t.insId,getContent:[function(){var e=(0,b.calcHistoryContent)(k),n=t.description?"<em>".concat(t.description,"</em>"):"";return"<div><div><strong>".concat(W,"</strong> (").concat(a,") </div>\n      ").concat(n,"\n      <hr/>\n      ").concat(e,"\n    ")},25]}),(0,p.jsx)("div",r({onMouseEnter:R,onMouseOut:M,"data-tip":"","data-html":!0,"data-for":l+t.insId,className:(0,m.default)("part-io-view-inner",{closest:E,selected:o}),id:(0,y.getMainPinDomId)(t.insId,l,a),onClick:U,onDoubleClick:B,onContextMenu:q},{children:l}))]}))}))},43318:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(16914),e)},80807:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.calcPartIoWidth=e.MIN_WIDTH_PER_PIN=e.PIECE_CHAR_WIDTH=e.PIECE_HORIZONTAL_PADDING=void 0,e.PIECE_HORIZONTAL_PADDING=15,e.PIECE_CHAR_WIDTH=9,e.MIN_WIDTH_PER_PIN=40;e.calcPartIoWidth=function(t){return Math.max(e.MIN_WIDTH_PER_PIN,t.length*e.PIECE_CHAR_WIDTH+2*e.PIECE_HORIZONTAL_PADDING)}},57076:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PinView=e.PIN_HEIGHT=void 0;var s=n(24246),c=a(n(27378)),l=u(n(60042)),p=n(42272),d=n(12901),f=n(18265),v=n(90095),y=n(75579),m=u(n(49040)),h=n(40411);e.PIN_HEIGHT=23;e.PinView=c.memo((function(t){var e=t.selected,n=t.type,o=t.connected,i=t.rotate,a=t.optional,u=t.isClosestToMouse,g=t.id,b=t.onRequestHistory,I=(0,h.useHistoryHelpers)(b,g,n),P=I.history,_=I.resetHistory,C=I.refreshHistory,O="input"===n?(0,f.getInputName)(g):(0,f.getOutputName)(g),x="input"===t.type&&(0,d.isDefined)(t.constValue)?t.constValue:void 0,w=i&&"input"===n;return(0,s.jsxs)("div",r({className:function(){if("input"===t.type){var r=t.isSticky,s=t.constValue;return(0,l.default)("pin",{sticky:r,selected:e,closest:u,optional:a,connected:o,rotate:i,"const-value":(0,d.isDefined)(s),"env-value":(0,d.isDefined)(s)&&(0,f.isEnvValue)(s),minimized:t.minimized},n)}return(0,l.default)("pin",{selected:e,connected:o,closest:u,rotate:i,optional:a,minimized:t.minimized},n,i)}(),onContextMenu:function(e){e.preventDefault(),e.stopPropagation();var n=function(){var e=(0,s.jsx)(p.MenuItem,{onClick:function(){return t.onToggleLogged(t.insId,t.id,t.type)}}),n=(0,s.jsx)(p.MenuItem,{onClick:function(){return t.onToggleBreakpoint(t.insId,t.id,t.type)}}),r=(0,s.jsx)(p.MenuItem,{onClick:function(){return t.onInspect(t.insId,t.id,t.type)},text:"Inspect"});if("input"===t.type){var o=t.onConvertConstToEnv;return(0,d.isDefined)(x)?(0,s.jsxs)(p.Menu,{children:[(0,s.jsx)(p.MenuItem,{onClick:function(){return t.onDetachConstValue(t.id)},text:"Detach value"}),(0,s.jsx)(p.MenuItem,{onClick:function(){return t.onCopyConstValue(t.id)},text:"Copy value"}),(0,d.isDefined)(t.copiedConstValue)?(0,s.jsx)(p.MenuItem,{onClick:function(){return t.onPasteConstValue(t.id)},text:"Paste value"}):null,o?(0,s.jsx)(p.MenuItem,{onClick:function(){return o(t.id)},text:"Convert to Env Var"}):null]}):(0,s.jsxs)(p.Menu,{children:[(0,s.jsx)(p.MenuItem,{onClick:function(){return t.onToggleSticky(t.id)},text:"Toggle sticky (square means sticky)"}),e,n,r,(0,d.isDefined)(t.copiedConstValue)?(0,s.jsx)(p.MenuItem,{onClick:function(){return t.onPasteConstValue(t.id)},text:"Paste value"}):null]})}return(0,s.jsxs)(p.Menu,{children:[e,n,r]})}();p.ContextMenu.show(n,{left:e.clientX,top:e.clientY})},"data-pin-id":g},{children:[(0,s.jsx)(m.default,{className:"pin-info-tooltip",html:!0,id:g+t.insId,getContent:[function(){var e=(0,h.calcHistoryContent)(P),r=t.description?"<em>".concat(t.description,"</em>"):"";return"<div><div><strong>".concat(O,"</strong> (").concat(n,") </div>\n      ").concat(r,"\n      <hr/>\n      ").concat((0,d.isDefined)(x)?"<div>Static value: <strong>".concat((0,y.valuePreview)(x).substr(0,200),"</strong></div>"):e,"\n    ")},25]}),(0,s.jsxs)("div",r({onMouseEnter:C,onMouseOut:_,"data-tip":"","data-html":!0,"data-for":g+t.insId,id:(0,v.getPinDomId)(t.parentInsId,t.insId,g,n),"data-place":w?"bottom":null,onDoubleClick:function(e){return t.onDoubleClick&&t.onDoubleClick(g,e)},className:"pin-inner",onClick:function(e){var r=t.onShiftClick,o=t.onClick,i=t.id;e.shiftKey&&r?r(i,e):o(i,n,e)}},{children:[O," ",(0,d.isDefined)(x)?(0,s.jsxs)(c.Fragment,{children:[":",(0,s.jsx)("span",r({className:"value"},{children:(0,d.toString)(x)}))]}):null,"input"===t.type&&t.isSticky?(0,s.jsx)("span",r({className:"suffix"},{children:"s"})):null,"input"===t.type&&t.queueSize?(0,s.jsxs)("span",r({className:"suffix"},{children:[t.queueSize," in Q"]})):null]})),(0,s.jsx)("div",{className:"wire"})]}))}))},40411:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.useHistoryHelpers=e.calcHistoryContent=void 0;var o=n(75579),i=r(n(27378)),a=n(27378);e.calcHistoryContent=function(t){if(t){var e=t.total,n=t.lastSamples,r="<strong>Activated ".concat(e," times this session</strong>"),i=n.length>0?"<div>Last value: <strong>".concat((0,o.valuePreview)(n[0].val).substr(0,200),"</strong></div>"):"";return"".concat(r," ").concat(i)}return"Loading session data.."};e.useHistoryHelpers=function(t,e,n){var r=(0,a.useRef)(),o=(0,a.useState)(),u=o[0],s=o[1];return{history:u,refreshHistory:(0,a.useCallback)((function(){clearInterval(r.current),t(e,n).then((function(t){s(t)})),r.current=setInterval((function(){t(e,n).then((function(t){s(t)}))}),500)}),[t,e,n]),resetHistory:i.default.useCallback((function(){clearInterval(r.current),s(void 0)}),[])}}},40490:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.QuickAddMenu=void 0;var u=n(24246),s=a(n(27378)),c=n(18265),l=n(42272),p=n(18185),d=n(10934),f=p.Select.ofType(),v=function(t){switch(t.type){case"part":return"".concat(t.part.id);case"value":return"Add inline value or function";case"import":return"Import ".concat(t.importablePart.part.id," from ").concat(t.importablePart.module)}},y=function(t,e){var n=e.handleClick,r=e.modifiers,o=e.query;if(!r.matchesPredicate)return null;var i=v(t);return"value"===t.type?(0,u.jsxs)(s.Fragment,{children:[(0,u.jsx)(l.MenuDivider,{}),(0,u.jsx)(l.MenuItem,{active:r.active,disabled:r.disabled,onClick:n,text:(0,d.highlightText)(i,o)},v(t))]}):(0,u.jsx)(l.MenuItem,{active:r.active,disabled:r.disabled,onClick:n,text:(0,d.highlightText)(i,o)},v(t))},m=function(t,e,n,r){var o=v(e).toLocaleLowerCase(),i=t.toLowerCase();return r?o===i:o.includes(i)};e.QuickAddMenu=function(t){var e,n=t.resolvedFlow,o=t.onRequestImportables,i={left:t.pos.x,top:t.pos.y},a=s.useState(),p=a[0],d=a[1];s.useEffect((function(){o&&o("").then(d)}),[o]);var v=(0,c.values)(r(r({},n.dependencies),((e={})[n.main.id]=n.main,e))),h=v.map((function(t){return{type:"part",part:t}})),g=new Set(v.map((function(t){return t.id}))),b=p?p.filter((function(t){return!g.has(t.part.id)})).map((function(t){return{type:"import",importablePart:t}})):[],I=h.concat(b).concat({type:"value"});return(0,u.jsx)("div",r({className:"quick-add-menu",style:i},{children:(0,u.jsx)(f,{className:"quick-add-parts-select",items:I,itemPredicate:m,itemRenderer:y,inputProps:{className:"quick-add-input"},noResults:(0,u.jsx)(l.MenuItem,{disabled:!0,text:"No results."}),onItemSelect:function(e){return t.onAdd(e)},popoverProps:{isOpen:!0,onClose:function(){return t.onClose()}}})}))}},29841:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(40490),e)},76298:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createRuntimePlayer=void 0;var r=n(18265),o=n(22940),i=(0,r.debugLogger)("runtime-player");e.createRuntimePlayer=function(t){var e=0,n=[],r=!1,a=Date.now(),u=e,s=function s(){return requestAnimationFrame((function(){var c,l,p,d=Date.now();u=e,e+=d-a,a=d,c=u,l=e,p=n,n=[],p.length&&i("Playing ".concat(p.length," events from"),c,l),p.forEach((function(e){i("Playing event",e),(0,o.playEvent)(t,e)})),r&&s()}))},c=function(){r=!1},l=function(){n=[],document.querySelectorAll("[data-runtime]").forEach((function(t){t.removeAttribute("data-runtime")})),document.querySelectorAll("[data-runtime-queue]").forEach((function(t){t.removeAttribute("data-runtime-queue")}))};return{stop:c,start:function(t){void 0===t&&(t=0),r=!0,e=t,a=Date.now(),s()},addEvents:function(t){n.push.apply(n,t)},destroy:function(){c(),l()},clear:l,status:function(){return{running:r,currDt:e,lastDt:u,queue:n,last:a}}}}},22940:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.playEvent=e.cancelTimers=void 0;var o=n(18265),i=n(90095),a=5e3,u=(0,o.debugLogger)("runtime-player:play-event"),s=function(t){return t.type===o.DebuggerEventType.INPUT_CHANGE||t.type===o.DebuggerEventType.OUTPUT_CHANGE?"".concat(t.parentInsId,".").concat(t.insId,".").concat(t.pinId):"".concat(t.parentInsId,".").concat(t.insId)};e.cancelTimers=new Map;e.playEvent=function(t,n){var c,l,p=s(n);switch(n.type){case o.DebuggerEventType.INPUT_CHANGE:case o.DebuggerEventType.OUTPUT_CHANGE:var d=n.pinId,f=n.insId,v=n.parentInsId,y=n.type===o.DebuggerEventType.INPUT_CHANGE?"input":"output",m=f===t?(0,i.getMainPinDomId)(f,d,y):(0,i.getPinDomId)(v,f,d,y),h=document.getElementById(m),g="".concat(f,".").concat(d),b=n.type===o.DebuggerEventType.OUTPUT_CHANGE?document.querySelectorAll('[data-from-id="'.concat(g,'"]')):[];if(h){clearTimeout(e.cancelTimers.get(p)),h.removeAttribute("data-runtime"),b.forEach((function(t){t.removeAttribute("data-runtime")})),setTimeout((function(){h.setAttribute("data-runtime","active"),b.forEach((function(t){t.setAttribute("data-runtime","active")}))}),0);var I=setTimeout((function(){h.removeAttribute("data-runtime"),b.forEach((function(t){t.removeAttribute("data-runtime")})),e.cancelTimers.delete(p)}),a);e.cancelTimers.set(s(n),I)}else console.warn("No DOM element with Id [".concat(m,"] found to play event")),u("No DOM element with Id [".concat(m,"] found to play event"),n);break;case o.DebuggerEventType.PROCESSING_CHANGE:f=n.insId,v=n.parentInsId,m=(0,i.getInstanceDomId)(v,f);var P=null===(c=document.getElementById(m))||void 0===c?void 0:c.parentElement;if(!P)return void u("No DOM element with Id [".concat(m,"] found to play event"),n);if(!0===n.val)P.setAttribute("data-runtime","processing"),clearTimeout(e.cancelTimers.get(p));else{P.removeAttribute("data-runtime"),setTimeout((function(){P.setAttribute("data-runtime","done")}),0);I=setTimeout((function(){P.removeAttribute("data-runtime"),e.cancelTimers.delete(p)}),a);e.cancelTimers.set(p,I)}break;case o.DebuggerEventType.ERROR:f=n.insId,v=n.parentInsId,m=(0,i.getInstanceDomId)(v,f);var _=null===(l=document.getElementById(m))||void 0===l?void 0:l.parentElement;if(!_)return void u("No DOM element with Id [".concat(m,"] found to play event"),n);clearTimeout(e.cancelTimers.get(p)),_.removeAttribute("data-runtime"),setTimeout((function(){_.setAttribute("data-runtime","error")}));I=setTimeout((function(){_.removeAttribute("data-runtime"),e.cancelTimers.delete(p)}),a);e.cancelTimers.set(p,I);var C=r(r({},n),{type:o.DebuggerEventType.OUTPUT_CHANGE,pinId:o.ERROR_PIN_ID});(0,e.playEvent)(t,C);break;case o.DebuggerEventType.INPUTS_STATE_CHANGE:(0,o.entries)(n.val).forEach((function(t){var e=t[0],r=t[1],o=n.insId,a=n.parentInsId,s=(0,i.getPinDomId)(a,o,e,"input"),c=document.getElementById(s);c?r>0?c.setAttribute("data-runtime-queue","".concat(r)):c.removeAttribute("data-runtime-queue"):u("No DOM element with Id [".concat(s,"] found to play event"),n)}))}}},69385:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useDebounce=void 0;var r=n(27378);e.useDebounce=function(t,e){var n=(0,r.useState)(t),o=n[0],i=n[1];return(0,r.useEffect)((function(){var n=setTimeout((function(){i(t)}),e);return function(){clearTimeout(n)}}),[t,e]),[o,i]}},13011:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&o(e,t,n);return i(e,t),e},u=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.handleChangePartInputType=e.handleIoPinRename=e.handleInstanceDrag=e.getInstancesInRect=e.isJsxValue=e.fitViewPortToPart=e.centerBoardPosOnTarget=e.renderedPosToLogicalPos=e.logicalPosToRenderedPos=e.getEffectivePartDimensions=e.calcPartsPositions=e.calcSelectionBoxArea=e.animateViewPort=e.easeInOutNum=e.easeInOutPos=e.easeInOutQuad=e.center=e.distance=e.clamp=e.domToViewPort=e.roundNumber=e.createNewPartInstance=e.createNewInlinePartInstance=e.parseInputOutputTypes=e.parsePromptValue=e.getSelectionBoxRect=e.findClosestPin=e.toggleStickyPin=e.emptyList=e.emptyObj=void 0;var s=a(n(63300)),c=n(41304),l=n(18265),p=n(68488),d=n(18265),f=n(71462),v=n(80807),y=n(99743),m=n(52688),h=n(41756);e.emptyObj={},e.emptyList=[];e.toggleStickyPin=function(t,e,n,o){return s.produce(t,(function(t){var o=t.instances,i=o.find((function(t){return t.id===e}));if(!i)throw new Error("blah");var a=i.inputConfig||{},u=a[n]||(0,l.queueInputPinConfig)();(0,l.isStickyInputPinConfig)(u)?a[n]=(0,l.queueInputPinConfig)():a[n]=(0,l.stickyInputPinConfig)(),t.instances=o.map((function(t){return t===i?r(r({},i),{inputConfig:a}):t}))}))};e.findClosestPin=function(t,e,n,r,o,i){var a=(0,l.partInstance)(t.id,t.id),s=(0,d.okeys)(t.inputs).map((function(t){return{id:t,type:"input",pos:(0,p.calcMainInputPosition)(t,o,"input",r,i),ins:a}})),c=(0,d.okeys)(t.outputs).map((function(t){return{id:t,type:"output",pos:(0,p.calcMainOutputPosition)(t,o,"output",r,i),ins:a}})),f=t.instances.reduce((function(n,a){var s=(0,l.getPartDef)(a,e),c=(0,h.getVisibleInputs)(a,s,t.connections),d=(0,h.getVisibleOutputs)(a,s,t.connections),f=c.map((function(t){return{ins:a,type:"input",pos:(0,p.calcPinPosition)(o,a.id,t,"input",r,i),id:t}})),v=d.map((function(t){return{ins:a,type:"output",pos:(0,p.calcPinPosition)(o,a.id,t,"output",r,i),id:t}}));return u(u(u([],n,!0),f,!0),v,!0)}),[]),v=u(u(u([],s,!0),f,!0),c,!0),y={dis:1e5,item:v[0]};return v.forEach((function(t){var e=t.pos.x-n.x,r=t.pos.y-n.y,o=Math.sqrt(e*e+r*r);o<y.dis&&(y.dis=o,y.item=t)})),y.item};e.getSelectionBoxRect=function(t,e){var n=Math.min(t.x,e.x),r=Math.min(t.y,e.y);return{x:n,y:r,w:Math.max(t.x,e.x)-n,h:Math.max(t.y,e.y)-r}};e.parsePromptValue=function(t){if(null!==t){var e=parseInt(t,10),n=t;return e.toString()!=t||isNaN(e)||(n=e),n}};e.parseInputOutputTypes=function(t){var e=t.match(/part\((.+)\|(.+)\)/)||[],n=e[1],r=e[2],o=(0,d.entries)(JSON.parse(n)).map((function(t){var e=t[0],n={type:t[1],optional:(0,d.isOptionalType)(e)};return[e.replace(/\?$/,""),n]})),i=(0,d.entries)(JSON.parse(r)).map((function(t){var e=t[0],n={type:t[1],optional:(0,d.isOptionalType)(e)};return[e.replace(/\?$/,""),n]}));return{inputs:(0,d.fromEntries)(o),outputs:(0,d.fromEntries)(i)}};e.createNewInlinePartInstance=function(t,e,n){void 0===e&&(e=-1*c.PART_HEIGHT*1.5);var o=(0,l.inlinePartInstance)("".concat(t.id,"-").concat((0,d.randomInt)(999)),t,{},{x:0,y:0}),i=(0,f.calcPartWidth)(o,t),a={x:n.x-i/2,y:n.y+e};return r(r({},o),{pos:a})};e.createNewPartInstance=function(t,e,n,o){void 0===e&&(e=-1*c.PART_HEIGHT*1.5);var i="string"==typeof t?(0,l.getPartDef)(t,o):t;if(!i)throw new Error("".concat(t," part not found in repo"));var a=(0,d.entries)(i.inputs).reduce((function(t,e){var n=e[0],r=e[1];return r.defaultValue&&(t[n]=(0,l.staticInputPinConfig)(r.defaultValue)),t}),{}),u=(0,l.partInstance)("".concat(i.id,"-").concat((0,d.randomInt)(999)),i.id,a,{x:0,y:0}),s=(0,f.calcPartWidth)(u,i),p={x:n.x-s/2,y:n.y+e};return r(r({},u),{pos:p})};e.roundNumber=function(t){return Math.round(100*t)/100};e.domToViewPort=function(t,n,r){return{x:(0,e.roundNumber)(n.pos.x+t.x/n.zoom/r.zoom),y:(0,e.roundNumber)(n.pos.y+t.y/n.zoom/r.zoom)}};e.clamp=function(t,e,n){return Math.max(t,Math.min(e,n))};e.distance=function(t,e){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)};e.center=function(t,e,n){var r=n.zoom,o=t.x+t.w/2,i=t.y+t.h/2;return{x:o-e.w/r/2,y:i-e.h/r/2}};e.easeInOutQuad=function(t){return t<.5?2*t*t:(4-2*t)*t-1};e.easeInOutPos=function(t,n,r,o,i){var a=(0,e.clamp)(0,1,(i-r)/o),u=(0,e.easeInOutQuad)(a),s=n.x-t.x,c=n.y-t.y;return{x:t.x+s*u,y:t.y+c*u}};e.easeInOutNum=function(t,n,r,o,i){var a=(0,e.clamp)(0,1,(i-r)/o);return t+(n-t)*(0,e.easeInOutQuad)(a)};e.animateViewPort=function(t,n,r,o){var i=(0,e.distance)(t.pos,n.pos),a=Date.now(),u=r;if(0!==i){requestAnimationFrame((function r(){var i=Date.now(),s=(0,e.easeInOutPos)(t.pos,n.pos,a,u,i),c=(0,e.easeInOutNum)(t.zoom,n.zoom,a,u,i);i-a<u?(o({pos:s,zoom:c}),requestAnimationFrame(r)):o({pos:s,zoom:c})}))}else o(t)};e.calcSelectionBoxArea=function(t){var n=(0,e.getSelectionBoxRect)(t.from,t.to);return n.h*n.w};var g=function(t,e,n,o){return{left:n.x,right:n.x+t,top:n.y,bottom:n.y+e,tag:o,center:(0,l.calcCenter)(r({w:t,h:e},n))}};e.calcPartsPositions=function(t,e){var n=t.instances.map((function(t){var n=(0,f.calcPartWidth)(t,(0,l.getPartDef)(t,e)),r=c.PART_HEIGHT;return g(n,r,t.pos,t.id)})),r=(0,d.okeys)(t.inputs).map((function(e){var n=(0,v.calcPartIoWidth)(e),r=c.PART_HEIGHT,o=t.inputsPosition[e]||{x:0,y:0};return g(n,r,o,"input_"+e)})),o=(0,d.okeys)(t.outputs).map((function(e){var n=(0,v.calcPartIoWidth)(e),r=c.PART_HEIGHT,o=t.outputsPosition[e]||{x:0,y:0};return g(n,r,o,"output"+e)}));return u(u(u([],n,!0),r,!0),o,!0)};e.getEffectivePartDimensions=function(t,n){var o=(0,e.calcPartsPositions)(t,n),i=o[0]||{left:0,right:0,top:0,bottom:0},a=o.reduce((function(t,e){return e.left<t?e.left:t}),i.left),u=o.reduce((function(t,e){return e.right>t?e.right:t}),i.right),s=o.reduce((function(t,e){return e.top<t?e.top:t}),i.top),c=u-a,p=o.reduce((function(t,e){return e.bottom>t?e.bottom:t}),i.bottom)-s,d={x:a,y:s};return{size:{width:c,height:p},pos:d,center:(0,l.calcCenter)(r({w:c,h:p},d))}};e.logicalPosToRenderedPos=function(t,e){var n=(0,y.vSub)(t,e.pos);return(0,y.vMul)(n,e.zoom)};e.renderedPosToLogicalPos=function(t,e){var n=(0,y.vDiv)(t,e.zoom);return(0,y.vAdd)(e.pos,n)};e.centerBoardPosOnTarget=function(t,n,o,i){var a=(0,e.logicalPosToRenderedPos)(t,i),u=(0,e.renderedPosToLogicalPos)(a,r(r({},i),{zoom:o})),s=Math.max(t.x,u.x)-Math.min(t.x,u.x),c=Math.max(t.y,u.y)-Math.min(t.y,u.y);return{x:o>i.zoom?i.pos.x+s:i.pos.x-s,y:o>i.zoom?i.pos.y+c:i.pos.y-c}};e.fitViewPortToPart=function(t,n,r){var o=(0,e.getEffectivePartDimensions)(t,n),i=o.size,a=o.center,u=i.width+0,s=i.height+0,c=r.width/u,l=r.height/s,p=Math.min(c,l)/1.15,d=(0,e.clamp)(.3,1.2,p);return{zoom:d,pos:{x:a.x-r.width/2/d,y:a.y-r.height/2/d}}};e.isJsxValue=function(t){var e=function(t){return(0,d.isDefined)(t.ref)&&(0,d.isDefined)(t.type)&&(0,d.isDefined)(t.props)};try{var n=JSON.parse(t);return e(n)||Array.isArray(n)&&e(n[0])}catch(r){return!1}};e.getInstancesInRect=function(t,n,o,i,a,u,s){var p=t.from,d=t.to,v=(0,e.getSelectionBoxRect)(p,d);return a.filter((function(t){var e=t.pos,i=(0,f.calcPartWidth)(t,(0,l.getPartDef)(t,n))*o.zoom*s.zoom,a=r(r({},e),{w:i,h:c.PART_HEIGHT*o.zoom*s.zoom});return console.log(t.id,a,"main",v),(0,l.intersectRect)(v,a)||(0,l.intersectRect)(a,v)})).map((function(t){return t.id}))};e.handleInstanceDrag=function(t,e,n,r,o,i){r.preventDefault(),r.stopPropagation();var a,c=(0,y.vSub)(n,e.pos),l=s.produce(t,(function(t){var s=t.instances.find((function(t){return t.id===e.id}));if(!s)throw new Error("impossible state dragging instance that does not exist");!r.shiftKey&&i&&(a=[i]);var l=t.instances.filter((function(t){return o.includes(t.id)&&t!==s})),p=u([s],l,!0),d=(0,m.getLeafInstancesOfSelection)(p,t.instances,t.connections);u(u([],l,!0),d,!0).forEach((function(t){t.pos=(0,y.vAdd)(t.pos,c)})),s.pos=n,!r.shiftKey&&i&&(a=[i])}));return{newValue:l,newSelected:a}};e.handleIoPinRename=function(t,e,n,o){return s.produce(t,(function(t){"input"===e?(t.inputs[o]=t.inputs[n],t.inputsPosition[o]=t.inputsPosition[n],delete t.inputs[n],t.connections=t.connections.map((function(t){return(0,l.isExternalConnectionNode)(t.from)&&t.from.pinId===n?r(r({},t),{from:r(r({},t.from),{pinId:o})}):t}))):(t.outputs[o]=t.outputs[n],t.outputsPosition[o]=t.outputsPosition[n],t.connections=t.connections.map((function(t){return(0,l.isExternalConnectionNode)(t.to)&&t.to.pinId===n?r(r({},t),{to:r(r({},t.to),{pinId:o})}):t})),t.completionOutputs=(t.completionOutputs||[]).map((function(t){return t.split("+").map((function(t){return t===n?o:n})).join("+")})),delete t.outputs[n])}))};e.handleChangePartInputType=function(t,e,n){return s.produce(t,(function(t){var r=t.inputs[e];if(!r)throw new Error("Wat");r.mode=n}))}},17229:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createEditorClient=void 0;var r=n(18265),o=n(14206),i=n(50208),a=n(19389),u=(0,r.debugLogger)("runtime-editor-client");e.createEditorClient=function(t,e){var n=new URL(t),r=(0,i.default)(n.origin,{path:"".concat("/"===n.pathname?"":n.pathname,"/socket.io/editor")});return r.emit("join-room-editor",e),{emitChange:function(t){r.emit(a.DebuggerServerEventType.CHANGE_EVENT_NAME,t)},emitBreakpointsChange:function(t){r.emit(a.DebuggerServerEventType.UPDATE_BREAKPOINTS,t)},interceptInput:function(t){r.emit(a.DebuggerServerEventType.INPUT_VALUE_OVERRIDE,t)},interceptOutput:function(t){r.emit(a.DebuggerServerEventType.OUTPUT_VALUE_OVERRIDE,t)},onRuntimeReady:function(t){return r.on(a.DebuggerServerEventType.RUNTIME_READY,t),function(){return r.off(a.DebuggerServerEventType.RUNTIME_READY,t)}},onChangeAwk:function(t){return r.on(a.DebuggerServerEventType.CHANGE_AWK,t),function(){return r.off(a.DebuggerServerEventType.CHANGE_AWK,t)}},onChangeError:function(t){return r.on(a.DebuggerServerEventType.CHANGE_ERROR,t),function(){return r.off(a.DebuggerServerEventType.CHANGE_ERROR,t)}},onIsAlive:function(t){return r.on(a.DebuggerServerEventType.IS_ALIVE,t),function(){return r.off(a.DebuggerServerEventType.IS_ALIVE,t)}},emitInputValue:function(t,e){u("Emitting push input value to ".concat(t," %o"),e),r.emit(a.DebuggerServerEventType.PUSH_INPUT_VALUE,{pinId:t,value:e})},destroy:function(){r.disconnect(),(0,a.enumToArray)(a.DebuggerServerEventType).forEach((function(t){return r.off(t)}))},onDisconnect:function(t){return r.on("disconnect",t),function(){return r.off("disconnect",t)}},debugInfo:function(){return"Remote debugger for ".concat(t)},onBatchedEvents:function(t){return r.on(a.DebuggerServerEventType.EVENTS_BATCH,t),function(){return r.off(a.DebuggerServerEventType.EVENTS_BATCH,t)}},requestState:function(){return o.default.get("".concat(t,"/state")).then((function(t){return t.data.state}))},getHistory:function(e){return o.default.get("".concat(t,"/history"),{params:{insId:e.insId,pinId:e.pinId,limit:e.limit}}).then((function(t){return t.data}))},clearHistory:function(){return o.default.delete("".concat(t,"/history")).then((function(){}))},triggerPart:function(e,n){return o.default.post("".concat(t,"/trigger"),{partId:e,inputs:n}).then((function(t){return t.data}))}}}},4278:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createRuntimeClient=e.DEFAULT_DT_SCALE=void 0;var r=n(18265),o=n(50208),i=n(19389),a=(0,r.debugLogger)("debugger-runtime-client");e.DEFAULT_DT_SCALE=1;e.createRuntimeClient=function(t,e){var n=new URL(t),u=(0,o.io)(n.origin,{path:"".concat("/"===n.pathname?"":n.pathname,"/socket.io/runtime")});u.emit("join-room-runtime",e);new Set;u.on(i.DebuggerServerEventType.UPDATE_BREAKPOINTS,(function(t){new Set(t)}));Date.now();var s=(0,r.cappedArrayDebounce)((function(t){a("Emitting debounced batched events - ".concat(t.length)),u.emit(i.DebuggerServerEventType.EVENTS_BATCH,t)}),100,200),c={onChange:function(t){return u.on(i.DebuggerServerEventType.CHANGE_EVENT_NAME,t),function(){return u.off(i.DebuggerServerEventType.CHANGE_EVENT_NAME,t)}},onInput:function(t){return u.on(i.DebuggerServerEventType.PUSH_INPUT_VALUE,t),function(){return u.off(i.DebuggerServerEventType.PUSH_INPUT_VALUE,t)}},emitEvent:function(t){a("Emitting event ".concat(t.type," change event of ").concat(t.insId)),s.addItem(t)},emitRuntimeReady:function(){u.emit(i.DebuggerServerEventType.RUNTIME_READY,{})},emitChangeAwk:function(){u.emit(i.DebuggerServerEventType.CHANGE_AWK,{})},emitChangeError:function(t){u.emit(i.DebuggerServerEventType.CHANGE_ERROR,{error:t})},emitIsAlive:function(t){u.emit(i.DebuggerServerEventType.IS_ALIVE,{time:t})},destroy:function(){s.flush(),(0,i.enumToArray)(i.DebuggerServerEventType).forEach((function(t){return u.off(t)})),u.disconnect()},onDisconnect:function(t){return u.on("disconnect",t),function(){return u.off("disconnect",t)}}};return new Promise((function(t,e){u.connected?t(c):(u.on("connect_error",(function(t){e("Socket connect error: ".concat(t))})),u.on("connect",(function(){t(c)})))}))}},19389:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DebuggerServerEventType=e.enumToArray=e.isNumber=e.isSimpleType=e.valuePreview=e.toString=void 0;var r=n(63726);e.toString=function(t){if("object"===typeof t){if(t instanceof Error)return JSON.stringify((0,r.serializeError)(t));try{return JSON.stringify(t).substr(0,250)}catch(e){return"Object (cannot stringify)"}}return"".concat(t).substr(0,250)};e.valuePreview=function(t){return(0,e.toString)(t).substr(0,100)};e.isSimpleType=function(t){return["number","string","boolean"].includes(typeof t)};e.isNumber=function(t){return!1===isNaN(Number(t))},e.enumToArray=function(t){return Object.keys(t).filter(e.isNumber).map((function(e){return t[e]}))},function(t){t.RUNTIME_READY="runtime-ready",t.CHANGE_EVENT_NAME="change",t.PUSH_INPUT_VALUE="push-input-value",t.CHANGE_AWK="live-change-awk",t.CHANGE_ERROR="live-change-error",t.IS_ALIVE="is-alive",t.UPDATE_BREAKPOINTS="update-breakpoints",t.INPUT_VALUE_OVERRIDE="input-value-override",t.OUTPUT_VALUE_OVERRIDE="output-value-override",t.INPUT_VALUE_CHANGE="input-value-changed",t.OUTPUT_VALUE_CHANGE="output-value-changed",t.PROCESSING_CHANGE="processing-changed",t.INPUTS_STATE_CHANGE="inputs-state-changed",t.PART_ERROR="part-error",t.EVENTS_BATCH="events-batch"}(e.DebuggerServerEventType||(e.DebuggerServerEventType={}))},75579:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,o)}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(19389),e),o(n(17229),e),o(n(4278),e)},97534:function(t,e,n){var r=n(45597).default;t.exports={id:"Dot",defaultStyle:{size:"small"},inputs:{obj:{mode:"required",type:"any"},key:{mode:"required",type:"any"}},outputs:{value:{type:"any"}},customViewCode:"<% if (inputs.key) { %> .<%- inputs.key %> <% } else { %> Dot <% } %>",completionOutputs:["value"],fn:function(t,e,n){for(var o,i=t.obj,a=t.key,u=e.value,s=!1,c={},l=a.replace(/\["(([^"])+)"\]/g,(function(t,e,n,r){var o="__$KEY$__"+r;return c[o]=e,"."+o})).split("."),p=Object.assign({},i),d=r(l);!(o=d()).done;){var f=o.value,v=c[f]||f;p&&void 0!==p[v]&&null!==p[v]?p=p[v]:(u.next(null),s=!0)}s||u.next(p)}}},71611:function(t,e,n){t.exports={id:"HttpGet",inputs:{url:{mode:"required",type:"any"},headers:{mode:"required-if-connected",type:"any"}},outputs:{response:{type:"any"}},completionOutputs:["response"],fn:function(t,e,r){var o=n(25717),i=t.url,a=t.headers,u=e.response,s=r.onError;o.get(i,{headers:a,timeout:15e3}).then((function(t){u.next(t.data)}),(function(t){s(t)}))}}},80902:function(t,e,n){t.exports={id:"HttpPost",inputs:{url:{mode:"required",type:"any"},body:{mode:"required",type:"any"},headers:{mode:"required-if-connected",type:"any"},bodyType:{mode:"required-if-connected",type:"any"}},completionOutputs:["response"],outputs:{response:{type:"any"}},fn:function(t,e,r){var o=n(25717),i=t.url,a=t.body,u=t.headers,s=t.bodyType,c=e.response,l=r.onError,p={headers:u,timeout:15e3};if("form"===s){var d=[];Object.keys(a).forEach((function(t){d.push(t+"="+encodeURIComponent(a[t]))})),o.post(i,d.join("&"),p).then((function(t){c.next(t.data)}),(function(t){var e=t.response,n=t.message,r=e?{data:e.data,status:e.status}:{data:n,status:-1};l(r)}))}else o.post(i,a,p).then((function(t){c.next(t.data)}),(function(t){var e=t.response,n=t.message,r=e?{data:e.data,status:e.status}:{data:n,status:-1};l(r)}))}}},42716:function(t,e,n){"use strict";n.d(e,{V:function(){return a}});var r=n(52685),o=n(27378),i=function(t){return o.createElement("li",{className:"log-item"},o.createElement("main",{className:"content"},t.value),o.createElement("aside",null,new Date(t.time).toLocaleTimeString()))},a=function(t){var e=o.useState([]),n=e[0],a=e[1];return o.useEffect((function(){t.output.subscribe((function(t){var e="object"==typeof t&&o.isValidElement(t)?t:""+t;a((function(t){return[].concat(t,[{value:e,time:Date.now()}])}))}))}),[]),o.createElement("div",{className:"output-log"},o.createElement("header",null,"Output Log"," ",o.createElement("button",{className:"clear-btn button button--outline button--secondary button--sm",onClick:function(){return a([])}},"Clear")),o.createElement("main",null,o.createElement("ul",null,n.map((function(t,e){return o.createElement(i,(0,r.Z)({},t,{key:e}))}))),0===n.length?o.createElement("div",{className:"empty-state"},"Nothing to show. Interact with the example to emit some outputs!"):null))}},38941:function(t,e,n){"use strict";n.d(e,{I:function(){return C}});var r=n(27378),o=n(67651),i=n(59821),a=n(38944),u=n(96149),s=n(18265),c={VMScript:function(t){this.script=t},VM:function(){function t(t){this.context=t}return t.prototype.run=function(t){var e=(0,s.okeys)(this.context.sandbox),n=Object.values(this.context.sandbox);Function.apply(void 0,e.concat([t.script])).apply(void 0,n)},t}()},l=n(81884),p=n(44305),d=n(13127),f=200,v=n(60512),y=n(1706),m=n(12902),h=n(33099);n.g.vm2=c;var g,b,I=(b=new Map,{requestHistory:(g=(0,d.Z)((0,p.Z)().mark((function t(e,n,r){var o,i,a,u;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o="input"===r?s.DebuggerEventType.INPUT_CHANGE:s.DebuggerEventType.OUTPUT_CHANGE,console.log({insId:e,pinId:n,type:o}),i=e+"."+n+"."+o,a=b.get(i)||{total:0,lastSamples:[]},u=a.lastSamples.slice(0,f),t.abrupt("return",Object.assign({},a,{lastSamples:u}));case 6:case"end":return t.stop()}}),t)}))),function(t,e,n){return g.apply(this,arguments)}),addEvents:function(t){t.forEach((function(t){if(t.type===s.DebuggerEventType.ERROR){var e=t;e.type=s.DebuggerEventType.OUTPUT_CHANGE,e.pinId=s.ERROR_PIN_ID}if(t.type===s.DebuggerEventType.INPUT_CHANGE||t.type===s.DebuggerEventType.OUTPUT_CHANGE){var n=t.insId,r=t.type,o=n+"."+t.pinId+"."+r,i=b.get(o)||{total:0,lastSamples:[]};i.lastSamples.unshift(t),i.lastSamples.length>f&&i.lastSamples.splice(f,i.lastSamples.length-f),i.total++,b.set(o,i)}}))}}),P=[{title:"Hello World",key:"hello-world"},{title:"React Counter",key:"react-counter"},{title:"BMI Calculator",key:"bmi"},{title:"REST API Usage",key:"apis"},{title:"Debounce vs. Throttling",key:"debounce-throttling"},{title:"Fibonacci Seq.",key:"fibonacci"}],_=function(t){var e,n,r=t.flow,i=t.output,a=t.inputs,u=t.onError,c=t.debugDelay,l=function(t,e){return{onEvent:function(n){console.info("Got debugger event",n),e.addEvents([n]),t.addEvents([n])}}}(t.player,I);l.debugDelay=c;var p=(0,s.keys)(r.main.outputs)[0];return(0,s.execute)({part:r.main,inputs:a,outputs:(e={},e[p]=i,e),partsRepo:Object.assign({},r.dependencies,(n={},n[r.main.id]=r.main,n)),_debugger:l,onBubbleError:function(t){u(t)},extraContext:{PubSub:o}})},C=function(t){var e=t.flowProps,n=e.flow,o=e.inputs,c=e.output,p=(0,r.useState)(t.initWidth||500),d=p[0],f=p[1],g=(0,r.useState)(t.defaultDelay||0),b=g[0],C=g[1],O=(0,r.useState)(!1),x=O[0],w=O[1],j=(0,r.useRef)((0,u.createRuntimePlayer)("root."+t.flowProps.flow.part.id)),E=(0,r.useState)(t.flowProps.resolvedFlow),D=E[0],S=E[1],T=(0,r.useState)({flow:n,boardData:{viewPort:{pos:{x:0,y:0},zoom:1},lastMousePos:{x:0,y:0},selected:[]}}),N=T[0],k=T[1];(0,r.useEffect)((function(){S((function(t){return Object.assign({},t,{main:N.flow.part})}))}),[N.flow.part]);var M={state:N,resolvedRepoWithDeps:D,onChangeEditorState:k,onInspectPin:s.noop,onRequestHistory:I.requestHistory,hideTemplatingTips:!0,onImportPart:s.noop,onExtractInlinePart:s.noop,onQueryImportables:s.noop};(0,r.useEffect)((function(){j.current.start()}),[]),(0,r.useEffect)((function(){var e=_({flow:D,output:c,inputs:o,onError:s.noop,debugDelay:b,player:j.current}),n=t.flowProps.output.subscribe((function(){return w(!0)}));return function(){e(),n.unsubscribe()}}),[b,D]);var R=(0,r.useCallback)((function(t,e){var n=e.size;f(n.width),k((function(t){var e=document.querySelector(".flow-container"),n=e?e.getBoundingClientRect():{width:500,height:500};return(0,m.ZP)(t,(function(t){t.boardData.viewPort=(0,u.fitViewPortToPart)(t.flow.part,D.dependencies,n)}))}))}),[]),A=r.createElement("div",{className:"delay-container"},r.createElement("input",{type:"range",id:"volume",name:"delay",value:b,step:"100",min:"0",max:"300",onChange:function(t){return C(Number(t.target.value))}}),r.createElement("label",{htmlFor:"volume"},"Debug Delay: ",b,"ms")),V=P.findIndex((function(e){return e.key===t.meta.key})),H=P[V+1],z=P[V-1];return r.createElement(i.Z,{title:t.meta.title+" | Playground",description:"Flyde Playground - "+t.meta.title+" example"},r.createElement("header",{className:(0,a.Z)("hero hero--primary",v.Z.heroBanner,"playground-hero")},r.createElement("div",{className:"container"},r.createElement("h1",{className:"hero__title"},"Welcome to Flyde's Online Playground"),r.createElement("p",{className:"hero__subtitle"},"Choose one of the examples below to get started. Feel free to play around with the canvas and see how your changes affect the result!"))),r.createElement("ul",{className:"examples__menu"},P.map((function(t){return r.createElement("li",{key:t.key},r.createElement(l.Z,{to:"/playground/"+t.key,className:"button button--primary"},t.title))}))),r.createElement("div",{className:"playground-container"},r.createElement("header",null,r.createElement("h2",{className:"playground-title"},t.meta.title),r.createElement("div",{className:"playground-description"},t.meta.description),x?r.createElement(r.Fragment,null,r.createElement("hr",null),r.createElement("div",{className:"playground-extra"},t.extraInfo||t.meta.extraInfo)):null,t.prefixComponent),r.createElement("div",{className:"playground"},r.createElement("div",{className:"flow-container"},!0!==t.hideDelay?A:null,r.createElement(h.Z,null,(function(){return r.createElement(u.FlowEditor,M)}))),r.createElement(y.Resizable,{height:0,width:d,onResize:R,axis:"x",handle:r.createElement("div",{className:"handle"}),resizeHandles:["w"]},r.createElement("div",{className:"output-container",style:{flexBasis:d}},t.children))),r.createElement("nav",{className:"pagination-nav"},r.createElement("div",{className:"pagination-nav__item"},z?r.createElement("a",{className:"pagination-nav__link",href:"/playground/"+z.key},r.createElement("div",{className:"pagination-nav__sublabel"},"Previous Example"),r.createElement("div",{className:"pagination-nav__label"},z.title)):null),r.createElement("div",{className:"pagination-nav__item pagination-nav__item--next"},H?r.createElement("a",{className:"pagination-nav__link",href:"/playground/"+H.key},r.createElement("div",{className:"pagination-nav__sublabel"},"Next Example"),r.createElement("div",{className:"pagination-nav__label"},H.title)):null))))}},65689:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return c}});var r=n(27378),o=n(18265),i=n(38941),a={resolvedFlow:{main:{instances:[{pos:{x:-656.1905053710938,y:326.03946411132813},id:"Inline-value-Hello from ${i76",inputConfig:{},part:{id:"Inline-value-Hello from ${i",inputs:{country:{type:"any",mode:"required"},capital:{type:"any",mode:"required"},population:{type:"any",mode:"required"}},outputs:{value:{type:"any",delayed:!1,optional:!1}},fnCode:"const result = (`Hello from ${inputs.country}! It's capital is ${inputs.capital} (population of ${inputs.population})`); Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"`Hello from ${inputs.country}! It's capital is ${inputs.capital} (population of ${inputs.population}",dataBuilderSource:"YEhlbGxvIGZyb20gJHtpbnB1dHMuY291bnRyeX0hIEl0J3MgY2FwaXRhbCBpcyAke2lucHV0cy5jYXBpdGFsfSAocG9wdWxhdGlvbiBvZiAke2lucHV0cy5wb3B1bGF0aW9ufSlg",templateType:"value",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}}},{pos:{x:-577.892123413086,y:-224.60953734636303},id:"Get User's Country-ins",inputConfig:{},part:{id:"Get User's Country",inputs:{},outputs:{country:{type:"any",delayed:!1,optional:!1}},instances:[{pos:{x:-376.6389208984375,y:-180.36268857002256},id:"HttpGet-907",inputConfig:{url:{mode:"static",value:"https://api.country.is/"}},visibleInputs:["url","__trigger"],visibleOutputs:["r","__error","response"],partId:"HttpGet"},{id:"Inline-value-{iso2: ${input76",part:{id:"Inline-value-{iso2: inputs.d",inputs:{data:{type:"any",mode:"required"}},outputs:{value:{type:"any",delayed:!1,optional:!1}},fnCode:"const result = ({iso2: inputs.data.country}); Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"{iso2: inputs.data.country}",dataBuilderSource:"e2lzbzI6IGlucHV0cy5kYXRhLmNvdW50cnl9",templateType:"value",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}},inputConfig:{},pos:{x:-468.5056274414062,y:-39.30523986816405}}],inputsPosition:{},outputsPosition:{r:{x:-363.42401672132144,y:105.34149194113161},country:{x:-322.5739794922268,y:138.57280736180334}},connections:[{from:{insId:"HttpGet-907",pinId:"response"},to:{insId:"Inline-value-{iso2: ${input76",pinId:"data"}},{from:{insId:"Inline-value-{iso2: ${input76",pinId:"value"},to:{pinId:"country",insId:"__this"}}],completionOutputs:["country"]},style:{size:"large",color:"#f15bb5"}},{pos:{x:-636.9743029785157,y:-85.37110525846481},id:"Get Country Name And Capital-ins",inputConfig:{},visibleOutputs:["name","capital"],part:{id:"Get Country Name And Capital",inputs:{body:{type:"any",mode:"required"}},outputs:{capital:{type:"any",delayed:!1,optional:!1},name:{type:"any",delayed:!1,optional:!1}},instances:[{pos:{x:-455.39787109375004,y:43.691497802734375},id:"HttpPost-624",inputConfig:{url:{mode:"static",value:"https://countriesnow.space/api/v0.1/countries/capital"}},visibleInputs:["url","body"],partId:"HttpPost"},{pos:{x:-559.7825415039063,y:194.45557312011715},id:"Dot-286",inputConfig:{key:{mode:"static",value:"data.name"}},visibleInputs:["obj"],partId:"Dot"},{pos:{x:-400.3785717773437,y:198.4349559259415},id:"Dot-822",inputConfig:{key:{mode:"static",value:"data.capital"}},visibleInputs:["obj"],partId:"Dot"}],inputsPosition:{body:{x:-333.75691140339336,y:-63.66470402308542}},outputsPosition:{value:{x:-514.1541695281439,y:411.8457371232514},i10:{x:-280.88783057750686,y:411.581705357324},capital:{x:-373.87585887717984,y:347.90184574177306},name:{x:-537.398329068569,y:348.1765805072715}},connections:[{from:{insId:"__this",pinId:"body"},to:{insId:"HttpPost-624",pinId:"body"}},{from:{insId:"Dot-286",pinId:"value"},to:{insId:"__this",pinId:"name"}},{from:{insId:"Dot-822",pinId:"value"},to:{insId:"__this",pinId:"capital"}},{from:{insId:"HttpPost-624",pinId:"response"},to:{insId:"Dot-286",pinId:"obj"}},{from:{insId:"HttpPost-624",pinId:"response"},to:{insId:"Dot-822",pinId:"obj"}}],completionOutputs:["name+capital"]},style:{size:"large",color:"#9b5de5"}},{pos:{x:-264.4149328613281,y:175.11608734130857},id:"Format Number-ins",inputConfig:{},part:{id:"Format Number",inputs:{number:{type:"any",mode:"required"}},outputs:{string:{type:"any",delayed:!1,optional:!1}},instances:[{id:"Inline-value-Result is ${in47",part:{id:"Inline-value-new Intl.Number",inputs:{population:{type:"any",mode:"required"}},outputs:{r:{type:"any",delayed:!1,optional:!1}},fnCode:"outputs.r.next((new Intl.NumberFormat().format(inputs.population)))",customViewCode:"new Intl.NumberFormat().format(inputs.population)",dataBuilderSource:"bmV3IEludGwuTnVtYmVyRm9ybWF0KCkuZm9ybWF0KGlucHV0cy5wb3B1bGF0aW9uKQ==",templateType:"value",completionOutputs:["r"]},inputConfig:{},pos:{x:-452.21022216796877,y:176.39826171875}}],inputsPosition:{population:{x:0,y:0},number:{x:0,y:0}},outputsPosition:{r:{x:0,y:400},string:{x:0,y:400}},connections:[{from:{insId:"__this",pinId:"number"},to:{insId:"Inline-value-Result is ${in47",pinId:"population"}},{from:{insId:"Inline-value-Result is ${in47",pinId:"r"},to:{insId:"__this",pinId:"string"}}],completionOutputs:["string"]},style:{size:"regular",color:"#fee440"}},{pos:{x:-318.75787109375,y:32.73055236816407},id:"cl8x5r4qp00074666lb382z1c",inputConfig:{},part:{id:"Get Population By City",inputs:{city:{type:"any",mode:"required"}},outputs:{value:{type:"any",delayed:!1,optional:!1}},instances:[{pos:{x:-204.90311279296873,y:349.60314422607416},id:"HttpPost-775",inputConfig:{url:{mode:"static",value:"https://countriesnow.space/api/v0.1/countries/population/cities"}},visibleInputs:["url","body"],partId:"HttpPost"},{pos:{x:-143.08780761718754,y:233.70198646545413},id:"Inline-value-{city: inputs.c75",inputConfig:{},part:{id:"Inline-value-{city: inputs.c",inputs:{city:{type:"any",mode:"required"}},outputs:{r:{type:"any",delayed:!1,optional:!1}},fnCode:"outputs.r.next(({city: inputs.city}))",customViewCode:"{city: inputs.city}",dataBuilderSource:"e2NpdHk6IGlucHV0cy5jaXR5fQ==",templateType:"value",completionOutputs:["r"]}},{id:"Dot-710",partId:"Dot",inputConfig:{key:{mode:"static",value:"data.populationCounts.0.value"}},pos:{x:-206.3246728515625,y:483.9902026367188},visibleInputs:["obj"]}],inputsPosition:{city:{x:-59.242744173605615,y:192.73141904118035}},outputsPosition:{value:{x:-107.75930491072856,y:617.5218613166921}},connections:[{from:{insId:"Inline-value-{city: inputs.c75",pinId:"r"},to:{insId:"HttpPost-775",pinId:"body"}},{from:{insId:"__this",pinId:"city"},to:{insId:"Inline-value-{city: inputs.c75",pinId:"city"}},{from:{insId:"Dot-710",pinId:"value"},to:{pinId:"value",insId:"__this"}},{from:{insId:"HttpPost-775",pinId:"response"},to:{insId:"Dot-710",pinId:"obj"}}],completionOutputs:["value"]},style:{size:"large",color:"#00bbf9"}}],connections:[{from:{insId:"Get Country Name And Capital-ins",pinId:"name"},to:{insId:"Inline-value-Hello from ${i76",pinId:"country"}},{from:{insId:"Get Country Name And Capital-ins",pinId:"capital"},to:{insId:"Inline-value-Hello from ${i76",pinId:"capital"}},{from:{insId:"Format Number-ins",pinId:"string"},to:{insId:"Inline-value-Hello from ${i76",pinId:"population"}},{from:{insId:"cl8x5r4qp00074666lb382z1c",pinId:"value"},to:{insId:"Format Number-ins",pinId:"number"}},{from:{insId:"Get Country Name And Capital-ins",pinId:"capital"},to:{insId:"cl8x5r4qp00074666lb382z1c",pinId:"city"}},{from:{insId:"Get User's Country-ins",pinId:"country"},to:{insId:"Get Country Name And Capital-ins",pinId:"body"}},{from:{insId:"Inline-value-Hello from ${i76",pinId:"value"},to:{insId:"__this",pinId:"response"}}],id:"ApisCombination",inputs:{},outputs:{response:{type:"any",optional:!1,delayed:!1}},inputsPosition:{city:{x:-187.27285824815934,y:-14.13215209416181}},outputsPosition:{json:{x:-441.98276309426666,y:480.38719404276554},na:{x:-441.98276309426666,y:480.38719404276554},result:{x:-499.82438378976735,y:706.7650396699393},output:{x:-474.64252250807056,y:437.71313745088565},response:{x:-506.3386688159596,y:488.67302443385125}},completionOutputs:["response"]},dependencies:{HttpGet:{id:"HttpGet",inputs:{url:{mode:"required",type:"any"},headers:{mode:"required-if-connected",type:"any"}},outputs:{response:{type:"any"}},completionOutputs:["response"],fn:n(71611).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/http/HttpGet.flyde.js",part:{id:"HttpGet",inputs:{url:{mode:"required",type:"any"},headers:{mode:"required-if-connected",type:"any"}},outputs:{response:{type:"any"}},completionOutputs:["response"],fn:n(71611).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/http/HttpGet.flyde.js"}},HttpPost:{id:"HttpPost",inputs:{url:{mode:"required",type:"any"},body:{mode:"required",type:"any"},headers:{mode:"required-if-connected",type:"any"},bodyType:{mode:"required-if-connected",type:"any"}},completionOutputs:["response"],outputs:{response:{type:"any"}},fn:n(80902).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/http/HttpPost.flyde.js",part:{id:"HttpPost",inputs:{url:{mode:"required",type:"any"},body:{mode:"required",type:"any"},headers:{mode:"required-if-connected",type:"any"},bodyType:{mode:"required-if-connected",type:"any"}},completionOutputs:["response"],outputs:{response:{type:"any"}},fn:n(80902).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/http/HttpPost.flyde.js"}},Dot:{id:"Dot",defaultStyle:{size:"small"},inputs:{obj:{mode:"required",type:"any"},key:{mode:"required",type:"any"}},outputs:{value:{type:"any"}},customViewCode:"<% if (inputs.key) { %> .<%- inputs.key %> <% } else { %> Dot <% } %>",completionOutputs:["value"],fn:n(97534).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/Dot.flyde.js",part:{id:"Dot",defaultStyle:{size:"small"},inputs:{obj:{mode:"required",type:"any"},key:{mode:"required",type:"any"}},outputs:{value:{type:"any"}},customViewCode:"<% if (inputs.key) { %> .<%- inputs.key %> <% } else { %> Dot <% } %>",completionOutputs:["value"],fn:n(97534).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/Dot.flyde.js"}}}},flow:{imports:{"@flyde/stdlib":["HttpResponse","HttpGet","Pick","HttpPost","Dot","HtmlBtn","Accumulate2"]},part:{instances:[{pos:{x:-656.1905053710938,y:326.03946411132813},id:"Inline-value-Hello from ${i76",inputConfig:{},part:{id:"Inline-value-Hello from ${i",inputs:{country:{type:"any",mode:"required"},capital:{type:"any",mode:"required"},population:{type:"any",mode:"required"}},outputs:{value:{type:"any",delayed:!1,optional:!1}},fnCode:"const result = (`Hello from ${inputs.country}! It's capital is ${inputs.capital} (population of ${inputs.population})`); Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"`Hello from ${inputs.country}! It's capital is ${inputs.capital} (population of ${inputs.population}",dataBuilderSource:"YEhlbGxvIGZyb20gJHtpbnB1dHMuY291bnRyeX0hIEl0J3MgY2FwaXRhbCBpcyAke2lucHV0cy5jYXBpdGFsfSAocG9wdWxhdGlvbiBvZiAke2lucHV0cy5wb3B1bGF0aW9ufSlg",templateType:"value",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}}},{pos:{x:-577.892123413086,y:-224.60953734636303},id:"Get User's Country-ins",inputConfig:{},part:{id:"Get User's Country",inputs:{},outputs:{country:{type:"any",delayed:!1,optional:!1}},instances:[{pos:{x:-376.6389208984375,y:-180.36268857002256},id:"HttpGet-907",inputConfig:{url:{mode:"static",value:"https://api.country.is/"}},visibleInputs:["url","__trigger"],visibleOutputs:["r","__error","response"],partId:"HttpGet"},{id:"Inline-value-{iso2: ${input76",part:{id:"Inline-value-{iso2: inputs.d",inputs:{data:{type:"any",mode:"required"}},outputs:{value:{type:"any",delayed:!1,optional:!1}},fnCode:"const result = ({iso2: inputs.data.country}); Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"{iso2: inputs.data.country}",dataBuilderSource:"e2lzbzI6IGlucHV0cy5kYXRhLmNvdW50cnl9",templateType:"value",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}},inputConfig:{},pos:{x:-468.5056274414062,y:-39.30523986816405}}],inputsPosition:{},outputsPosition:{r:{x:-363.42401672132144,y:105.34149194113161},country:{x:-322.5739794922268,y:138.57280736180334}},connections:[{from:{insId:"HttpGet-907",pinId:"response"},to:{insId:"Inline-value-{iso2: ${input76",pinId:"data"}},{from:{insId:"Inline-value-{iso2: ${input76",pinId:"value"},to:{pinId:"country",insId:"__this"}}],completionOutputs:["country"]},style:{size:"large",color:"#f15bb5"}},{pos:{x:-636.9743029785157,y:-85.37110525846481},id:"Get Country Name And Capital-ins",inputConfig:{},visibleOutputs:["name","capital"],part:{id:"Get Country Name And Capital",inputs:{body:{type:"any",mode:"required"}},outputs:{capital:{type:"any",delayed:!1,optional:!1},name:{type:"any",delayed:!1,optional:!1}},instances:[{pos:{x:-455.39787109375004,y:43.691497802734375},id:"HttpPost-624",inputConfig:{url:{mode:"static",value:"https://countriesnow.space/api/v0.1/countries/capital"}},visibleInputs:["url","body"],partId:"HttpPost"},{pos:{x:-559.7825415039063,y:194.45557312011715},id:"Dot-286",inputConfig:{key:{mode:"static",value:"data.name"}},visibleInputs:["obj"],partId:"Dot"},{pos:{x:-400.3785717773437,y:198.4349559259415},id:"Dot-822",inputConfig:{key:{mode:"static",value:"data.capital"}},visibleInputs:["obj"],partId:"Dot"}],inputsPosition:{body:{x:-333.75691140339336,y:-63.66470402308542}},outputsPosition:{value:{x:-514.1541695281439,y:411.8457371232514},i10:{x:-280.88783057750686,y:411.581705357324},capital:{x:-373.87585887717984,y:347.90184574177306},name:{x:-537.398329068569,y:348.1765805072715}},connections:[{from:{insId:"__this",pinId:"body"},to:{insId:"HttpPost-624",pinId:"body"}},{from:{insId:"Dot-286",pinId:"value"},to:{insId:"__this",pinId:"name"}},{from:{insId:"Dot-822",pinId:"value"},to:{insId:"__this",pinId:"capital"}},{from:{insId:"HttpPost-624",pinId:"response"},to:{insId:"Dot-286",pinId:"obj"}},{from:{insId:"HttpPost-624",pinId:"response"},to:{insId:"Dot-822",pinId:"obj"}}],completionOutputs:["name+capital"]},style:{size:"large",color:"#9b5de5"}},{pos:{x:-264.4149328613281,y:175.11608734130857},id:"Format Number-ins",inputConfig:{},part:{id:"Format Number",inputs:{number:{type:"any",mode:"required"}},outputs:{string:{type:"any",delayed:!1,optional:!1}},instances:[{id:"Inline-value-Result is ${in47",part:{id:"Inline-value-new Intl.Number",inputs:{population:{type:"any",mode:"required"}},outputs:{r:{type:"any",delayed:!1,optional:!1}},fnCode:"outputs.r.next((new Intl.NumberFormat().format(inputs.population)))",customViewCode:"new Intl.NumberFormat().format(inputs.population)",dataBuilderSource:"bmV3IEludGwuTnVtYmVyRm9ybWF0KCkuZm9ybWF0KGlucHV0cy5wb3B1bGF0aW9uKQ==",templateType:"value",completionOutputs:["r"]},inputConfig:{},pos:{x:-452.21022216796877,y:176.39826171875}}],inputsPosition:{population:{x:0,y:0},number:{x:0,y:0}},outputsPosition:{r:{x:0,y:400},string:{x:0,y:400}},connections:[{from:{insId:"__this",pinId:"number"},to:{insId:"Inline-value-Result is ${in47",pinId:"population"}},{from:{insId:"Inline-value-Result is ${in47",pinId:"r"},to:{insId:"__this",pinId:"string"}}],completionOutputs:["string"]},style:{size:"regular",color:"#fee440"}},{pos:{x:-318.75787109375,y:32.73055236816407},id:"cl8x5r4qp00074666lb382z1c",inputConfig:{},part:{id:"Get Population By City",inputs:{city:{type:"any",mode:"required"}},outputs:{value:{type:"any",delayed:!1,optional:!1}},instances:[{pos:{x:-204.90311279296873,y:349.60314422607416},id:"HttpPost-775",inputConfig:{url:{mode:"static",value:"https://countriesnow.space/api/v0.1/countries/population/cities"}},visibleInputs:["url","body"],partId:"HttpPost"},{pos:{x:-143.08780761718754,y:233.70198646545413},id:"Inline-value-{city: inputs.c75",inputConfig:{},part:{id:"Inline-value-{city: inputs.c",inputs:{city:{type:"any",mode:"required"}},outputs:{r:{type:"any",delayed:!1,optional:!1}},fnCode:"outputs.r.next(({city: inputs.city}))",customViewCode:"{city: inputs.city}",dataBuilderSource:"e2NpdHk6IGlucHV0cy5jaXR5fQ==",templateType:"value",completionOutputs:["r"]}},{id:"Dot-710",partId:"Dot",inputConfig:{key:{mode:"static",value:"data.populationCounts.0.value"}},pos:{x:-206.3246728515625,y:483.9902026367188},visibleInputs:["obj"]}],inputsPosition:{city:{x:-59.242744173605615,y:192.73141904118035}},outputsPosition:{value:{x:-107.75930491072856,y:617.5218613166921}},connections:[{from:{insId:"Inline-value-{city: inputs.c75",pinId:"r"},to:{insId:"HttpPost-775",pinId:"body"}},{from:{insId:"__this",pinId:"city"},to:{insId:"Inline-value-{city: inputs.c75",pinId:"city"}},{from:{insId:"Dot-710",pinId:"value"},to:{pinId:"value",insId:"__this"}},{from:{insId:"HttpPost-775",pinId:"response"},to:{insId:"Dot-710",pinId:"obj"}}],completionOutputs:["value"]},style:{size:"large",color:"#00bbf9"}}],connections:[{from:{insId:"Get Country Name And Capital-ins",pinId:"name"},to:{insId:"Inline-value-Hello from ${i76",pinId:"country"}},{from:{insId:"Get Country Name And Capital-ins",pinId:"capital"},to:{insId:"Inline-value-Hello from ${i76",pinId:"capital"}},{from:{insId:"Format Number-ins",pinId:"string"},to:{insId:"Inline-value-Hello from ${i76",pinId:"population"}},{from:{insId:"cl8x5r4qp00074666lb382z1c",pinId:"value"},to:{insId:"Format Number-ins",pinId:"number"}},{from:{insId:"Get Country Name And Capital-ins",pinId:"capital"},to:{insId:"cl8x5r4qp00074666lb382z1c",pinId:"city"}},{from:{insId:"Get User's Country-ins",pinId:"country"},to:{insId:"Get Country Name And Capital-ins",pinId:"body"}},{from:{insId:"Inline-value-Hello from ${i76",pinId:"value"},to:{insId:"__this",pinId:"response"}}],id:"ApisCombination",inputs:{},outputs:{response:{type:"any",optional:!1,delayed:!1}},inputsPosition:{city:{x:-187.27285824815934,y:-14.13215209416181}},outputsPosition:{json:{x:-441.98276309426666,y:480.38719404276554},na:{x:-441.98276309426666,y:480.38719404276554},result:{x:-499.82438378976735,y:706.7650396699393},output:{x:-474.64252250807056,y:437.71313745088565},response:{x:-506.3386688159596,y:488.67302443385125}},completionOutputs:["response"]}}},u=n(42716),s={title:"HTTP Requests",description:"Flyde works great for heavy asynchronous & concurrent tasks, like combining several REST APIs together. This example shows exactly that, by combining 3 different REST APIs, the population of the capital of the country your IP is assigned with is retrieved",key:"api",extraInfo:r.createElement("strong",null,r.createElement("h3",null,"Try double-clicking each API part to see it's underlying implementation! In Flyde, nothing is hidden, only abstracted"))};function c(){var t=(0,r.useRef)((0,o.dynamicOutput)()),e=(0,r.useRef)({__trigger:(0,o.dynamicPartInput)()}),n=(0,r.useState)({flow:a.flow,resolvedFlow:a.resolvedFlow,inputs:e.current,output:t.current}),c=n[0],l=(n[1],r.createElement("button",{className:"button button--success",onClick:function(){return e.current.__trigger.subject.next("run")}},"Run!"));return r.createElement(i.I,{meta:s,flowProps:c,defaultDelay:100,prefixComponent:l},r.createElement(u.V,{output:t.current}))}},60512:function(t,e){"use strict";e.Z={heroBanner:"heroBanner_qdFl",buttons:"buttons_AeoN","gh-stars-wrapper":"gh-stars-wrapper_LiAa","project-editor":"project-editor_XBpx",_hj_feedback_container:"_hj_feedback_container_Af03"}},95126:function(t,e,n){var r={"./af":1009,"./af.js":1009,"./ar":88769,"./ar-dz":23739,"./ar-dz.js":23739,"./ar-kw":93745,"./ar-kw.js":93745,"./ar-ly":99576,"./ar-ly.js":99576,"./ar-ma":67408,"./ar-ma.js":67408,"./ar-sa":48781,"./ar-sa.js":48781,"./ar-tn":87856,"./ar-tn.js":87856,"./ar.js":88769,"./az":2030,"./az.js":2030,"./be":56476,"./be.js":56476,"./bg":25304,"./bg.js":25304,"./bm":48125,"./bm.js":48125,"./bn":34,"./bn-bd":29835,"./bn-bd.js":29835,"./bn.js":34,"./bo":64082,"./bo.js":64082,"./br":8317,"./br.js":8317,"./bs":93107,"./bs.js":93107,"./ca":68272,"./ca.js":68272,"./cs":98567,"./cs.js":98567,"./cv":61583,"./cv.js":61583,"./cy":10076,"./cy.js":10076,"./da":31760,"./da.js":31760,"./de":8973,"./de-at":63214,"./de-at.js":63214,"./de-ch":74728,"./de-ch.js":74728,"./de.js":8973,"./dv":54053,"./dv.js":54053,"./el":7499,"./el.js":7499,"./en-au":67876,"./en-au.js":67876,"./en-ca":47010,"./en-ca.js":47010,"./en-gb":34239,"./en-gb.js":34239,"./en-ie":99830,"./en-ie.js":99830,"./en-il":28438,"./en-il.js":28438,"./en-in":25322,"./en-in.js":25322,"./en-nz":43264,"./en-nz.js":43264,"./en-sg":55449,"./en-sg.js":55449,"./eo":39486,"./eo.js":39486,"./es":32430,"./es-do":16310,"./es-do.js":16310,"./es-mx":27038,"./es-mx.js":27038,"./es-us":73099,"./es-us.js":73099,"./es.js":32430,"./et":34975,"./et.js":34975,"./eu":87063,"./eu.js":87063,"./fa":68073,"./fa.js":68073,"./fi":50957,"./fi.js":50957,"./fil":8764,"./fil.js":8764,"./fo":81775,"./fo.js":81775,"./fr":74179,"./fr-ca":14306,"./fr-ca.js":14306,"./fr-ch":73791,"./fr-ch.js":73791,"./fr.js":74179,"./fy":47014,"./fy.js":47014,"./ga":46911,"./ga.js":46911,"./gd":62958,"./gd.js":62958,"./gl":87344,"./gl.js":87344,"./gom-deva":33161,"./gom-deva.js":33161,"./gom-latn":35798,"./gom-latn.js":35798,"./gu":68485,"./gu.js":68485,"./he":27917,"./he.js":27917,"./hi":52159,"./hi.js":52159,"./hr":95842,"./hr.js":95842,"./hu":30005,"./hu.js":30005,"./hy-am":51312,"./hy-am.js":51312,"./id":60781,"./id.js":60781,"./is":64101,"./is.js":64101,"./it":43467,"./it-ch":4759,"./it-ch.js":4759,"./it.js":43467,"./ja":44164,"./ja.js":44164,"./jv":70079,"./jv.js":70079,"./ka":57036,"./ka.js":57036,"./kk":92022,"./kk.js":92022,"./km":63418,"./km.js":63418,"./kn":43655,"./kn.js":43655,"./ko":30986,"./ko.js":30986,"./ku":91902,"./ku.js":91902,"./ky":4604,"./ky.js":4604,"./lb":99026,"./lb.js":99026,"./lo":20537,"./lo.js":20537,"./lt":22288,"./lt.js":22288,"./lv":1495,"./lv.js":1495,"./me":60690,"./me.js":60690,"./mi":2571,"./mi.js":2571,"./mk":93959,"./mk.js":93959,"./ml":97225,"./ml.js":97225,"./mn":88,"./mn.js":88,"./mr":46622,"./mr.js":46622,"./ms":11070,"./ms-my":48899,"./ms-my.js":48899,"./ms.js":11070,"./mt":63931,"./mt.js":63931,"./my":95393,"./my.js":95393,"./nb":4274,"./nb.js":4274,"./ne":8914,"./ne.js":8914,"./nl":33114,"./nl-be":68479,"./nl-be.js":68479,"./nl.js":33114,"./nn":4513,"./nn.js":4513,"./oc-lnc":46549,"./oc-lnc.js":46549,"./pa-in":28264,"./pa-in.js":28264,"./pl":32848,"./pl.js":32848,"./pt":90899,"./pt-br":55077,"./pt-br.js":55077,"./pt.js":90899,"./ro":92512,"./ro.js":92512,"./ru":21753,"./ru.js":21753,"./sd":16840,"./sd.js":16840,"./se":78362,"./se.js":78362,"./si":50464,"./si.js":50464,"./sk":66324,"./sk.js":66324,"./sl":41963,"./sl.js":41963,"./sq":53039,"./sq.js":53039,"./sr":93454,"./sr-cyrl":10466,"./sr-cyrl.js":10466,"./sr.js":93454,"./ss":95158,"./ss.js":95158,"./sv":28859,"./sv.js":28859,"./sw":57594,"./sw.js":57594,"./ta":26915,"./ta.js":26915,"./te":15677,"./te.js":15677,"./tet":92154,"./tet.js":92154,"./tg":74098,"./tg.js":74098,"./th":89071,"./th.js":89071,"./tk":49381,"./tk.js":49381,"./tl-ph":1869,"./tl-ph.js":1869,"./tlh":92346,"./tlh.js":92346,"./tr":71483,"./tr.js":71483,"./tzl":30266,"./tzl.js":30266,"./tzm":33138,"./tzm-latn":32960,"./tzm-latn.js":32960,"./tzm.js":33138,"./ug-cn":29456,"./ug-cn.js":29456,"./uk":50805,"./uk.js":50805,"./ur":61127,"./ur.js":61127,"./uz":29628,"./uz-latn":80840,"./uz-latn.js":80840,"./uz.js":29628,"./vi":56962,"./vi.js":56962,"./x-pseudo":49257,"./x-pseudo.js":49257,"./yo":62423,"./yo.js":62423,"./zh-cn":61002,"./zh-cn.js":61002,"./zh-hk":6046,"./zh-hk.js":6046,"./zh-mo":36903,"./zh-mo.js":36903,"./zh-tw":24710,"./zh-tw.js":24710};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=95126},91764:function(){}}]);