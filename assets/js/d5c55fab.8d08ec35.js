(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1988],{65236:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cappedArrayDebounce=void 0;t.cappedArrayDebounce=function(e,t,n,o){void 0===o&&(o=500);let i=[],s=null,r=null;return{addItem:a=>{clearTimeout(s),i.push(a),r||(r=setTimeout((()=>{e(i),clearTimeout(s),r=null}),o)),i.length>=n?(e(i),clearTimeout(r),r=null,i=[]):s=setTimeout((()=>{e(i),clearTimeout(r),r=null,i=[]}),t)},flush:()=>{i.length&&(e(i),i=[],clearTimeout(r))},pendingItems:()=>i.length}}},73460:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.dataShaper=t.DataShapeType=void 0,function(e){e[e.STRING=0]="STRING",e[e.NUMBER=1]="NUMBER",e[e.BOOLEAN=2]="BOOLEAN",e[e.ARRAY=3]="ARRAY",e[e.OBJECT=4]="OBJECT",e[e.NULL=5]="NULL",e[e.UNSUPPORTED=6]="UNSUPPORTED"}(n=t.DataShapeType||(t.DataShapeType={}));const o={string:n.STRING,number:n.NUMBER,boolean:n.BOOLEAN,object:n.OBJECT,array:n.ARRAY,null:n.NULL,symbol:n.UNSUPPORTED,undefined:n.UNSUPPORTED,function:n.UNSUPPORTED,bigint:n.UNSUPPORTED};t.dataShaper=function(e,n,i){void 0===n&&(n=5),void 0===i&&(i=5);const s=null===(r=e)?"null":typeof r;var r,a;if("object"===s){if(Array.isArray(e))return n>1?e.filter(((e,t)=>t<i)).map((e=>(0,t.dataShaper)(e,n-1,i))):o.array;if(n>1){const o={};for(const s in e)o[s]=(0,t.dataShaper)(e[s],n-1,i);return a=o,Object.keys(a).sort().reduce(((e,t)=>(e[t]=a[t],e)),{})}return o.object}return o[s]}},40383:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.debugLogger=void 0;const i=(0,o(n(55069)).default)("flyde");t.debugLogger=e=>i.extend(e)},92014:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fullInsIdPath=void 0,t.fullInsIdPath=function(e,t){if(!e)throw new Error("insId is not defined");return t?t+"."+e:e}},84754:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.hashFlow=t.hashPart=void 0;const i=o(n(68805)),s=n(57438),r=e=>(0,i.default)(e);t.hashPart=function(e,t){var n;void 0===t&&(t=!0);const{id:o,completionOutputs:i,reactiveInputs:a,inputs:u,outputs:l}=e,c={id:o,completionOutputs:i,reactiveInputs:a,inputs:u,outputs:l};if((0,s.isVisualPart)(e)){const{instances:n,connections:o,inputsPosition:i,outputsPosition:s}=e,a=n.map((e=>{const{pos:t,...n}=e;return n})),u=t?{}:{inputsPosition:i,outputsPosition:s},l=t?a:n;l.sort(((e,t)=>e.id.localeCompare(t.id)));const d=[...o];d.sort(((e,t)=>{const n=e.from.insId+"."+e.from.pinId,o=t.from.insId+"."+t.from.pinId;return n.localeCompare(o)}));const p=JSON.stringify({instancesToUse:l,conns:d,...c,maybeIoPos:u});return r(p)}if((0,s.isInlineValuePart)(e)){const{customViewCode:t}=e,o=null!==(n=e.fnCode)&&void 0!==n?n:e.runFnRawCode,i=JSON.stringify({fnCode:o,customViewCode:t,...c});return r(i)}throw new Error("Hashing code parts unsupported")};t.hashFlow=e=>{const{part:n,imports:o}=e,i=(0,t.hashPart)(n,!1),s=Object.entries(null!=o?o:{}).sort(((e,t)=>{let[n]=e,[o]=t;return n.localeCompare(o)})).map((e=>{let[t,n]=e;return[t,n.sort()]})).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o}}),{}),a=JSON.stringify(s);return r(i+a)}},85636:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.DepGraph=void 0,i(n(60711),t),i(n(28235),t),i(n(40383),t),i(n(65236),t),i(n(28235),t),i(n(84754),t),i(n(2652),t),i(n(73460),t),i(n(92014),t),t.DepGraph=n(60359).DepGraph},60711:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testDataCreator=void 0;t.testDataCreator=e=>function(t){void 0===t&&(t={});return{..."function"==typeof e?e():e,...t}}},28235:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simplePluralize=t.eventually=t.delay=t.noop=t.removeDupes=t.ensure=t.isOptionalType=t.callFnOrFnPromise=t.isPromise=t.isDefined=t.containsAll=t.shuffle=t.randomInts=t.repeat=t.pickRandom=t.randomPos=t.randomInt=t.pickSecond=t.pickFirst=t.fromEntries=t.entries=t.okeys=t.values=t.keys=t.filterOMap=t.mapOMap=t.middlePos=t.calcCenter=t.intersectRect=void 0;t.intersectRect=(e,t)=>{const n=e.x+e.w,o=t.x+t.w;return!(t.x>n||o<e.x||t.y>e.y+e.h||t.y+t.h<e.y)};t.calcCenter=e=>{let{w:t,h:n,x:o,y:i}=e;return{x:o+t/2,y:i+n/2}};t.middlePos=(e,t)=>({x:(e.x+t.x)/2,y:(e.y+t.y)/2});t.mapOMap=(e,n)=>(0,t.entries)(e).map((e=>{let[t,o]=e;return[t,n(t,o)]})).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o}}),{});t.filterOMap=(e,n)=>(0,t.entries)(e).filter((e=>{let[t,o]=e;return n(t,o)})).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o}}),{});t.keys=e=>Object.keys(e);t.values=e=>Object.values(e),t.okeys=t.keys;t.entries=e=>(0,t.okeys)(e).map((t=>[t,e[t]]));t.fromEntries=e=>e.reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o}}),{});t.pickFirst=e=>e[0];t.pickSecond=e=>e[1];t.randomInt=function(e,t){void 0===t&&(t=0);const n=Math.random();return t+Math.floor((e-t)*n)};t.randomPos=function(e,n){void 0===e&&(e=1e3),void 0===n&&(n=0);return{x:(0,t.randomInt)(e,n),y:(0,t.randomInt)(e,n)}};t.pickRandom=e=>e[(0,t.randomInt)(e.length)];t.repeat=(e,t)=>"x".repeat(e).split("").map(((e,n)=>t(n)));t.randomInts=function(e,n,o){return void 0===n&&(n=100),void 0===o&&(o=0),(0,t.repeat)(e,(()=>(0,t.randomInt)(n,o)))};t.shuffle=e=>{const t=[...e];for(let n=t.length-1;n>=0;n--){const e=Math.floor(Math.random()*(n+1));[t[n],t[e]]=[t[e],t[n]]}return t};t.containsAll=(e,t)=>t.every((t=>e.includes(t)));t.isDefined=e=>void 0!==e;t.isPromise=e=>e&&"function"==typeof e.then;t.callFnOrFnPromise=(e,n)=>{if(!(0,t.isDefined)(e))return;const o=e=>{try{e()}catch(t){console.error(n,t)}};"function"==typeof e?o(e):Promise.resolve(e).then((e=>{"function"==typeof e&&o(e)}))};t.isOptionalType=e=>/\?$/.test(e);t.ensure=(e,t)=>{if(void 0===e)throw new Error(t||"Undefined value passed");return e};t.removeDupes=e=>Array.from(new Set(e));t.noop=()=>{};t.delay=e=>new Promise((t=>setTimeout(t,e)));t.eventually=async function(e,n,o,i){if(void 0===n&&(n=1e3),void 0===o&&(o=100),void 0===i&&(i=new Set),n<0){const e=Array.from(i).reduce(((e,t,n)=>e+"\n\t\t"+(n+1)+". "+t),"");throw new Error("[Eventually timeout exceeded after: timeout with error]: "+e)}try{await e()}catch(s){const r=Date.now();await(0,t.delay)(o);const a=Date.now()-r;return i.add(null==s?void 0:s.message),(0,t.eventually)(e,n-a,o,i)}},t.simplePluralize=function(e,t){return e+" "+t+(1!==e?"s":"")}},2652:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compileObjectTemplate=t.compileStringTemplate=void 0;t.compileStringTemplate=(e,t)=>{let n=decodeURIComponent(e);return Object.keys(t).forEach((e=>{const o=t[e],i=new RegExp("\\$\\{"+e+"\\}","g");n=n.replace(i,o)})),n};t.compileObjectTemplate=(e,t)=>{let n=decodeURIComponent(e);return Object.keys(t).forEach((e=>{const o=t[e],i=JSON.stringify(o),s=new RegExp('"\\$\\$\\{'+e+'\\}"',"g"),r=new RegExp("\\$\\{"+e+"\\}","g"),a="string"==typeof o?o.replace(/"/g,((e,t,n)=>"\\"!==n[t-1]?'\\"':n[t])):o;n=n.replace(s,i).replace(r,a).replace(/\n/g,"\\n")})),JSON.parse(n)}},65601:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.connection=t.connectionData=t.connectionDataEquals=t.connectionNodeEquals=t.connectionNode=t.externalConnectionNode=t.isInternalConnection=t.isExternalConnection=t.isInternalConnectionNode=t.isExternalConnectionNode=t.getPartOutputs=t.getOutputName=t.getInputName=t.getPartInputs=t.TRIGGER_PIN_ID=t.ERROR_PIN_ID=t.THIS_INS_ID=void 0;const o=n(57438);t.THIS_INS_ID="__this",t.ERROR_PIN_ID="__error",t.TRIGGER_PIN_ID="__trigger";t.getPartInputs=e=>({...e.inputs,[t.TRIGGER_PIN_ID]:(0,o.partInput)()});t.getInputName=e=>e===t.TRIGGER_PIN_ID?"Trigger Part":e;t.getOutputName=e=>e===t.ERROR_PIN_ID?"Error":e;t.getPartOutputs=e=>({...e.outputs,[t.ERROR_PIN_ID]:(0,o.partOutput)()});t.isExternalConnectionNode=e=>e&&e.insId===t.THIS_INS_ID;t.isInternalConnectionNode=e=>e.insId!==t.THIS_INS_ID;t.isExternalConnection=e=>{let{from:n,to:o}=e;return(0,t.isExternalConnectionNode)(n)||(0,t.isExternalConnectionNode)(o)};t.isInternalConnection=e=>!(0,t.isExternalConnection)(e);t.externalConnectionNode=e=>({insId:t.THIS_INS_ID,pinId:e});t.connectionNode=(e,t)=>({insId:e,pinId:t});t.connectionNodeEquals=(e,t)=>e.insId===t.insId&&e.pinId===t.pinId;t.connectionDataEquals=(e,n)=>!(!e||!n)&&((0,t.connectionNodeEquals)(e.from,n.from)&&(0,t.connectionNodeEquals)(e.to,n.to)),t.connectionData=function(e,n,o){const i="string"==typeof e?e.split("."):e,s="string"==typeof n?n.split("."):n;if(i.length>2||s.length>2)throw new Error("invalid source or target to connection data - "+e+" / "+n);return{from:2===i.length?(0,t.connectionNode)(i[0],i[1]):(0,t.externalConnectionNode)(i[0]),to:2===s.length?(0,t.connectionNode)(s[0],s[1]):(0,t.externalConnectionNode)(s[0]),delayed:o}};t.connection=function(e,t,n){return void 0===n&&(n=!1),{from:e,to:t,delayed:n}}},53850:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.connect=void 0;const s=n(57438),r=n(43078),a=n(85636),u=n(65601);i(n(65601),t);t.connect=function(e,t,n,o,i,l,c,d){void 0===n&&(n={}),void 0===i&&(i={}),void 0===l&&(l=a.noop),void 0===c&&(c={}),void 0===d&&(d={});const{id:p,connections:f,instances:m}=e,g=p||"connected-part"+(0,a.randomInt)(999);return{inputs:e.inputs,outputs:e.outputs,id:g,completionOutputs:e.completionOutputs,reactiveInputs:e.reactiveInputs,run:(p,h)=>{let v=[];const I=new a.DepGraph({}),y=new Map,b=new Map,C=new Map,P=new Map,_=new Map,x=new Map;let j;const w=new Set;m.forEach((e=>{const n=(0,s.getPart)(e,t),o=e.id;y.set(e,o),b.set(o,e),I.addNode(o);const i=Object.keys(n.inputs),r=Object.keys(n.outputs),a={},l={};i.forEach((t=>{const n=(e.inputConfig||{})[t]||(0,s.queueInputPinConfig)();(0,s.isStaticInputPinConfig)(n)?a[t]=(0,s.staticPartInput)(n.value):a[t]=(0,s.dynamicPartInput)({config:n})})),a[u.TRIGGER_PIN_ID]=(0,s.dynamicPartInput)({config:(0,s.queueInputPinConfig)()});if(f.some((t=>(0,u.isInternalConnectionNode)(t.to)&&t.to.insId===e.id&&t.to.pinId===u.TRIGGER_PIN_ID))&&e.inputConfig&&e.inputConfig[u.TRIGGER_PIN_ID])throw"Trigger connection can not be configured";r.forEach((e=>{const t=(0,s.dynamicOutput)();l[e]=t}));f.some((t=>(0,u.isInternalConnectionNode)(t.from)&&t.from.insId===e.id&&t.from.pinId===u.ERROR_PIN_ID))&&(l[u.ERROR_PIN_ID]=(0,s.dynamicOutput)()),C.set(o,a),P.set(o,l)}));const O=new Set;return f.forEach((n=>{const{from:o,to:i}=n,{insId:r,pinId:a}=o,{insId:l,pinId:c}=i,d=P.get(r),p=C.get(l);if((0,u.isInternalConnectionNode)(i)&&O.add(i.insId+"."+i.pinId),(0,u.isExternalConnection)(n)){if((0,u.isExternalConnectionNode)(o)){const e=null==p?void 0:p[i.pinId];if(!e)throw new Error("Input "+i.pinId+" of instance "+l+" not found");const t=_.get(o.pinId)||[];t.push(e),_.set(o.pinId,t)}else{let e=null==d?void 0:d[o.pinId];if(!e)throw new Error("Output "+o.pinId+" of instance "+r+" not found");const t=x.get(i.pinId)||[];t.push(e),x.set(i.pinId,t)}return}if(!d)throw new Error("No outputs found for instance ["+r+"]");if(!p)throw b.has(l)?new Error("No inputs found for instance ["+l+"]"):new Error("Instance with id ["+l+"] does not exist!");const f=d[a];if(!f)throw console.log(a),new Error("Output source - ["+a+"] not found in part ["+g+"]");const m=p[c],h=b.get(r);if(!h&&r!==u.THIS_INS_ID)throw new Error("Instance ["+r+"] does not exist! failed to connect ["+o+"] -> ["+i+"]");const y=(h?(0,s.getPart)(h,t):e).outputs[a];if(y&&y.delayed||n.delayed||r!==u.THIS_INS_ID&&l!==u.THIS_INS_ID&&I.addDependency(r,l),!m)throw new Error("Target arg - ["+i+"] not found in part ["+g+"]");const j=f.subscribe((async e=>{if(!(0,s.isDynamicInput)(m))throw console.info(m),new Error("Impossible state listening to non dynamic input - "+l+"."+c);m.subject.next(e)}));v.push((()=>j.unsubscribe()))})),(0,a.okeys)(h).forEach((e=>{(x.get(e)||[]).forEach((t=>{const n=t.subscribe((async t=>{if(!h[e])throw new Error("Impossible state - output "+e+" does not exist");h[e].next(t)}));v.push((()=>n.unsubscribe()))}))})),I.overallOrder().map((e=>b.get(e))).forEach((e=>{const a=C.get(e.id),u=P.get(e.id),p=(0,s.getPart)(e,t);if(!a)throw new Error("Unexpected error - args not found when running "+e);if(!u)throw new Error("Unexpected error - outputs not found when running "+e);for(const t in a){const n=e.inputConfig[t];O.has(e.id+"."+t)||(0,s.isStaticInputPinConfig)(n)||delete a[t]}const f=(0,r.execute)({part:p,inputs:a,outputs:u,resolvedDeps:t,_debugger:n,insId:e.id,extraContext:d,mainState:i,ancestorsInsIds:o,onBubbleError:l,onCompleted:()=>{return t=e.id,w.delete(t),void(0===w.size&&j&&j());var t},onStarted:()=>{return t=e.id,void w.add(t);var t},env:c});v.push(f)})),Object.keys(p).forEach((async e=>{(_.get(e)||[]).forEach((t=>{const n=p[e];if(!(0,s.isDynamicInput)(t))throw new Error("Unsure what to do with key "+e+", input: "+t+" of ins "+o);(0,a.isDefined)(n)&&t.subject.next(n)}))})),void 0===e.completionOutputs&&w.size>0?new Promise((e=>{j=e})):()=>v.forEach((e=>{try{e()}catch(t){console.error("error unsubscribing",t)}}))}}}},44403:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MINOR_DEBUGGER_EVENT_TYPES=t.MAJOR_DEBUGGER_EVENT_TYPES=t.DebuggerEventType=void 0,function(e){e.INPUT_CHANGE="i",e.OUTPUT_CHANGE="o",e.PROCESSING_CHANGE="pc",e.ERROR="err",e.INPUTS_STATE_CHANGE="isc"}(n=t.DebuggerEventType||(t.DebuggerEventType={})),t.MAJOR_DEBUGGER_EVENT_TYPES=[n.INPUT_CHANGE,n.OUTPUT_CHANGE,n.ERROR],t.MINOR_DEBUGGER_EVENT_TYPES=[n.PROCESSING_CHANGE,n.INPUTS_STATE_CHANGE]},24312:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatEvent=void 0;const o=n(44403);t.formatEvent=function(e){var t,n,i;const s=[e.insId,...null!==(n=null===(t=e.ancestorsInsIds)||void 0===t?void 0:t.split("."))&&void 0!==n?n:[]];(null===(i=e.ancestorsInsIds)||void 0===i?void 0:i.length)>0&&e.ancestorsInsIds;const r="Part <"+e.partId+"> ",a="("+s.join(" -> ")+")";return r+" - "+function(e){switch(e.type){case o.DebuggerEventType.PROCESSING_CHANGE:return e.val?"started processing":"stopped processing";case o.DebuggerEventType.INPUT_CHANGE:return"Input pin <"+e.pinId+"> changed to "+e.val;case o.DebuggerEventType.OUTPUT_CHANGE:return"Output pin <"+e.pinId+"> changed to "+e.val;case o.DebuggerEventType.INPUTS_STATE_CHANGE:return"Inputs queue size changed to "+Object.entries(e.val).map((e=>{let[t,n]=e;return t+": "+n})).join(", ");case o.DebuggerEventType.ERROR:return"Error: "+e.val}}(e)+" "+a}},14123:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(44403),t),i(n(24312),t)},43078:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.execute=t.GLOBAL_STATE_NS=t.ROOT_INS_ID=t.INPUTS_STATE_SUFFIX=t.INNER_STATE_SUFFIX=void 0;const s=n(62600),r=n(87794);i(n(14123),t);const a=n(57438),u=n(53850),l=n(74839),c=n(85636),d=n(40383),p=n(57438),f=n(14123),m=n(97740);t.INNER_STATE_SUFFIX="_inner",t.INPUTS_STATE_SUFFIX="_inputs";t.ROOT_INS_ID="__root",t.GLOBAL_STATE_NS="____global";t.execute=e=>{let{part:n,inputs:o,outputs:i,resolvedDeps:g,_debugger:h={},insId:v=t.ROOT_INS_ID,extraContext:I={},mainState:y={},ancestorsInsIds:b,onBubbleError:C=s.noop,env:P={},onCompleted:_=s.noop,onStarted:x=s.noop}=e;const j=[];y[t.GLOBAL_STATE_NS]||(y[t.GLOBAL_STATE_NS]=new Map);const w={...I,ENV:P},O=(0,m.customPartsToPartsCollection)(g,w),E=e=>{const t=e instanceof a.PartInstanceError?e:new a.PartInstanceError(e,(0,c.fullInsIdPath)(v,b),n.id);h.onEvent&&h.onEvent({type:f.DebuggerEventType.ERROR,val:t,insId:v,ancestorsInsIds:b,partId:n.id}),i[u.ERROR_PIN_ID]?i[u.ERROR_PIN_ID].next(t):C(t)},D=(e=>(0,a.isVisualPart)(e)?(0,u.connect)(e,O,h,(0,c.fullInsIdPath)(v,b),y,E,P,I):(0,a.isInlineValuePart)(e)?(0,m.inlineValuePartToPart)(e,w):e)(n),M=h.onEvent||s.noop,S={},N={};(0,c.entries)(o).forEach((e=>{let[t,o]=e;if((0,a.isDynamicInput)(o)){const e=(0,a.dynamicPartInput)({config:o.config}),i=o.subject.subscribe((async o=>{const i=M({type:f.DebuggerEventType.INPUT_CHANGE,insId:v,pinId:t,val:o,ancestorsInsIds:b,partId:n.id});if(i){const t=await i.valuePromise;e.subject.next(t)}else h.debugDelay&&await(0,c.delay)(h.debugDelay),e.subject.next(o)}));j.push((()=>i.unsubscribe())),N[t]=e}else{M({type:f.DebuggerEventType.INPUT_CHANGE,insId:v,pinId:t,val:o.config.value,ancestorsInsIds:b,partId:n.id});const e=(0,a.staticPartInput)((0,a.getStaticValue)(o.config.value,O,v));N[t]=e}})),(0,c.entries)(i).forEach((e=>{let[t,o]=e;const i=(0,a.dynamicOutput)(),s=i.subscribe((async e=>{const i=M({type:f.DebuggerEventType.OUTPUT_CHANGE,insId:v,pinId:t,val:e,ancestorsInsIds:b,partId:n.id});if(i){const e=await i.valuePromise;o.next(e)}else o.next(e)}));j.push((()=>s.unsubscribe())),S[t]=i}));const k=(e=>{var n,o;const{part:i,inputs:u,outputs:m,resolvedDeps:g,_debugger:h,insId:v,ancestorsInsIds:I,mainState:y,onError:b,onStarted:C,onCompleted:P,env:_,extraContext:x}=e,{run:j,fn:w}=i,O=(0,d.debugLogger)("core"),E=[];let D;const M=(null==h?void 0:h.onEvent)||s.noop,S=(0,c.fullInsIdPath)(v,I),N=""+S+t.INNER_STATE_SUFFIX,k=""+S+t.INPUTS_STATE_SUFFIX,T=O.extend(S),R=y[t.GLOBAL_STATE_NS];y[N]||(y[N]=new Map),y[k]||(y[k]=new Map);let V=null!==(n=y[k])&&void 0!==n?n:new Map;const A=()=>{const e=Array.from(V.entries()).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:(0,a.isQueueInputPinConfig)(u[n].config)?null==o?void 0:o.length:1}}),{});M({type:f.DebuggerEventType.INPUTS_STATE_CHANGE,val:e,insId:v,ancestorsInsIds:I,partId:i.id})},z={execute:(e,n,o,i)=>(0,t.execute)({part:e,inputs:n,outputs:o,resolvedDeps:g,_debugger:h,insId:i,onCompleted:P,onStarted:C}),insId:v,state:null!==(o=y[N])&&void 0!==o?o:new Map,onCleanup:e=>{E.push(e)},onError:e=>{b(e)},context:null!=x?x:{},ancestorsInsIds:I,globalState:R};let H,G=!1;const L=(i.reactiveInputs||[]).filter((e=>{var t;return!(0,p.isStaticInputPinConfig)(null===(t=u[e])||void 0===t?void 0:t.config)})),B=()=>{var e;null===(e=y[N])||void 0===e||e.clear(),(0,c.keys)(y).filter((e=>e.startsWith(S+"."))).forEach((e=>{y[e]=new Map}))},F=e=>{const t=(null==e?void 0:e.key)&&L.includes(null==e?void 0:e.key);if(G&&!t);else{const o=G&&t;if((0,l.isPartStateValid)(u,V,i)||o){let t;if(G){if(!e)throw new Error("Unexpected state,  got reactive part while not processing and not valid");const n=(0,l.pullValueForExecution)(e.key,u[e.key],V,_);t={...H,[e.key]:n},A()}else t=(0,l.pullValuesForExecution)(u,V,_),H=t,A();let o=new Set,s={};if(G=!0,M({type:f.DebuggerEventType.PROCESSING_CHANGE,val:G,insId:v,ancestorsInsIds:I,partId:i.id}),i.completionOutputs){const e=i.completionOutputs.map((e=>e.split("+"))).reduce(((e,t)=>(t.forEach((n=>{e.set(n,t)})),e)),new Map);(0,c.entries)(m).forEach((t=>{let[n,a]=t;a.pipe((0,r.first)()).subscribe((t=>{o.add(n),s[n]=t;let r=e.get(n);r&&(r.splice(r.indexOf(n),1),0===r.length&&(G=!1,M({type:f.DebuggerEventType.PROCESSING_CHANGE,val:G,insId:v,ancestorsInsIds:I,partId:i.id}),P&&P(s),B(),(0,c.callFnOrFnPromise)(D,"Error with cleanup function of "+i.id),D=void 0,o.clear(),s={},(0,l.hasNewSignificantValues)(u,V,_,i.id)&&F()))}))}))}else(0,c.entries)(m).forEach((e=>{let[t,n]=e;n.subscribe((e=>{s[t]=e}))}));try{T("Running part %s with values %o",i.id,t),C&&C(),D=(null!=w?w:j)(t,m,z),(0,c.isPromise)(D)?D.then((()=>{void 0===i.completionOutputs&&P&&(G=!1,M({type:f.DebuggerEventType.PROCESSING_CHANGE,val:G,insId:v,ancestorsInsIds:I,partId:i.id}),P(s),B(),(0,l.hasNewSignificantValues)(u,V,_,i.id)&&F())})).catch((e=>{b(e),G=!1,T("Error in part %s - value %e",i.id,e),M({type:f.DebuggerEventType.PROCESSING_CHANGE,val:G,insId:v,ancestorsInsIds:I,partId:i.id})})):void 0===i.completionOutputs&&P&&(G=!1,M({type:f.DebuggerEventType.PROCESSING_CHANGE,val:G,insId:v,ancestorsInsIds:I,partId:i.id}),P(s),B())}catch(n){b(n),G=!1,T("Error in part %s - value %e",i.id,n),M({type:f.DebuggerEventType.PROCESSING_CHANGE,val:G,insId:v,ancestorsInsIds:I,partId:i.id})}const d=L.find((e=>u[e]&&(0,l.peekValueForExecution)(e,u[e],V,_,i.id)));if(d){const e=(0,l.peekValueForExecution)(d,u[d],V,_,i.id);F({key:d,value:e})}else{const e=(0,c.entries)(u).find((e=>{let[t,n]=e;const o=(0,a.isQueueInputPinConfig)(n.config),s=(0,l.peekValueForExecution)(t,n,V,_,i.id);return!!o&&(0,c.isDefined)(s)}));if(e){const[t,n]=e,o=(0,l.peekValueForExecution)(t,n,V,_,i.id);F({key:t,value:o})}}}}};F();const U=(0,l.subscribeInputsToState)(u,V,((e,t)=>{O("Got input %s - value is [%o]",e,t),A();try{F({key:e,value:t})}catch(n){b(n)}}));return E.push(U),()=>{(0,c.callFnOrFnPromise)(D,"Error with cleanup function of "+i.id),E.forEach((e=>e()))}})({part:D,inputs:N,outputs:S,resolvedDeps:O,_debugger:h,insId:v,mainState:y,ancestorsInsIds:b,onError:E,onBubbleError:C,env:P,extraContext:I,onCompleted:_,onStarted:x});return()=>{j.forEach((e=>e())),k()}}},74839:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeInputsToState=t.isPartStateValid=t.hasNewSignificantValues=t.peekValuesForExecution=t.pullValuesForExecution=t.pullValueForExecution=t.peekValueForExecution=void 0;const o=n(57438),i=n(85636),s=n(53850),r=(e,t)=>{const n=(0,o.extractStaticValue)(e);if((0,o.isEnvValue)(n)){return((e,t)=>{const n=e.split(".");let o={...t};for(let s of n){if(!o||!(0,i.isDefined)(o[s])||null===o[s])throw new Error("Cannot find key "+e+" inside obj "+t);o=o[s]}return o})((0,o.getEnvKeyFromValue)(n),t)}return n};t.peekValueForExecution=(e,t,n,i,s)=>{const a=n.get(e);let u;if(!t)throw new Error('Trying to peek value of inexsting input in key "'+e+'" in part "'+s+'"');return u=(0,o.isStaticInput)(t)?r(t,i):(0,o.isQueueInputPinConfig)(t.config)?a?[...a].shift():void 0:a,u};t.pullValueForExecution=(e,t,n,i)=>{const s=n.get(e);let a;return(0,o.isStaticInput)(t)?a=r(t,i):(0,o.isQueueInputPinConfig)(t.config)?(a=(s||[]).shift(),n.set(e,s)):(a=s,(0,o.isStickyInputPinConfig)(t.config)||n.delete(e)),a};t.pullValuesForExecution=(e,n,o)=>(0,i.entries)(e).reduce(((e,i)=>{let[s,r]=i;return e[s]=(0,t.pullValueForExecution)(s,r,n,o),e}),{});t.peekValuesForExecution=(e,n,o,s)=>(0,i.entries)(e).reduce(((e,i)=>{let[r,a]=i;return e[r]=(0,t.peekValueForExecution)(r,a,n,o,s),e}),{});t.hasNewSignificantValues=(e,n,s,r)=>(0,i.entries)(e).some((e=>{let[a,u]=e;const l=(0,o.isQueueInputPinConfig)(u.config),c=(0,t.peekValueForExecution)(a,u,n,s,r);return(0,i.isDefined)(c)&&l}));t.isPartStateValid=(e,t,n)=>{const r=(0,i.keys)(e),a=(0,i.keys)(n.inputs).filter((e=>{var t;const o=null===(t=n.inputs[e])||void 0===t?void 0:t.mode;return!o||"required"===o}));r.includes(s.TRIGGER_PIN_ID)&&a.push(s.TRIGGER_PIN_ID);return!!(0,i.containsAll)(r,a)&&(0,i.entries)(e).filter((e=>{let[t]=e;return!!n.inputs[t]||t===s.TRIGGER_PIN_ID})).every((e=>{let[s,r]=e;var a;const u=t.get(s);return"optional"===((null===(a=n.inputs[s])||void 0===a?void 0:a.mode)||"required")||(!!(0,o.isStaticInput)(r)||((0,o.isQueueInputPinConfig)(r.config)?(0,i.isDefined)(u)&&u.length>0:(0,i.isDefined)(u)))}))};t.subscribeInputsToState=(e,t,n)=>{const s=[];return(0,i.entries)(e).forEach((e=>{let[i,r]=e;if(!r)return;if((0,o.isStaticInput)(r))return;const a=r.subject.subscribe((e=>{if((0,o.isQueueInputPinConfig)(r.config)){const o=t.get(i)||[];if(!Array.isArray(o))throw new Error("impossible state - state of key "+i+" is set but not an array");o.push(e),t.set(i,o),n(i,e)}else t.set(i,e),n(i,e)}));s.push((()=>a.unsubscribe()))})),()=>s.forEach((e=>e()))}},58844:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flydeFlowSchema=void 0;const o=n(50675),i=o.z.record(o.z.string(),o.z.string().or(o.z.array(o.z.string()))),s=o.z.strictObject({x:o.z.number(),y:o.z.number()}),r=o.z.discriminatedUnion("mode",[o.z.strictObject({mode:o.z.literal("static"),value:o.z.any()}),o.z.strictObject({mode:o.z.literal("queue")}),o.z.strictObject({mode:o.z.literal("sticky")})]),a=o.z.object({size:o.z.optional(o.z.enum(["small","regular","large"])),icon:o.z.optional(o.z.any()),color:o.z.optional(o.z.string()),cssOverride:o.z.optional(o.z.record(o.z.string()))}),u=o.z.object({pos:s.default({x:0,y:0}),id:o.z.string(),inputConfig:o.z.optional(o.z.record(o.z.string(),r)).default({}),visibleInputs:o.z.optional(o.z.array(o.z.string())),visibleOutputs:o.z.optional(o.z.array(o.z.string())),partId:o.z.optional(o.z.string()),part:o.z.optional(o.z.any()),style:o.z.optional(a)}).refine((e=>e.part||e.partId),{message:"Instance must have either an inline part or refer to a partId"}),l=o.z.union([o.z.string(),o.z.object({mode:o.z.enum(["required","optional","required-if-connected"]),type:o.z.optional(o.z.string()),description:o.z.optional(o.z.string()),defaultValue:o.z.optional(o.z.any())})]),c=o.z.object({type:o.z.optional(o.z.string()),optional:o.z.optional(o.z.boolean()),delayed:o.z.optional(o.z.boolean()),description:o.z.optional(o.z.string())}),d=o.z.object({id:o.z.optional(o.z.string()),inputs:o.z.record(o.z.string(),l),outputs:o.z.record(o.z.string(),c),inputsPosition:o.z.optional(o.z.record(o.z.string(),s)),outputsPosition:o.z.optional(o.z.record(o.z.string(),s)),customViewCode:o.z.optional(o.z.string()),dataBuilderSource:o.z.optional(o.z.string()),templateType:o.z.optional(o.z.string()),completionOutputs:o.z.optional(o.z.array(o.z.string())),reactiveInputs:o.z.optional(o.z.array(o.z.string())),defaultStyle:o.z.optional(a),description:o.z.optional(o.z.string()),searchKeywords:o.z.optional(o.z.array(o.z.string()))}),p=o.z.object({instances:o.z.array(u),connections:o.z.array(o.z.strictObject({from:o.z.strictObject({insId:o.z.string(),pinId:o.z.string()}),to:o.z.strictObject({insId:o.z.string(),pinId:o.z.string()}),delayed:o.z.optional(o.z.boolean()),hidden:o.z.optional(o.z.boolean())}))}).and(d);t.flydeFlowSchema=o.z.strictObject({imports:o.z.optional(i).default({}),part:p})},14376:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.isStaticValueVisualPart=void 0,i(n(85636),t);const s=n(57438);i(n(53850),t),i(n(43078),t),i(n(82877),t),i(n(57438),t),i(n(45201),t),i(n(97740),t),i(n(53943),t),i(n(58844),t);t.isStaticValueVisualPart=e=>!!e&&!!(0,s.maybeGetStaticValuePartId)(""+e)},82454:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fakeVm=t.VM=t.VMScript=void 0;const o=n(85636);class i{constructor(e){this.script=e}}t.VMScript=i;class s{constructor(e){this.context=e}run(e){const t=(0,o.okeys)(this.context.sandbox),n=Object.values(this.context.sandbox);Function(...t,e.script)(...n)}}t.VM=s,t.fakeVm={VMScript:i,VM:s}},87894:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVM2Instance=void 0;const o=n(82454);t.getVM2Instance=()=>o.fakeVm},97740:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.customPartsToPartsCollection=t.inlineValuePartToPart=void 0;const i=o(n(10411)),s=n(85636),r=n(57438),a=(0,n(87894).getVM2Instance)();t.inlineValuePartToPart=function(e,t){void 0===t&&(t={});const{runFnRawCode:n,...o}=e,u=(0,s.debugLogger)("code-part:"+e.id),l="\n  try {\n    "+n+"\n  } catch (e) {\n    adv.onError(e);\n  }\n  ",c=new a.VMScript(l),d={...o,run:(n,o,l)=>{const d=new a.VM({sandbox:{inputs:n,outputs:o,setInterval:setInterval,clearInterval:clearInterval,setTimeout:setTimeout,clearTimeout:clearTimeout,encodeURIComponent:encodeURIComponent,adv:l,log:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];u("Log from code part "+e.id+" ["+l.insId+"]",...n)},axios:i.default,DEFAULT_AXIOS_TIMEOUT:15e3,dynamicPartInput:r.dynamicPartInput,dynamicPartArg:r.dynamicPartInput,dynamicOutput:r.dynamicOutput,isDefined:s.isDefined,compileStringTemplate:s.compileStringTemplate,compileObjectTemplate:s.compileObjectTemplate,process:{env:{}},...t}});d.run(c)}};return d};t.customPartsToPartsCollection=function(e,n){void 0===n&&(n={});const o={};for(let i in e){const s=e[i];o[i]=(0,r.isInlineValuePart)(s)?(0,t.inlineValuePartToPart)(s,n):s}return o}},45201:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPartWithDependencies=void 0;const o=n(57438),i=n(14376),s=n(96545);t.getPartWithDependencies=function(e,n,r){if(void 0===r&&(r=[]),(0,o.isInlineValuePart)(e))return[e];if(r.includes(e.id))return[];const a=(0,i.removeDupes)(e.instances.filter((e=>(0,s.isRefPartInstance)(e))).map((e=>e.partId)).filter((e=>n[e])));return[e,...a.flatMap((e=>{var t;return null!==(t=n[e])&&void 0!==t?t:[]})).reduce(((e,o)=>[...e,...(0,t.getPartWithDependencies)(o,n,[...r,...a])]),[])]}},57438:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(96545),t),i(n(68730),t),i(n(79855),t),i(n(98396),t),i(n(35516),t),i(n(63784),t)},35516:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartInstanceError=void 0;class n extends Error{constructor(e,t,n){let o="Unknown error";o="string"==typeof e?e:e instanceof Error?e.message:null!==e&&"object"==typeof e?JSON.stringify(e):String(e),super(o+" (insId: "+t+", partId: "+n+")"),this.name=this.constructor.name,this.message=o+" (insId: "+t+", partId: "+n+")",Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.fullInsIdsPath=t,this.partId=n}}t.PartInstanceError=n},96545:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInsId=t.PartInstance=t.isRefPartInstance=t.isInlinePartInstance=t.inlinePartInstance=t.partInstance=void 0;const o=n(36618);t.partInstance=(e,t,n,o)=>({id:e,partId:t,inputConfig:n||{},pos:o||{x:0,y:0}});t.inlinePartInstance=(e,t,n,o)=>({id:e,part:t,inputConfig:n||{},pos:o||{x:0,y:0}});t.isInlinePartInstance=e=>!!e.part;t.isRefPartInstance=e=>!(0,t.isInlinePartInstance)(e);t.PartInstance=(e,t,n,o)=>({id:e,partId:t.id,inputConfig:n||{},pos:o||{x:0,y:0}});t.createInsId=e=>e.id+"-"+(0,o.slug)()},68730:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnvKeyFromValue=t.toEnvValue=t.isEnvValue=t.extractStaticValue=t.isStaticInput=t.isDynamicInput=t.staticPartInput=t.dynamicPartInputs=t.dynamicPartInput=t.dynamicOutput=t.partOutputs=t.partOutput=t.partInputs=t.isInputPinOptional=t.partInput=void 0;const o=n(62600),i=n(57438),s=n(85636),r=n(79855);t.partInput=function(e){return void 0===e&&(e="required"),{mode:e}};t.isInputPinOptional=e=>"optional"===e.mode;t.partInputs=(e,n)=>(0,s.repeat)(e,(e=>(0,t.partInput)((null==n?void 0:n[e])||"required")));t.partOutput=function(e){return void 0===e&&(e=!1),{delayed:e}};t.partOutputs=e=>(0,s.repeat)(e,(()=>(0,t.partOutput)()));t.dynamicOutput=()=>new o.Subject,t.dynamicPartInput=(0,s.testDataCreator)((()=>({subject:new o.Subject,config:(0,r.queueInputPinConfig)()})));t.dynamicPartInputs=function(e){return void 0===e&&(e=10),(0,s.repeat)(e,(()=>(0,s.testDataCreator)((()=>({subject:new o.Subject,config:(0,r.queueInputPinConfig)()})))()))};t.staticPartInput=e=>({config:(0,r.staticInputPinConfig)(e)});t.isDynamicInput=e=>{const t=e;return t&&t.subject&&!!t.subject.next};t.isStaticInput=e=>(0,i.isStaticInputPinConfig)(null==e?void 0:e.config);t.extractStaticValue=e=>{if((0,t.isStaticInput)(e))return e.config.value;throw new Error("Cannot extract static value from non static arg")};t.isEnvValue=e=>"string"==typeof e&&e.startsWith("$ENV.");t.toEnvValue=e=>"$ENV."+e;t.getEnvKeyFromValue=e=>"string"==typeof e?e.replace(/^\$ENV\./,""):e},63784:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codeFromFunction=t.getPartDef=t.getPart=t.getStaticValue=t.maybeGetStaticValuePartId=t.fromSimplified=t.inlineValuePart=t.codePart=t.visualPart=t.isInlineValuePart=t.isVisualPart=t.isCodePart=t.isBasePart=t.InlineValuePartType=void 0;const o=n(85636),i=n(96545),s=n(68730);!function(e){e.VALUE="value",e.FUNCTION="function"}(t.InlineValuePartType||(t.InlineValuePartType={}));t.isBasePart=e=>e&&e.id&&e.inputs&&e.outputs;t.isCodePart=e=>(0,t.isBasePart)(e)&&"function"==typeof e.run;t.isVisualPart=e=>!!e.instances;t.isInlineValuePart=e=>(0,o.isDefined)(e)&&(0,o.isDefined)(e.runFnRawCode),t.visualPart=(0,o.testDataCreator)({id:"visual-part",inputs:{},outputs:{},instances:[],connections:[],outputsPosition:{},inputsPosition:{}}),t.codePart=(0,o.testDataCreator)({id:"part",inputs:{},outputs:{},run:o.noop}),t.inlineValuePart=(0,o.testDataCreator)({id:"part",inputs:{},outputs:{},runFnRawCode:""});t.fromSimplified=e=>{let{run:t,inputTypes:n,outputTypes:i,id:s}=e;return{id:s,inputs:(0,o.entries)(n).reduce(((e,t)=>{let[n]=t;return{...e,[n]:{}}}),{}),outputs:(0,o.entries)(i).reduce(((e,t)=>{let[n]=t;return{...e,[n]:{}}}),{}),run:t}};t.maybeGetStaticValuePartId=e=>{const t="string"==typeof e&&e.match(/^__part\:(.*)/);if(t){return t[1]}return null};t.getStaticValue=(e,n,o)=>{const i=(0,t.maybeGetStaticValuePartId)(e);if(i){const e=n[i];if(!e)throw new Error("Instance "+o+" referrer to a part reference "+i+" that does not exist");return e}return e};t.getPart=(e,t)=>{if("string"!=typeof e&&(0,i.isInlinePartInstance)(e))return e.part;const n="string"==typeof e?e:e.partId,o=t[n];if(!o)throw new Error("Part with id "+n+" not found");return o};t.getPartDef=(e,t)=>{if("string"!=typeof e&&(0,i.isInlinePartInstance)(e))return e.part;const n="string"==typeof e?e:e.partId,o=t[n];if(!o)throw console.error("Part with id "+n+" not found"),new Error("Part with id "+n+" not found");return o};t.codeFromFunction=e=>{let{id:t,fn:n,inputNames:o,outputName:i,defaultStyle:r}=e;return{id:t,inputs:o.reduce(((e,t)=>({...e,[t]:(0,s.partInput)()})),{}),outputs:{[i]:(0,s.partOutput)()},run:(e,t)=>{const s=o.map((t=>e[t])),r=t[i],a=n(...s);return Promise.resolve(a).then((e=>null==r?void 0:r.next(e)))},completionOutputs:[i],defaultStyle:r}}},98396:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.partFromSimpleFunction=void 0,t.partFromSimpleFunction=function(e){var t;return{...e,id:e.id,description:e.description,namespace:e.namespace,inputs:e.inputs?e.inputs.reduce(((e,t)=>{let{name:n,description:o,mode:i,defaultValue:s}=t;return{...e,[n]:{description:o,mode:null!=i?i:"required",defaultValue:s}}}),{}):{},outputs:e.output?{[e.output.name]:{description:e.output.description}}:{},defaultStyle:{icon:e.icon,size:e.size},run:null!==(t=e.fullRunFn)&&void 0!==t?t:async function(t,n,o){var i,s;const r=(null!==(i=e.inputs)&&void 0!==i?i:[]).map((e=>{let{name:n}=e;return t[n]}));try{const t=await Promise.resolve(e.run(...r));e.output&&(null===(s=n[e.output.name])||void 0===s||s.next(t))}catch(a){console.error("Error in part",a),o.onError(a)}},customViewCode:e.customViewCode}}},79855:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isStaticInputPinConfig=t.isStickyInputPinConfig=t.isQueueInputPinConfig=t.staticInputPinConfig=t.stickyInputPinConfig=t.queueInputPinConfig=t.INPUT_MODES=void 0,t.INPUT_MODES=["queue","sticky","static"];t.queueInputPinConfig=()=>({mode:"queue"});t.stickyInputPinConfig=()=>({mode:"sticky"});t.staticInputPinConfig=e=>({mode:"static",value:e});t.isQueueInputPinConfig=e=>"queue"===e.mode;t.isStickyInputPinConfig=e=>!!e&&"sticky"===e.mode,t.isStaticInputPinConfig=function(e){return!!e&&"static"===e.mode}},82877:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simplifiedExecute=void 0;const o=n(14376),i=n(43078);t.simplifiedExecute=function(e,t,n,s,r){void 0===r&&(r={});const a=(0,o.keys)(e.outputs),u=Object.keys(n).reduce(((e,t)=>{const i=n[t];return{...e,[t]:(0,o.isDynamicInput)(i)?i:(0,o.staticPartInput)(i)}}),{}),l=a.reduce(((e,t)=>{const n=(0,o.dynamicOutput)();return s&&n.subscribe((e=>{s(t,e)})),{...e,[t]:n}}),{});return(0,i.execute)({part:e,inputs:u,outputs:l,resolvedDeps:t,onBubbleError:e=>{throw e},...r})}},53943:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isScheduledTrigger=t.isRestApiTrigger=t.isWebAppTrigger=void 0;t.isWebAppTrigger=e=>"web-app"===e.type;t.isRestApiTrigger=e=>"rest-api"===e.type;t.isScheduledTrigger=e=>"scheduled"===e.type},18699:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartPreview=void 0;const o=n(20264),i=n(14376),s=n(36075);t.PartPreview=e=>{let{part:t}=e;const n={part:t,instance:(0,i.partInstance)("bob",t.id,{}),connections:[],viewPort:{pos:{x:0,y:0},zoom:1},resolvedDeps:{},connectionsPerInput:{},onUngroup:i.noop,onDblClick:i.noop,onDragEnd:i.noop,onDragMove:i.noop,onDragStart:i.noop,onPinClick:i.noop,onPinDblClick:i.noop,onSelect:i.noop,onTogglePinBreakpoint:i.noop,onTogglePinLog:i.noop,onToggleSticky:i.noop,displayMode:!0,onInspectPin:i.noop,onDetachConstValue:i.noop,onCopyConstValue:i.noop,onPasteConstValue:i.noop,ancestorsInsIds:"",onChangeVisibleInputs:i.noop,onChangeVisibleOutputs:i.noop,onConvertConstToEnv:i.noop,forceShowMinimized:"both",onExtractInlinePart:i.noop,onCloseInlineEditor:i.noop,isConnectedInstanceSelected:!1,inlineEditorPortalDomNode:null,onChangeStyle:i.noop,onDeleteInstance:i.noop,onGroupSelected:i.noop,onSetDisplayName:i.noop,hadError:!1,queuedInputsData:{},onPinMouseDown:i.noop,onPinMouseUp:i.noop};return(0,o.jsx)("div",{className:"part-preview",children:(0,o.jsx)(s.InstanceView,{...n})})}},26855:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DataInspectionModal=void 0;const a=n(20264),u=n(51857),l=r(n(65443)),c=s(n(49231)),d=n(44108),p=n(92169),f=n(14957),m=n(56469);t.DataInspectionModal=e=>{var t;const{onRequestHistory:n}=(0,m.useDebuggerContext)(),{item:o}=e,[i,s]=c.default.useState(),[r,g]=c.default.useState(0),[h,v]=c.default.useState(""),[I,y]=c.default.useState(),[b]=(0,d.useDebounce)(h,300);(0,c.useEffect)((()=>{y(null==i?void 0:i.lastSamples.filter((e=>"object"==typeof e.val?JSON.stringify(e.val).includes(b):e.val.toString().includes(b)))),g(0)}),[null==i?void 0:i.lastSamples,b]),c.default.useEffect((()=>{!async function(){var e,t;const i=await n(o.insId,null===(e=o.pin)||void 0===e?void 0:e.id,null===(t=o.pin)||void 0===t?void 0:t.type);s(i)}()}),[o,n]);const C=e=>{const t=e.val;return"object"==typeof t?(0,a.jsx)(p.BrowserOnlyReactJson,{src:t,name:null}):(0,a.jsx)(u.Code,{children:t.toString()})},P='"'+o.insId+'" '+((null===(t=o.pin)||void 0===t?void 0:t.id)?"("+o.pin.id+")":"");return(0,a.jsx)(u.Dialog,{isOpen:!0,title:"Inspecting data for instance "+P,onClose:e.onClose,canEscapeKeyClose:!1,className:"data-inspection-modal",children:(0,a.jsx)("main",{className:(0,l.default)(u.Classes.DIALOG_BODY),tabIndex:0,children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("header",{children:[i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("em",{children:[P," called ",i.total," time(s)"]}),i.total>10&&(0,a.jsx)("span",{children:"Showing last 10 samples"})]}):null,(0,a.jsx)("input",{className:"bp3-input bp3-small bp3-fill",type:"search",placeholder:"Search for values",dir:"auto",onChange:e=>v(e.target.value),value:h}),b.length>0&&(0,a.jsxs)("span",{children:["Showing ",null==I?void 0:I.length," of ",i.lastSamples.length," ",'samples matching query "',b,'"']})]}),(0,a.jsx)("main",{className:"main-wrapper",children:(()=>{if(!i)return(0,a.jsx)(f.Loader,{});if(0===i.total)return(0,a.jsxs)(u.Callout,{intent:"warning",children:["No events captured for instance ",(0,a.jsx)("em",{children:o.insId})," ",o.pin?(0,a.jsxs)(c.default.Fragment,{children:["and pin ",(0,a.jsx)("em",{children:o.pin.id})]}):null,". Make sure debugger is running and your program was triggered."]});const e=null==I?void 0:I[r];return e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.Card,{className:"content-wrapper",children:[e?(0,a.jsxs)("div",{className:"info",children:[(0,a.jsxs)("div",{children:["Showing sample ",r," of event from"," ",(0,a.jsx)("strong",{children:(0,d.timeAgo)(e.time)})," (",new Date(e.time).toLocaleString(),")"]}),(0,a.jsxs)("div",{children:["Instance: ",(0,a.jsx)("strong",{children:e.insId}),", Pin id:"," ",(0,a.jsx)("strong",{children:e.pinId})," "]}),(0,a.jsx)("div",{children:"Value:"})]}):null,C(e)]}),(0,a.jsx)(u.Menu,{className:"samples-menu",children:I.map(((e,t)=>{const n=e.pinId,o=i.total-t+'. from pin "'+n+'"';return(0,a.jsx)(u.MenuItem,{text:o,onClick:()=>g(t)},t)}))})]}):i.lastSamples.length>0&&h.length>0?(0,a.jsxs)(u.Callout,{intent:"warning",children:['No data found for search query "',h,'"']}):(0,a.jsxs)(u.Callout,{intent:"warning",children:["No events captured for instance ",o.insId," ",o.pin?"and "+o.pin.id:"",". Make sure a debugger is connected and your program was triggered."]})})()})]})})})}},65966:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(26855),t)},56469:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDebuggerContext=t.DebuggerContextProvider=void 0;const o=n(49231),i=(0,o.createContext)({onRequestHistory:()=>Promise.reject(new Error("Not implemented"))});t.DebuggerContextProvider=i.Provider;t.useDebuggerContext=()=>(0,o.useContext)(i)},69381:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDependenciesContext=t.DependenciesContextProvider=void 0;const o=n(49231),i=(0,o.createContext)({resolvedDependencies:{},onImportPart:()=>Promise.reject(new Error("Not implemented")),onRequestImportables:()=>Promise.reject(new Error("Not implemented"))});t.DependenciesContextProvider=i.Provider;t.useDependenciesContext=()=>(0,o.useContext)(i)},69200:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FlowEditor=void 0;const u=n(20264),l=s(n(49231)),c=n(14376),d=n(99678),p=a(n(53865)),f=n(50385),m=n(43925),g=n(12623),h=n(91028),v=n(7936),I=n(68870),y=n(97281),b=n(21061),C=n(69193),P=n(59429),_=n(65966),x=n(56469),j=n(69381);r(n(68870),t),r(n(56469),t),r(n(69381),t),y.library.add(b.fab,C.fas);const w=["select","drag-move","order-step"];t.FlowEditor=l.memo(l.forwardRef(((e,t)=>{const{state:n,onChangeEditorState:o}=e,{resolvedDependencies:i,onImportPart:s}=(0,j.useDependenciesContext)(),[r,a]=l.useState([]),[y,b]=l.useState([]),{flow:C,boardData:O}=n,E=n.flow.part,[D,M]=l.useState({}),[S,N]=l.useState(new Set),{debuggerClient:k}=(0,x.useDebuggerContext)();l.useEffect((()=>{if(k)return k.onBatchedEvents((e=>{e.forEach((e=>{e.type===c.DebuggerEventType.INPUTS_STATE_CHANGE&&(console.log("INPUTS_STATE_CHANGE",e.insId,e.val),M((t=>({...t,[e.insId]:e.val})))),e.type===c.DebuggerEventType.ERROR&&N((t=>{const n=new Set(t);return n.add(e.insId),n}))}))}))}),[k]);const{openFile:T,reportEvent:R}=(0,I.usePorts)(),V=l.useCallback(((e,t)=>{console.info("onChangeFlow",t.type),"functional"===t.type&&(a([{flow:{...n.flow,...e}},...r.slice(0,50)]),b([])),o((t=>({...t,flow:{...t.flow,...e}})))}),[o,n.flow,r]),[A,z]=l.useState({instances:[],connections:[]}),[H,G]=l.useState(!1),L=l.useCallback((()=>G(!1)),[]),B=l.useCallback((()=>G(!0)),[]),F=l.useCallback((e=>{o((t=>({...t,boardData:{...t.boardData,...e}})))}),[o]);l.useEffect((()=>{F({selected:[],viewPort:d.defaultViewPort,from:void 0,to:void 0,lastMousePos:{x:0,y:0}})}),[E.id]),(0,f.useHotkeys)("cmd+z",(e=>{b([...y,n]);const[t,...i]=r;t&&(o((e=>({...e,...t}))),a(i)),e.preventDefault()}),{text:"Undo last change",group:"Editing"},[n,r,y]);const U=l.useCallback(((e,t)=>{w.some((e=>t.message.includes(e)))||b([]),V({part:e},t)}),[V]),q=l.useCallback((e=>{T({absPath:e.source.path})}),[T]),W=l.useCallback((function(e,t){void 0===t&&(t=-1*d.PART_HEIGHT*1.5);const n=(0,m.createNewPartInstance)(e,t,O.lastMousePos,i);if(n){const e=(0,p.default)(C,(e=>{const t=e.part;if(!(0,c.isVisualPart)(t))throw new Error("Impossible state, adding part to non visual part");t.instances.push(n)}));return V(e,(0,h.functionalChange)("add-part")),L(),n}}),[O.lastMousePos,C,V,L,i]),Z=l.useCallback((async e=>{switch(e.type){case v.OmniBarCmdType.ADD:return R("addPart",{partId:e.data,source:"omnibar"}),W(e.data);case v.OmniBarCmdType.ADD_VALUE:{const e=t.current;null==e||e.requestNewInlineValue();break}case v.OmniBarCmdType.IMPORT:{await s(e.data,{pos:O.lastMousePos});const t=(0,P.vAdd)({x:0,y:0},O.lastMousePos),n=(0,m.createNewPartInstance)(e.data.part,0,t,i),o=(0,p.default)(C,(e=>{e.part.instances.push(n)}));V(o,(0,h.functionalChange)("add-imported-part")),R("addPart",{partId:e.data.part.id,source:"omnibar"});break}default:g.AppToaster.show({intent:"warning",message:"Not supported yet"})}L()}),[L,R,W,t,s,O.lastMousePos,i,C,V]),[J,Y]=l.useState(),X=l.useCallback((()=>Y(void 0)),[]),K=l.useCallback(((e,t)=>{Y({insId:e,pin:t})}),[]);return(0,u.jsx)("div",{className:"flyde-flow-editor",children:(()=>{if((0,c.isInlineValuePart)(E))throw new Error("Impossible state");return(0,u.jsxs)(l.Fragment,{children:[J?(0,u.jsx)(_.DataInspectionModal,{item:J,onClose:X}):null,(0,u.jsx)(d.VisualPartEditor,{currentInsId:c.ROOT_INS_ID,ref:t,boardData:O,onChangeBoardData:F,part:E,onGoToPartDef:q,onChangePart:U,resolvedDependencies:i,clipboardData:A,onCopy:z,partIoEditable:!E.id.startsWith("Trigger"),onInspectPin:K,onShowOmnibar:B,onExtractInlinePart:e.onExtractInlinePart,queuedInputsData:D,initialPadding:e.initialPadding,instancesWithErrors:S,disableScrolling:e.disableScrolling},E.id),H?(0,u.jsx)(v.Omnibar,{flow:C,resolvedParts:i,onCommand:Z,visible:H,onClose:L}):null]})})()})})))},13328:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BasePartEditor=t.renderCreateIOOption=void 0;const i=n(20264),s=o(n(49231)),r=n(14376),a=n(51857),u=o(n(53865)),l=n(7586),c=n(18699);t.renderCreateIOOption=(e,t,n)=>(0,i.jsx)(a.MenuItem,{icon:"add",text:'Create "'+e+'"',active:t,onClick:n,shouldDismissPopover:!1});const d=l.MultiSelect.ofType();t.BasePartEditor=e=>{var n,o;const{part:l,onChange:p}=e,f=(0,r.entries)(l.inputs),m=f.filter((e=>{let[,t]=e;return"required"===t.mode})).map((e=>{let[t]=e;return t})),g=f.filter((e=>{let[,t]=e;return"optional"===t.mode})).map((e=>{let[t]=e;return t})),h=f.filter((e=>{let[,t]=e;return"required-if-connected"===t.mode})).map((e=>{let[t]=e;return t})),[v,I]=s.default.useState(!1),y=(0,r.okeys)(l.outputs),b=s.default.useCallback((e=>{p({...l,id:e})}),[l,p]),C=s.default.useCallback((e=>{let t=e?e.split(","):void 0;"[]"===e&&(t=[]),console.log(e,t),p({...l,completionOutputs:t})}),[l,p]),P=s.default.useCallback((e=>{let t=e?e.split(","):void 0;p({...l,reactiveInputs:t})}),[l,p]),_=s.default.useCallback(((e,t)=>{const n=(0,u.default)(l,(n=>{n.inputs[e]=(0,r.partInput)(t)}));p(n)}),[l,p]),x=s.default.useCallback((e=>{const t=(0,u.default)(l,(t=>{delete t.inputs[e]}));p(t)}),[l,p]),j=s.default.useCallback((e=>{const t=(0,u.default)(l,(t=>{t.outputs[e]=(0,r.partOutput)()}));p(t)}),[l,p]),w=s.default.useCallback((e=>{const t=(0,u.default)(l,(t=>{delete t.outputs[e]}));p(t)}),[l,p]);s.default.useCallback((e=>{try{const t=JSON.parse(e),n=(0,u.default)(l,(e=>{Object.entries(t).forEach((t=>{let[n,o]=t;const i=e.inputs[n],s=e.outputs[n];i?e.inputs[n]={...i}:s&&(e.outputs[n]={...s})}))}));p(n)}catch(t){console.error("cannot parse")}}),[p,l]);return(0,i.jsxs)("div",{className:"base-part-editor",children:[(0,i.jsx)("div",{className:"form-row",children:(0,i.jsx)(a.FormGroup,{label:"Part Name",labelFor:"text-input",labelInfo:"(required)",children:(0,i.jsx)(a.InputGroup,{id:"part-name",disabled:e.idDisabled,placeholder:"Part ID",value:l.id,onChange:e=>b(e.target.value)})})}),(0,i.jsx)(a.FormGroup,{label:"Required Inputs",children:(0,i.jsx)(d,{selectedItems:m,placeholder:"Enter input names here",items:[],tagRenderer:e=>e,onItemSelect:e=>_(e,"required"),onRemove:x,resetOnSelect:!0,itemRenderer:e=>(0,i.jsx)("span",{children:e}),createNewItemFromQuery:e=>e,createNewItemRenderer:t.renderCreateIOOption,fill:!0})}),!0!==e.hiddenOutputs?(0,i.jsx)(a.FormGroup,{label:"Outputs",children:(0,i.jsx)(d,{selectedItems:y,placeholder:"Enter output names here",items:[],tagRenderer:e=>e,onItemSelect:j,onRemove:w,resetOnSelect:!0,itemRenderer:e=>(0,i.jsx)("span",{children:e}),createNewItemFromQuery:e=>e,createNewItemRenderer:t.renderCreateIOOption,fill:!0})}):null,(0,i.jsx)(a.Checkbox,{checked:v,onChange:e=>I(e.target.checked),children:"Show advanced options"}),(0,i.jsxs)(a.Collapse,{isOpen:v,children:[(0,i.jsx)(a.FormGroup,{label:"Optional Inputs",children:(0,i.jsx)(d,{selectedItems:g,placeholder:"Enter input names here",items:[],tagRenderer:e=>e,onItemSelect:e=>_(e,"optional"),onRemove:x,resetOnSelect:!0,itemRenderer:e=>(0,i.jsx)("span",{children:e}),createNewItemFromQuery:e=>e,createNewItemRenderer:t.renderCreateIOOption,fill:!0})}),(0,i.jsx)(a.FormGroup,{label:"Required-if-connected Inputs",children:(0,i.jsx)(d,{selectedItems:h,placeholder:"Enter input names here",items:[],tagRenderer:e=>e,onItemSelect:e=>_(e,"required-if-connected"),onRemove:x,resetOnSelect:!0,itemRenderer:e=>(0,i.jsx)("span",{children:e}),createNewItemFromQuery:e=>e,createNewItemRenderer:t.renderCreateIOOption,fill:!0})}),(0,i.jsx)(a.FormGroup,{label:"Completion Outputs",children:(0,i.jsx)(a.InputGroup,{id:"completion-outputs",placeholder:"completion outputs",value:(null===(n=l.completionOutputs)||void 0===n?void 0:n.join(","))||"",onChange:e=>C(e.target.value)})}),(0,i.jsx)(a.FormGroup,{label:"Reactive Inputs",children:(0,i.jsx)(a.InputGroup,{id:"reactive-inputs",placeholder:"Reactive inputs",value:(null===(o=l.reactiveInputs)||void 0===o?void 0:o.join(","))||"",onChange:e=>P(e.target.value)})})]}),(0,i.jsx)(a.FormGroup,{label:"Preview",children:(0,i.jsx)("div",{className:"preview-wrapper",children:(0,i.jsx)(c.PartPreview,{part:l})})})]})}},91028:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.metaChange=t.functionalChange=void 0;t.functionalChange=e=>({type:"functional",message:e});t.metaChange=function(e){return void 0===e&&(e="n/a"),{type:"meta",message:e}}},12934:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InlineCodeModal=void 0;const a=n(20264),u=s(n(49231)),l=r(n(57706)),c=n(51857),d=r(n(65443)),p=n(18841),f=n(14376),m=n(28186),g="`Result is ${inputs.a + inputs.b}`";t.InlineCodeModal=u.memo((function(e){const{initialValue:t,initialType:n}=e,[o,i]=u.useState((0,f.isDefined)(t)?t:g),[s,r]=u.useState(n||f.InlineValuePartType.VALUE),h=(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:['You can add variables to by referrencing the "inputs" object.',(0,a.jsx)("br",{})," For example:",(0,a.jsx)(c.Code,{children:"`Hello {inputs.name}`"}),' will expose an input pin named "name"']}),(0,a.jsxs)("p",{children:["You can also use ternery expressions, arithmetic operators and more!",(0,a.jsx)("br",{}),"For example:",(0,a.jsx)(c.Code,{children:"inputs.a > inputs.b ? inputs.a + 42 : Math.random() * inputs.b"})]})]}),v=(0,a.jsxs)("span",{children:["Type in any valid JS value, such as ",(0,a.jsx)(c.Code,{children:"true"}),", ",(0,a.jsx)(c.Code,{children:"42"}),","," ",(0,a.jsx)(c.Code,{children:'["bob", "alice", "dave"]'}),".",(0,a.jsx)("br",{})," Dynamic inputs may also be used"]}),I=(0,a.jsxs)("span",{children:["Write any JS code and return a value.",(0,a.jsx)("br",{})," The returned value will be the output.",(0,a.jsx)("br",{})," Example:",(0,a.jsx)(c.Code,{children:"const a = inputs.a; const b = inputs.b; return Math.floor(a/b);"})]}),y=(0,p.getVariables)(o);return u.useEffect((()=>{o===g&&s===f.InlineValuePartType.FUNCTION&&i("return "+g),o==="return "+g&&s===f.InlineValuePartType.VALUE&&i(g)}),[o,s]),(0,a.jsxs)(c.Dialog,{isOpen:!0,title:"Inline Value / Code",onClose:e.onCancel,className:"inline-code-modal",children:[(0,a.jsxs)("main",{className:(0,d.default)(c.Classes.DIALOG_BODY),onKeyDown:t=>{"Enter"===t.key&&t.metaKey&&e.onSubmit(s,o)},tabIndex:0,children:[(0,a.jsxs)(c.RadioGroup,{inline:!0,onChange:e=>r(e.target.value),selectedValue:s,children:[(0,a.jsx)(c.Radio,{labelElement:(0,a.jsxs)(u.Fragment,{children:["Value"," ",(0,a.jsx)(m.Tooltip2,{content:v,placement:"top",children:(0,a.jsx)(c.Icon,{icon:"info-sign",intent:"primary"})})]}),value:f.InlineValuePartType.VALUE}),(0,a.jsx)(c.Radio,{labelElement:(0,a.jsxs)(u.Fragment,{children:["Function"," ",(0,a.jsx)(m.Tooltip2,{content:I,placement:"top",children:(0,a.jsx)(c.Icon,{icon:"info-sign",intent:"primary"})})]}),value:f.InlineValuePartType.FUNCTION})]}),(0,a.jsx)(l.default,{height:"80px",theme:"vs-dark",defaultLanguage:"javascript",value:o,onChange:e=>i(e||""),onMount:e=>{e&&e.updateOptions({lineNumbers:"off",minimap:{enabled:!1}})}}),(()=>{const e=o.includes("return");return e&&s===f.InlineValuePartType.VALUE?(0,a.jsx)(c.Callout,{intent:c.Intent.WARNING,children:'When using the "value" type you are not expected to return anything'}):e||s!==f.InlineValuePartType.FUNCTION?null:(0,a.jsxs)(c.Callout,{intent:c.Intent.DANGER,children:['When using the "function" type you are expected to'," ",(0,a.jsx)(c.Code,{children:"return"})," a value.",(0,a.jsx)("br",{}),"Example: ",(0,a.jsx)(c.Code,{children:"return 42 + Date.now();"})]})})(),(0,a.jsxs)(c.Callout,{intent:c.Intent.NONE,children:["Input pins detected:"," ",y.length?y.map((e=>(0,a.jsx)(c.Code,{children:e},e))):"None",(0,a.jsx)(m.Tooltip2,{content:h,children:(0,a.jsx)(c.Icon,{icon:"info-sign",intent:c.Intent.PRIMARY})})]})]}),(0,a.jsx)("div",{className:c.Classes.DIALOG_FOOTER,children:(0,a.jsxs)("div",{className:c.Classes.DIALOG_FOOTER_ACTIONS,children:[(0,a.jsx)(c.Button,{onClick:e.onCancel,children:"Cancel"}),(0,a.jsx)(c.Button,{onClick:()=>e.onSubmit(s,o),intent:c.Intent.PRIMARY,className:"save-btn",children:"Save"})]})})]})}))},51743:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(12934),t)},18841:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInlineValuePart=t.getVariables=void 0;const o=n(14376),i=n(14376);t.getVariables=e=>(e.match(/inputs\.([a-zA-Z]\w*)/g)||[]).map((e=>e.replace(/inputs\./,"")));t.createInlineValuePart=e=>{let{code:n,customView:s,partId:r,type:a}=e;const u=(0,t.getVariables)(n).reduce(((e,t)=>({...e,[t]:(0,o.partInput)()})),{}),l={value:(0,o.partOutput)()},c=a===o.InlineValuePartType.FUNCTION?"const result = (function() { "+n+"}());\n  Promise.resolve(result).then(val => outputs.value.next(val))":"const result = ("+n+"); Promise.resolve(result).then(val => outputs.value.next(val))",d=btoa(n);return(0,i.inlineValuePart)({id:r||"Inline Code "+(0,o.randomInt)(99999),inputs:u,outputs:l,runFnRawCode:c,customViewCode:s||n,dataBuilderSource:d,templateType:a,completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}},description:"Custom inline "+(a===o.InlineValuePartType.VALUE?"value":"function")})}},7936:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Omnibar=t.OmniBarCmdType=void 0;const a=n(20264),u=s(n(49231)),l=n(7586),c=n(14376),d=n(51857),p=r(n(65443));var f;!function(e){e.ADD="add",e.ADD_VALUE="add-value",e.IMPORT="import"}(f=t.OmniBarCmdType||(t.OmniBarCmdType={}));const m=[];t.Omnibar=e=>{const{resolvedParts:t}=e,[n,o]=u.useState(""),[i,s]=u.useState(null),[r,g]=u.useState([]);u.useEffect((()=>{const e=(0,c.keys)(t).map((e=>({title:""+t[e].id,cmd:{type:f.ADD,data:e},extra:"current flow"}))),n=r.map((e=>({title:""+e.part.id,description:e.part.description,cmd:{type:f.IMPORT,data:e},extra:""+e.module}))),o={title:"Add inline value or code",suggestOnEmpty:!0,cmd:{type:f.ADD_VALUE}},i=[...m,...n,o,...e];s(i)}),[t,r]),u.useEffect((()=>{e.onRequestImportables&&e.onRequestImportables(n).then((e=>{g(e)}))}),[e,n]);const h=u.useCallback(((e,t)=>{let{handleClick:n,modifiers:o,query:i,index:s}=t;if(!o.matchesPredicate)return null;const r=""+e.title;return(0,a.jsx)(d.MenuItem,{active:o.active,disabled:o.disabled,onClick:n,text:(0,a.jsxs)("div",{className:(0,p.default)("omnibar-item",{active:o.active}),children:[(0,a.jsxs)("div",{className:"title",children:[r," ",e.extra?(0,a.jsx)("span",{className:"extra",children:e.extra}):null]}),e.description?(0,a.jsx)("div",{className:"description",children:e.description}):null]})},s)}),[]),v=u.useCallback(((e,t)=>{const n=e.toLowerCase().split("").map((e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+".*")).join(""),o=new RegExp(n);return!!t.title.toLowerCase().match(o)}),[]),I=u.useCallback((t=>{e.onCommand(t.cmd),e.onClose()}),[e]);return i?(0,a.jsx)(l.Omnibar,{query:n,onQueryChange:o,onClose:e.onClose,noResults:(0,a.jsx)(d.MenuItem,{disabled:!0,text:"No results."}),itemPredicate:v,isOpen:e.visible,items:i,initialContent:void 0,onItemSelect:I,itemRenderer:h,inputProps:{placeholder:"Search for parts or commands.."}}):null}},37866:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},68870:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(78409),t)},78409:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.usePorts=t.useConfirm=t.usePrompt=t.PortsContext=t.defaultPorts=void 0;const s=n(49231);i(n(37866),t);const r=async()=>{throw new Error("Not implemented")};t.defaultPorts={prompt:async e=>{let{text:t,defaultValue:n}=e;return prompt(""+t,n)},openFile:async e=>{},confirm:async e=>{let{text:t}=e;return confirm(t)},readFlow:r,setFlow:r,resolveDeps:r,getImportables:r,onExternalFlowChange:r,onInstallRuntimeRequest:r,onRunFlow:r,onStopFlow:r,reportEvent:r,generatePartFromPrompt:r,hasOpenAiToken:()=>Promise.resolve(!1)},t.PortsContext=(0,s.createContext)(t.defaultPorts);t.usePrompt=()=>{const e=(0,s.useContext)(t.PortsContext).prompt;return(t,n)=>e({text:t,defaultValue:n})};t.useConfirm=()=>{const e=(0,s.useContext)(t.PortsContext).confirm;return t=>e({text:t})};t.usePorts=()=>(0,s.useContext)(t.PortsContext)},38300:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.groupSelected=void 0;const i=n(14376),s=o(n(53865)),r=n(71103);t.groupSelected=async(e,t,n,o,a)=>{const{instances:u,connections:l}=t,c=u.filter((t=>e.includes(t.id))),d=l.filter((t=>{let{from:n,to:o}=t;return-1!==e.indexOf(n.insId)||-1!==e.indexOf(o.insId)}));if(!c.length)throw new Error("visual without selections");const{visualPart:p,renamedInputs:f,renamedOutputs:m}=await(0,r.createGroup)(c,d,n,a),g=c.reduce(((e,t)=>(0,i.middlePos)(t.pos,e)),u[0].pos),h="ref"===o?(0,i.partInstance)((0,i.createInsId)(p),p.id,{},g):(0,i.inlinePartInstance)((0,i.createInsId)(p),p,{},g),v=u.filter((t=>-1===e.indexOf(t.id))),I=l.map((e=>{const t=e.from.insId+"."+e.from.pinId,n=e.to.insId+"."+e.to.pinId;return f[n]?{...e,to:{insId:h.id,pinId:f[n]}}:m[t]?{...e,from:{insId:h.id,pinId:m[t]}}:e})).filter((t=>-1===e.indexOf(t.from.insId)&&-1===e.indexOf(t.to.insId)));return{newPart:p,currentPart:(0,s.default)(t,(e=>{e.instances=[...v,h],e.connections=I}))}}},44108:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(69200),t),i(n(75219),t),i(n(23015),t),i(n(12623),t),i(n(14957),t),i(n(91028),t),i(n(18699),t),i(n(55266),t),i(n(55066),t),i(n(50385),t),i(n(19555),t),i(n(95763),t),i(n(81653),t),i(n(59429),t),i(n(13328),t),i(n(43925),t),i(n(98582),t)},76055:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfoTooltip=void 0;const o=n(20264),i=n(51857),s=n(28186);t.InfoTooltip=e=>{const{content:t}=e;return(0,o.jsx)(s.Tooltip2,{content:t,placement:"top",className:"info-tooltip",children:(0,o.jsx)(i.Icon,{icon:"info-sign",intent:"primary",className:"info-tooltip-icon"})})}},92169:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserOnlyReactJson=void 0;const o=n(20264);t.BrowserOnlyReactJson=e=>{if("undefined"==typeof window)return null;const t=n(86510).default;return(0,o.jsx)(t,{...e})}},19555:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsValueRenderer=void 0;const o=n(20264),i=n(14376),s=n(92169);t.AnalyticsValueRenderer=e=>{let{val:t}=e;try{const e=JSON.parse(t),n="object"==typeof e?e:{value:e},r=e&&[e.type,e.key,e.props,e.ref].every(i.isDefined),a=r?{jsxValue:e}:n;return(0,o.jsx)(s.BrowserOnlyReactJson,{src:a,name:!1,collapseStringsAfterLength:50,groupArraysAfterLength:5,collapsed:r})}catch(n){return(0,o.jsx)(s.BrowserOnlyReactJson,{src:{value:t},name:!1,collapseStringsAfterLength:50,groupArraysAfterLength:5})}}},71103:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGroup=void 0;const o=n(14376),i=n(14376),s=n(59429),r=n(68122);t.createGroup=async(e,t,n,a)=>{if(0===e.length)throw new Error("cannot create group without instances");const u=e.map((e=>e.id)),l=t.filter((e=>{const t=u.includes(e.from.insId),n=u.includes(e.to.insId);return!t&&n})).filter(((e,t,n)=>n.findIndex((t=>(0,i.connectionNodeEquals)(t.to,e.to)))===t)),c=t.filter((e=>{const t=u.includes(e.from.insId),n=u.includes(e.to.insId);return t&&!n})).filter(((e,t,n)=>n.findIndex((t=>(0,i.connectionNodeEquals)(t.from,e.from)))===t));let d={},p={},f={},m={};const g=[],h={};for(const o of l){const e=o.to.insId+"."+o.to.pinId,t=o.from.insId+"."+o.from.pinId,n=o.to.pinId;if(f[t]){g.push({from:(0,i.externalConnectionNode)(f[t]),to:(0,i.connectionNode)(o.to.insId,o.to.pinId)});continue}const r=h[n]?await a("Name this input ("+n+" of "+o.to.insId+") is already taken:")||"i"+(0,s.rnd)():n;d[e]=r,f[t]=r,g.push({from:(0,i.externalConnectionNode)(r),to:(0,i.connectionNode)(o.to.insId,o.to.pinId)}),h[r]=(0,i.partInput)()}const v={};for(const r of c){const e=r.to.insId+"."+r.to.pinId,t=r.from.insId+"."+r.from.pinId,n=r.from.pinId;if(m[e]){g.push({from:(0,i.connectionNode)(r.from.insId,r.from.pinId),to:(0,i.externalConnectionNode)(m[e])});continue}const u=v[n]?await a("Name this output ("+n+" of "+r.from.insId+" is already taken:")||"i"+(0,s.rnd)():n;p[t]=u,m[e]=u,g.push({from:(0,i.connectionNode)(r.from.insId,r.from.pinId),to:(0,i.externalConnectionNode)(u)}),v[u]=(0,o.partOutput)()}e.reduce(((e,t)=>(0,i.middlePos)(t.pos,e)),e[0].pos);const I=t.filter((e=>u.includes(e.from.insId)&&u.includes(e.to.insId)));return{visualPart:{id:n,inputs:h,outputs:v,instances:e,defaultStyle:{size:"large",color:(0,o.pickRandom)(r.partStylePresetColors.map((e=>e.color)))},inputsPosition:(0,o.okeys)(h).reduce(((e,t,n)=>({...e,[t]:{x:0+100*n,y:0}})),{}),outputsPosition:(0,o.okeys)(v).reduce(((e,t,n)=>({...e,[t]:{x:0+100*n,y:400}})),{}),connections:[...I,...g],completionOutputs:(0,o.okeys)(v)},renamedInputs:d,renamedOutputs:p}}},55066:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.highlightText=void 0;const o=n(20264);function i(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}t.highlightText=(e,t)=>{let n=0;const s=t.split(/\s+/).filter((e=>e.length>0)).map(i);if(0===s.length)return[e];const r=new RegExp(s.join("|"),"gi"),a=[];for(;;){const t=r.exec(e);if(!t)break;const i=t[0].length,s=e.slice(n,r.lastIndex-i);s.length>0&&a.push(s),n=r.lastIndex,a.push((0,o.jsx)("strong",{children:t[0]},n))}const u=e.slice(n);return u.length>0&&a.push(u),a}},14957:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Loader=void 0;const i=n(20264),s=o(n(26031));t.Loader=()=>(0,i.jsx)(s.default,{type:"ball-clip-rotate",active:!0})},98582:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logger=void 0;const o=n(14376);t.logger=(0,o.debugLogger)("editor")},96529:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.preloadMonaco=void 0;const o=n(57706),i=n(98582);let s=!1;t.preloadMonaco=()=>{s||o.loader.init().then((()=>{(0,i.logger)("monaco preloaded"),s=!0}))}},50385:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useHotkeys=t.currentHotkeys=void 0;const i=o(n(97219)),s=n(49231);t.currentHotkeys=new Map,t.useHotkeys=function(e,n,o,r,a){void 0===r&&(r=[]);const u=(0,s.useCallback)((function(){a&&!a.current||n(...arguments)}),[...r,n]);(0,s.useEffect)((()=>((0,i.default)(e,{},u),t.currentHotkeys.set(e,o),()=>{t.currentHotkeys.delete(e),i.default.unbind(e,u)})),[e,u,o])}},81653:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeSessionStorage=t.safeLocalStorage=void 0,t.safeLocalStorage={getItem:function(){try{return localStorage.getItem(...arguments)}catch(e){return null}},setItem:function(){try{return localStorage.setItem(...arguments)}catch(e){return null}}},t.safeSessionStorage={getItem:function(){try{return sessionStorage.getItem(...arguments)}catch(e){return null}},setItem:function(){try{return sessionStorage.setItem(...arguments)}catch(e){return null}}}},62674:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CustomReactTooltip=void 0;const i=n(20264),s=n(49231),r=o(n(64151)),a=o(n(17853));function u(e){let{children:t,domNode:n}=e;return r.default.createPortal(t,n)}t.CustomReactTooltip=e=>{const t=(0,s.useRef)();return(0,s.useEffect)((()=>{t.current=document.createElement("div"),document.body.appendChild(t.current)}),[]),t.current?(0,i.jsx)(u,{domNode:t.current,children:(0,i.jsx)(a.default,{effect:"solid",...e})}):null},t.default=t.CustomReactTooltip},23015:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.useLocalStorage=t.useResizePref=t.userPreferences=t.useUserPref=void 0;const r=s(n(49231)),a=n(75219),u=n(81653);t.useUserPref=(e,n)=>{const[o,i]=r.useState((()=>{const o=t.userPreferences.getItem(e);return(0,a.isDefined)(o)?o:n}));r.useEffect((()=>{const o=t.userPreferences.getItem(e),s=(0,a.isDefined)(o)?o:n;i(s)}),[e]);return[o,n=>{t.userPreferences.setItem(e,n),console.log("Saved",e,n),i(n)}]},t.userPreferences=(()=>{const e=e=>"up."+e;return{getItem:t=>{const n=u.safeLocalStorage.getItem(e(t))||"",o=u.safeSessionStorage.getItem(e(t))||"";try{return JSON.parse(o||n).value}catch(i){return}},setItem:function(t,n,o){void 0===o&&(o=!1);const i=o?sessionStorage:u.safeLocalStorage;try{const o=JSON.stringify({value:n});return i.setItem(e(t),o),!0}catch(s){return console.error("Error saving user preference",s),!1}}}})();t.useResizePref=(e,n)=>{const o="resize."+e;return(0,t.useUserPref)(o,n)};const l=e=>{const t=u.safeLocalStorage.getItem(e);if(!t)return null;try{return JSON.parse(t).value}catch(n){return null}};t.useLocalStorage=(e,t)=>{const[n,o]=r.useState(l(e)||t),i=r.useCallback((t=>{u.safeLocalStorage.setItem(e,JSON.stringify({value:t})),o(t)}),[e]);return r.useEffect((()=>{l(e)||u.safeLocalStorage.setItem(e,JSON.stringify({value:t}))}),[e,t,i]),[n,i]}},59429:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.totalEnergy=t.itrPhysics=t.hookes=t.coulombs=t.vToStr=t.vNorm=t.vLen=t.vSub=t.vAdd=t.vDiv=t.vMul=t.vZero=t.rnd=t.vec=t.size=void 0;t.size=(e,t)=>({width:e,height:t});t.vec=(e,t)=>({x:e,y:t});t.rnd=function(e,t){return void 0===e&&(e=100),void 0===t&&(t=0),Math.floor(Math.random()*(e-t))+t},t.vZero={x:0,y:0};t.vMul=(e,t)=>{let{x:n,y:o}=e;return{x:n*t,y:o*t}};t.vDiv=(e,n)=>{let{x:o,y:i}=e;return(0,t.vMul)({x:o,y:i},1/n)};t.vAdd=(e,t)=>({x:e.x+t.x,y:e.y+t.y});t.vSub=(e,n)=>(0,t.vAdd)(e,(0,t.vMul)(n,-1));t.vLen=e=>{let{x:t,y:n}=e;return Math.sqrt(t*t+n*n)};t.vNorm=e=>(0,t.vDiv)(e,(0,t.vLen)(e)||1);t.vToStr=e=>{let{x:t,y:n}=e;return t.toFixed(1)+","+n.toFixed(1)};t.coulombs=(e,n,o)=>{const i=(0,t.vLen)((0,t.vSub)(e.p,n.p));if(0===i){const i=(0,t.vec)(2*Math.random()-1,2*Math.random()-1),s=e.m*n.m/Math.pow(10,2);return(0,t.vMul)(i,s*o)}{const s=(0,t.vNorm)((0,t.vSub)(n.p,e.p)),r=e.m*n.m/Math.pow(i+.1,2);return(0,t.vMul)(s,r*o)}};t.hookes=(e,n,o,i,s)=>{const r=(0,t.vLen)((0,t.vSub)(e.p,n.p)),a=(0,t.vNorm)((0,t.vSub)(e.p,n.p));let u=0;return r<o?u=o-r:r>i&&(u=i-r),(0,t.vMul)(a,s*u)};t.itrPhysics=(e,n)=>{const{p:o,v:i,f:s,m:r}=n,a=(0,t.vDiv)(s,r),u=e/1e3,l=(0,t.vAdd)((0,t.vMul)(a,u),i),c=(0,t.vAdd)((0,t.vMul)(l,u),o);return{...n,p:c,v:l,f:(0,t.vec)(0,0)}};t.totalEnergy=e=>e.reduce(((e,n)=>{const o=(0,t.vLen)(n.v);return e+.5*n.m*o*o}),0)},12623:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateToast=t.toastMsg=t.AppToaster=void 0;const o=n(51857);t.AppToaster=(()=>{try{return o.Toaster.create({className:"app-toaster",position:o.Position.BOTTOM_RIGHT})}catch(e){return{}}})();t.toastMsg=(e,n,o)=>t.AppToaster.show({message:e,intent:n,timeout:o});t.updateToast=(e,n,o)=>t.AppToaster.show({message:n,intent:o},e)},75219:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.preventDefaultAnd=t.isLocal=t.fullTime=t.timeAgoFromDt=t.timeAgo=t.toString=t.isDefined=t.set=t.createOmap=t.toOmap=t.values=t.keys=t.entries=void 0;const i=n(43925),s=n(14376),r=o(n(36622));t.entries=e=>Object.keys(e).map((t=>[t,e[t]]));t.keys=e=>Object.keys(e);t.values=e=>Object.keys(e).map((t=>e[t]));t.toOmap=e=>Array.from(e.entries()).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o}}),{});t.createOmap=function(e){return void 0===e&&(e=[]),e.reduce(((e,t)=>({...e,[t[0]]:t[1]})),{})};t.set=(e,t,n)=>{e[t]=n};t.isDefined=e=>void 0!==e;t.toString=e=>{const t=typeof e;if(""===e)return"(empty string)";if((0,i.isJsxValue)(e))return"JSX Value";if((0,s.isStaticValueVisualPart)(e))return"Embedded Part";if((0,s.isEnvValue)(e))return(0,s.getEnvKeyFromValue)(e);if("object"===t)try{const t=JSON.stringify(e);return"{}"===t?"Empty object":t}catch(n){return"Object (cannot stringify)"}return""+e};t.timeAgo=e=>(0,r.default)(new Date(e)).fromNow();t.timeAgoFromDt=e=>(0,r.default)(Date.now()-e).fromNow();t.fullTime=e=>(0,r.default)(new Date(e)).toString();t.isLocal=()=>location.href.includes(":300");t.preventDefaultAnd=e=>t=>{t.preventDefault(),e(t)}},16391:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ActionButton=t.ActionsMenu=t.ActionType=void 0;const r=n(20264),a=n(51857),u=n(28186),l=n(14376),c=s(n(49231)),d=n(69381),p=n(68870),f=n(50385),m=n(23015),g=n(12623),h=n(16213),v=n(1171),I=n(96749),y=n(22305);var b;!function(e){e.AddPart="add-part",e.RemovePart="remove-part",e.Group="group",e.UnGroup="un-group",e.AddInlineValue="add-inline-value",e.Inspect="inspect",e.Run="run",e.AI="ai"}(b=t.ActionType||(t.ActionType={}));t.ActionsMenu=e=>{const{onAction:n,selectedInstances:o,resolvedParts:i,part:s,from:u,to:v,hotkeysEnabled:P,showRunFlowOptions:_}=e,{onRequestImportables:x}=(0,d.useDependenciesContext)(),[j,w]=c.default.useState(!1),[O,E]=c.default.useState(!1),[D,M]=c.default.useState(!1),[S,N]=c.default.useState(null),[k,T]=(0,m.useLocalStorage)("hideHotkeyHintMap",{}),R=(0,c.useCallback)((()=>{w(!1)}),[]),{onRunFlow:V,generatePartFromPrompt:A}=(0,p.usePorts)(),z=(0,c.useCallback)((e=>(E(!1),V(e))),[V]),H=[];if(H.push(b.AddPart),H.push(b.AddInlineValue),1===o.length){const e=s.instances.find((e=>e.id===o[0]));if(e)try{const t=(0,l.getPartDef)(e,i);(0,l.isVisualPart)(t)&&H.push(b.UnGroup)}catch(U){console.error("Could not find part with id "+o[0]+" - "+U)}else console.error("Could not find instance with id "+o[0])}_&&H.push(b.Run),o.length>0&&H.push(b.Group),(1===o.length||u||v)&&H.push(b.Inspect),o.length>0&&H.push(b.RemovePart),H.push(b.AI);const G=(0,c.useCallback)(((e,t)=>{T({...k,[e]:!0}),g.AppToaster.dismiss(t)}),[k,T]),L=(0,c.useCallback)(((e,t)=>{const{hotkey:o}=C[e];if("click"===t.type&&o&&!k[o]){const t=(0,g.toastMsg)((0,r.jsxs)(r.Fragment,{children:["Did you know? you can also use the hotkey"," ",(0,r.jsx)("kbd",{className:"hotkey",children:o})," to"," ",C[e].text.replace(/^[A-Z]/,(e=>e.toLowerCase())),(0,r.jsxs)(a.Button,{minimal:!0,small:!0,onClick:()=>G(o,t),children:[" ","Don't show again"," "]})]}),"none",3e3)}switch(e){case b.AddPart:w(!0);break;case b.Run:!async function(){Object.keys(s.inputs).length>0?E(!0):V({})}();break;case b.AI:M(!0);break;default:n({type:e,data:void 0})}}),[k,n,G,V,s.inputs]);Object.entries(C).forEach((e=>{let[t,n]=e;n.hotkey&&(0,f.useHotkeys)(n.hotkey,(e=>{e.preventDefault(),H.includes(t)&&(L(t,e),T({...k,[n.hotkey]:!0}))}),{text:n.text,group:"Action menu hotkeys"},[H],P)}));const B=(0,c.useCallback)((e=>{n({type:b.AddPart,data:{importablePart:e}})}),[n]),F=(0,c.useCallback)((async e=>{N(Date.now());try{const t=await A({prompt:e});N(null),n({type:b.AI,data:t}),M(!1)}catch(U){N(null),g.AppToaster.show({message:"Failed to generate part",intent:"danger"})}}),[A,n]);return(0,r.jsxs)("div",{className:"actions-menu",children:[H.map((e=>(0,r.jsx)(t.ActionButton,{type:e,onClick:L},e))),j?(0,r.jsx)(h.AddPartMenu,{onRequestImportables:x,onAddPart:B,onClose:R}):null,O?(0,r.jsx)(y.RunFlowModal,{onClose:()=>E(!1),onRun:z,part:s}):null,D?(0,r.jsx)(I.PromptAIMenu,{onClose:()=>{M(!1),N(null)},onSubmit:F,submitting:null!==S,submitTime:S}):null]})};const C={[b.AddPart]:{icon:v.addPartIcon,text:'Open the "add part" menu',hotkey:"a"},[b.RemovePart]:{icon:v.removePartIcon,text:"Remove selected instances",hotkey:"backspace"},[b.Group]:{icon:v.groupIcon,text:"Group selection into a new part",hotkey:"g"},[b.UnGroup]:{icon:v.ungroupIcon,text:"Ungroup selected visual part"},[b.Inspect]:{icon:v.inspectIcon,text:"Inspect data",hotkey:"i"},[b.AddInlineValue]:{icon:v.pencilIcon,text:"Add value / inline function",hotkey:"v"},[b.Run]:{icon:v.playIcon,text:"Run flow",hotkey:"r"},[b.AI]:{icon:v.starIcon,text:"Generate new code part using AI \u2728"}},P={icon:"",text:"N/A",hotkey:void 0};t.ActionButton=e=>{var t;const{onClick:n,type:o}=e,i=(0,c.useCallback)((e=>n(o,e)),[n,o]),s=null!==(t=C[o])&&void 0!==t?t:P,a=s.hotkey?(0,r.jsxs)("span",{children:[s.text," ",(0,r.jsx)("kbd",{className:"hotkey",children:s.hotkey})]}):s.text;return(0,r.jsx)("div",{className:"action-button",onClick:i,children:(0,r.jsx)(u.Tooltip2,{hoverOpenDelay:100,content:a,className:"icon-wrapper",popoverClassName:"action-button-tooltip",children:(0,r.jsx)("span",{dangerouslySetInnerHTML:{__html:s.icon}})})})}},18718:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AddPartMenu=t.AddPartMenuFilterTree=void 0;const a=n(20264),u=n(51857),l=n(28186),c=n(14376),d=r(n(65443)),p=s(n(49231)),f=n(68870),m=n(76055),g=n(14957),h=n(97047),v=n(89638);t.AddPartMenuFilterTree=u.Tree.ofType();function I(e,t,n){return[...e.external.map((e=>({id:e.module,label:e.module,hasCaret:!0,nodeData:{type:"external",module:e.module},isSelected:"external"===(null==t?void 0:t.type)&&t.module===e.module,isExpanded:n.has(e.module),childNodes:e.namespaces.map((o=>({id:e.module+"/"+o,label:o,hasCaret:!1,isSelected:"external"===(null==t?void 0:t.type)&&t.module===e.module&&t.namespace===o,isExpanded:n.has(e.module+"/"+o),nodeData:{type:"external",module:e.module,namespace:o}})))}))),{id:"internal",label:"Current Project",nodeData:{type:"internal"},isExpanded:n.has("internal"),hasCaret:!0,isSelected:"internal"===t.type,childNodes:e.internal.files.map((e=>({id:e,label:e,isSelected:"internal"===t.type&&t.file===e,hasCaret:!1,isExpanded:n.has(e),nodeData:{type:"internal",file:e}})))}]}function y(e){return/\.flyde(\.[jt]s)?$/.test(e.module)}t.AddPartMenu=e=>{const{onRequestImportables:n,onAddPart:o,onClose:i}=e,[s,r]=p.default.useState(),[b,C]=p.default.useState([]),[P,_]=p.default.useState(new Set),[x,j]=p.default.useState(""),[w,O]=p.default.useState({type:"all"}),[E,D]=p.default.useState(null),[M,S]=p.default.useState(null),[N,k]=p.default.useState(null),T=(0,p.useCallback)((e=>{P.add(e.id),_(new Set(P))}),[P]),R=(0,p.useCallback)((e=>{P.delete(e.id),_(new Set(P))}),[P]),V=(0,p.useCallback)((e=>{o(e),i()}),[o,i]),{onInstallRuntimeRequest:A,reportEvent:z}=(0,f.usePorts)();(0,p.useEffect)((()=>{z("addPartMenuOpen",{})}),[z]),(0,p.useEffect)((()=>{S(null==s?void 0:s.flatMap((e=>{var t,n,o;if(w)if("external"===w.type){if((e.module!==w.module||w.namespace)&&e.part.namespace!==w.namespace)return[]}else if("internal"===w.type&&(!y(e)||w.file&&e.module!==w.file))return[];if(x){const i=((null!==(n=null===(t=e.part.searchKeywords)||void 0===t?void 0:t.join(" "))&&void 0!==n?n:[])+" "+e.part.id+" "+(null!==(o=e.part.namespace)&&void 0!==o?o:"")+" "+e.part.description).toLowerCase().indexOf(x.toLowerCase());return-1===i?[]:[{importable:e,score:i}]}return[{importable:e,score:1}]})).sort(((e,t)=>e.score-t.score)).map((e=>{let{importable:t}=e;return t})))}),[s,w,x]),(0,p.useEffect)((()=>{n().then((e=>{let{importables:t,errors:n}=e;C(n);const o=t.filter((e=>!y(e))).reduce(((e,t)=>{var n,o,i;null!==(n=e[i=t.module])&&void 0!==n||(e[i]=[]);const s=null!==(o=t.part.namespace)&&void 0!==o?o:"";return e[t.module].includes(s)||e[t.module].push(s),e}),{}),i=t.filter(y).map((e=>e.module));D({external:Object.entries(o).map((e=>{let[t,n]=e;return{module:t,namespaces:n}})),internal:{files:i}}),r(t),_(new Set(["internal",...Object.keys(o)]))}))}),[n]);const H=(0,p.useCallback)((e=>{switch(e.key){case"ArrowDown":case"ArrowUp":if(e.preventDefault(),M&&!N)return void k(M["ArrowDown"===e.key?0:M.length-1]);if(M&&N){const t=M.findIndex((e=>e===N));let n="ArrowDown"===e.key?t+1:t-1;n=n<0?M.length-1:n,n=n>=M.length?0:n,k(M[n])}break;case"Enter":N&&V(N)}}),[M,N,V]),G=(0,p.useCallback)((e=>{let{nodeData:t}=e;JSON.stringify(t)===JSON.stringify(w)?"external"===t.type?t.namespace?O({type:"external",module:t.module}):O({type:"all"}):"internal"===t.type&&(t.file?O({type:"internal"}):O({type:"all"})):O(t)}),[w]),L=!s||s.some((e=>e.module.includes("@flyde/stdlib"))),B=(0,p.useCallback)((()=>{A(),i()}),[i,A]);return(0,a.jsx)(u.Dialog,{isOpen:!0,title:"Add Part Menu",onClose:e.onClose,className:"add-part-menu",isCloseButtonShown:!0,children:(0,a.jsxs)("main",{className:(0,d.default)(u.Classes.DIALOG_BODY),children:[(0,a.jsxs)("header",{children:[(0,a.jsxs)("div",{className:"bp3-input-group",children:[(0,a.jsx)(u.Icon,{icon:"search"}),(0,a.jsx)("input",{className:"bp3-input",type:"search",placeholder:"Search input",dir:"auto",autoFocus:!0,onChange:e=>j(e.target.value),value:x,onKeyDown:H})]}),L?null:(0,a.jsxs)(u.Callout,{intent:u.Intent.NONE,style:{marginTop:10},children:["Using built-in @flyde/stdlib. It's recommended to explicitly install it instead."," ",(0,a.jsx)(u.Button,{minimal:!0,small:!0,intent:u.Intent.PRIMARY,onClick:B,children:"Click here to install it using npm/yarn"})]})]}),(0,a.jsx)("div",{className:"content-wrapper",children:s?(0,a.jsxs)(p.default.Fragment,{children:[(0,a.jsxs)("aside",{children:[(0,a.jsxs)("div",{className:"filter-header",children:["Filter by package"," ",(0,a.jsx)(l.Tooltip2,{content:(0,a.jsxs)("span",{children:["Click to learn more about how packages work in Flyde"," "]}),hoverCloseDelay:1500,children:(0,a.jsx)("a",{target:"_blank",href:"https://www.flyde.dev/docs/packages",rel:"noreferrer",children:(0,a.jsx)(u.Icon,{icon:"help",intent:"primary",iconSize:12})})})]}),(0,a.jsx)("div",{className:"tree-container",children:(0,a.jsx)(t.AddPartMenuFilterTree,{contents:I(E,w,P),onNodeCollapse:R,onNodeExpand:T,onNodeClick:G,className:u.Classes.ELEVATION_0})})]}),(0,a.jsx)("main",{children:M?0===M.length?(0,a.jsxs)("div",{className:"no-results",children:[(0,a.jsx)(v.AddPartMenuResultsSummary,{filter:w,onChangeFilter:O,query:x,onChangeQuery:j,resultsCount:M.length}),(0,a.jsxs)(u.Callout,{className:"callout",intent:"primary",children:["Can't find a suitable part? Create one yourself!"," ",(0,a.jsx)("a",{href:"https://www.flyde.dev/docs/code-parts",target:"_blank",rel:"noreferrer",children:"Learn more"})]})]}):(0,a.jsxs)(p.default.Fragment,{children:[(0,a.jsx)(v.AddPartMenuResultsSummary,{filter:w,onChangeFilter:O,query:x,onChangeQuery:j,resultsCount:M.length}),(0,a.jsx)("div",{className:"results",children:M.map((e=>(0,a.jsx)(h.AddPartMenuListItem,{importablePart:e,onAdd:V,selected:(null==N?void 0:N.part)===e.part,onSelect:k,onSetFilter:O},e.part.id+e.part.namespace+e.module)))})]}):(0,a.jsx)(g.Loader,{})})]}):(0,a.jsx)(g.Loader,{})}),b.length>0?(0,a.jsxs)(u.Callout,{intent:"warning",style:{marginTop:"10px"},children:["Found ",(0,c.simplePluralize)(b.length,"corrupt flow"),(0,a.jsx)(m.InfoTooltip,{content:b.map((e=>{let{path:t,message:n}=e;return t+": "+n})).join(", ")})," "]}):null]})})}},21773:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AddPartMenuListItem=void 0;const a=n(20264),u=n(51857),l=r(n(65443)),c=s(n(49231));t.AddPartMenuListItem=e=>{const{importablePart:t,onSetFilter:n,onAdd:o,onSelect:i}=e,{part:s,module:r}=t,{id:d,description:p}=s,f=c.default.useRef(null);c.default.useEffect((()=>{e.selected&&f.current&&f.current.scrollIntoView({block:"center"})}),[e.selected]);const m=(0,c.useCallback)((()=>{o(t)}),[o,t]),g=(0,c.useCallback)((()=>{i(t)}),[i,t]);return(0,a.jsxs)("div",{className:(0,l.default)("add-part-menu-list-item",{selected:e.selected}),ref:f,onClick:g,children:[(0,a.jsxs)("div",{className:"content",children:[(0,a.jsxs)("header",{children:[(0,a.jsx)("span",{className:"id",children:d}),(0,a.jsxs)(u.Tag,{interactive:!0,onClick:()=>n({type:"external",module:r,namespace:s.namespace}),className:"source",minimal:!0,children:[r,s.namespace?" / "+s.namespace:null]})]}),(0,a.jsx)("div",{className:"description",children:p||(0,a.jsx)("em",{children:"No description"})})]}),(0,a.jsx)("aside",{children:(0,a.jsx)(u.Button,{onClick:m,children:"Add"})})]})}},97047:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(21773),t)},29003:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddPartMenuResultsSummary=void 0;const o=n(20264),i=n(51857);t.AddPartMenuResultsSummary=e=>{const{resultsCount:t,query:n,filter:s,onChangeFilter:r,onChangeQuery:a}=e;return(0,o.jsxs)("div",{className:"add-part-menu-results-summary",children:[t?"Showing "+t+" result"+(t>1?"s":""):"No results found","\xa0",n?(0,o.jsxs)(o.Fragment,{children:["matching query\xa0",(0,o.jsxs)(i.Tag,{minimal:!0,interactive:!0,onRemove:()=>a(""),children:['"',n,'"']})]}):null,"all"===s.type?null:"external"===s.type?(0,o.jsxs)(o.Fragment,{children:["from \xa0",(0,o.jsxs)(i.Tag,{minimal:!0,interactive:!0,onRemove:()=>r({type:"all"}),children:["package ",s.module,s.namespace?" / "+s.namespace:null]})]}):(0,o.jsxs)(o.Fragment,{children:["from \xa0",(0,o.jsxs)(i.Tag,{minimal:!0,interactive:!0,onRemove:()=>r({type:"all"}),children:["\xa0this project ",s.file?" / "+s.file:null]})]})]})}},89638:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(29003),t)},16213:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(18718),t)},15882:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PromptAIMenu=void 0;const a=n(20264),u=n(51857),l=r(n(65443)),c=s(n(49231)),d=1e4;t.PromptAIMenu=e=>{const{onClose:t}=e,[n,o]=c.default.useState(""),[i,s]=c.default.useState(0);return(0,c.useEffect)((()=>{s(0);const t=setInterval((()=>{s((t=>{const n=(Date.now()-e.submitTime)/d;return Math.min(n+.05*Math.random()/2,.95)}))}),500);return()=>clearInterval(t)}),[e.submitTime]),(0,a.jsxs)(u.Dialog,{isOpen:!0,onClose:t,className:"prompt-ai-menu",title:"\u2728 Generate Code Part using AI",children:[(0,a.jsx)("main",{className:(0,l.default)(u.Classes.DIALOG_BODY),tabIndex:0,children:(0,a.jsx)(u.TextArea,{value:n,disabled:e.submitting,onChange:e=>o(e.target.value),placeholder:"Describe your part in details",fill:!0})}),e.submitTime?(0,a.jsx)("div",{className:"progress-bar-container",children:(0,a.jsx)(u.ProgressBar,{value:i})}):null,(0,a.jsx)("div",{className:u.Classes.DIALOG_FOOTER,children:(0,a.jsxs)("div",{className:u.Classes.DIALOG_FOOTER_ACTIONS,children:[(0,a.jsx)(u.Button,{onClick:t,children:"Close"}),(0,a.jsx)(u.Button,{intent:u.Intent.PRIMARY,className:"run-btn",disabled:e.submitting||!n,loading:e.submitting,onClick:()=>{s(0),e.onSubmit(n)},children:"Create \u2728"})]})})]})}},96749:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(15882),t)},9965:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RunFlowModal=void 0;const a=n(20264),u=s(n(49231)),l=r(n(57706)),c=n(51857),d=r(n(65443)),p=n(23015);t.RunFlowModal=u.memo((function(e){const{onRun:t,onClose:n,part:o}=e,[i,s]=(0,p.useLocalStorage)("run-inputs-"+o.id,Object.keys(o.inputs).reduce(((e,t)=>(e[t]="Enter a value for input "+t,e)),{})),[r,f]=u.useState(JSON.stringify(i,null,2)),m=u.useCallback((()=>{const e=JSON.parse(r);s(e),t(e)}),[t,s,r]),g=Object.keys(o.inputs).filter((e=>"required"!==o.inputs[e].mode));return(0,a.jsxs)(c.Dialog,{isOpen:!0,onClose:e.onClose,className:"run-flow-modal",children:[(0,a.jsxs)("main",{className:(0,d.default)(c.Classes.DIALOG_BODY),onKeyDown:e=>{"Enter"===e.key&&e.metaKey&&m()},tabIndex:0,children:[(0,a.jsx)("strong",{children:"This part receives external inputs. Enter values for each input below:"}),(0,a.jsx)(l.default,{height:"80px",theme:"vs-dark",defaultLanguage:"json",value:r,onChange:e=>f(null!=e?e:""),onMount:e=>{e&&e.updateOptions({lineNumbers:"off",minimap:{enabled:!1}})}}),g.length>0?(0,a.jsxs)(c.Callout,{intent:c.Intent.NONE,children:["Note: input(s) ",(0,a.jsx)("code",{children:g.join(", ")})," are optional"]}):null]}),(0,a.jsx)("div",{className:c.Classes.DIALOG_FOOTER,children:(0,a.jsxs)("div",{className:c.Classes.DIALOG_FOOTER_ACTIONS,children:[(0,a.jsx)(c.Button,{onClick:n,children:"Close"}),(0,a.jsx)(c.Button,{onClick:m,intent:c.Intent.PRIMARY,className:"run-btn",children:"Run"})]})})]})}))},22305:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(9965),t)},1171:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.starIcon=t.stopIcon=t.playIcon=t.pencilIcon=t.ungroupIcon=t.groupIcon=t.inspectIcon=t.removePartIcon=t.addPartIcon=void 0,t.addPartIcon='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M15 7H9V1C9 0.734784 8.89464 0.48043 8.70711 0.292893C8.51957 0.105357 8.26522 0 8 0C7.73478 0 7.48043 0.105357 7.29289 0.292893C7.10536 0.48043 7 0.734784 7 1V7H1C0.734784 7 0.48043 7.10536 0.292893 7.29289C0.105357 7.48043 0 7.73478 0 8C0 8.26522 0.105357 8.51957 0.292893 8.70711C0.48043 8.89464 0.734784 9 1 9H7V15C7 15.2652 7.10536 15.5196 7.29289 15.7071C7.48043 15.8946 7.73478 16 8 16C8.26522 16 8.51957 15.8946 8.70711 15.7071C8.89464 15.5196 9 15.2652 9 15V9H15C15.2652 9 15.5196 8.89464 15.7071 8.70711C15.8946 8.51957 16 8.26522 16 8C16 7.73478 15.8946 7.48043 15.7071 7.29289C15.5196 7.10536 15.2652 7 15 7Z"/>\n</svg>',t.removePartIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M10.0002 18C10.2655 18 10.5198 17.8946 10.7074 17.7071C10.8949 17.5196 11.0002 17.2652 11.0002 17V11C11.0002 10.7348 10.8949 10.4804 10.7074 10.2929C10.5198 10.1054 10.2655 10 10.0002 10C9.73503 10 9.48067 10.1054 9.29314 10.2929C9.1056 10.4804 9.00024 10.7348 9.00024 11V17C9.00024 17.2652 9.1056 17.5196 9.29314 17.7071C9.48067 17.8946 9.73503 18 10.0002 18ZM20.0002 6H16.0002V5C16.0002 4.20435 15.6842 3.44129 15.1216 2.87868C14.559 2.31607 13.7959 2 13.0002 2H11.0002C10.2046 2 9.44153 2.31607 8.87892 2.87868C8.31631 3.44129 8.00024 4.20435 8.00024 5V6H4.00024C3.73503 6 3.48067 6.10536 3.29314 6.29289C3.1056 6.48043 3.00024 6.73478 3.00024 7C3.00024 7.26522 3.1056 7.51957 3.29314 7.70711C3.48067 7.89464 3.73503 8 4.00024 8H5.00024V19C5.00024 19.7956 5.31631 20.5587 5.87892 21.1213C6.44153 21.6839 7.20459 22 8.00024 22H16.0002C16.7959 22 17.559 21.6839 18.1216 21.1213C18.6842 20.5587 19.0002 19.7956 19.0002 19V8H20.0002C20.2655 8 20.5198 7.89464 20.7074 7.70711C20.8949 7.51957 21.0002 7.26522 21.0002 7C21.0002 6.73478 20.8949 6.48043 20.7074 6.29289C20.5198 6.10536 20.2655 6 20.0002 6ZM10.0002 5C10.0002 4.73478 10.1056 4.48043 10.2931 4.29289C10.4807 4.10536 10.735 4 11.0002 4H13.0002C13.2655 4 13.5198 4.10536 13.7074 4.29289C13.8949 4.48043 14.0002 4.73478 14.0002 5V6H10.0002V5ZM17.0002 19C17.0002 19.2652 16.8949 19.5196 16.7074 19.7071C16.5198 19.8946 16.2655 20 16.0002 20H8.00024C7.73503 20 7.48067 19.8946 7.29314 19.7071C7.1056 19.5196 7.00024 19.2652 7.00024 19V8H17.0002V19ZM14.0002 18C14.2655 18 14.5198 17.8946 14.7074 17.7071C14.8949 17.5196 15.0002 17.2652 15.0002 17V11C15.0002 10.7348 14.8949 10.4804 14.7074 10.2929C14.5198 10.1054 14.2655 10 14.0002 10C13.735 10 13.4807 10.1054 13.2931 10.2929C13.1056 10.4804 13.0002 10.7348 13.0002 11V17C13.0002 17.2652 13.1056 17.5196 13.2931 17.7071C13.4807 17.8946 13.735 18 14.0002 18Z"/>\n</svg>',t.inspectIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M21.07 16.8302L19 14.7102C18.5547 14.2869 17.9931 14.0065 17.3872 13.9049C16.7813 13.8034 16.1589 13.8853 15.6 14.1402L14.7 13.2402C15.7605 11.8231 16.2449 10.0569 16.0555 8.29702C15.8662 6.53718 15.0172 4.91441 13.6794 3.75539C12.3417 2.59636 10.6145 1.98714 8.84565 2.05037C7.07678 2.1136 5.39754 2.84458 4.14596 4.09615C2.89438 5.34773 2.1634 7.02698 2.10017 8.79585C2.03695 10.5647 2.64617 12.2919 3.80519 13.6296C4.96421 14.9674 6.58699 15.8164 8.34683 16.0057C10.1067 16.1951 11.8729 15.7107 13.29 14.6502L14.18 15.5402C13.8951 16.0998 13.793 16.7348 13.8881 17.3555C13.9831 17.9762 14.2706 18.5515 14.71 19.0002L16.83 21.1202C17.3925 21.682 18.155 21.9975 18.95 21.9975C19.745 21.9975 20.5075 21.682 21.07 21.1202C21.3557 20.8408 21.5828 20.5071 21.7378 20.1388C21.8928 19.7704 21.9726 19.3748 21.9726 18.9752C21.9726 18.5756 21.8928 18.1799 21.7378 17.8116C21.5828 17.4432 21.3557 17.1096 21.07 16.8302V16.8302ZM12.59 12.5902C11.8902 13.2882 10.9993 13.7631 10.0297 13.955C9.06017 14.1469 8.05549 14.0472 7.14259 13.6684C6.2297 13.2896 5.44955 12.6487 4.9007 11.8267C4.35185 11.0048 4.05893 10.0386 4.05893 9.05019C4.05893 8.06182 4.35185 7.09562 4.9007 6.27365C5.44955 5.45168 6.2297 4.81081 7.14259 4.432C8.05549 4.05319 9.06017 3.95343 10.0297 4.14534C10.9993 4.33724 11.8902 4.81219 12.59 5.51019C13.0556 5.97464 13.4251 6.5264 13.6771 7.13385C13.9292 7.7413 14.0589 8.39251 14.0589 9.05019C14.0589 9.70786 13.9292 10.3591 13.6771 10.9665C13.4251 11.574 13.0556 12.1257 12.59 12.5902V12.5902ZM19.66 19.6602C19.567 19.7539 19.4564 19.8283 19.3346 19.8791C19.2127 19.9298 19.082 19.956 18.95 19.956C18.818 19.956 18.6873 19.9298 18.5654 19.8791C18.4436 19.8283 18.333 19.7539 18.24 19.6602L16.12 17.5402C16.0263 17.4472 15.9519 17.3366 15.9011 17.2148C15.8503 17.0929 15.8242 16.9622 15.8242 16.8302C15.8242 16.6982 15.8503 16.5675 15.9011 16.4456C15.9519 16.3237 16.0263 16.2131 16.12 16.1202C16.213 16.0265 16.3236 15.9521 16.4454 15.9013C16.5673 15.8505 16.698 15.8244 16.83 15.8244C16.962 15.8244 17.0927 15.8505 17.2146 15.9013C17.3364 15.9521 17.447 16.0265 17.54 16.1202L19.66 18.2402C19.7537 18.3331 19.8281 18.4437 19.8789 18.5656C19.9297 18.6875 19.9558 18.8182 19.9558 18.9502C19.9558 19.0822 19.9297 19.2129 19.8789 19.3348C19.8281 19.4566 19.7537 19.5672 19.66 19.6602V19.6602Z"/>\n</svg>\n',t.groupIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M16 9.99998H14V7.99998C14 7.73477 13.8946 7.48041 13.7071 7.29288C13.5196 7.10534 13.2652 6.99998 13 6.99998H7.99998C7.73477 6.99998 7.48041 7.10534 7.29288 7.29288C7.10534 7.48041 6.99998 7.73477 6.99998 7.99998V13C6.99998 13.2652 7.10534 13.5196 7.29288 13.7071C7.48041 13.8946 7.73477 14 7.99998 14H9.99998V16C9.99998 16.2652 10.1053 16.5196 10.2929 16.7071C10.4804 16.8946 10.7348 17 11 17H16C16.2652 17 16.5196 16.8946 16.7071 16.7071C16.8946 16.5196 17 16.2652 17 16V11C17 10.7348 16.8946 10.4804 16.7071 10.2929C16.5196 10.1053 16.2652 9.99998 16 9.99998ZM9.99998 11V12H8.99998V8.99998H12V9.99998H11C10.7348 9.99998 10.4804 10.1053 10.2929 10.2929C10.1053 10.4804 9.99998 10.7348 9.99998 11ZM15 15H12V12H15V15ZM21 18.28V5.71998C21.2704 5.56955 21.5023 5.3584 21.6773 5.10317C21.8523 4.84793 21.9657 4.55556 22.0085 4.24906C22.0514 3.94257 22.0225 3.63031 21.9242 3.33686C21.8259 3.04342 21.6608 2.77679 21.442 2.55795C21.2232 2.33912 20.9565 2.17406 20.6631 2.07575C20.3697 1.97745 20.0574 1.94858 19.7509 1.99143C19.4444 2.03427 19.152 2.14766 18.8968 2.32267C18.6416 2.49768 18.4304 2.72953 18.28 2.99998H5.71998C5.56955 2.72953 5.3584 2.49768 5.10317 2.32267C4.84793 2.14766 4.55556 2.03427 4.24906 1.99143C3.94257 1.94858 3.63031 1.97745 3.33686 2.07575C3.04342 2.17406 2.77679 2.33912 2.55795 2.55795C2.33912 2.77679 2.17406 3.04342 2.07575 3.33686C1.97745 3.63031 1.94858 3.94257 1.99143 4.24906C2.03427 4.55556 2.14766 4.84793 2.32267 5.10317C2.49768 5.3584 2.72953 5.56955 2.99998 5.71998V18.28C2.72953 18.4304 2.49768 18.6416 2.32267 18.8968C2.14766 19.152 2.03427 19.4444 1.99143 19.7509C1.94858 20.0574 1.97745 20.3697 2.07575 20.6631C2.17406 20.9565 2.33912 21.2232 2.55795 21.442C2.77679 21.6608 3.04342 21.8259 3.33686 21.9242C3.63031 22.0225 3.94257 22.0514 4.24906 22.0085C4.55556 21.9657 4.84793 21.8523 5.10317 21.6773C5.3584 21.5023 5.56955 21.2704 5.71998 21H18.28C18.4304 21.2704 18.6416 21.5023 18.8968 21.6773C19.152 21.8523 19.4444 21.9657 19.7509 22.0085C20.0574 22.0514 20.3697 22.0225 20.6631 21.9242C20.9565 21.8259 21.2232 21.6608 21.442 21.442C21.6608 21.2232 21.8259 20.9565 21.9242 20.6631C22.0225 20.3697 22.0514 20.0574 22.0085 19.7509C21.9657 19.4444 21.8523 19.152 21.6773 18.8968C21.5023 18.6416 21.2704 18.4304 21 18.28ZM19 18.28C18.6993 18.4504 18.4504 18.6993 18.28 19H5.71998C5.54956 18.6993 5.30071 18.4504 4.99998 18.28V5.71998C5.30071 5.54956 5.54956 5.30071 5.71998 4.99998H18.28C18.4504 5.30071 18.6993 5.54956 19 5.71998V18.28Z"/>\n</svg>\n',t.ungroupIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M21.0002 18.28V11.72C21.2707 11.5695 21.5025 11.3584 21.6775 11.1032C21.8525 10.8479 21.9659 10.5556 22.0088 10.2491C22.0516 9.94257 22.0228 9.63031 21.9245 9.33686C21.8262 9.04342 21.6611 8.77679 21.4423 8.55795C21.2234 8.33912 20.9568 8.17406 20.6633 8.07575C20.3699 7.97745 20.0576 7.94858 19.7511 7.99143C19.4447 8.03427 19.1523 8.14766 18.897 8.32267C18.6418 8.49768 18.4307 8.72953 18.2802 8.99998H15.0002V5.71998C15.2707 5.56955 15.5025 5.3584 15.6775 5.10317C15.8525 4.84793 15.9659 4.55556 16.0088 4.24906C16.0516 3.94257 16.0228 3.63031 15.9245 3.33686C15.8262 3.04342 15.6611 2.77679 15.4423 2.55795C15.2234 2.33912 14.9568 2.17406 14.6633 2.07575C14.3699 1.97745 14.0576 1.94858 13.7511 1.99143C13.4447 2.03427 13.1523 2.14766 12.897 2.32267C12.6418 2.49768 12.4307 2.72953 12.2802 2.99998H5.72023C5.56979 2.72953 5.35865 2.49768 5.10341 2.32267C4.84817 2.14766 4.5558 2.03427 4.24931 1.99143C3.94281 1.94858 3.63055 1.97745 3.33711 2.07575C3.04366 2.17406 2.77703 2.33912 2.5582 2.55795C2.33937 2.77679 2.1743 3.04342 2.076 3.33686C1.97769 3.63031 1.94883 3.94257 1.99167 4.24906C2.03452 4.55556 2.14791 4.84793 2.32291 5.10317C2.49792 5.3584 2.72977 5.56955 3.00023 5.71998V12.28C2.72977 12.4304 2.49792 12.6416 2.32291 12.8968C2.14791 13.152 2.03452 13.4444 1.99167 13.7509C1.94883 14.0574 1.97769 14.3697 2.076 14.6631C2.1743 14.9565 2.33937 15.2232 2.5582 15.442C2.77703 15.6608 3.04366 15.8259 3.33711 15.9242C3.63055 16.0225 3.94281 16.0514 4.24931 16.0085C4.5558 15.9657 4.84817 15.8523 5.10341 15.6773C5.35865 15.5023 5.56979 15.2704 5.72023 15H9.00023V18.28C8.72977 18.4304 8.49792 18.6416 8.32291 18.8968C8.14791 19.152 8.03452 19.4444 7.99167 19.7509C7.94883 20.0574 7.97769 20.3697 8.076 20.6631C8.1743 20.9565 8.33937 21.2232 8.5582 21.442C8.77703 21.6608 9.04366 21.8259 9.33711 21.9242C9.63055 22.0225 9.94281 22.0514 10.2493 22.0085C10.5558 21.9657 10.8482 21.8523 11.1034 21.6773C11.3586 21.5023 11.5698 21.2704 11.7202 21H18.2802C18.4307 21.2704 18.6418 21.5023 18.897 21.6773C19.1523 21.8523 19.4447 21.9657 19.7511 22.0085C20.0576 22.0514 20.3699 22.0225 20.6633 21.9242C20.9568 21.8259 21.2234 21.6608 21.4423 21.442C21.6611 21.2232 21.8262 20.9565 21.9245 20.6631C22.0228 20.3697 22.0516 20.0574 22.0088 19.7509C21.9659 19.4444 21.8525 19.152 21.6775 18.8968C21.5025 18.6416 21.2707 18.4304 21.0002 18.28ZM8.00023 9.99998C8.00233 10.349 8.09574 10.6914 8.27118 10.9932C8.44661 11.2949 8.69795 11.5455 9.00023 11.72V13H5.72023C5.5498 12.6993 5.30096 12.4504 5.00023 12.28V5.71998C5.30096 5.54956 5.5498 5.30071 5.72023 4.99998H12.2802C12.4507 5.30071 12.6995 5.54956 13.0002 5.71998V8.99998H11.7202C11.4975 8.62457 11.1581 8.33233 10.7538 8.16784C10.3495 8.00335 9.90245 7.97565 9.48092 8.08896C9.05939 8.20228 8.6865 8.45039 8.41915 8.79543C8.15181 9.14047 8.00468 9.56351 8.00023 9.99998V9.99998ZM13.0002 11V12.28C12.6995 12.4504 12.4507 12.6993 12.2802 13H11.0002V11.72C11.301 11.5496 11.5498 11.3007 11.7202 11H13.0002ZM19.0002 18.28C18.6995 18.4504 18.4507 18.6993 18.2802 19H11.7202C11.5498 18.6993 11.301 18.4504 11.0002 18.28V15H12.2802C12.4307 15.2704 12.6418 15.5023 12.897 15.6773C13.1523 15.8523 13.4447 15.9657 13.7511 16.0085C14.0576 16.0514 14.3699 16.0225 14.6633 15.9242C14.9568 15.8259 15.2234 15.6608 15.4423 15.442C15.6611 15.2232 15.8262 14.9565 15.9245 14.6631C16.0228 14.3697 16.0516 14.0574 16.0088 13.7509C15.9659 13.4444 15.8525 13.152 15.6775 12.8968C15.5025 12.6416 15.2707 12.4304 15.0002 12.28V11H18.2802C18.4507 11.3007 18.6995 11.5496 19.0002 11.72V18.28Z"/>\n</svg>\n',t.pencilIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M5 17.9999H9.24C9.37161 18.0007 9.50207 17.9755 9.62391 17.9257C9.74574 17.8759 9.85656 17.8026 9.95 17.7099L16.87 10.7799L19.71 7.99994C19.8037 7.90698 19.8781 7.79637 19.9289 7.67452C19.9797 7.55266 20.0058 7.42195 20.0058 7.28994C20.0058 7.15793 19.9797 7.02722 19.9289 6.90536C19.8781 6.7835 19.8037 6.6729 19.71 6.57994L15.47 2.28994C15.377 2.19621 15.2664 2.12182 15.1446 2.07105C15.0227 2.02028 14.892 1.99414 14.76 1.99414C14.628 1.99414 14.4973 2.02028 14.3754 2.07105C14.2536 2.12182 14.143 2.19621 14.05 2.28994L11.23 5.11994L4.29 12.0499C4.19732 12.1434 4.12399 12.2542 4.07423 12.376C4.02446 12.4979 3.99924 12.6283 4 12.7599V16.9999C4 17.2652 4.10536 17.5195 4.29289 17.707C4.48043 17.8946 4.73478 17.9999 5 17.9999ZM14.76 4.40994L17.59 7.23994L16.17 8.65994L13.34 5.82994L14.76 4.40994ZM6 13.1699L11.93 7.23994L14.76 10.0699L8.83 15.9999H6V13.1699ZM21 19.9999H3C2.73478 19.9999 2.48043 20.1053 2.29289 20.2928C2.10536 20.4804 2 20.7347 2 20.9999C2 21.2652 2.10536 21.5195 2.29289 21.707C2.48043 21.8946 2.73478 21.9999 3 21.9999H21C21.2652 21.9999 21.5196 21.8946 21.7071 21.707C21.8946 21.5195 22 21.2652 22 20.9999C22 20.7347 21.8946 20.4804 21.7071 20.2928C21.5196 20.1053 21.2652 19.9999 21 19.9999Z"/>\n</svg>',t.playIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M18.54 9.00027L8.87997 3.46027C8.35725 3.15843 7.76397 3.00031 7.16036 3.00197C6.55676 3.00362 5.96435 3.165 5.4433 3.46971C4.92225 3.77442 4.49112 4.2116 4.19372 4.73685C3.89631 5.2621 3.74321 5.8567 3.74997 6.46027V17.5803C3.74997 18.4873 4.11029 19.3572 4.75167 19.9986C5.39304 20.6399 6.26293 21.0003 7.16997 21.0003C7.77041 20.9993 8.36006 20.8406 8.87997 20.5403L18.54 15.0003C19.059 14.6999 19.49 14.2682 19.7896 13.7487C20.0891 13.2292 20.2468 12.64 20.2468 12.0403C20.2468 11.4405 20.0891 10.8514 19.7896 10.3318C19.49 9.8123 19.059 9.38068 18.54 9.08027V9.00027ZM17.54 13.1903L7.87997 18.8103C7.66346 18.933 7.41884 18.9975 7.16997 18.9975C6.9211 18.9975 6.67648 18.933 6.45997 18.8103C6.24407 18.6856 6.06479 18.5063 5.94015 18.2904C5.81552 18.0745 5.74993 17.8296 5.74997 17.5803V6.42027C5.74993 6.17097 5.81552 5.92605 5.94015 5.71013C6.06479 5.49422 6.24407 5.31492 6.45997 5.19027C6.67738 5.06943 6.92127 5.00416 7.16997 5.00027C7.4185 5.00537 7.66211 5.07056 7.87997 5.19027L17.54 10.7703C17.756 10.8949 17.9353 11.0741 18.06 11.2901C18.1847 11.506 18.2504 11.7509 18.2504 12.0003C18.2504 12.2496 18.1847 12.4946 18.06 12.7105C17.9353 12.9264 17.756 13.1057 17.54 13.2303V13.1903Z"/>\n</svg>\n',t.stopIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M15 8H9C8.73479 8 8.48043 8.10536 8.2929 8.29289C8.10536 8.48043 8 8.73478 8 9V15C8 15.2652 8.10536 15.5196 8.2929 15.7071C8.48043 15.8946 8.73479 16 9 16H15C15.2652 16 15.5196 15.8946 15.7071 15.7071C15.8946 15.5196 16 15.2652 16 15V9C16 8.73478 15.8946 8.48043 15.7071 8.29289C15.5196 8.10536 15.2652 8 15 8ZM14 14H10V10H14V14ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2V2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20V20Z"/>\n</svg>\n',t.starIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M22 9.66966C21.9368 9.48674 21.822 9.32608 21.6693 9.20716C21.5167 9.08823 21.3328 9.01615 21.14 8.99966L15.45 8.16966L12.9 2.99966C12.8181 2.83059 12.6902 2.688 12.5311 2.58823C12.3719 2.48846 12.1878 2.43555 12 2.43555C11.8121 2.43555 11.6281 2.48846 11.4689 2.58823C11.3097 2.688 11.1819 2.83059 11.1 2.99966L8.54998 8.15966L2.85998 8.99966C2.6749 9.02596 2.5009 9.10362 2.35773 9.22381C2.21455 9.34401 2.10794 9.50193 2.04998 9.67966C1.99692 9.85333 1.99216 10.0382 2.03621 10.2143C2.08025 10.3905 2.17144 10.5514 2.29998 10.6797L6.42998 14.6797L5.42998 20.3597C5.3896 20.5481 5.40453 20.7442 5.47296 20.9243C5.54139 21.1044 5.66041 21.261 5.81571 21.3751C5.971 21.4891 6.15595 21.5559 6.34831 21.5674C6.54066 21.5789 6.73224 21.5345 6.89998 21.4397L12 18.7697L17.1 21.4397C17.2403 21.5188 17.3988 21.5602 17.56 21.5597C17.7718 21.5604 17.9784 21.4939 18.15 21.3697C18.3051 21.2585 18.4252 21.1053 18.4961 20.9281C18.567 20.7509 18.5857 20.5571 18.55 20.3697L17.55 14.6897L21.68 10.6897C21.8244 10.5673 21.9311 10.4066 21.9877 10.226C22.0444 10.0455 22.0486 9.85253 22 9.66966ZM15.85 13.6697C15.7342 13.7821 15.6474 13.9208 15.5969 14.074C15.5464 14.2273 15.5337 14.3905 15.56 14.5497L16.28 18.7497L12.52 16.7497C12.3738 16.6774 12.213 16.6398 12.05 16.6398C11.8869 16.6398 11.7261 16.6774 11.58 16.7497L7.81998 18.7497L8.53998 14.5497C8.56622 14.3905 8.55354 14.2273 8.50305 14.074C8.45255 13.9208 8.36572 13.7821 8.24998 13.6697L5.24998 10.6697L9.45998 10.0597C9.62198 10.0371 9.77598 9.9752 9.90848 9.87931C10.041 9.78342 10.1479 9.65649 10.22 9.50966L12 5.69966L13.88 9.51966C13.952 9.66649 14.059 9.79342 14.1915 9.88931C14.324 9.9852 14.478 10.0471 14.64 10.0697L18.85 10.6797L15.85 13.6697Z"/>\n</svg>\n\n\n'},40762:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HelpBubble=void 0;const i=n(49231),s=n(20264),r=n(51857),a=n(31270),u=n(28186),l=o(n(49231)),c=n(50385),d=o(n(62674)),p=n(38581),f=n(68870),m={offset:{enabled:!0,options:{offset:[0,20]}},preventOverflow:{enabled:!0,options:{padding:10}}};const g=["Viewport Controls","Editing","Selection"];t.HelpBubble=()=>{const[e,t]=l.default.useState(!1),n=Array.from(c.currentHotkeys.entries()).map((e=>{let[t,n]=e;return{combo:(o={key:t,menuData:n}).key,label:o.menuData.text,group:o.menuData.group};var o})).reduce(((e,t)=>(e[t.group]||(e[t.group]=[]),e[t.group].push(t),e)),{}),o=Object.entries(n).sort(((e,t)=>g.indexOf(t[0])-g.indexOf(e[0]))),{reportEvent:h}=(0,f.usePorts)(),v=(0,s.jsx)(r.Dialog,{isOpen:e,onClose:()=>t(!1),children:(0,s.jsx)("div",{className:r.Classes.DIALOG_BODY,children:o.map((e=>{let[t,n]=e;return(0,s.jsxs)(l.default.Fragment,{children:[(0,s.jsx)(r.H4,{children:t}),n.map((e=>(0,i.createElement)(a.Hotkey,{...e,key:e.combo})))]},t)}))})}),I=(0,s.jsxs)(r.Menu,{children:[(0,s.jsx)(r.MenuItem,{text:"Hotkeys",onClick:()=>{t(!0),h("helpMenuItem",{item:"hotkeys"})}}),(0,s.jsx)(r.MenuItem,{text:"Documentation",onClick:()=>h("helpMenuItem",{item:"documentation"}),href:"https://www.flyde.dev/docs",target:"_blank"}),(0,s.jsx)(r.MenuDivider,{}),(0,s.jsx)(r.MenuItem,{text:"Discord",onClick:()=>h("helpMenuItem",{item:"discord"}),href:"https://discord.gg/x7t4tjZQP8",target:"_blank"})]});return(0,s.jsxs)("div",{className:"help-bubble","data-tip":"Help",children:[(0,s.jsx)(d.default,{}),(0,s.jsx)(u.Popover2,{content:I,modifiers:m,onOpened:()=>h("helpMenuOpen",{}),children:(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:p.helpIcon}})}),v]})}},38581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.helpIcon=void 0,t.helpIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M11.29 15.29C11.247 15.3375 11.2069 15.3876 11.17 15.44C11.1322 15.4957 11.1019 15.5563 11.08 15.62C11.0512 15.6767 11.031 15.7374 11.02 15.8C11.0151 15.8666 11.0151 15.9334 11.02 16C11.0166 16.1312 11.044 16.2613 11.1 16.38C11.1449 16.5041 11.2166 16.6168 11.3099 16.7101C11.4032 16.8034 11.5159 16.8751 11.64 16.92C11.7597 16.9729 11.8891 17.0002 12.02 17.0002C12.1509 17.0002 12.2803 16.9729 12.4 16.92C12.5241 16.8751 12.6368 16.8034 12.7301 16.7101C12.8234 16.6168 12.8951 16.5041 12.94 16.38C12.9844 16.2584 13.0048 16.1294 13 16C13.0008 15.8684 12.9755 15.7379 12.9258 15.6161C12.876 15.4943 12.8027 15.3834 12.71 15.29C12.617 15.1963 12.5064 15.1219 12.3846 15.0711C12.2627 15.0203 12.132 14.9942 12 14.9942C11.868 14.9942 11.7373 15.0203 11.6154 15.0711C11.4936 15.1219 11.383 15.1963 11.29 15.29ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2V2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20V20ZM12 7C11.4731 6.99966 10.9553 7.13812 10.4989 7.40144C10.0425 7.66476 9.66347 8.04366 9.4 8.5C9.32765 8.61382 9.27907 8.7411 9.25718 8.87418C9.23529 9.00726 9.24055 9.14339 9.27263 9.27439C9.30472 9.40538 9.36297 9.52854 9.44389 9.63643C9.5248 9.74433 9.62671 9.83475 9.74348 9.90224C9.86024 9.96974 9.98945 10.0129 10.1233 10.0292C10.2572 10.0454 10.393 10.0345 10.5225 9.99688C10.6521 9.9593 10.7727 9.89591 10.8771 9.81052C10.9814 9.72513 11.0675 9.61951 11.13 9.5C11.2181 9.3474 11.345 9.22078 11.4978 9.13298C11.6505 9.04518 11.8238 8.9993 12 9C12.2652 9 12.5196 9.10536 12.7071 9.29289C12.8946 9.48043 13 9.73478 13 10C13 10.2652 12.8946 10.5196 12.7071 10.7071C12.5196 10.8946 12.2652 11 12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V13C11 13.2652 11.1054 13.5196 11.2929 13.7071C11.4804 13.8946 11.7348 14 12 14C12.2652 14 12.5196 13.8946 12.7071 13.7071C12.8946 13.5196 13 13.2652 13 13V12.82C13.6614 12.58 14.2174 12.1152 14.5708 11.5069C14.9242 10.8985 15.0525 10.1853 14.9334 9.49189C14.8143 8.79849 14.4552 8.16902 13.919 7.71352C13.3828 7.25801 12.7035 7.00546 12 7V7Z"/>\n</svg>\n'},17080:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(40762),t)},75598:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MainInstanceEventsIndicator=void 0;const i=n(20264),s=o(n(62674)),r=n(60324),a=n(7170);t.MainInstanceEventsIndicator=e=>{const{currentInsId:t,ancestorsInsIds:n}=e,{history:o,refreshHistory:u,resetHistory:l}=(0,a.useHistoryHelpers)(t),c="main-indicator-"+t+"}";return(0,i.jsxs)("div",{className:"main-instance-events-indicator",children:[(0,i.jsx)(s.default,{html:!0,getContent:[()=>(0,a.calcHistoryContent)(o),200],id:c}),(0,i.jsx)("span",{onMouseEnter:u,onMouseOut:l,id:(0,r.getMainInstanceIndicatorDomId)(t,n),className:"status-text","data-tip":"","data-html":!0,"data-for":c})]})}},77266:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(75598),t)},99678:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VisualPartEditor=t.defaultBoardData=t.defaultViewPort=t.PART_HEIGHT=void 0;const a=n(20264),u=s(n(49231)),l=n(14376),c=n(36075),d=n(83133),p=n(75219),f=n(78237),m=n(43925),g=n(53865),h=n(49231),v=n(50385),I=r(n(80104)),y=n(51857),b=n(13155),C=n(59429),P=n(49390),_=n(14376),x=n(17524),j=n(16249),w=n(96529),O=n(12623),E=n(91028),D=n(51743),M=n(18841),S=r(n(61888)),N=n(38300),k=n(68870),T=r(n(65443)),R=n(62917),V=n(76458),A=n(23744),z=n(5593),H=n(68122),G=n(69200),L=n(16391),B=n(77266),F=n(17080),U=u.memo(y.Slider),q=()=>null;t.PART_HEIGHT=28;t.defaultViewPort={pos:{x:0,y:0},zoom:1},t.defaultBoardData={selected:[],viewPort:t.defaultViewPort,lastMousePos:{x:0,y:0}},t.VisualPartEditor=u.memo(u.forwardRef(((e,n)=>{const{onChangePart:o,partIoEditable:i,onCopy:s,onGoToPartDef:r,onInspectPin:Z,boardData:J,onChangeBoardData:Y,currentInsId:X,ancestorsInsIds:K,part:Q,onShowOmnibar:$,resolvedDependencies:ee,queuedInputsData:te,initialPadding:ne,disableScrolling:oe}=e,{onImportPart:ie}=(0,G.useDependenciesContext)(),{reportEvent:se}=(0,k.usePorts)(),re=e.parentViewport||t.defaultViewPort,[ae,ue]=(0,h.useState)({...ee,[Q.id]:Q});(0,h.useEffect)((()=>{ue({...ee,[Q.id]:Q})}),[ee,Q]);const{selected:le,from:ce,to:de}=J,{instances:pe,connections:fe,inputsPosition:me,outputsPosition:ge,inputs:he,outputs:ve}=Q,[Ie,ye]=(0,h.useState)(),[be,Ce]=(0,h.useState)(),Pe=void 0===K,[_e,xe]=(0,h.useState)(0),[je,we]=(0,h.useState)(),[Oe,Ee]=(0,h.useState)(!1),[De,Me]=(0,h.useState)(),[Se,Ne]=(0,h.useState)(),[ke,Te]=(0,h.useState)(),[Re,Ve]=(0,h.useState)(),Ae=(0,h.useRef)();(0,f.useDidMount)((()=>{Ae.current=Xe.current.querySelector(".inline-editor-portal-root")}));const ze=(0,k.useConfirm)(),He=(0,k.usePrompt)(),Ge=J.viewPort,Le=(0,h.useRef)(!0),[Be,Fe]=(0,h.useState)(null),Ue=u.useCallback((e=>{Y({viewPort:e})}),[Y]),qe=u.useCallback(((e,t)=>Z(e,t)),[Z]),We=u.useCallback(((e,t,n)=>{const i=(0,V.handleConnectionCloseEditorCommand)(Q,{from:e,to:t}),s=(0,l.isInternalConnectionNode)(t)?pe.find((e=>e.id===t.insId)):null,r=(s?s.inputConfig:{})[t.pinId],a=(0,l.isStaticInputPinConfig)(r)?(0,A.handleDetachConstEditorCommand)(i,t.insId,t.pinId):i;o(a,(0,E.functionalChange)("close-connection")),Y({from:void 0,to:void 0}),se("createConnection",{source:n})}),[pe,o,Y,Q,se]),Ze=u.useCallback((async()=>{const e=await He("New visual part name?");if(!e)return;const{currentPart:t}=await(0,N.groupSelected)(J.selected,Q,e,"inline",He);o(t,(0,E.functionalChange)("group part")),(0,O.toastMsg)("Part grouped"),se("groupSelected",{count:J.selected.length})}),[He,J.selected,o,Q,se]);(0,h.useEffect)((()=>{if(je){const e=setTimeout((()=>{we(void 0)}),350);return()=>clearTimeout(e)}}),[je]);const[Je,Ye]=(0,h.useState)();(0,h.useEffect)((()=>{(0,w.preloadMonaco)()}),[]);const Xe=(0,h.useRef)(),Ke=(0,I.default)(Xe),Qe=u.useRef({x:400,y:400}),$e=(0,f.useBoundingclientrect)(Xe)||C.vZero,et=()=>{const e=(0,m.fitViewPortToPart)(Q,ae,Ke);(0,m.animateViewPort)(Ge,e,500,(e=>{Ue(e)}))},tt=u.useCallback(((e,t)=>{const{to:n,from:o}=J,i="input"===t?o:n,s="input"===t?n:o,r={pinId:e,insId:l.THIS_INS_ID},a="input"===t?{from:r}:{to:r};i&&i.pinId===e?Y({from:void 0,to:void 0}):s?"input"===t&&n?We(r,n,"partIoClick"):o&&We(o,r,"partIoClick"):Y(a)}),[J,Y,We]),nt=u.useCallback(((e,t,n)=>{const i=(0,g.produce)(Q,(o=>{"input"===e?o.inputs[t].description=n:o.outputs[t].description=n}));o(i,(0,E.functionalChange)("Part io description"))}),[o,Q]),ot=u.useCallback(((e,t,n)=>{const{from:o,to:i}=J;if(ce&&ce.insId===e.id||de&&de.insId===e.id)Y({from:void 0,to:void 0});else if("input"===n){const n={insId:e.id,pinId:t};!i||i.pinId!==t||(0,l.isInternalConnectionNode)(i)&&i.insId!==e.id?ce?We(ce,n,"pinClick"):Y({to:n,selected:[]}):Y({to:void 0})}else{const n={insId:e.id,pinId:t};!o||o.pinId!==t||(0,l.isInternalConnectionNode)(o)&&o.insId!==e.id?de?We(n,de,"pinClick"):Y({from:n,selected:[]}):Y({from:void 0})}}),[J,ce,Y,We,de]);(0,h.useEffect)((()=>{if(!Oe&&Ke.width){const t=(0,m.fitViewPortToPart)(Q,ae,Ke,ne);Ue(t);const n=setTimeout((()=>{const t=(0,m.fitViewPortToPart)(Q,ae,Ke,ne);e.thumbnailMode||Ue(t),Ee(!0)}),100);return()=>clearTimeout(n)}}),[Q,ne,Ke,e.thumbnailMode,Oe,ae,Ue]);const it=u.useCallback((()=>{const{selected:e}=J,t=Q.instances.filter((t=>e.includes(t.id))).map((e=>({...e,id:e.id+"-copy"}))),n=Q.connections.filter((t=>{let{from:n,to:o}=t;return e.includes(n.insId)&&e.includes(o.insId)}));s({instances:t,connections:n})}),[J,s,Q]),st=u.useCallback((()=>{const{newPart:t,newInstances:n}=(0,R.pasteInstancesCommand)(Q,Qe.current,e.clipboardData);o(t,(0,E.functionalChange)("paste instances")),Y({selected:n.map((e=>e.id))})}),[o,Y,Q,e.clipboardData]),rt=u.useCallback((()=>{const e=Q.id;Je?"input"===Je.type?Je.ins.id===e?tt(Je.pin,"input"):ot(Je.ins,Je.pin,"input"):Je.ins.id===e?tt(Je.pin,"output"):ot(Je.ins,Je.pin,"output"):console.warn("tried selecting closest with no pin nearby")}),[Q.id,Je,tt,ot]),at=u.useCallback(((e,t)=>{const n=Math.min(Math.max(e,.1),3),o="mouse"===t?Qe.current:{x:Ge.pos.x+Ke.width/2,y:Ge.pos.y+Ke.height/2},i=(0,m.centerBoardPosOnTarget)(o,Ke,n,Ge);Ue({...Ge,zoom:n,pos:i})}),[Ue,Ge,Ke]);(0,v.useHotkeys)("cmd+=",(e=>{at(Ge.zoom+.1,"hotkey"),e.preventDefault()}),{text:"Zoom in board",group:"Viewport Controls"},[Ge,at],Le),(0,v.useHotkeys)("cmd+-",(e=>{at(Ge.zoom-.1,"hotkey"),e.preventDefault()}),{text:"Zoom out board",group:"Viewport Controls"},[at,Ge.zoom],Le),(0,v.useHotkeys)("cmd+o",(e=>{e.preventDefault(),(0,O.toastMsg)("Ordering");const t=[];(0,x.orderVisualPart)(Q,ae,200,((e,n)=>{n%3==0&&t.push(e)})),(async()=>{for(;t.length;){const e=t.shift();(0,O.toastMsg)("Step "+t.length+"!"),await(0,l.delay)(200),o(e,(0,E.metaChange)("order-step")),(0,O.toastMsg)("Step "+t.length+"! done")}})()}),{text:"Auto-layout (experimental)",group:"Misc."},[o,Q,ee],Le),(0,v.useHotkeys)("cmd+0",(e=>{at(1),e.preventDefault()}),{text:"Reset zoom",group:"Viewport Controls"},[Ge,at],Le);const ut=()=>{Y({from:void 0,to:void 0,selected:[]})},lt=u.useCallback(((e,t)=>{ye(e.id),o({...Q},(0,E.metaChange)("drag-start"))}),[o,Q]),ct=u.useCallback(((e,t,n)=>{const{newValue:i,newSelected:s}=(0,m.handleInstanceDrag)(Q,e,n,t,le,Ie);o(i,(0,E.metaChange)("drag-move")),s&&Y({selected:s})}),[Ie,o,Y,le,Q]),dt=u.useCallback(((e,t)=>{t.preventDefault(),t.stopPropagation(),ye(void 0)}),[]),pt=u.useCallback(((e,t)=>{t.preventDefault(),t.stopPropagation(),ye(l.THIS_INS_ID)}),[]),ft=u.useCallback((async(t,n,o,i)=>{o.preventDefault(),o.stopPropagation();const{x:s,y:r}=i,a=(0,g.produce)(Q,(e=>{"input"===t?e.inputsPosition[n]={x:s,y:r}:e.outputsPosition[n]={x:s,y:r}}));e.onChangePart(a,(0,E.metaChange)("part-io-drag-move"))}),[e,Q]),mt=u.useCallback((async(e,t,n,o)=>{n.preventDefault(),n.stopPropagation(),ye(void 0)}),[]),gt=u.useCallback(((e,t)=>{let{id:n}=e;const o=t.shiftKey?le.filter((e=>e!==n)):[],i=t.shiftKey?[...le,n]:[n],s=le.includes(n)?o:i;Y({selected:s,from:void 0,to:void 0})}),[Y,le]),ht=u.useCallback((()=>{const e=Q.instances.map((e=>e.id));Y({selected:e,from:void 0,to:void 0})}),[Y,Q.instances]),vt=u.useCallback((e=>{const t=fe.filter((t=>{let{from:n,to:o}=t;return-1===e.indexOf(n.insId)&&-1===e.indexOf(o.insId)})),n=(0,g.produce)(Q,(n=>{n.connections=t,n.instances=n.instances.filter((t=>!e.includes(t.id)))}));Y({selected:[]}),o(n,(0,E.functionalChange)("delete-ins"))}),[fe,o,Y,Q]),It=u.useCallback((e=>{vt([e.id])}),[vt]),yt=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{"input"===e?(delete n.inputs[t],n.connections=n.connections.filter((e=>!((0,l.isExternalConnectionNode)(e.from)&&e.from.pinId===t)))):(n.connections=n.connections.filter((e=>!((0,l.isExternalConnectionNode)(e.to)&&e.to.pinId===t))),n.completionOutputs=(n.completionOutputs||[]).map((e=>e.split("+").filter((e=>e!==t)).join("+"))).filter((e=>!!e)),delete n.outputs[t])}));ce&&ce.insId===l.THIS_INS_ID&&ce.pinId===t?Y({from:void 0}):de&&de.insId===l.THIS_INS_ID&&de.pinId===t&&Y({to:void 0}),o(n,(0,E.functionalChange)("remove io pin"))}),[Q,ce,de,o,Y]),bt=u.useCallback((async()=>{const{selected:e,from:t,to:n}=J;0===e.length?t&&(0,l.isExternalConnectionNode)(t)?await ze("Are you sure you want to remove main input "+t.pinId+"?")&&yt("input",t.pinId):n&&(0,l.isExternalConnectionNode)(n)&&await ze("Are you sure you want to remove main output "+n.pinId+"?")&&yt("output",n.pinId):vt(e)}),[ze,J,vt,yt]),Ct=u.useCallback(((e,t,n)=>{const i=(0,m.getInstancePinConfig)(Q,e.id,t),s=(0,l.isStickyInputPinConfig)(i)?(0,_.queueInputPinConfig)():(0,l.stickyInputPinConfig)();o((0,m.changePinConfig)(Q,e.id,t,s),(0,E.functionalChange)("toggle-sticky")),se("togglePinSticky",{isSticky:(0,l.isStickyInputPinConfig)(s)})}),[o,Q,se]),Pt=u.useCallback((()=>{const{newPart:e,newInstances:t}=(0,z.handleDuplicateSelectedEditorCommand)(Q,le);o(e,(0,E.functionalChange)("duplicated instances")),Y({selected:t.map((e=>e.id))})}),[o,Y,Q,le]),_t=u.useCallback((e=>{const t=e.nativeEvent.target;if(0===e.button&&W(e.nativeEvent,Q.id)&&t&&"board-editor-inner"===t.className){if(Date.now()-_e<300)return void $(e);xe(Date.now());const t={x:e.clientX,y:e.clientY},n=(0,C.vSub)(t,$e),o=(0,m.domToViewPort)(n,Ge,re);Ce({from:o,to:o})}}),[Q.id,Ge,_e,$e,re,$]),xt=u.useCallback((e=>{if(Fe(null),W(e.nativeEvent,Q.id)&&be){if((0,m.calcSelectionBoxArea)(be)>50){const t=(0,m.getInstancesInRect)(be,ae,Ge,Jt.current,Q.instances,$e,re);console.log({toSelect:t,selectionBox:be});const n=e.shiftKey?[...le,...t]:t;Y({selected:n})}Ce(void 0)}}),[Q.id,Q.instances,be,ae,Ge,$e,re,le,Y]),jt=u.useCallback((e=>{if(!W(e.nativeEvent,Q.id))return void(Le.current=!1);Le.current=!0;const t={x:e.clientX,y:e.clientY},n=(0,C.vSub)(t,(0,C.vAdd)($e,C.vZero)),o=(0,m.domToViewPort)(n,Ge,re);be&&Ce({...be,to:o});const i=(0,m.findClosestPin)(Q,ae,n,$e,X,K,Ge),s=Je;if(i){(!s||s.ins!==i.ins||s.ins===i.ins&&s.pin!==i.pin)&&Ye({ins:i.ins,type:i.type,pin:i.id})}Qe.current=o,Y({lastMousePos:Qe.current})}),[Q,$e,Ge,re,be,ae,X,K,Je,Y]),wt=u.useCallback((()=>{Ye(void 0),Le.current=!1}),[]),Ot=u.useCallback(((e,t)=>{if(t){const t=(0,l.isInlinePartInstance)(e)?e.part:(0,l.getPartDef)(e.partId,ae);if(!t)throw new Error("Impossible state inspecting inexisting part");if(!(0,l.isVisualPart)(t))return void(0,O.toastMsg)("Cannot inspect a non visual part","warning");Ve({insId:X+"."+e.id,part:t})}else if((0,l.isRefPartInstance)(e)){const t=(0,l.getPartDef)(e,ae);r(t)}else{const t=e.part;if(!(0,l.isInlineValuePart)(t))return void((0,l.isVisualPart)(t)?Ve({insId:e.id,part:t}):(0,O.toastMsg)("Editing this type of part is not supported"));const n=atob(t.dataBuilderSource);Te({insId:e.id,templateType:t.templateType,value:n,type:"existing"}),(0,O.toastMsg)("Editing inline visual part not supported yet")}}),[r,ae,X]),Et=u.useCallback((e=>{if((0,l.isInlinePartInstance)(e)){const t=e.part;if(!(0,l.isVisualPart)(t))return void(0,O.toastMsg)("Not supported","warning");const n=(0,g.produce)(Q,(n=>{n.instances=n.instances.filter((t=>t.id!==e.id)),n.connections=n.connections.filter((t=>{let{from:n,to:o}=t;return n.insId!==e.id&&o.insId!==e.id})),n.instances.push(...t.instances),n.connections.push(...t.connections.filter((e=>(0,l.isInternalConnectionNode)(e.from)&&(0,l.isInternalConnectionNode)(e.to))))}));o(n,{type:"functional",message:"ungroup"}),Y({selected:[]})}else{const t=(0,l.getPartDef)(e.partId,ae);if(!(0,l.isVisualPart)(t))return void(0,O.toastMsg)("Not supported","warning")}}),[Q,o,Y,ae]),Dt=u.useCallback((async e=>{}),[]),Mt=u.useCallback(((e,t)=>{const n=(0,A.handleDetachConstEditorCommand)(Q,e.id,t);o(n,(0,E.functionalChange)("detach-const"))}),[o,Q]),St=u.useCallback(((e,t)=>{const n=e.inputConfig[t]||(0,_.queueInputPinConfig)();(0,l.isStaticInputPinConfig)(n)&&(Ne(n.value),O.AppToaster.show({message:"Value copied"}))}),[]),Nt=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{const o=n.instances.find((t=>t.id===e.id));if(!o)throw new Error("Impossible state");o.inputConfig[t]=(0,l.staticInputPinConfig)(Se),n.connections=n.connections.filter((n=>!(0,l.isInternalConnectionNode)(n.to)||!(n.to.insId===e.id&&n.to.pinId===t)))}));o(n,(0,E.functionalChange)("paste const value"))}),[Q,o,Se]),kt=u.useCallback((async e=>{const t=await He("New name?");if(!t)return;const n=(0,g.produce)(Q,(n=>{var o;"input"===e?(Q.inputs||(n.inputs={}),n.inputs[t]=(0,l.partInput)(),n.inputsPosition[t]=Qe.current):(Q.outputs||(n.outputs={}),n.outputs[t]=(0,l.partOutput)(),n.outputsPosition[t]=Qe.current,(null===(o=n.completionOutputs)||void 0===o?void 0:o.length)&&(0,O.toastMsg)("Note that this part has explicit completion outputs set. You may need to update them."))}));o(n,(0,E.functionalChange)("add new io pin")),se("addIoPin",{type:e})}),[He,Q,o,se]),Tt=u.useCallback((async()=>{var e;const t=null===(e=Q.completionOutputs)||void 0===e?void 0:e.join(","),n=await He("Edit completion outputs",t);if((0,p.isDefined)(n)&&null!==n){const e=(0,g.produce)(Q,(e=>{e.completionOutputs=""===n?void 0:n.split(",")}));o(e,(0,E.functionalChange)("change part completions")),se("editCompletionOutputs",{count:n?n.split(",").length:0})}}),[He,o,Q,se]),Rt=u.useCallback((async()=>{var e;const t=null===(e=Q.reactiveInputs)||void 0===e?void 0:e.join(","),n=await He("Edit reactive inputs",t);if((0,p.isDefined)(n)&&null!==n){const e=(0,g.produce)(Q,(e=>{e.reactiveInputs=""===n?void 0:n.split(",")}));o(e,(0,E.functionalChange)("change reactive inputs")),se("editReactiveInputs",{count:n?n.split(",").length:0})}}),[He,o,Q,se]),Vt=u.useCallback((async()=>{const e=await He("Description?",Q.description),t=(0,g.produce)(Q,(t=>{t.description=e}));o(t,(0,E.functionalChange)("Edit part description"))}),[He,o,Q]),At=u.useCallback((e=>{const t=(0,g.produce)(Q,(t=>{t.defaultStyle=e}));o(t,(0,E.functionalChange)("change default style")),se("changeStyle",{isDefault:!0})}),[o,Q,se]),zt=u.useCallback((async(e,t)=>{const n=await He("New name?",t)||t,i=(0,m.handleIoPinRename)(Q,e,t,n);o(i,(0,E.functionalChange)("rename io pin"))}),[Q,o,He]),Ht=u.useCallback(((e,t)=>{const n=(0,m.handleChangePartInputType)(Q,e,t);o(n,(0,E.functionalChange)("toggle io pin optional"))}),[Q,o]),Gt=u.useCallback((e=>{switch(e.type){case L.ActionType.RemovePart:{const e=(0,g.produce)(Q,(e=>{if(!(0,l.isVisualPart)(Q))throw new Error("Impossible state, deleting instances opf non visual part");e.instances=e.instances.filter((e=>!le.includes(e.id))),e.connections=e.connections.filter((e=>!le.includes(e.from.insId)&&!le.includes(e.to.insId)))}));Y({selected:[]}),o(e,(0,E.functionalChange)("remove-instances")),(0,O.toastMsg)("Removed "+le.length+" instances(s)"),se("deleteInstances",{count:le.length});break}case L.ActionType.Inspect:if(1===le.length)Z(le[0]);else if(ce||de){const e=null!=ce?ce:de,t=(0,l.isExternalConnectionNode)(e)?l.ROOT_INS_ID:e.insId;Z(t,{type:ce?"output":"input",id:e.pinId})}se("openInspectMenu",{source:"actionMenu"});break;case L.ActionType.Group:(async()=>{await Ze()})();break;case L.ActionType.UnGroup:{const e=Q.instances.find((e=>e.id===le[0]));Et(e);const t=(0,l.getPartDef)(e,ae);(0,O.toastMsg)("Ungrouped inline part "+t.id),se("unGroupPart",{instancesCount:t.instances.length});break}case L.ActionType.AddInlineValue:Te({type:"new-floating",pos:Qe.current}),se("addValueModalOpen",{source:"actionMenu"});break;case L.ActionType.AddPart:!async function(){const t=(0,m.getMiddleOfViewPort)(Ge,Ke),{importablePart:n}=e.data,i=await ie(n),s=(0,C.vSub)(t,{x:0,y:50*Ge.zoom}),r=(0,m.createNewPartInstance)(n.part.id,0,s,i),a=(0,g.produce)(Q,(e=>{e.instances.push(r)})),u=(0,g.produce)(J,(e=>{e.selected=[r.id]}));o(a,(0,E.functionalChange)("add new instance")),Y(u),(0,O.toastMsg)("Part "+n.part.id+" successfully imported from "+n.module),se("addPart",{partId:n.part.id,source:"actionMenu"})}();break;case L.ActionType.AI:!async function(){const t=(0,m.getMiddleOfViewPort)(Ge,Ke),{importablePart:n}=e.data,i=await ie(n),s=(0,C.vSub)(t,{x:0,y:50*Ge.zoom}),r=(0,m.createNewPartInstance)(n.part.id,0,s,i),a=(0,g.produce)(Q,(e=>{e.instances.push(r)})),u=(0,g.produce)(J,(e=>{e.selected=[r.id]}));o(a,(0,E.functionalChange)("add new instance")),Y(u),(0,O.toastMsg)("Part "+n.part.id+" successfully imported from "+n.module),se("addPart",{partId:n.part.id,source:"actionMenu"})}();break;default:(0,O.toastMsg)(e.type+" not supported yet")}}),[J,ce,o,Y,Ze,ie,Z,Et,Q,ae,se,le,de,Ge,Ke]),Lt=()=>{const t=J.from;return(0,p.entries)(he).map((n=>{let[o,s]=n;return(0,a.jsx)(b.PartIoView,{currentInsId:X,ancestorInsIds:e.ancestorsInsIds,type:"input",pos:me[o]||{x:0,y:0},id:o,onDelete:i?yt:void 0,onRename:i?zt:void 0,onDblClick:qt,closest:!(!Je||"input"!==Je.type||Je.ins.id!==Q.id||Je.pin!==o),connected:!1,inputMode:s.mode,onChangeInputMode:Ht,viewPort:Ge,onDragStart:pt,onDragEnd:mt,onDragMove:ft,onSelect:tt,onSetDescription:nt,selected:(null==t?void 0:t.pinId)===o,description:s.description,onMouseUp:Pn,onMouseDown:Cn},o)}))},Bt=()=>{const{to:t}=J;return(0,p.entries)(ve).map((n=>{let[o,s]=n;return(0,a.jsx)(b.PartIoView,{currentInsId:X,ancestorInsIds:e.ancestorsInsIds,type:"output",pos:ge[o]||{x:0,y:0},id:o,onDelete:i?yt:void 0,onRename:i?zt:void 0,closest:!(!Je||"output"!==Je.type||Je.ins.id!==Q.id||Je.pin!==o),connected:!1,viewPort:Ge,onDragStart:pt,onDragEnd:mt,onDragMove:ft,onSelect:tt,onSetDescription:nt,description:s.description,selected:(null==t?void 0:t.pinId)===o,onMouseUp:Pn,onMouseDown:Cn},o)}))},Ft=()=>{if(be){const{from:e,to:t}=be,n=(0,m.logicalPosToRenderedPos)(e,Ge),o=(0,m.logicalPosToRenderedPos)(t,Ge);console.log(e.x,t.x," | ",n.x,o.x);const{x:i,y:s,w:r,h:u}=(0,m.getSelectionBoxRect)(n,o);return(0,a.jsx)("div",{className:"selection-box",style:{top:s,left:i,width:r,height:u}})}return null},Ut=u.useCallback((async(e,t,n,o)=>{if("input"===n){const n=e.inputConfig[t],o=(0,l.isStaticInputPinConfig)(n)?JSON.stringify(n.value):void 0;Te({type:"static-input",insId:e.id,pinId:t,value:null!=o?o:JSON.stringify("Some static value")}),se("addValueModalOpen",{source:"dblClickPin"})}else{const i=(0,l.getPartDef)(e,ae);if(!(0,l.getPartOutputs)(i)[t])throw new Error("Dbl clicked on un-existing pin");Me({pos:{x:o.clientX,y:o.clientY},ins:e,targetPart:i,pinId:t,pinType:n})}}),[ae,se]),qt=u.useCallback((async(e,t)=>{if(!Q.inputs[e])throw new Error("Dbl clicked on un-existing pin");Me({pos:{x:t.clientX,y:t.clientY},pinId:e,pinType:"input",targetPart:Q})}),[Q]),Wt=u.useCallback((e=>{if(e.metaKey||e.ctrlKey){const t=-.005*e.deltaY;at(Ge.zoom+t,"mouse"),e.preventDefault(),e.stopPropagation()}else{if(oe)return;const t=e.deltaX,n=e.deltaY,o=(0,g.produce)(Ge,(e=>{e.pos.x=e.pos.x+t/e.zoom,e.pos.y=e.pos.y+n/e.zoom}));Ue(o),e.stopPropagation(),e.preventDefault()}}),[oe,at,Ue,Ge]);(0,h.useEffect)((()=>{const{current:e}=Xe;if(e)return e.addEventListener("wheel",Wt),()=>{e.removeEventListener("wheel",Wt)}}),[Wt]);const Zt={backgroundPositionX:(0,m.roundNumber)(-Ge.pos.x*Ge.zoom),backgroundPositionY:(0,m.roundNumber)(-Ge.pos.y*Ge.zoom),backgroundSize:(0,m.roundNumber)(25*Ge.zoom)+"px"},Jt=u.useRef(new Map);u.useEffect((()=>{const e=pe.reduce(((e,t)=>{const n=(0,l.getPartDef)(t,ae);return n&&e.set(t.id,(0,l.keys)((0,l.getPartInputs)(n))),e}),new Map),t=pe.reduce(((e,t)=>{const n=(0,l.getPartDef)(t,ae);return n&&e.set(t.id,(0,l.keys)((0,l.getPartOutputs)(n))),e}),new Map);e.set(l.THIS_INS_ID,(0,l.keys)(Q.outputs)),t.set(l.THIS_INS_ID,(0,l.keys)(Q.inputs));const n=fe.filter((n=>{const o=e.get(n.to.insId)&&e.get(n.to.insId).includes(n.to.pinId),i=t.get(n.from.insId)&&t.get(n.from.insId).includes(n.from.pinId);return!(o&&i)}));if(n.length>0){(0,O.toastMsg)(n.length+" orphan connections removed","warning"),console.log(n.length+" orphan connections removed",n);const e=(0,g.produce)(Q,(e=>{e.connections=Q.connections.filter((e=>!n.includes(e)))}));o(e,(0,E.functionalChange)("prune orphan connections"))}}),[pe,o,fe,Q,ae]),u.useEffect((()=>{let e=[];const t=(0,g.produce)(Q,(t=>{t.instances=t.instances.map((t=>{const n=(0,l.getPartDef)(t,ae);if(n){const o=(0,l.getPartInputs)(n),i=(0,l.getPartOutputs)(n);if(t.visibleInputs){const n=t.visibleInputs.filter((e=>!o[e]));n.length>0&&(t.visibleInputs=(0,l.keys)(o),e.push(...n))}if(t.visibleOutputs){const n=t.visibleOutputs.filter((e=>!i[e]));n.length>0&&(t.visibleOutputs=(0,l.keys)(i),e.push(...n))}}return t}))}));e.length>0&&((0,O.toastMsg)("Found "+e.length+" invalid visible inputs/outputs: "+e.join(", ")+". Reset them","warning"),o(t,(0,E.functionalChange)("reset corrupt visible inputs/outputs")))}),[pe,o,Q,ae]),(0,h.useEffect)((()=>{const e=new Map(pe.map((e=>[e.id,e])));Jt.current=fe.reduce(((t,n)=>{const o=t.get(n.to.insId)||{},i=o[n.to.pinId]||[],s={...o,[n.to.pinId]:[...i,e.get(n.from.insId)]};return t.set(n.to.insId,s),t}),new Map)}),[fe,pe]);const Yt=u.useCallback((()=>{Me(void 0)}),[]),Xt=u.useCallback((async e=>{if(!De)throw new Error("impossible state - quick add menu invoked but not available");const{ins:t,pinId:n}=De;switch(e.type){case"import":case"part":{const i="import"===e.type?await ie(e.importablePart):ae,s="import"===e.type?e.importablePart.part:e.part,r=(0,m.createNewPartInstance)(s.id,100,Qe.current,i);if(r){const e=(0,g.produce)(Q,(e=>{e.instances.push(r),e.connections.push({from:{insId:t?t.id:l.THIS_INS_ID,pinId:n},to:{insId:r.id,pinId:l.TRIGGER_PIN_ID}})}));o(e,(0,E.functionalChange)("add-item-quick-menu")),Yt()}se("addPart",{partId:s.id,source:"quickAdd"});break}case"value":if(!t)return void(0,O.toastMsg)("Cannot add value to main input");Te({type:"new-output",insId:t.id,pinId:n}),se("addValueModalOpen",{source:"quickAdd"})}}),[De,ae,se,Q,o,Yt,ie]),Kt=u.useCallback((async()=>{const e=JSON.stringify(Q);await navigator.clipboard.writeText(e),O.AppToaster.show({message:"Copied!"})}),[Q]),Qt=u.useCallback((e=>{var t,n;const o=i?"":" (cannot edit main part, only visual)";return(0,a.jsxs)(y.Menu,{children:[(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:"New Value",onClick:(0,p.preventDefaultAnd)((()=>{Te({type:"new-floating",pos:Qe.current}),se("addValueModalOpen",{source:"contextMenu"})}))}),(0,a.jsx)(y.MenuItem,{text:"New input "+o,onMouseDown:e=>e.stopPropagation(),onClick:(0,p.preventDefaultAnd)((()=>kt("input"))),disabled:!i}),(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:"New output "+o,onClick:(0,p.preventDefaultAnd)((()=>kt("output"))),disabled:!i}),(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:"Copy part to clipboard",onClick:(0,p.preventDefaultAnd)(Kt)}),(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:"Edit Completion Outputs ("+((null===(t=Q.completionOutputs)||void 0===t?void 0:t.join(","))||"n/a")+")",onClick:(0,p.preventDefaultAnd)((()=>Tt()))}),(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:"Edit Reactive inputs ("+((null===(n=Q.reactiveInputs)||void 0===n?void 0:n.join(","))||"n/a")+")",onClick:(0,p.preventDefaultAnd)((()=>Rt()))}),(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:"Edit description",onClick:(0,p.preventDefaultAnd)((()=>Vt()))}),(0,a.jsx)(y.MenuDivider,{}),(0,a.jsx)(y.MenuItem,{text:"Default Style",children:(0,a.jsx)(H.PartStyleMenu,{style:Q.defaultStyle,onChange:At,promptFn:He})})]})}),[i,Kt,Q.completionOutputs,Q.reactiveInputs,Q.defaultStyle,At,He,se,kt,Tt,Rt,Vt]),$t=u.useCallback((e=>{if(e.preventDefault(),!Le.current)return;const t=(0,m.domToViewPort)({x:e.clientX,y:e.clientY},Ge,re),n=Qt(t);y.ContextMenu.show(n,{left:e.clientX,top:e.clientY})}),[Qt,re,Ge]);(0,v.useHotkeys)("shift+c",et,{text:"Center viewport",group:"Viewport Controls"},[],Le),(0,v.useHotkeys)("cmd+c",it,{text:"Copy instances",group:"Editing"},[],Le),(0,v.useHotkeys)("cmd+v",st,{text:"Paste instances",group:"Editing"},[],Le),(0,v.useHotkeys)("esc",ut,{text:"Clear selections",group:"Selection"},[],Le),(0,v.useHotkeys)("backspace",bt,{text:"Delete instances",group:"Editing"},[],Le),(0,v.useHotkeys)("shift+d",Pt,{text:"Duplicate selected instances",group:"Editing"},[],Le),(0,v.useHotkeys)("cmd+a",ht,{text:"Select all",group:"Selection"},[],Le),(0,v.useHotkeys)("s",rt,{text:"Select pin closest to mouse",group:"Selection"},[],Le);const en=u.useCallback(((e,t)=>{if(!Re)throw new Error("impossible state");const n=(0,g.produce)(Q,(t=>{const n=t.instances.find((e=>e.id===Re.insId));if(!n||!(0,l.isInlinePartInstance)(n))throw new Error("impossible state");n.part=e}));o(n,(0,E.functionalChange)("Inner change: "+t.message)),Ve((t=>({...t,part:e})))}),[o,Re,Q]),[tn,nn]=(0,h.useState)({selected:[],viewPort:t.defaultViewPort,lastMousePos:{x:0,y:0}}),on=u.useCallback((e=>nn((t=>({...t,...e})))),[]),sn=n=>Re&&Re.insId===n.id?{currentInsId:Re.insId,ancestorsInsIds:(0,l.fullInsIdPath)(X,K),boardData:tn,onChangeBoardData:on,resolvedDependencies:ee,onCopy:s,clipboardData:e.clipboardData,onInspectPin:e.onInspectPin,onGoToPartDef:e.onGoToPartDef,partIoEditable:e.partIoEditable,part:Re.part,onChangePart:en,onShowOmnibar:$,parentViewport:t.defaultViewPort,parentBoardPos:$e,onExtractInlinePart:e.onExtractInlinePart,queuedInputsData:e.queuedInputsData}:void 0,rn=()=>{if(ce&&("input"===(null==Je?void 0:Je.type)&&(null==Je?void 0:Je.ins.id)!==Q.id||(null==Je?void 0:Je.ins.id)===Q.id&&"output"===(null==Je?void 0:Je.type))){const e=Je.ins.id===Q.id?{pinId:Je.pin,insId:l.THIS_INS_ID}:{insId:Je.ins.id,pinId:Je.pin};if(!(0,l.isInternalConnectionNode)(e)&&!(0,l.isInternalConnectionNode)(ce))return;return{from:ce,to:e}}if(de&&("output"===(null==Je?void 0:Je.type)&&(null==Je?void 0:Je.ins.id)!==Q.id||(null==Je?void 0:Je.ins.id)===Q.id&&"input"===(null==Je?void 0:Je.type))){const e=Je.ins.id===Q.id?{pinId:Je.pin,insId:l.THIS_INS_ID}:{insId:Je.ins.id,pinId:Je.pin};if(!(0,l.isInternalConnectionNode)(de)&&!(0,l.isInternalConnectionNode)(e))return;return{from:e,to:de}}},an=()=>{const e=rn();if(e){const{from:t,to:n}=e;return{connection:{from:t,to:n},type:fe.some((t=>(0,l.connectionDataEquals)(t,e)))?"future-remove":"future-add"}}},un=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{n.instances=n.instances.map((n=>n.id===e.id?{...n,visibleInputs:t}:n))}));o(n,(0,E.functionalChange)("change instance visible inputs"))}),[Q,o]),ln=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{n.instances=n.instances.map((n=>n.id===e.id?{...n,style:t}:n))}));o(n,(0,E.functionalChange)("change instance style")),se("changeStyle",{isDefault:!1})}),[o,Q,se]),cn=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{n.instances=n.instances.map((n=>n.id===e.id?{...n,visibleOutputs:t}:n))}));o(n,(0,E.functionalChange)("change instance visible outputs"))}),[Q,o]),dn=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{n.instances=n.instances.map((n=>n.id===e.id?{...n,displayName:t}:n))}));o(n,(0,E.functionalChange)("change instance display name"))}),[Q,o]);u.useImperativeHandle(n,(()=>({centerInstance(e){const t=Q.instances.find((t=>t.id===e));if(t){const e=(0,C.vSub)(t.pos,(0,C.vec)(Ke.width/2,Ke.height/2));Ue({...Ge,pos:e})}},centerViewPort(){et()},getViewPort:()=>Ge,clearSelection:()=>{ut()},requestNewInlineValue:()=>{Te({type:"new-floating",pos:Qe.current})}})));const[pn,fn]=u.useState([]),mn=u.useCallback(((e,t)=>{const n=t.trim().substr(0,100),i="Inline-value-"+n.substr(0,15).replace(/["'`]/g,""),s=(0,M.createInlineValuePart)({code:t,customView:n,partId:i,type:e});switch(ke.type){case"existing":{const[e]=Q.instances.filter((e=>e.id===ke.insId)).filter((e=>(0,l.isInlinePartInstance)(e))).map((e=>e.part));if(!e)throw new Error("Unable to find inline part to save to");const t=(0,l.keys)(e.inputs),n=(0,l.keys)(s.inputs),i=new Set(S.default.difference(t,n)),r=(0,g.produce)(Q,(e=>{e.instances=e.instances.map((e=>e.id===ke.insId?(0,l.inlinePartInstance)(e.id,s,e.inputConfig,e.pos):e)),e.connections=e.connections.filter((e=>!(e.to.insId===ke.insId&&i.has(e.to.pinId))))}));o(r,(0,E.functionalChange)("change inline value")),Te(void 0);break}case"static-input":{let e;try{const n=t.replace(/^['`]/,'"').replace(/['`]$/,'"');e=JSON.parse(n)}catch(r){return void(0,O.toastMsg)("Input values must not be formulas or code")}const n=(0,g.produce)(Q,(t=>{t.instances.find((e=>e.id===ke.insId)).inputConfig[ke.pinId]=(0,l.staticInputPinConfig)(e)}));o(n,(0,E.functionalChange)("set static input value")),Te(void 0);break}case"new-floating":{const e=(0,l.inlinePartInstance)((0,l.createInsId)(s),s,{},ke.pos),t=(0,g.produce)(Q,(t=>{t.instances.push(e)}));o(t,(0,E.functionalChange)("new floating value")),Te(void 0);break}case"new-output":{const{insId:e,pinId:t}=ke,n=Q.instances.find((t=>t.id===e));if(!n)throw new Error("Impossible state");const i=(0,l.inlinePartInstance)((0,l.createInsId)(s),s,{},(0,C.vAdd)(n.pos,{x:-50,y:150})),r=(0,g.produce)(Q,(n=>{n.instances.push(i),n.connections.push({from:(0,l.connectionNode)(e,t),to:(0,l.connectionNode)(i.id,l.TRIGGER_PIN_ID)})}));o(r,(0,E.functionalChange)("new value connected to output")),Te(void 0)}}se("addValue",{type:e,placeholdersCount:(0,l.keys)(s.inputs).length})}),[ke,o,Q,se]),gn=fe.filter((e=>{const t=rn();return!t||!(0,l.connectionDataEquals)(t,e)})),hn=u.useCallback((()=>{Ve(void 0),nn(t.defaultBoardData)}),[]),vn=u.useCallback((e=>{const t=(0,g.produce)(Q,(t=>{const n=t.connections.find((t=>(0,l.connectionDataEquals)(t,e)));n.hidden=!n.hidden}));o(t,(0,E.functionalChange)("toggle connection hidden"))}),[o,Q]),In=u.useCallback((e=>{const t=(0,g.produce)(Q,(t=>{t.connections=t.connections.filter((t=>!(0,l.connectionDataEquals)(t,e)))}));o(t,(0,E.functionalChange)("remove connection"))}),[o,Q]),yn=u.useCallback(((e,t,n)=>{"input"===n?(console.log(e.id,t),Fe({to:(0,l.connectionNode)(e.id,t),from:void 0})):Fe({from:(0,l.connectionNode)(e.id,t),to:void 0})}),[]),bn=u.useCallback(((e,t,n)=>{Be&&(Be.from&&"input"===n?We(Be.from,(0,l.connectionNode)(e.id,t),"pinDrag"):Be.to&&"output"===n&&We((0,l.connectionNode)(e.id,t),Be.to,"pinDrag")),Fe(null)}),[Be,We]),Cn=u.useCallback(((e,t)=>{}),[]),Pn=u.useCallback(((e,t)=>{Be&&(Be.from&&"output"===t?We(Be.from,(0,l.externalConnectionNode)(e),"partIoPinDrag"):Be.to&&"input"===t&&We((0,l.externalConnectionNode)(e),Be.to,"partIoPinDrag"))}),[Be,We]);try{return(0,a.jsxs)("div",{className:(0,T.default)("visual-part-editor",e.className),"data-id":Q.id,onContextMenu:$t,children:[(0,a.jsxs)("main",{className:"board-editor-inner",onMouseDown:_t,onMouseUp:xt,onMouseMove:jt,onMouseLeave:wt,ref:Xe,style:Zt,children:[(0,a.jsx)(u.Fragment,{children:(0,a.jsx)(j.LayoutDebugger,{vp:Ge,part:Q,extraDebug:m.emptyList,mousePos:Qe.current})}),(0,a.jsx)(d.ConnectionView,{resolvedParts:ae,currentInsId:X,ancestorsInsIds:K,size:Ke,part:Q,boardPos:$e,instances:pe,connections:gn,futureConnection:an(),onDblClick:l.noop,viewPort:Ge,parentVp:re,selectedInstances:le,toggleHidden:vn,removeConnection:In,lastMousePos:Qe.current,draggedSource:Be}),Lt(),pe.map((t=>{var n,o,i,s,r;return(0,a.jsx)(c.InstanceView,{onUngroup:Et,onExtractInlinePart:Dt,onDetachConstValue:Mt,onCopyConstValue:St,onPasteConstValue:Nt,copiedConstValue:Se,connectionsPerInput:Jt.current.get(t.id)||m.emptyObj,part:(0,l.getPartDef)(t,ae),ancestorsInsIds:(0,l.fullInsIdPath)(X,K),onPinClick:ot,onPinDblClick:Ut,onDragStart:lt,onDragEnd:dt,resolvedDeps:ae,onDragMove:ct,onDblClick:Ot,onSelect:gt,onToggleSticky:Ct,selected:-1!==le.indexOf(t.id),dragged:Ie===t.id,onInspectPin:qe,selectedInput:de&&(0,l.isInternalConnectionNode)(de)&&de.insId===t.id?de.pinId:void 0,selectedOutput:ce&&(0,l.isInternalConnectionNode)(ce)&&ce.insId===t.id?ce.pinId:void 0,closestPin:Je&&Je.ins.id===t.id?Je:void 0,queuedInputsData:null!==(n=te[t.id])&&void 0!==n?n:m.emptyObj,instance:t,connections:fe,onTogglePinBreakpoint:l.noop,onTogglePinLog:l.noop,viewPort:Ge,onChangeVisibleInputs:un,onChangeVisibleOutputs:cn,onSetDisplayName:dn,onDeleteInstance:It,forceShowMinimized:ce||(null===(o=null==Be?void 0:Be.to)||void 0===o?void 0:o.insId)===t.id?"input":de||(null===(i=null==Be?void 0:Be.from)||void 0===i?void 0:i.insId)===t.id?"output":void 0,isConnectedInstanceSelected:le.some((e=>fe.some((n=>{let{from:o,to:i}=n;return o.insId===t.id&&i.insId===e||o.insId===e&&i.insId===t.id})))),inlineGroupProps:sn(t),onCloseInlineEditor:hn,inlineEditorPortalDomNode:Ae.current,onChangeStyle:ln,onGroupSelected:Ze,onPinMouseDown:yn,onPinMouseUp:bn,hadError:null!==(r=null===(s=e.instancesWithErrors)||void 0===s?void 0:s.has((0,l.fullInsIdPath)(t.id)))&&void 0!==r&&r},t.id)})),Ft(),Bt(),(0,a.jsx)(B.MainInstanceEventsIndicator,{currentInsId:X,ancestorsInsIds:K,viewPort:Ge}),De?(0,a.jsx)(P.QuickAddMenu,{targetPart:De.targetPart,pinId:De.pinId,pinType:De.pinType,pos:De.pos,resolvedDependencies:ee,part:Q,onAdd:Xt,onClose:Yt}):null,(0,a.jsxs)("div",{className:"viewport-controls-and-help",children:[(0,a.jsx)(y.Button,{small:!0,onClick:et,minimal:!0,intent:"primary",children:"Center"}),(0,a.jsx)(U,{min:.15,max:3,stepSize:.05,labelStepSize:10,labelRenderer:q,onChange:at,value:Ge.zoom}),Pe?(0,a.jsx)(F.HelpBubble,{}):null]}),ke?(0,a.jsx)(D.InlineCodeModal,{env:m.emptyObj,initialValue:ke.value,initialType:"existing"===ke.type?ke.templateType:void 0,onCancel:()=>Te(void 0),onSubmit:mn}):null,(0,a.jsx)("div",{className:"inline-editor-portal-root"})]}),(0,a.jsx)(L.ActionsMenu,{showRunFlowOptions:Pe,onAction:Gt,selectedInstances:le,part:Q,resolvedParts:ae,to:de,from:ce,hotkeysEnabled:Le})]})}catch(_n){return console.error(_n),(0,a.jsxs)("div",{children:["Error rendering board - ",_n.toString()]})}})));const W=(e,t)=>{const n=e.target.closest(".visual-part-editor");return n&&n.getAttribute("data-id")===t}},71651:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BasePartView=void 0;const a=n(20264),u=s(n(49231)),l=r(n(65443)),c=r(n(51406));t.BasePartView=function(e){const{dragged:t,viewPort:n,pos:o,onDragEnd:i,onDragMove:s,onDragStart:r,displayMode:d}=e,p=u.useCallback(((e,t)=>{r(e,t)}),[r]),f=u.useCallback(((e,t)=>{const s=o,r=(t.x-s.x)/n.zoom,a=(t.y-s.y)/n.zoom,u=s.x+r,l=s.y+a;i(e,{...t,x:u,y:l})}),[o,i,n]),m=u.useCallback(((e,t)=>{s(e,{x:t.x,y:t.y})}),[s]),g={transform:"scale("+n.zoom+")"},h=(0,l.default)("base-part-view",e.className,{dragged:t,"display-mode":d}),v=o.x*n.zoom-n.pos.x*n.zoom,I=o.y*n.zoom-n.pos.y*n.zoom,y={transform:"translate("+(v-o.x)+"px, "+(I-o.y)+"px)"},b=(0,l.default)("base-part-view-vp-fixer",{"display-mode":d});return(0,a.jsx)("div",{className:b,style:y,children:(0,a.jsx)(c.default,{onStop:f,onStart:p,onDrag:m,position:o,cancel:".no-drag",children:(0,a.jsx)("span",{className:"base-part-view-wrapper",children:(0,a.jsx)("div",{className:h,style:g,id:e.domId,children:e.children})})})})}},76458:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleConnectionCloseEditorCommand=void 0;const i=n(14376),s=o(n(53865));t.handleConnectionCloseEditorCommand=(e,t)=>{let{from:n,to:o}=t;return(0,s.default)(e,(e=>{const t=e.connections.find((e=>{const t=(0,i.connectionNodeEquals)(n,e.from),s=(0,i.connectionNodeEquals)(o,e.to);return t&&s}));t?e.connections=e.connections.filter((e=>e!==t)):e.connections.push({from:n,to:o})}))}},23744:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleDetachConstEditorCommand=void 0;const i=n(14376),s=o(n(53865)),r=n(18841);t.handleDetachConstEditorCommand=(e,t,n)=>(0,s.default)(e,(e=>{const{instances:o}=e,s=o.find((e=>e.id===t));if(!s)throw new Error("Impossible state ins id with no matching instance");const a=s.inputConfig[n];if(!a)throw new Error("impossible state detaching const from unexistent config");if(!(0,i.isStaticInputPinConfig)(a))throw new Error("impossible state detaching const with no value");const u=JSON.stringify(a.value),l=(0,r.createInlineValuePart)({code:""+u,type:i.InlineValuePartType.VALUE}),c=(0,i.inlinePartInstance)("value-"+(0,i.randomInt)(999),l,{},{x:s.pos.x,y:s.pos.y-100});if(!e.instances.find((e=>e.id===s.id)))throw new Error("impossible state instance not found");s.inputConfig[n]=(0,i.queueInputPinConfig)(),e.instances.push(c),e.connections.push((0,i.connectionData)(c.id+".value",s.id+"."+n))}))},5593:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleDuplicateSelectedEditorCommand=void 0;const i=n(14376),s=o(n(53865));t.handleDuplicateSelectedEditorCommand=(e,t)=>{const n=[];return{newPart:(0,s.default)(e,(o=>{const s=o.instances;t.forEach((t=>{const o=s.find((e=>e.id===t));if(!o)throw new Error("impossible state duplicate selected no matching instance");if(o){const{pos:t}=o,r={...o,pos:{x:t.x+20,y:t.y+20},id:(0,i.createInsId)(e)};s.push(r),n.push(r.id)}}))})),newInstances:n}}},62917:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.pasteInstancesCommand=void 0;const i=n(14376),s=o(n(53865));t.pasteInstancesCommand=(e,t,n)=>{const o=n.instances.map((n=>({...n,pos:t,id:(0,i.createInsId)(e)}))),r=new Map(o.map(((e,t)=>[n.instances[t].id,e.id])));return{newPart:(0,s.default)(e,(e=>{e.instances.push(...o);const t=n.connections.map((e=>{let{from:t,to:n}=e;return{from:{...t,insId:r.get(t.insId)||t.insId},to:{...n,insId:r.get(n.insId)||n.insId}}}));e.connections.push(...t)})),newInstances:o}}},83133:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionView=t.SingleConnectionView=void 0;const a=n(49231),u=n(20264),l=s(n(49231)),c=r(n(65443)),d=n(14376),p=n(85418),f=n(30905),m=n(44108),g=n(59429),h=n(51857),v=n(81776);t.SingleConnectionView=e=>{const{isBrowser:t}=(0,f.useSsr)(),{connection:n,part:o,resolvedParts:i,instances:s,type:r,viewPort:a,toggleHidden:m,parentSelected:I,removeConnection:y}=e,{from:b}=n,C=(0,d.isInternalConnectionNode)(b)&&s.find((e=>e.id===b.insId));if(!C&&(0,d.isInternalConnectionNode)(b))throw new Error('impossible state  - "from instance id - ['+b.insId+'] does not exist"');const P=((0,d.isInternalConnectionNode)(b)&&C?(0,d.getPartDef)(C,i):o).outputs[b.pinId],_=P&&P.delayed,x=t?(0,p.calcStartPos)({...e,connectionNode:b}):{x:0,y:0},j=t?(0,p.calcTargetPos)({...e,connectionNode:n.to}):{x:0,y:0},{x:w,y:O}=(0,g.vDiv)(x,e.parentVp.zoom),{x:E,y:D}=(0,g.vDiv)(j,e.parentVp.zoom),M=(0,c.default)({delayed:_,hidden:n.hidden,"parent-selected":I},r),S=l.useCallback((e=>{e.preventDefault(),e.stopPropagation();const t=(0,u.jsxs)(h.Menu,{children:[(0,u.jsx)(h.MenuItem,{text:n.hidden?"Show connection":"Hide connection",onClick:()=>m(n)}),(0,u.jsx)(h.MenuItem,{text:"Remove connection",onClick:()=>y(n)})]});h.ContextMenu.show(t,{left:e.pageX,top:e.pageY})}),[n,y,m]);return(0,u.jsx)(v.ConnectionViewPath,{className:M,from:{x:w,y:O},to:{x:E,y:D},dashed:"regular"!==r,zoom:a.zoom,onContextMenu:S})};t.ConnectionView=e=>{var n;const{viewPort:o,futureConnection:i,toggleHidden:s,selectedInstances:r,draggedSource:c}=e,[d,f]=l.useState(0),g=l.useCallback((e=>requestAnimationFrame((()=>{f((e=>(e+1)%9)),e>0&&g(e-1)}))),[]);l.useEffect((()=>{const e=g(10);return()=>{cancelAnimationFrame(e)}}),[g]),l.useEffect((()=>{const e=()=>{g(3)};return window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}}),[g,d]);const h=e.connections.map((n=>{const o=r.includes(n.from.insId)||r.includes(n.to.insId);return(0,a.createElement)(t.SingleConnectionView,{...e,connection:n,type:"regular",parentSelected:o,key:n.from.insId+n.from.pinId+n.to.insId+n.to.pinId})}));if(i&&h.push((0,a.createElement)(t.SingleConnectionView,{...e,connection:i.connection,type:i.type,toggleHidden:s,parentSelected:!1,key:"future"})),c){const t=(c.from?p.calcStartPos:p.calcTargetPos)({connectionNode:null!==(n=c.from)&&void 0!==n?n:c.to,viewPort:o,boardPos:e.boardPos,ancestorsInsIds:e.ancestorsInsIds,currentInsId:e.currentInsId});h.push((0,u.jsx)(v.ConnectionViewPath,{className:"dragged",from:t,to:(0,m.logicalPosToRenderedPos)(e.lastMousePos,o),zoom:o.zoom},"dragged"))}return(0,u.jsx)("span",{className:"connections-view",style:{opacity:o.zoom},children:(0,u.jsx)("svg",{style:{width:"100%"},children:h})})}},81776:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionViewPath=void 0;const i=n(20264),s=o(n(65443)),r=n(35394);t.ConnectionViewPath=e=>{const{from:t,to:n,className:o,onContextMenu:a,zoom:u,dashed:l}=e,{x:c,y:d}=t,{x:p,y:f}=n,m=(0,r.calcBezierPath)({sourceX:c,sourceY:d,targetX:p,targetY:f,curvature:.15}),g=3*u,h=l?6*u:void 0;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:m,className:(0,s.default)("connection",o),style:{strokeWidth:g,strokeDasharray:h},onContextMenu:a}),e.label?(0,i.jsx)("text",{className:"label",x:(c+p)/2,y:(d+f)/2,fontSize:"12px"}):null,(0,i.jsxs)("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,i.jsx)("stop",{offset:"0%"}),(0,i.jsx)("stop",{offset:"100%"})]})]})}},35394:(e,t)=>{"use strict";var n;function o(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function i(e){let t,i,{pos:s,x1:r,y1:a,x2:u,y2:l,c:c}=e;switch(s){case n.Left:t=r-o(r-u,c),i=a;break;case n.Right:t=r+o(u-r,c),i=a;break;case n.Top:t=r,i=a-o(a-l,c);break;case n.Bottom:t=r,i=a+o(l-a,c)}return[t,i]}Object.defineProperty(t,"__esModule",{value:!0}),t.getBezierCenter=t.calcBezierPath=t.Position=void 0,function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(n=t.Position||(t.Position={}));t.calcBezierPath=e=>{let{sourceX:t,sourceY:o,sourcePosition:s=n.Bottom,targetX:r,targetY:a,targetPosition:u=n.Top,curvature:l=.25}=e;const[c,d]=i({pos:s,x1:t,y1:o,x2:r,y2:a,c:l}),[p,f]=i({pos:u,x1:r,y1:a,x2:t,y2:o,c:l});return"M"+t+","+o+" C"+c+","+d+" "+p+","+f+" "+r+","+a},t.getBezierCenter=function(e){let{sourceX:t,sourceY:o,sourcePosition:s=n.Bottom,targetX:r,targetY:a,targetPosition:u=n.Top,curvature:l=.25}=e;const[c,d]=i({pos:s,x1:t,y1:o,x2:r,y2:a,c:l}),[p,f]=i({pos:u,x1:r,y1:a,x2:t,y2:o,c:l}),m=.125*t+.375*c+.375*p+.125*r,g=.125*o+.375*d+.375*f+.125*a;return[m,g,Math.abs(m-t),Math.abs(g-o)]}},85418:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcTargetPos=t.calcStartPos=t.calcPinPosition=void 0;const o=n(14376),i=n(60324),s={x:99999,y:99999};function r(e){const t=(0,i.getPinDomId)({fullInsIdPath:(0,o.fullInsIdPath)(e.insId,e.ancestorsInsIds),pinId:e.pinId,pinType:e.pinType,isMain:e.isMain});return((e,t,n,o)=>{if(!e)return console.warn("Cannot find element "+n+" to calculate position."),s;const{x:i,y:r,width:a,height:u}=e.getBoundingClientRect(),l=r+u/2;return{x:i+a/2-t.x,y:l-t.y}})(document.getElementById(t),e.boardPos,t,e.viewPort)}t.calcPinPosition=r;t.calcStartPos=e=>{const{connectionNode:t,boardPos:n,ancestorsInsIds:i,viewPort:s,currentInsId:a}=e;return(0,o.isExternalConnectionNode)(t)?r({pinId:t.pinId,insId:a,ancestorsInsIds:i,isMain:!0,pinType:"input",boardPos:n,viewPort:s}):r({pinId:t.pinId,insId:t.insId,ancestorsInsIds:(0,o.fullInsIdPath)(a,i),isMain:!1,pinType:"output",boardPos:n,viewPort:s})};t.calcTargetPos=e=>{const{connectionNode:t,boardPos:n,ancestorsInsIds:i,viewPort:s,currentInsId:a}=e;return(0,o.isExternalConnectionNode)(t)?r({pinId:t.pinId,insId:a,ancestorsInsIds:i,isMain:!0,pinType:"output",boardPos:n,viewPort:s}):r({pinId:t.pinId,insId:t.insId,ancestorsInsIds:(0,o.fullInsIdPath)(a,i),isMain:!1,pinType:"input",boardPos:n,viewPort:s})}},60324:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPinDomId=t.getMainInstanceIndicatorDomId=t.getInstanceDomId=void 0;const o=n(14376);t.getInstanceDomId=(e,t)=>("ins:"+(0,o.fullInsIdPath)(e,t)).replace(/\s+/g,"-");t.getMainInstanceIndicatorDomId=(e,t)=>("main-ins:"+(0,o.fullInsIdPath)(e,t)).replace(/\s+/g,"-");t.getPinDomId=e=>{let{pinType:t,fullInsIdPath:n,pinId:o,isMain:i}=e;return((i?"main-":"")+"pin:"+t+":"+n+":"+o).replace(/\s+/g,"-")}},36075:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceView=t.getVisibleOutputs=t.getVisibleInputs=t.INSTANCE_INFO_TOOLTIP_DELAY=t.MAX_INSTANCE_WIDTH=t.MIN_WIDTH_PER_PIN=t.PIECE_CHAR_WIDTH=t.PIECE_HORIZONTAL_PADDING=void 0;const a=n(20264),u=s(n(49231)),l=n(47315),c=n(14376),d=r(n(65443)),p=n(21153),f=n(14376),m=n(14376),g=n(46839),h=n(71651),v=n(14376),I=n(60324),y=n(99678),b=n(44108),C=n(51857),P=r(n(64151)),_=n(68122),x=r(n(62674));t.PIECE_HORIZONTAL_PADDING=25,t.PIECE_CHAR_WIDTH=11,t.MIN_WIDTH_PER_PIN=40,t.MAX_INSTANCE_WIDTH=400,t.INSTANCE_INFO_TOOLTIP_DELAY=400;t.getVisibleInputs=(e,t,n)=>{const{visibleInputs:o}=e;if(o)return o;const i=(0,c.keys)((0,m.getPartInputs)(t)).filter(((o,i)=>{var s;const r=n.some((t=>t.to.insId===e.id&&t.to.pinId===o)),a=t.inputs[o]&&"optional"===(null===(s=t.inputs[o])||void 0===s?void 0:s.mode);return r||!a&&o!==f.TRIGGER_PIN_ID}));return 0===i.length?[f.TRIGGER_PIN_ID]:i};t.getVisibleOutputs=(e,t,n)=>{const{visibleOutputs:o}=e;if(o)return o;const i=Object.keys(t.outputs);return n.some((t=>t.from.insId===e.id&&t.from.pinId===f.ERROR_PIN_ID))?[...i,f.ERROR_PIN_ID]:i};t.InstanceView=function(e){const{selected:n,selectedInput:o,selectedOutput:i,closestPin:s,dragged:r,onTogglePinLog:j,onTogglePinBreakpoint:w,onDetachConstValue:O,onCopyConstValue:E,onPasteConstValue:D,displayMode:M,connections:S,instance:N,viewPort:k,part:T,onPinClick:R,onPinDblClick:V,onDragStart:A,onDragEnd:z,onDragMove:H,onToggleSticky:G,onSelect:L,onDblClick:B,onChangeVisibleInputs:F,onChangeVisibleOutputs:U,onConvertConstToEnv:q,inlineGroupProps:W,onUngroup:Z,onExtractInlinePart:J,onGroupSelected:Y,isConnectedInstanceSelected:X,inlineEditorPortalDomNode:K,onChangeStyle:Q,onDeleteInstance:$,onSetDisplayName:ee,onPinMouseUp:te,onPinMouseDown:ne}=e,{id:oe}=N,ie=u.useMemo((()=>{const e=(0,c.randomInt)(6,1);return{icon:(0,c.pickRandom)([["fab","discord"],["fab","slack"],"bug","cube"]),color:e,size:(0,c.randomInt)(3,1),variation:(0,c.randomInt)(5,1)}}),[]),se=u.useRef(),re=u.useMemo((()=>N.style||T.defaultStyle||{}),[T,N]),ae=re.size||"regular",ue=u.useMemo((()=>new Map(S.filter((e=>{let{to:t}=e;return t.insId===oe})).map((e=>{let{to:t,hidden:n}=e;return[t.pinId,n]})))),[S,oe]),le=u.useMemo((()=>new Map(S.filter((e=>{let{from:t}=e;return t.insId===oe})).map((e=>{let{from:t,hidden:n}=e;return[t.pinId,n]})))),[S,oe]),ce=(0,b.usePrompt)(),de=u.useCallback((e=>R(N,e,"input")),[N,R]),pe=u.useCallback(((e,t)=>V(N,e,"input",t)),[N,V]),fe=u.useCallback(((e,t)=>V(N,e,"output",t)),[N,V]),me=u.useCallback((e=>R(N,e,"output")),[N,R]),ge=u.useCallback(((e,t)=>{A(N,e,t)}),[N,A]),he=u.useCallback(((e,t)=>{const n=N.pos,o=(t.x-n.x)/k.zoom,i=(t.y-n.y)/k.zoom,s=n.x+o,r=n.y+i;z(N,e,{...t,x:s,y:r})}),[N,z,k.zoom]),ve=u.useCallback(((e,t)=>{H(N,e,{x:t.x,y:t.y})}),[N,H]),Ie=u.useCallback((e=>G(N,e)),[N,G]),ye=u.useCallback((e=>O(N,e)),[N,O]),be=u.useCallback((e=>E(N,e)),[N,E]),Ce=u.useCallback((e=>D(N,e)),[N,D]),Pe=u.useCallback((e=>L(N,e)),[N,L]),_e=u.useCallback((e=>B(N,e.shiftKey)),[N,B]),xe=(0,c.entries)(T.inputs),{visibleInputs:je,visibleOutputs:we}=N;je&&xe.sort(((e,t)=>je.indexOf(e[0])-je.indexOf(t[0])));const Oe=(0,c.entries)(T.outputs);we&&Oe.sort(((e,t)=>we.indexOf(e[0])-we.indexOf(t[0])));const Ee=(0,t.getVisibleInputs)(N,T,S),De=(0,t.getVisibleOutputs)(N,T,S);xe.push([f.TRIGGER_PIN_ID,{...(0,c.partInput)(),description:"Use this pin to manually trigger the part. If not connected, the part will be triggered automatically when all required inputs have data."}]),Oe.push([f.ERROR_PIN_ID,{...(0,f.partOutput)(),description:"Use this pin to catch errors that happen inside this part. If not connected, errors will bubble up to the parent part."}]);const Me=xe.filter((e=>{let[t]=e;return Ee.includes(t)||(n||X)&&ue.has(t)})),Se=Oe.filter((t=>{let[o]=t;return De.includes(o)||(n||X)&&le.has(o)||o===f.ERROR_PIN_ID&&e.hadError})),Ne=S.some((e=>e.from.insId===oe&&e.from.pinId===f.ERROR_PIN_ID)),ke=(0,d.default)("ins-view",{"no-inputs":0===xe.length,"no-outputs":0===Oe.length,"display-mode":M,"force-minimized-input":"input"===e.forceShowMinimized||"both"===e.forceShowMinimized,"force-minimized-output":"output"===e.forceShowMinimized||"both"===e.forceShowMinimized,"inline-part-edited":!!W,"error-caught":Ne}),Te=(0,d.default)({selected:n,dragged:r,closest:s&&s.ins.id===N.id},"size-"+ae),Re=new Set((0,c.entries)(T.inputs).filter((e=>{let[t,n]=e;return(0,f.isInputPinOptional)(n)})).map(c.pickFirst)),Ve=(0,c.entries)(N.inputConfig).reduce(((e,t)=>{let[n,o]=t;return(0,f.isStickyInputPinConfig)(o)||o.sticky?{...e,[n]:!0}:e}),{}),Ae=(0,g.calcPartContent)(N,T),ze=e=>{const t=N.inputConfig[e];if((0,v.isStaticInputPinConfig)(t))return t.value},He=u.useCallback((async()=>{const e=(0,c.okeys)(T.inputs),t=await ce("New order?",(N.visibleInputs||e).join(","));t&&F(N,t.split(","))}),[T.inputs,ce,N,F]),Ge=u.useCallback((async()=>{const e=(0,c.okeys)(T.outputs),t=await ce("New order?",(N.visibleOutputs||e).join(","));t&&U(N,t.split(","))}),[T.outputs,ce,N,U]),Le=u.useCallback((()=>{$(N)}),[$,N]),Be=u.useCallback((async()=>{const e=await ce("Set custom display name",N.displayName||T.id);ee(N,e)}),[ce,N,ee,T.id]),Fe=Object.keys((0,m.getPartInputs)(T)),Ue=Object.keys((0,c.getPartOutputs)(T)),qe=u.useCallback((e=>{q&&q(N,e)}),[N,q]),We=u.useCallback(((e,t)=>{te&&te(N,e,t)}),[N,te]),Ze=u.useCallback(((e,t)=>{ne&&ne(N,e,t)}),[N,ne]),Je=()=>(0,a.jsx)("div",{className:"inputs no-drag",children:Me.map((t=>{let[i,r]=t;var u;return(0,a.jsx)(p.PinView,{type:"input",currentInsId:N.id,ancestorsInsIds:e.ancestorsInsIds,id:i,optional:Re.has(i),connected:ue.has(i),isSticky:Ve[i],minimized:!n&&1===Me.length,onToggleSticky:Ie,onDetachConstValue:ye,onCopyConstValue:be,onPasteConstValue:Ce,copiedConstValue:e.copiedConstValue,selected:i===o,onClick:de,onDoubleClick:pe,isClosestToMouse:!!s&&"input"===s.type&&s.pin===i,onToggleLogged:j,onToggleBreakpoint:w,onInspect:e.onInspectPin,constValue:ze(i),onConvertConstToEnv:e.onConvertConstToEnv?qe:void 0,description:r.description,queuedValues:null!==(u=e.queuedInputsData[i])&&void 0!==u?u:0,onMouseUp:We,onMouseDown:Ze},i)}))}),Ye=()=>(0,a.jsx)("div",{className:"outputs no-drag",children:Se.map((t=>{let[o,r]=t;return(0,a.jsx)(p.PinView,{currentInsId:N.id,ancestorsInsIds:e.ancestorsInsIds,connected:le.has(o),type:"output",id:o,minimized:!n&&1===Se.length,isClosestToMouse:!!s&&"output"===s.type&&s.pin===o,selected:o===i,onClick:me,onDoubleClick:fe,onToggleLogged:j,onToggleBreakpoint:w,onInspect:e.onInspectPin,description:r.description,onMouseUp:We,onMouseDown:Ze},o)}))}),Xe=u.useCallback((e=>{Q(N,e)}),[N,Q]),Ke=u.useCallback((()=>{const e=[...Fe.map((e=>{const t=Ee.includes(e),n=ue.has(e)&&!0!==ue.get(e),o=(0,c.getInputName)(e);return{text:t?n?'Hide input "'+o+'" (disconnect first)':'Hide input "'+o+'"':'Show input "'+o+'"',onClick:()=>F(N,t?Ee.filter((t=>t!==e)):[...Ee,e]),disabled:n&&t}})),...Ue.map((e=>{const t=De.includes(e),n=le.has(e),o=(0,c.getOutputName)(e);return{text:t?n?'Hide output "'+o+'" (disconnect first)':'Hide output "'+o+'"':'Show output "'+o+'"',onClick:()=>U(N,t?De.filter((t=>t!==e)):[...De,e]),disabled:n&&t}})),...(0,c.isInlinePartInstance)(N)&&(0,m.isVisualPart)(N.part)?[{text:"Ungroup inline part",onClick:()=>Z(N)}]:[],...(0,c.isInlinePartInstance)(N)?[{text:"Extract inline part to file",onClick:()=>J(N)}]:[],{text:"Reorder inputs",onClick:He},{text:"Reorder outputs",onClick:Ge},{text:"Set display name",onClick:Be},{text:"Group selected instances",onClick:Y},{text:"Delete instance",intent:"danger",onClick:Le}];return(0,a.jsxs)(C.Menu,{children:[(0,a.jsx)(C.MenuItem,{text:"Style",children:(0,a.jsx)(_.PartStyleMenu,{style:re,onChange:Xe,promptFn:ce})}),e.map((e=>(0,a.jsx)(C.MenuItem,{...e})))]})}),[Fe,Ue,N,He,Ge,Be,Le,re,Xe,ce,Ee,ue,F,De,le,U,Z,J,Y]),Qe=u.useCallback((e=>{e.preventDefault(),e.stopPropagation();const t=Ke();C.ContextMenu.show(t,{left:e.clientX,top:e.clientY})}),[Ke]),$e={"--part-color":re.color,...re.cssOverride||{}},et=(0,I.getInstanceDomId)(N.id,e.ancestorsInsIds);return(0,a.jsx)("div",{className:ke,children:(0,a.jsxs)(h.BasePartView,{pos:N.pos,viewPort:k,onDragStart:ge,onDragMove:ve,onDragEnd:he,upperRenderer:Je,bottomRenderer:Ye,displayMode:M,domId:et,children:[(0,a.jsx)(x.default,{className:"instance-info-tooltip",html:!0,id:et+"__tooltip",delayShow:t.INSTANCE_INFO_TOOLTIP_DELAY}),Je(),W?P.default.createPortal((0,a.jsxs)("div",{className:"inline-group-editor-container no-drag",children:[(0,a.jsxs)("header",{children:[Ae," ",(0,a.jsx)("button",{onClick:e.onCloseInlineEditor,children:"close"})]}),(0,a.jsx)(y.VisualPartEditor,{...e.inlineGroupProps,className:"no-drag",ref:se})]}),K):(0,a.jsxs)("div",{className:(0,d.default)("ins-view-inner",Te,"size-"+ie.size),onClick:Pe,onDoubleClick:_e,onContextMenu:Qe,style:$e,"data-tip":T.description,"data-for":et+"__tooltip",children:[re.icon?(0,a.jsx)(l.FontAwesomeIcon,{icon:re.icon}):null," ",Ae]}),Ye()]})})}},57711:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PartStyleMenu=t.partStylePresetColors=void 0;const r=n(20264),a=n(51857),u=s(n(49231)),l=n(12623);t.partStylePresetColors=[{name:"Amethyst",color:"#9b5de5"},{name:"Magenta",color:"#f15bb5"},{name:"Yellow",color:"#fee440"},{name:"Capri",color:"#00bbf9"},{name:"Sea Green",color:"#00f5d4"},{name:"Orange",color:"#ff7f00"}];const c={size:"regular"};t.PartStyleMenu=e=>{var n;const{onChange:o,style:i}=e,s=i||c,d=e.promptFn,p=u.default.useCallback(((e,t)=>{o({...s,[e]:t})}),[s,o]),f=u.default.useCallback((async()=>{const e=await d("Icon name? (Font Awesome conventions)","rocket"),t=e.includes(",")?e.split(","):e;p("icon",t)}),[d,p]),m=(0,u.useCallback)((async()=>{const e=await d("Enter a custom style (valid JSON representing a React CSS object)",s.cssOverride?JSON.stringify(s.cssOverride):"");try{const t=JSON.parse(e);p("cssOverride",t)}catch(t){console.error(t),(0,l.toastMsg)("Invalid object","danger")}}),[d,p,s.cssOverride]);return(0,r.jsxs)(u.default.Fragment,{children:[(0,r.jsxs)(a.MenuItem,{text:"Color",children:[t.partStylePresetColors.map((e=>(0,r.jsx)(a.MenuItem,{text:e.name,onClick:()=>p("color",e.color)},e.name))),(0,r.jsx)(a.MenuDivider,{}),(0,r.jsx)(a.MenuItem,{text:"Remove Color",onClick:()=>p("color",void 0)})]}),(0,r.jsxs)(a.MenuItem,{text:"Size ("+(null!==(n=s.size)&&void 0!==n?n:"regular")+")",children:[(0,r.jsx)(a.MenuItem,{text:"Small",onClick:()=>p("size","small")}),(0,r.jsx)(a.MenuItem,{text:"Regular",onClick:()=>p("size","regular")}),(0,r.jsx)(a.MenuItem,{text:"Large",onClick:()=>p("size","large")})]}),(0,r.jsxs)(a.MenuItem,{text:"Icon",children:[(0,r.jsx)(a.MenuItem,{text:"Choose Icon",onClick:f}),(0,r.jsx)(a.MenuItem,{text:"Remove Icon",onClick:()=>p("icon",void 0)})]}),(0,r.jsx)(a.MenuItem,{text:"Custom Styling",onClick:m})]})}},68122:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(57711),t)},35882:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(36075),t)},46839:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.calcInstancePosition=t.calcPartWidth=t.calcPartContent=void 0;const r=n(14376),a=s(n(38266)),u=n(75219),l=n(36075),c=n(61888),d=n(60324);t.calcPartContent=(e,t)=>{if(e.displayName)return e.displayName;if(t.customViewCode)try{const n=Object.entries(e.inputConfig).filter((e=>{let[,t]=e;return(0,r.isStaticInputPinConfig)(t)})).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o.value}}),{});return a.render(t.customViewCode,{inputs:n,isDefined:u.isDefined}).trim()}catch(n){return console.error("Error with custom view",n),"Error in custom view ["+t.id+"]"}return t.id};t.calcPartWidth=(e,n)=>{const o=(0,r.okeys)(n.inputs).length*l.MIN_WIDTH_PER_PIN,i=(0,t.calcPartContent)(e,n),s=l.PIECE_CHAR_WIDTH;return(0,c.clamp)(i.length*s+2*l.PIECE_HORIZONTAL_PADDING,o,l.MAX_INSTANCE_WIDTH)};t.calcInstancePosition=(e,t,n)=>{const o=(0,d.getInstanceDomId)(e,t),i=document.getElementById(o);if(i){const{x:e,y:t,width:o,height:s}=i.getBoundingClientRect(),r=t+s/2;return{x:e+o/2-n.x,y:r-n.y}}return console.warn("Cannot find element to draw connection to",o),{x:99999,y:99999}}},10457:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LayoutDebugger=t.LayoutDebuggerItem=t.PosDebugger=void 0;const i=n(49231),s=n(20264),r=n(14376),a=o(n(49231)),u=n(43925),l=e=>{let{pos:t}=e;return(0,s.jsxs)("span",{children:[t.x.toFixed(1),", ",t.y.toFixed(1)]})};t.PosDebugger=e=>(0,s.jsx)("span",{className:"pos-debugger",children:(0,s.jsx)(l,{pos:e.pos})});t.LayoutDebuggerItem=e=>{const{pos:n,viewPort:o,size:i,color:r}=e,a=o.zoom,u=n.x*a-o.pos.x*a,l=n.y*a-o.pos.y*a,c={transform:"translate("+(u-n.x)+"px, "+(l-n.y)+"px)"},d={transform:"scale("+o.zoom+")"},p={transform:"translate("+n.x+"px, "+n.y+"px)"},f={width:i.width+"px",height:i.height+"px",backgroundColor:r};return(0,s.jsx)("div",{className:"layout-debugger",style:c,children:(0,s.jsxs)("span",{className:"drag-sim",style:p,children:[(0,s.jsx)(t.PosDebugger,{pos:n}),(0,s.jsx)("div",{className:"layout-debugger-zoom-wrapper",style:d,children:(0,s.jsx)("div",{className:"layout-debugger-inner",style:f})})]})})};const c=(()=>{try{return"true"===localStorage.getItem("pos-debugger")}catch(e){return!1}})();t.LayoutDebugger=e=>{const{extraDebug:n,vp:o,part:d,mousePos:p}=e;if(!c)return null;const f=n.map(((e,n)=>(0,i.createElement)(t.LayoutDebuggerItem,{...e,key:n}))),m=[...d.instances.map((e=>e.pos)),...(0,r.values)(d.inputsPosition),...(0,r.values)(d.outputsPosition)].map((e=>(0,s.jsx)(t.LayoutDebuggerItem,{pos:e,viewPort:o,size:{width:0,height:0},color:"red"}))),g=(0,u.logicalPosToRenderedPos)(p,o),h=(0,s.jsxs)("div",{className:"viewport-data",children:[(0,s.jsxs)("div",{children:["Pos: ",(0,s.jsx)(l,{pos:o.pos})]}),(0,s.jsxs)("div",{children:["Zoom: ",o.zoom.toFixed(2)," "]}),(0,s.jsxs)("div",{children:["Mouse (logical): ",(0,s.jsx)(l,{pos:p})]}),(0,s.jsxs)("div",{children:["Rendered (rendered): ",(0,s.jsx)(l,{pos:g})]})]});return(0,s.jsxs)(a.default.Fragment,{children:[h,f,m]})}},16249:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(10457),t)},17524:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.orderVisualPart=t.layoutToInstances=void 0;const i=n(99678),s=n(14376),r=n(69159),a=o(n(53865)),u=n(66046),l=n(59429),c=n(46839);t.layoutToInstances=(e,t)=>(0,a.default)(t,(t=>{(0,s.entries)(e.nodes).forEach((e=>{let[n,o]=e;if(n.startsWith("ins-")){const e=n.replace("ins-",""),i=t.instances.find((t=>t.id===e));i?i.pos=o.p:console.warn("WAT")}if(n.startsWith("part-input-")){const e=n.replace("part-input-","");t.inputsPosition[e]=o.p}if(n.startsWith("part-output-")){const e=n.replace("part-output-","");t.outputsPosition[e]=o.p}}))}));t.orderVisualPart=(e,n,o,a)=>{const{instances:d,connections:p}=e,f={...d.reduce(((e,t)=>{const o=(0,l.size)((0,c.calcPartWidth)(t,(0,s.getPartDef)(t,n)),i.PART_HEIGHT);return{...e,["ins-"+t.id]:{p:t.pos,s:o}}}),{}),...(0,s.okeys)(e.inputsPosition).reduce(((t,n)=>({...t,["part-input-"+n]:{p:e.inputsPosition[n],s:(0,l.size)((0,u.calcPartIoWidth)(n),i.PART_HEIGHT)}})),{}),...(0,s.okeys)(e.outputsPosition).reduce(((t,n)=>({...t,["part-output-"+n]:{p:e.outputsPosition[n],s:(0,l.size)((0,u.calcPartIoWidth)(n),i.PART_HEIGHT)}})),{})},m=p.map((e=>[(0,s.isExternalConnectionNode)(e.from)?"part-input-"+e.from.pinId:"ins-"+e.from.insId,(0,s.isExternalConnectionNode)(e.to)?"part-output-"+e.to.pinId:"ins-"+e.to.insId])),g=(0,r.orderLayout)({nodes:f,edges:m},o,((n,o)=>{a&&a((0,t.layoutToInstances)(n,e),o)}));return(0,t.layoutToInstances)(g,e)}},69159:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.orderLayout=void 0;const o=n(59429),i=400,s=e=>e.reduce(((e,t)=>{const n=(0,o.vSub)(t.p,(0,o.vec)(t.s.width/2,t.s.height/2));return{...e,[t.id]:{p:n,s:t.s}}}),{});t.orderLayout=(e,t,n)=>{let{nodes:r,edges:a}=e,u=Object.entries(r).map((e=>{let[t,n]=e;return{id:t,p:(0,o.vAdd)(n.p,(0,o.vec)(n.s.width/2,n.s.height/2)),f:(0,o.vec)(0,0),v:(0,o.vec)(0,0),m:1,s:n.s}})),l=0;for(;l<t&&(l<2||(0,o.totalEnergy)(u)>.01);){let e=u;for(let t=0;t<e.length;t++)for(let n=t+1;n<e.length;n++)if(t!==n){const s=e[t],r=e[n],a=(0,o.vSub)(s.p,r.p),u=Math.abs(a.x),l=Math.abs(a.y),c=s.id.startsWith("part-input"),d=s.id.startsWith("part-output"),p=r.id.startsWith("part-input"),f=r.id.startsWith("part-output");if(u<i&&l<80){const e=1e3*(i-u);s.f=(0,o.vAdd)(s.f,(0,o.vec)(.5*e,0)),r.f=(0,o.vAdd)(r.f,(0,o.vec)(-.5*e,0))}if(l<50){const e=100*a.y;s.f=(0,o.vAdd)(s.f,(0,o.vec)(0,.5*e)),r.f=(0,o.vAdd)(r.f,(0,o.vec)(0,-.5*e))}if(c&&f){const e=(0,o.vSub)(s.p,r.p).y;if(e<-500){const t=100*(i-e);s.f=(0,o.vAdd)(s.f,(0,o.vec)(0,-.5*t)),r.f=(0,o.vAdd)(r.f,(0,o.vec)(0,.5*t))}}else if(d&&p){const e=(0,o.vSub)(s.p,r.p).y;if(e<500){const t=100*(i-e);s.f=(0,o.vAdd)(s.f,(0,o.vec)(0,-.5*t)),r.f=(0,o.vAdd)(r.f,(0,o.vec)(0,.5*t))}}const m=(0,o.vSub)(s.p,(0,o.vec)(0,s.p.y)),g=(0,o.vLen)(m),h=(0,o.vMul)((0,o.vNorm)(m),-50*g);s.f=(0,o.vAdd)(s.f,h)}a.forEach((t=>{let n=e.find((e=>e.id===t[0])),i=e.find((e=>e.id===t[1]));if(!n||!i)return void console.warn("weoops",t[0],t[1]);const s=(0,o.vec)(0,-200),r=(0,o.vSub)(n.p,i.p),a=(0,o.vSub)(s,r),u=1e3*(0,o.vLen)(a),l=(0,o.vMul)((0,o.vNorm)(a),.5*u),c=(0,o.vMul)((0,o.vNorm)(a),-.5*u);n.f=(0,o.vAdd)(n.f,l),i.f=(0,o.vAdd)(i.f,c)})),e=e.map((e=>(0,o.itrPhysics)(15,e))),e=e.map((e=>{const t=(0,o.vMul)(e.v,.5),n=(0,o.vLen)(t)>100?(0,o.vMul)((0,o.vNorm)(t),100):t;return{...e,v:n}})),u=e,n&&n({nodes:s(e),edges:a},l),l++}return{nodes:s(u),edges:a,itrs:l,timeout:l>=t,total:(0,o.totalEnergy)(u)}}},57402:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateInstancesWithSingleConstPinsMap=t.getLeafInstancesOfSelection=void 0;t.getLeafInstancesOfSelection=(e,t,n)=>e.reduce(((e,o)=>[...e,...n.filter((e=>e.to.insId===o.id)).map((e=>t.find((t=>t.id===e.from.insId)))).filter((e=>!!e))]),[]).filter((t=>1===n.filter((e=>e.from.insId===t.id||e.to.insId===t.id)).length&&!e.includes(t)));t.calculateInstancesWithSingleConstPinsMap=(e,t)=>{const{connections:n}=e;return n.filter((e=>t.has(e.from.insId))).reduce(((e,n)=>{const o=t.get(n.from.insId),i=n.to.insId,s=e.get(i)||new Map;return s.set(n.to.pinId,{val:o,insId:n.from.insId}),e.set(i,s),e}),new Map)}},51688:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PartIoView=void 0;const a=n(20264),u=s(n(49231)),l=n(14376),c=n(71651),d=r(n(65443)),p=n(51857),f=n(68870),m=n(7170),g=n(14376),h=r(n(62674)),v=n(60324);t.PartIoView=u.memo((function(e){const{viewPort:t,selected:n,pos:o,type:i,id:s,onDblClick:r,onRename:I,onDelete:y,onChangeInputMode:b,inputMode:C,onSelect:P,closest:_,onSetDescription:x,description:j,onMouseUp:w,onMouseDown:O,currentInsId:E}=e,{history:D,resetHistory:M,refreshHistory:S}=(0,m.useHistoryHelpers)(E,s,i),N=(0,f.usePrompt)(),k=u.useCallback((async()=>{const e=await N("Description?",j);x(i,s,e)}),[N,j,x,i,s]),T=u.useCallback((()=>{y&&y(i,s)}),[i,s,y]),R=u.useCallback((()=>{I&&I(i,s)}),[i,s,I]),V=u.useCallback((e=>{b&&b(s,e)}),[s,b]),A=u.useCallback((()=>[{text:"Current mode - "+C,onClick:l.noop},{text:"Make required",onClick:()=>V("required")},{text:"Make optional",onClick:()=>V("optional")},{text:"Make required-if-connected",onClick:()=>V("required-if-connected")},{text:"Set description",onClick:k},...e.onRename?[{text:"Rename",onClick:R}]:[],...e.onDelete?[{text:"Delete",onClick:T}]:[]]),[k,C,V,T,R,e.onDelete,e.onRename]),z=u.useCallback((t=>{r&&r(e.id,t)}),[r,e.id]),H=u.useCallback((()=>{P(s,i)}),[s,i,P]),G=u.useCallback((()=>(0,a.jsx)(p.Menu,{children:A().map((e=>(0,a.jsx)(p.MenuItem,{...e})))})),[A]),L=u.useCallback((e=>{e.preventDefault(),e.stopPropagation();const t=G();p.ContextMenu.show(t,{left:e.clientX,top:e.clientY})}),[G]),B="input"===i?(0,g.getInputName)(s):(0,l.getOutputName)(s),F=u.useCallback((e=>{w(s,i,e)}),[s,w,i]),U=u.useCallback((e=>{O(s,i,e)}),[s,O,i]);return(0,a.jsxs)(c.BasePartView,{className:(0,d.default)("part-io-view",i),pos:o,onDragEnd:(n,o)=>{const r=e.pos,a=(o.x-r.x)/t.zoom,u=(o.y-r.y)/t.zoom,l=r.x+a,c=r.y+u;e.onDragEnd(i,s,n,{...o,x:l,y:c})},onDragStart:(t,n)=>{e.onDragStart(s,t,n)},onDragMove:(n,o)=>{const r=e.pos,a=(o.x-r.x)/t.zoom,u=(o.y-r.y)/t.zoom,l=r.x+a,c=r.y+u;e.onDragMove(i,s,n,{...o,x:l,y:c})},viewPort:t,children:[(0,a.jsx)(h.default,{className:"pin-info-tooltip",html:!0,id:s+e.currentInsId,getContent:[()=>{const t=(0,m.calcHistoryContent)(D),n=e.description?"<em>"+e.description+"</em>":"";return"<div><div><strong>"+B+"</strong> ("+i+") </div>\n      "+n+"\n      <hr/>\n      "+t+"\n    "},25]}),(0,a.jsx)("div",{onMouseEnter:S,onMouseOut:M,onMouseUp:F,onMouseDown:U,"data-tip":"","data-html":!0,"data-for":s+e.currentInsId,className:(0,d.default)("part-io-view-inner",{closest:_,selected:n}),id:(0,v.getPinDomId)({fullInsIdPath:(0,l.fullInsIdPath)(e.currentInsId,e.ancestorInsIds),pinId:s,pinType:i,isMain:!0}),onClick:H,onDoubleClick:z,onContextMenu:L,children:s})]})}))},13155:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(51688),t)},66046:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcPartIoWidth=t.MIN_WIDTH_PER_PIN=t.PIECE_CHAR_WIDTH=t.PIECE_HORIZONTAL_PADDING=void 0,t.PIECE_HORIZONTAL_PADDING=15,t.PIECE_CHAR_WIDTH=9,t.MIN_WIDTH_PER_PIN=40;t.calcPartIoWidth=e=>Math.max(t.MIN_WIDTH_PER_PIN,e.length*t.PIECE_CHAR_WIDTH+2*t.PIECE_HORIZONTAL_PADDING)},21153:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PinView=t.PIN_HEIGHT=void 0;const a=n(20264),u=s(n(49231)),l=r(n(65443)),c=n(51857),d=n(75219),p=n(14376),f=n(60324),m=n(60940),g=r(n(62674)),h=n(7170);t.PIN_HEIGHT=23;t.PinView=u.memo((function(e){const{selected:t,type:n,connected:o,rotate:i,optional:s,currentInsId:r,isClosestToMouse:v,id:I,onMouseDown:y,onMouseUp:b}=e,{history:C,resetHistory:P,refreshHistory:_}=(0,h.useHistoryHelpers)(r,I,n),x="input"===n?(0,p.getInputName)(I):(0,p.getOutputName)(I),j="input"===e.type&&(0,d.isDefined)(e.constValue)?e.constValue:void 0,w=i&&"input"===n,O=u.useCallback((e=>{0===e.button&&y(I,n,e)}),[I,n,y]),E=u.useCallback((e=>{0===e.button&&b(I,n,e)}),[I,n,b]);return(0,a.jsxs)("div",{className:(()=>{if("input"===e.type){const{isSticky:r,constValue:a}=e;return(0,l.default)("pin",{sticky:r,selected:t,closest:v,optional:s,connected:o,rotate:i,"const-value":(0,d.isDefined)(a),"env-value":(0,d.isDefined)(a)&&(0,p.isEnvValue)(a),minimized:e.minimized},n)}return(0,l.default)("pin",{selected:t,connected:o,closest:v,rotate:i,optional:s,minimized:e.minimized,"error-pin":I===p.ERROR_PIN_ID},n,i)})(),"data-pin-id":I,children:[(0,a.jsx)(g.default,{className:"pin-info-tooltip",html:!0,id:I+e.currentInsId,getContent:[()=>{const t=(0,h.calcHistoryContent)(C,"input"===n?e.queuedValues:void 0),o=e.description?"<em>"+e.description+"</em>":"";return"<div><div><strong>"+x+"</strong> ("+n+") </div>\n      "+o+"\n      <hr/>\n      "+((0,d.isDefined)(j)?"<div>Static value: <strong>"+(0,m.valuePreview)(j).substr(0,200)+"</strong></div>":t)+"\n    "},25]}),(0,a.jsxs)("div",{onMouseEnter:_,onMouseOut:P,onMouseDown:O,onMouseUp:E,"data-tip":"","data-html":!0,"data-for":I+e.currentInsId,id:(0,f.getPinDomId)({fullInsIdPath:(0,p.fullInsIdPath)(e.currentInsId,e.ancestorsInsIds),pinId:I,pinType:n,isMain:!1}),"data-place":w?"bottom":null,onDoubleClick:t=>e.onDoubleClick&&e.onDoubleClick(I,t),className:"pin-inner",onContextMenu:t=>{t.preventDefault(),t.stopPropagation();const n=(()=>{const t=(0,a.jsx)(c.MenuItem,{onClick:()=>e.onInspect(e.currentInsId,{id:e.id,type:e.type}),text:"Inspect"});if("input"===e.type){const{onConvertConstToEnv:n}=e;return(0,d.isDefined)(j)?(0,a.jsxs)(c.Menu,{children:[(0,a.jsx)(c.MenuItem,{onClick:()=>e.onDetachConstValue(e.id),text:"Detach value"}),(0,a.jsx)(c.MenuItem,{onClick:()=>e.onCopyConstValue(e.id),text:"Copy value"}),(0,d.isDefined)(e.copiedConstValue)?(0,a.jsx)(c.MenuItem,{onClick:()=>e.onPasteConstValue(e.id),text:"Paste value"}):null,n?(0,a.jsx)(c.MenuItem,{onClick:()=>n(e.id),text:"Convert to Env Var"}):null]}):(0,a.jsxs)(c.Menu,{children:[(0,a.jsx)(c.MenuItem,{onClick:()=>e.onToggleSticky(e.id),text:"Toggle sticky (square means sticky)"}),t,(0,d.isDefined)(e.copiedConstValue)?(0,a.jsx)(c.MenuItem,{onClick:()=>e.onPasteConstValue(e.id),text:"Paste value"}):null]})}return(0,a.jsx)(c.Menu,{children:t})})();c.ContextMenu.show(n,{left:t.clientX,top:t.clientY})},onClick:t=>{const{onShiftClick:o,onClick:i,id:s}=e;t.shiftKey&&o?o(s,t):i(s,n,t)},children:[x," ",(0,d.isDefined)(j)?(0,a.jsxs)(u.Fragment,{children:[":",(0,a.jsx)("span",{className:"value",children:(0,d.toString)(j)})]}):null,"input"===e.type&&e.isSticky?(0,a.jsx)("span",{className:"suffix",children:"s"}):null,"input"===e.type&&e.queueSize?(0,a.jsxs)("span",{className:"suffix",children:[e.queueSize," in Q"]}):null]}),(0,a.jsx)("div",{className:"wire"})]})}))},7170:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useHistoryHelpers=t.calcHistoryContent=void 0;const i=n(60940),s=o(n(49231)),r=n(49231),a=n(56469);t.calcHistoryContent=(e,t)=>{if(e){const{total:n,lastSamples:o}=e;return"<strong>Activated "+n+" times this session</strong>"+" "+(o.length>0?"<div>Last value: <strong>"+(0,i.valuePreview)(o[0].val).substring(0,200)+"</strong></div><em>Inspect instance for the full value</em>":"")+(t?"<hr/><div>Queued values: <strong>"+t+"</strong></div>":"")}return"Loading session data.."};t.useHistoryHelpers=(e,t,n)=>{const o=(0,r.useRef)(),{onRequestHistory:i}=(0,a.useDebuggerContext)(),[u,l]=(0,r.useState)();return{history:u,refreshHistory:(0,r.useCallback)((()=>{clearInterval(o.current),i(e,t,n).then((e=>{l(e)})),o.current=setInterval((()=>{i(e,t,n).then((e=>{l(e)}))}),500)}),[e,i,t,n]),resetHistory:s.default.useCallback((()=>{clearInterval(o.current),l(void 0)}),[])}}},1227:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.QuickAddMenu=void 0;const r=n(20264),a=s(n(49231)),u=n(14376),l=n(51857),c=n(7586),d=n(55066),p=n(69381),f=c.Select.ofType(),m=e=>{switch(e.type){case"part":return""+e.part.id;case"value":return"Add inline value or function";case"import":return"Import "+e.importablePart.part.id+" from "+e.importablePart.module}},g=(e,t)=>{let{handleClick:n,modifiers:o,query:i}=t;if(!o.matchesPredicate)return null;const s=m(e);return"value"===e.type?(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)(l.MenuDivider,{}),(0,r.jsx)(l.MenuItem,{active:o.active,disabled:o.disabled,onClick:n,text:(0,d.highlightText)(s,i)},m(e))]}):(0,r.jsx)(l.MenuItem,{active:o.active,disabled:o.disabled,onClick:n,text:(0,d.highlightText)(s,i)},m(e))},h=(e,t,n,o)=>{const i=m(t).toLocaleLowerCase(),s=e.toLowerCase();return o?i===s:i.includes(s)};t.QuickAddMenu=e=>{const{resolvedDependencies:t,targetPart:n}=e,o={left:e.pos.x,top:e.pos.y},{onRequestImportables:i}=(0,p.useDependenciesContext)(),[s,c]=a.useState();a.useEffect((()=>{i().then((e=>c(e.importables)))}),[i]);const d=(0,u.values)({...t,[n.id]:n}),m=d.map((e=>({type:"part",part:e}))),v=new Set(d.map((e=>e.id))),I=s?s.filter((e=>!v.has(e.part.id))).map((e=>({type:"import",importablePart:e}))):[],y=m.concat(I).concat({type:"value"});return(0,r.jsx)("div",{className:"quick-add-menu",style:o,children:(0,r.jsx)(f,{className:"quick-add-parts-select",items:y,itemPredicate:h,itemRenderer:g,inputProps:{className:"quick-add-input"},noResults:(0,r.jsx)(l.MenuItem,{disabled:!0,text:"No results."}),onItemSelect:t=>e.onAdd(t),popoverProps:{isOpen:!0,onClose:()=>e.onClose()}})})}},49390:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(1227),t)},95763:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRuntimePlayer=void 0;const o=n(14376),i=n(29343),s=(0,o.debugLogger)("runtime-player");t.createRuntimePlayer=()=>{let e=0,t=[];let n=!1,r=Date.now(),a=e;const u=()=>requestAnimationFrame((()=>{const l=Date.now();a=e,e+=l-r,r=l,((e,n)=>{const r=t;t=[],r.length&&s("Playing "+r.length+" events from",e,n),r.forEach((e=>{s("Playing event",e),(0,i.playEvent)(e),e.insId===o.ROOT_INS_ID&&e.type===o.DebuggerEventType.PROCESSING_CHANGE&&!1===e.val&&(s("Main instance is done processing, clearing runtime UI",e),c())}))})(a,e),n&&u()})),l=()=>{n=!1},c=()=>{document.querySelectorAll("[data-runtime]").forEach((e=>{e.removeAttribute("data-runtime")})),document.querySelectorAll("[data-runtime-queue]").forEach((e=>{e.removeAttribute("data-runtime-queue")})),t=[]};return{stop:l,start:function(t){void 0===t&&(t=0),n=!0,e=t,r=Date.now(),u()},addEvents:e=>{t.push(...e)},destroy:()=>{l(),c()},clear:c,status:()=>({running:n,currDt:e,lastDt:a,queue:t,last:r})}}},29343:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.playEvent=t.cancelTimers=void 0;const o=n(14376),i=n(60324),s=5e3,r=(0,o.debugLogger)("runtime-player:play-event"),a=(e,t)=>e.type===o.DebuggerEventType.INPUT_CHANGE||e.type===o.DebuggerEventType.OUTPUT_CHANGE?(0,o.fullInsIdPath)(e.insId,e.ancestorsInsIds)+"."+e.pinId:(0,o.fullInsIdPath)(e.insId,e.ancestorsInsIds);t.cancelTimers=new Map;t.playEvent=e=>{switch(e.type){case o.DebuggerEventType.INPUT_CHANGE:case o.DebuggerEventType.OUTPUT_CHANGE:{const{pinId:n,insId:u,ancestorsInsIds:l}=e,c=e.type===o.DebuggerEventType.INPUT_CHANGE?"input":"output",d=[(0,i.getPinDomId)({fullInsIdPath:(0,o.fullInsIdPath)(u,l),pinId:n,pinType:c,isMain:!0})];u!==o.ROOT_INS_ID&&d.push((0,i.getPinDomId)({fullInsIdPath:(0,o.fullInsIdPath)(u,l),pinId:n,pinType:c,isMain:!1})),d.forEach(((i,l)=>{const c=a(e);clearTimeout(t.cancelTimers.get(c));const d=document.getElementById(i),p=u+"."+n,f=e.type===o.DebuggerEventType.OUTPUT_CHANGE?document.querySelectorAll('[data-from-id="'+p+'"]'):[];if(d){clearTimeout(t.cancelTimers.get(c)),d.removeAttribute("data-runtime"),f.forEach((e=>{e.removeAttribute("data-runtime")})),setTimeout((()=>{d.setAttribute("data-runtime","active"),f.forEach((e=>{e.setAttribute("data-runtime","active")}))}),0);const n=setTimeout((()=>{d.removeAttribute("data-runtime"),f.forEach((e=>{e.removeAttribute("data-runtime")})),t.cancelTimers.delete(c)}),s);t.cancelTimers.set(a(e),n)}else console.warn("No DOM element with Id ["+i+"] found to play event"),r("No DOM element with Id ["+i+"] found to play event",e)}));break}case o.DebuggerEventType.PROCESSING_CHANGE:{const{insId:n,ancestorsInsIds:u}=e,l=[(0,i.getMainInstanceIndicatorDomId)(n,u)];n!==o.ROOT_INS_ID&&l.push((0,i.getInstanceDomId)(n,u)),l.forEach(((n,o)=>{var i;const u=a(e),l=null===(i=document.getElementById(n))||void 0===i?void 0:i.parentElement;if(l)if(!0===e.val)l.setAttribute("data-runtime","processing"),clearTimeout(t.cancelTimers.get(u));else{l.removeAttribute("data-runtime"),setTimeout((()=>{"error"!==l.getAttribute("data-runtime")&&l.setAttribute("data-runtime","done")}),0);const e=setTimeout((()=>{l.removeAttribute("data-runtime"),t.cancelTimers.delete(u)}),s);t.cancelTimers.set(u,e)}else r("No DOM element with Id ["+n+"] found to play event",e)}));break}case o.DebuggerEventType.ERROR:{const{insId:n,ancestorsInsIds:u}=e,l=[(0,i.getMainInstanceIndicatorDomId)(n,u)];n!==o.ROOT_INS_ID&&l.push((0,i.getInstanceDomId)(n,u)),l.forEach(((n,o)=>{var i;const u=a(e),l=null===(i=document.getElementById(n))||void 0===i?void 0:i.parentElement;if(!l)return void r("No DOM element with Id ["+n+"] found to play event",e);clearTimeout(t.cancelTimers.get(u)),l.removeAttribute("data-runtime"),setTimeout((()=>{l.setAttribute("data-runtime","error")}));const c=setTimeout((()=>{l.removeAttribute("data-runtime"),t.cancelTimers.delete(u)}),s);t.cancelTimers.set(u,c)}));const c={...e,type:o.DebuggerEventType.OUTPUT_CHANGE,pinId:o.ERROR_PIN_ID};(0,t.playEvent)(c);break}case o.DebuggerEventType.INPUTS_STATE_CHANGE:(0,o.entries)(e.val).forEach((t=>{let[n,s]=t;const{insId:a,ancestorsInsIds:u}=e,l=(0,i.getPinDomId)({fullInsIdPath:(0,o.fullInsIdPath)(a,u),pinId:n,pinType:"input",isMain:!1}),c=document.getElementById(l);c?s>0?c.setAttribute("data-runtime-queue",""+s):c.removeAttribute("data-runtime-queue"):r("No DOM element with Id ["+l+"] found to play event",e)}))}}},55266:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDebounce=void 0;const o=n(49231);t.useDebounce=function(e,t){const[n,i]=(0,o.useState)(e);return(0,o.useEffect)((()=>{const n=setTimeout((()=>{i(e)}),t);return()=>{clearTimeout(n)}}),[e,t]),[n,i]}},43925:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleChangePartInputType=t.handleIoPinRename=t.handleInstanceDrag=t.getInstancesInRect=t.isJsxValue=t.getMiddleOfViewPort=t.fitViewPortToPart=t.centerBoardPosOnTarget=t.renderedPosToLogicalPos=t.logicalPosToRenderedPos=t.getEffectivePartDimensions=t.calcPartsPositions=t.calcSelectionBoxArea=t.animateViewPort=t.easeInOutNum=t.easeInOutPos=t.easeInOutQuad=t.center=t.distance=t.clamp=t.domToViewPort=t.roundNumber=t.createNewPartInstance=t.createNewInlinePartInstance=t.parseInputOutputTypes=t.parsePromptValue=t.getSelectionBoxRect=t.findClosestPin=t.changePinConfig=t.getInstancePinConfig=t.emptyList=t.emptyObj=void 0;const a=s(n(53865)),u=r(n(36618)),l=n(99678),c=n(14376),d=n(85418),p=n(14376),f=n(46839),m=n(66046),g=n(59429),h=n(57402),v=n(35882);t.emptyObj={},t.emptyList=[],t.getInstancePinConfig=function(e,n,o){var i;const s=e.instances.find((e=>e.id===n));if(!s)throw new Error("Instance "+n+" not found");return null!==(i=(s.inputConfig||t.emptyObj)[o])&&void 0!==i?i:(0,c.queueInputPinConfig)()};t.changePinConfig=(e,t,n,o)=>a.produce(e,(e=>{var i;const{instances:s}=e,r=s.find((e=>e.id===t));if(!r)throw new Error("blah");const a=null!==(i=r.inputConfig)&&void 0!==i?i:{};a[n]=o,e.instances=s.map((e=>e===r?{...r,inputConfig:a}:e))}));t.findClosestPin=(e,t,n,o,i,s,r)=>{const a=(0,c.partInstance)(e.id,e.id),u=(0,p.okeys)(e.inputs).map((e=>({id:e,type:"input",pos:(0,d.calcPinPosition)({insId:i,ancestorsInsIds:s,pinId:e,pinType:"input",boardPos:o,viewPort:r,isMain:!0}),ins:a}))),l=(0,p.okeys)(e.outputs).map((e=>({id:e,type:"output",pos:(0,d.calcPinPosition)({insId:i,ancestorsInsIds:s,pinId:e,pinType:"output",boardPos:o,viewPort:r,isMain:!0}),ins:a}))),f=[...u,...e.instances.reduce(((n,a)=>{const u=(0,c.getPartDef)(a,t),l=(0,v.getVisibleInputs)(a,u,e.connections),p=(0,v.getVisibleOutputs)(a,u,e.connections);return[...n,...l.map((e=>({ins:a,type:"input",pos:(0,d.calcPinPosition)({insId:a.id,ancestorsInsIds:(0,c.fullInsIdPath)(i,s),pinId:e,pinType:"input",boardPos:o,viewPort:r,isMain:!1}),id:e}))),...p.map((e=>({ins:a,type:"output",pos:(0,d.calcPinPosition)({insId:a.id,ancestorsInsIds:(0,c.fullInsIdPath)(i,s),pinId:e,pinType:"output",boardPos:o,viewPort:r,isMain:!1}),id:e})))]}),[]),...l];let m={dis:1e5,item:f[0]};return f.forEach((e=>{const t=e.pos.x-n.x,o=e.pos.y-n.y,i=Math.sqrt(t*t+o*o);i<m.dis&&(m.dis=i,m.item=e)})),m.item};t.getSelectionBoxRect=(e,t)=>{const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y);return{x:n,y:o,w:Math.max(e.x,t.x)-n,h:Math.max(e.y,t.y)-o}};t.parsePromptValue=e=>{if(null===e)return;const t=parseInt(e,10);let n=e;return t.toString()!=e||isNaN(t)||(n=t),n};t.parseInputOutputTypes=e=>{const[,t,n]=e.match(/part\((.+)\|(.+)\)/)||[],o=(0,p.entries)(JSON.parse(t)).map((e=>{let[t,n]=e;const o={type:n,optional:(0,p.isOptionalType)(t)};return[t.replace(/\?$/,""),o]})),i=(0,p.entries)(JSON.parse(n)).map((e=>{let[t,n]=e;const o={type:n,optional:(0,p.isOptionalType)(t)};return[t.replace(/\?$/,""),o]}));return{inputs:(0,p.fromEntries)(o),outputs:(0,p.fromEntries)(i)}};t.createNewInlinePartInstance=function(e,t,n){void 0===t&&(t=-1*l.PART_HEIGHT*1.5);const o=(0,c.inlinePartInstance)(e.id+"-"+(0,p.randomInt)(999),e,{},{x:0,y:0}),i=(0,f.calcPartWidth)(o,e),{x:s,y:r}=n,a={x:s-i/2,y:r+t};return{...o,pos:a}};t.createNewPartInstance=function(e,t,n,o){void 0===t&&(t=-1*l.PART_HEIGHT*1.5);const i="string"==typeof e?(0,c.getPartDef)(e,o):e;if(!i)throw new Error(e+" part not found in resolvedParts");const s=(0,p.entries)(i.inputs).reduce(((e,t)=>{let[n,o]=t;return o.defaultValue&&(e[n]=(0,c.staticInputPinConfig)(o.defaultValue)),e}),{}),r=(0,c.partInstance)((0,u.default)(),i.id,s,{x:0,y:0}),a=(0,f.calcPartWidth)(r,i),{x:d,y:m}=n,g={x:d-a/2,y:m+t};return{...r,pos:g}};t.roundNumber=e=>Math.round(100*e)/100;t.domToViewPort=(e,n,o)=>({x:(0,t.roundNumber)(n.pos.x+e.x/n.zoom/o.zoom),y:(0,t.roundNumber)(n.pos.y+e.y/n.zoom/o.zoom)});t.clamp=(e,t,n)=>Math.max(e,Math.min(t,n));t.distance=(e,t)=>{const n=t.x-e.x,o=t.y-e.y;return Math.sqrt(n*n+o*o)};t.center=(e,t,n)=>{let{zoom:o}=n;const i=e.x+e.w/2,s=e.y+e.h/2,{w:r,h:a}=t;return{x:i-r/o/2,y:s-a/o/2}};t.easeInOutQuad=e=>e<.5?2*e*e:(4-2*e)*e-1;t.easeInOutPos=(e,n,o,i,s)=>{const r=(0,t.clamp)(0,1,(s-o)/i),a=(0,t.easeInOutQuad)(r),u=n.x-e.x,l=n.y-e.y;return{x:e.x+u*a,y:e.y+l*a}};t.easeInOutNum=(e,n,o,i,s)=>{const r=(0,t.clamp)(0,1,(s-o)/i);return e+(n-e)*(0,t.easeInOutQuad)(r)};t.animateViewPort=(e,n,o,i)=>{const s=(0,t.distance)(e.pos,n.pos),r=Date.now(),a=o;if(0===s)return void i(e);const u=()=>{const o=Date.now(),s=(0,t.easeInOutPos)(e.pos,n.pos,r,a,o),l=(0,t.easeInOutNum)(e.zoom,n.zoom,r,a,o);o-r<a?(i({pos:s,zoom:l}),requestAnimationFrame(u)):i({pos:s,zoom:l})};requestAnimationFrame(u)};t.calcSelectionBoxArea=e=>{const n=(0,t.getSelectionBoxRect)(e.from,e.to);return n.h*n.w};const I=(e,t,n,o)=>({left:n.x,right:n.x+e,top:n.y,bottom:n.y+t,tag:o,center:(0,c.calcCenter)({w:e,h:t,...n})});t.calcPartsPositions=(e,t)=>[...e.instances.map((e=>{const n=(0,f.calcPartWidth)(e,(0,c.getPartDef)(e,t)),o=l.PART_HEIGHT;return I(n,o,e.pos,e.id)})),...(0,p.okeys)(e.inputs).map((t=>{const n=(0,m.calcPartIoWidth)(t),o=l.PART_HEIGHT,i=e.inputsPosition[t]||{x:0,y:0};return I(n,o,i,"input_"+t)})),...(0,p.okeys)(e.outputs).map((t=>{const n=(0,m.calcPartIoWidth)(t),o=l.PART_HEIGHT,i=e.outputsPosition[t]||{x:0,y:0};return I(n,o,i,"output"+t)}))];t.getEffectivePartDimensions=(e,n)=>{const o=(0,t.calcPartsPositions)(e,n),i=o[0]||{left:0,right:0,top:0,bottom:0},s=o.reduce(((e,t)=>t.left<e?t.left:e),i.left),r=o.reduce(((e,t)=>t.right>e?t.right:e),i.right),a=o.reduce(((e,t)=>t.top<e?t.top:e),i.top),u=r-s,l=o.reduce(((e,t)=>t.bottom>e?t.bottom:e),i.bottom)-a,d={x:s,y:a};return{size:{width:u,height:l},pos:d,center:(0,c.calcCenter)({w:u,h:l,...d})}};t.logicalPosToRenderedPos=(e,t)=>{const n=(0,g.vSub)(e,t.pos);return(0,g.vMul)(n,t.zoom)};t.renderedPosToLogicalPos=(e,t)=>{const n=(0,g.vDiv)(e,t.zoom);return(0,g.vAdd)(t.pos,n)};t.centerBoardPosOnTarget=(e,n,o,i)=>{const s=(0,t.logicalPosToRenderedPos)(e,i),r=(0,t.renderedPosToLogicalPos)(s,{...i,zoom:o}),a=Math.max(e.x,r.x)-Math.min(e.x,r.x),u=Math.max(e.y,r.y)-Math.min(e.y,r.y);return{x:o>i.zoom?i.pos.x+a:i.pos.x-a,y:o>i.zoom?i.pos.y+u:i.pos.y-u}};t.fitViewPortToPart=function(e,n,o,i){void 0===i&&(i=[20,150]);const{size:s,center:r}=(0,t.getEffectivePartDimensions)(e,n),a=i[0],u=i[1],l=s.width+a,c=s.height+u,d=o.width/l,p=o.height/c,f=Math.min(d,p)/1.15,m=(0,t.clamp)(.3,1.2,f);return{zoom:m,pos:{x:r.x-o.width/2/m,y:r.y-o.height/2/m+40}}};t.getMiddleOfViewPort=(e,n)=>{const o={x:n.width/2,y:n.height/2};return(0,t.renderedPosToLogicalPos)(o,e)};t.isJsxValue=e=>{const t=e=>(0,p.isDefined)(e.ref)&&(0,p.isDefined)(e.type)&&(0,p.isDefined)(e.props);try{const n=JSON.parse(e);return t(n)||Array.isArray(n)&&t(n[0])}catch(n){return!1}};t.getInstancesInRect=(e,n,o,i,s,r,a)=>{const{from:u,to:d}=e,p=(0,t.getSelectionBoxRect)(u,d);return s.filter((e=>{const{pos:t}=e,i={...t,w:(0,f.calcPartWidth)(e,(0,c.getPartDef)(e,n))*o.zoom*a.zoom,h:l.PART_HEIGHT*o.zoom*a.zoom};return console.log(e.id,i,"main",p),(0,c.intersectRect)(p,i)||(0,c.intersectRect)(i,p)})).map((e=>e.id))};t.handleInstanceDrag=(e,t,n,o,i,s)=>{o.preventDefault(),o.stopPropagation();const r=(0,g.vSub)(n,t.pos);let u;const l=a.produce(e,(e=>{const a=e.instances.find((e=>e.id===t.id));if(!a)throw new Error("impossible state dragging instance that does not exist");!o.shiftKey&&s&&(u=[s]);const l=e.instances.filter((e=>i.includes(e.id)&&e!==a)),c=[a,...l],d=(0,h.getLeafInstancesOfSelection)(c,e.instances,e.connections);[...l,...d].forEach((e=>{e.pos=(0,g.vAdd)(e.pos,r)})),a.pos=n,!o.shiftKey&&s&&(u=[s])}));return{newValue:l,newSelected:u}};t.handleIoPinRename=(e,t,n,o)=>a.produce(e,(e=>{"input"===t?(e.inputs[o]=e.inputs[n],e.inputsPosition[o]=e.inputsPosition[n],delete e.inputs[n],e.connections=e.connections.map((e=>(0,c.isExternalConnectionNode)(e.from)&&e.from.pinId===n?{...e,from:{...e.from,pinId:o}}:e))):(e.outputs[o]=e.outputs[n],e.outputsPosition[o]=e.outputsPosition[n],e.connections=e.connections.map((e=>(0,c.isExternalConnectionNode)(e.to)&&e.to.pinId===n?{...e,to:{...e.to,pinId:o}}:e)),e.completionOutputs=(e.completionOutputs||[]).map((e=>e.split("+").map((e=>e===n?o:n)).join("+"))),delete e.outputs[n])}));t.handleChangePartInputType=(e,t,n)=>a.produce(e,(e=>{const o=e.inputs[t];if(!o)throw new Error("Wat");o.mode=n}))},63712:(e,t,n)=>{"use strict";n.d(t,{Y:()=>m});var o=n(49231),i=n(11253),s=n(44108),r=n(86001),a=n(14376),u=n(96191);var l=n(11552),c=n(222);n.g.vm2=r.z;const d=(0,u.S)(),p=[0,0],f=e=>{let{flow:t,output:n,inputs:o,onError:s,debugDelay:r,dependencies:u,player:l}=e;const c=((e,t)=>{const n=new Set;return{onEvent:o=>{const i={...o,time:Date.now()};console.info("Got debugger event",o),t.addEvents([i]),e.addEvents([i]),n.forEach((e=>e([i])))},onBatchedEvents:e=>(n.add(e),()=>n.delete(e))}})(l,d);c.debugDelay=r;const p=(0,a.keys)(t.part.outputs)[0];return{executeResult:(0,a.execute)({part:t.part,inputs:o,outputs:{[p]:n},resolvedDeps:{...u,[t.part.id]:t.part},_debugger:c,onBubbleError:e=>{s(e)},extraContext:{PubSub:i}}),localDebugger:c}},m=e=>{const{debugDelay:t,onOutput:i,flowProps:r}=e,{flow:u,inputs:m,output:g}=r,h=(0,o.useRef)((0,s.createRuntimePlayer)()),[v,I]=(0,o.useState)(e.flowProps.dependencies),[y,b]=(0,o.useState)(),[C]=(0,s.useDebounce)(v,500),P=async(e,t)=>{const{part:o}=e,i=Object.values(await n.e(8299).then(n.t.bind(n,88299,23))).find((e=>(0,a.isBasePart)(e)&&e.id===o.id));let r;I((e=>({...e,dependencies:{...e.dependencies,[i.id]:{...i,source:{path:"@flyde/stdlib/dist/all-browser",export:i.id}}}})));const c=(0,l.ZP)(u,(n=>{if(t){const o=(0,s.vAdd)({x:0,y:0},t.pos);if(r=(0,s.createNewPartInstance)(e.part,0,o,v),n.part.instances.push(r),t.connectTo){const{insId:e,outputId:o}=t.connectTo;n.part.connections.push({from:{insId:e,pinId:o},to:{insId:r.id,pinId:a.TRIGGER_PIN_ID}})}}}));await new Promise((e=>setTimeout(e,10)));const d=(0,l.ZP)(x,(e=>{var n;(e.flow=c,null!=t&&t.selectAfterAdding&&r)&&(e.boardData.selected=[null==(n=r)?void 0:n.id])}));return j(d),(0,s.toastMsg)("Part "+o.id+" successfully imported from "+e.module),v},_=async()=>({importables:Object.values(await n.e(8299).then(n.t.bind(n,88299,23))).filter(a.isBasePart).map((e=>({part:{...e,source:{path:"n/a",export:"n/a"}},module:"@flyde/stdlib"}))),errors:[]}),[x,j]=(0,o.useState)({flow:u,boardData:{viewPort:{pos:{x:0,y:0},zoom:1},lastMousePos:{x:0,y:0},selected:[]}});(0,o.useEffect)((()=>{j((e=>({...e,flow:u})))}),[u]),(0,o.useEffect)((()=>{I((e=>({...e,main:x.flow.part})))}),[x.flow.part]);const w={state:x,onChangeEditorState:j,hideTemplatingTips:!0,initialPadding:p,onExtractInlinePart:a.noop,disableScrolling:!0};(0,o.useEffect)((()=>{h.current.start()}),[]),(0,o.useEffect)((()=>{const{executeResult:n,localDebugger:o}=f({flow:x.flow,dependencies:v,output:g,inputs:m,onError:a.noop,debugDelay:t,player:h.current}),s=e.flowProps.output.subscribe((e=>i(e)));return b(o),()=>{n(),s.unsubscribe()}}),[t,C]);const O=(0,o.useMemo)((()=>({resolvedDependencies:v,onImportPart:P,onRequestImportables:_})),[]),E=(0,o.useMemo)((()=>({debuggerClient:y,onRequestHistory:d.requestHistory})),[y]);return o.createElement(c.Z,null,(()=>o.createElement(s.DependenciesContextProvider,{value:O},o.createElement(s.DebuggerContextProvider,{value:E},o.createElement(s.FlowEditor,w)))))}},96191:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var o=n(14376);const i=200,s=()=>{const e=new Map,t=new Map;return{requestHistory:async(n,s,r)=>{const a="input"===r?o.DebuggerEventType.INPUT_CHANGE:o.DebuggerEventType.OUTPUT_CHANGE;if(console.log({insId:n,pinId:s,type:a}),s){const t=n+"."+s+"."+a,o=e.get(t)||{total:0,lastSamples:[]},r=o.lastSamples.slice(0,i);return{...o,lastSamples:r}}{const e=t.get(n)||{total:0,lastSamples:[]},o=e.lastSamples.slice(0,i);return{...e,lastSamples:o}}},addEvents:n=>{n.forEach((n=>{if(n.type===o.DebuggerEventType.ERROR){const e=n;e.type=o.DebuggerEventType.OUTPUT_CHANGE,e.pinId=o.ERROR_PIN_ID}if(n.type===o.DebuggerEventType.INPUT_CHANGE||n.type===o.DebuggerEventType.OUTPUT_CHANGE){const{insId:o,type:s,pinId:r}=n;{const t=o+"."+r+"."+s,a=e.get(t)||{total:0,lastSamples:[]};a.lastSamples.unshift(n),a.lastSamples.length>i&&a.lastSamples.splice(i,a.lastSamples.length-i),a.total++,e.set(t,a)}{const s=t.get(o)||{total:0,lastSamples:[]};s.lastSamples.unshift(n),s.lastSamples.length>i&&s.lastSamples.splice(i,s.lastSamples.length-i),s.total++,e.set(o,s)}}}))}}}},86001:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});var o=n(14376);const i={VMScript:class{constructor(e){this.script=e}},VM:class{constructor(e){this.context=e}run(e){const t=(0,o.okeys)(this.context.sandbox),n=Object.values(this.context.sandbox);Function(...t,e.script)(...n)}}}},26421:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});var o=n(45675),i=n(49231);const s=e=>i.createElement("li",{className:"log-item"},i.createElement("main",{className:"content"},e.value),i.createElement("aside",null,new Date(e.time).toLocaleTimeString())),r=e=>{const[t,n]=i.useState([]);return i.useEffect((()=>{e.output.subscribe((e=>{const t="object"==typeof e&&i.isValidElement(e)?e:""+e;n((e=>[...e,{value:t,time:Date.now()}]))}))}),[]),i.createElement("div",{className:"output-log"},i.createElement("header",null,"Output Log"," ",i.createElement("button",{className:"clear-btn button button--outline button--secondary button--sm",onClick:()=>n([])},"Clear")),i.createElement("main",null,i.createElement("ul",null,t.map(((e,t)=>i.createElement(s,(0,o.Z)({},e,{key:t}))))),0===t.length?i.createElement("div",{className:"empty-state"},"Nothing to show. Interact with the example to emit some outputs!"):null))}},6745:(e,t,n)=>{"use strict";n.d(t,{I:()=>f});var o=n(49231),i=(n(11253),n(89523)),s=n(19841),r=n(86001),a=n(88744),u=(n(14376),n(96191)),l=n(79732),c=n(97066),d=n(63712);n.g.vm2=r.z;(0,u.S)();const p=[{title:"Hello World",key:"hello-world"},{title:"React Counter",key:"react-counter"},{title:"BMI Calculator",key:"bmi"},{title:"REST API Usage",key:"apis"},{title:"Debounce vs. Throttling",key:"debounce-throttling"},{title:"Fibonacci Seq.",key:"fibonacci"}],f=e=>{const[t,n]=(0,o.useState)(e.initWidth||500),[r,u]=(0,o.useState)(e.defaultDelay||0),[f,m]=(0,o.useState)(!1),g=(0,o.useCallback)(((e,t)=>{let{size:o}=t;n(o.width)}),[]),h=o.createElement("div",{className:"delay-container"},o.createElement("input",{type:"range",id:"volume",name:"delay",value:r,step:"100",min:"0",max:"300",onChange:e=>u(Number(e.target.value))}),o.createElement("label",{htmlFor:"volume"},"Debug Delay: ",r,"ms")),v=p.findIndex((t=>t.key===e.meta.key)),I=p[v+1],y=p[v-1];return o.createElement(i.Z,{title:e.meta.title+" | Playground",description:"Flyde Playground - "+e.meta.title+" example"},o.createElement("header",{className:(0,s.Z)("hero hero--primary",l.Z.heroBanner,"playground-hero")},o.createElement("div",{className:"container"},o.createElement("h1",{className:"hero__title"},"Welcome to Flyde's Online Playground"),o.createElement("p",{className:"hero__subtitle"},"Choose one of the examples below to get started. Feel free to play around with the canvas and see how your changes affect the result!"))),o.createElement("div",{className:"mobile-warning"},"Flyde is currently not optimized for mobile devices. Please"," ",o.createElement("strong",null,"use a desktop computer for the best experience"),"."),o.createElement("ul",{className:"examples__menu"},p.map((e=>o.createElement("li",{key:e.key},o.createElement(a.Z,{to:"/playground/"+e.key,className:"button button--primary"},e.title))))),o.createElement("div",{className:"playground-container"},o.createElement("header",null,o.createElement("h2",{className:"playground-title"},e.meta.title),o.createElement("div",{className:"playground-description"},e.meta.description),f?o.createElement(o.Fragment,null,o.createElement("hr",null),o.createElement("div",{className:"playground-extra"},e.extraInfo||e.meta.extraInfo,o.createElement("div",{className:"star-hint"},o.createElement("span",null,"\xa0 PS: Did you like this example?"),"Please consider giving a \u2b50\ufe0f to the project"," ",o.createElement("span",{className:"star-wrapper"},o.createElement("iframe",{className:"gh-stars-frame",src:"https://ghbtns.com/github-btn.html?user=flydehq&repo=flyde&type=star&count=true&size=small",width:100,height:20,title:"GitHub Stars"}))))):null,e.prefixComponent),o.createElement("div",{className:"playground"},o.createElement("div",{className:"flow-container"},!0!==e.hideDelay?h:null,o.createElement(d.Y,{flowProps:e.flowProps,debugDelay:r,onOutput:()=>m(!0)})),o.createElement(c.Resizable,{height:0,width:t,onResize:g,axis:"x",handle:o.createElement("div",{className:"handle"}),resizeHandles:["w"]},o.createElement("div",{className:"output-container",style:{flexBasis:t}},e.children))),o.createElement("nav",{className:"pagination-nav"},o.createElement("div",{className:"pagination-nav__item"},y?o.createElement("a",{className:"pagination-nav__link",href:"/playground/"+y.key},o.createElement("div",{className:"pagination-nav__sublabel"},"Previous Example"),o.createElement("div",{className:"pagination-nav__label"},y.title)):null),o.createElement("div",{className:"pagination-nav__item pagination-nav__item--next"},I?o.createElement("a",{className:"pagination-nav__link",href:"/playground/"+I.key},o.createElement("div",{className:"pagination-nav__sublabel"},"Next Example"),o.createElement("div",{className:"pagination-nav__label"},I.title)):null))))}},97237:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l});var o=n(49231),i=n(14376),s=n(6745);const r={dependencies:[],flow:{imports:{"@flyde/stdlib":["IsGreater"]},part:{instances:[{pos:{x:-339.8445458984375,y:-298.6939727783203},id:"clal8c6ws00054664pn7mxwak",inputConfig:{},part:{id:"Inline-value-prompt(What is",inputs:{},outputs:{value:{type:"any",delayed:!1,optional:!1}},runFnRawCode:"const result = (prompt('What is your weight (in kilograms)?')); Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"prompt('What is your weight (in kilograms)?')",dataBuilderSource:"cHJvbXB0KCdXaGF0IGlzIHlvdXIgd2VpZ2h0IChpbiBraWxvZ3JhbXMpPycp",templateType:"value",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}}},{pos:{x:97.43304077148437,y:-298.35113525390625},id:"clal8cm19000b4664u3iz2pbb",inputConfig:{},part:{id:"Inline-value-prompt(What is",inputs:{},outputs:{value:{type:"any",delayed:!1,optional:!1}},runFnRawCode:"const result = (prompt('What is your height (in cm)?')); Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"prompt('What is your height (in cm)?')",dataBuilderSource:"cHJvbXB0KCdXaGF0IGlzIHlvdXIgaGVpZ2h0IChpbiBjbSk/Jyk=",templateType:"value",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}}},{pos:{x:-140.88708862304688,y:-123.31595092773438},id:"clal8dus5000j4664s9pwujgy",inputConfig:{},part:{id:"Inline-value-(inputs.weight ",inputs:{weight:{type:"any",mode:"required"},height:{type:"any",mode:"required"}},outputs:{value:{type:"any",delayed:!1,optional:!1}},runFnRawCode:"const result = ((inputs.weight / inputs.height**2)  * 10000); Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"(inputs.weight / inputs.height**2)  * 10000",dataBuilderSource:"KGlucHV0cy53ZWlnaHQgLyBpbnB1dHMuaGVpZ2h0KioyKSAgKiAxMDAwMA==",templateType:"value",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}}},{pos:{x:-122.89145629882813,y:6.26922607421875},id:"clal91glf00024664mfh47zbj",inputConfig:{},part:{id:"Inline-value-let range;\nif (",inputs:{bmi:{type:"any",mode:"required"}},outputs:{value:{type:"any",delayed:!1,optional:!1}},runFnRawCode:"const result = (function() { let range;\nif (inputs.bmi < 18.5) \n    range = 'overweight'\nelse if (inputs.bmi < 25) {\n    range = 'normal';\n} else if (inputs.bmi < 30) {\n    range = 'overweight';\n} else {\n    range = 'obese';\n}\n\nreturn `You are in the ${range} range`}());\n  Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"let range;\nif (inputs.bmi < 18.5) \n    range = 'overweight'\nelse if (inputs.bmi < 25) {\n    range = ",dataBuilderSource:"bGV0IHJhbmdlOwppZiAoaW5wdXRzLmJtaSA8IDE4LjUpIAogICAgcmFuZ2UgPSAnb3ZlcndlaWdodCcKZWxzZSBpZiAoaW5wdXRzLmJtaSA8IDI1KSB7CiAgICByYW5nZSA9ICdub3JtYWwnOwp9IGVsc2UgaWYgKGlucHV0cy5ibWkgPCAzMCkgewogICAgcmFuZ2UgPSAnb3ZlcndlaWdodCc7Cn0gZWxzZSB7CiAgICByYW5nZSA9ICdvYmVzZSc7Cn0KCnJldHVybiBgWW91IGFyZSBpbiB0aGUgJHtyYW5nZX0gcmFuZ2Vg",templateType:"function",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}}}],connections:[{from:{insId:"clal8c6ws00054664pn7mxwak",pinId:"value"},to:{insId:"clal8dus5000j4664s9pwujgy",pinId:"weight"}},{from:{insId:"clal8cm19000b4664u3iz2pbb",pinId:"value"},to:{insId:"clal8dus5000j4664s9pwujgy",pinId:"height"}},{from:{insId:"clal8dus5000j4664s9pwujgy",pinId:"value"},to:{insId:"clal91glf00024664mfh47zbj",pinId:"bmi"}},{from:{insId:"clal91glf00024664mfh47zbj",pinId:"value"},to:{insId:"__this",pinId:"rename"}}],id:"BMI",inputs:{},outputs:{rename:{type:"any",optional:!1,delayed:!1}},inputsPosition:{},outputsPosition:{result:{x:24.354419059198683,y:165.7657006221402},r:{x:24.354419059198683,y:165.7657006221402},rename:{x:33.925163537262904,y:163.67737650172523}},completionOutputs:["rename"]}}};var a=n(26421);const u={title:"BMI Calculator",description:"Simple BMI calculator with a decision tree. There are many things that make sense done visually, and even more that don't. This example showcases Flyde's support for inline code. The BMI calculation uses a simple inline formula, and the final string uses a textual switch case. Flyde exposes dynamic arguments to your inline code automatically if you use the special \"inputs.\" object!",key:"bmi"};function l(){const e=(0,o.useRef)((0,i.dynamicOutput)()),t=(0,o.useRef)({__trigger:(0,i.dynamicPartInput)()}),[n,l]=(0,o.useState)({flow:r.flow,dependencies:r.dependencies,inputs:t.current,output:e.current}),c=o.createElement("button",{className:"button button--success ",onClick:()=>t.current.__trigger.subject.next("run")},"Run!");return o.createElement(s.I,{meta:u,flowProps:n,prefixComponent:c,initWidth:300,extraInfo:"Try adding another prompt and another input to the formula!",defaultDelay:500},o.createElement(a.V,{output:e.current}))}},79732:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={"flyde-flow-editor":"flyde-flow-editor_AAD4",_hj_feedback_container:"_hj_feedback_container_Af03"}},87149:(e,t,n)=>{var o={"./af":99811,"./af.js":99811,"./ar":88973,"./ar-dz":90415,"./ar-dz.js":90415,"./ar-kw":36629,"./ar-kw.js":36629,"./ar-ly":14775,"./ar-ly.js":14775,"./ar-ma":6641,"./ar-ma.js":6641,"./ar-sa":38077,"./ar-sa.js":38077,"./ar-tn":65264,"./ar-tn.js":65264,"./ar.js":88973,"./az":34792,"./az.js":34792,"./be":44825,"./be.js":44825,"./bg":93340,"./bg.js":93340,"./bm":45824,"./bm.js":45824,"./bn":70406,"./bn-bd":92041,"./bn-bd.js":92041,"./bn.js":70406,"./bo":41017,"./bo.js":41017,"./br":21923,"./br.js":21923,"./bs":69475,"./bs.js":69475,"./ca":5918,"./ca.js":5918,"./cs":67842,"./cs.js":67842,"./cv":2943,"./cv.js":2943,"./cy":50226,"./cy.js":50226,"./da":70511,"./da.js":70511,"./de":44713,"./de-at":54504,"./de-at.js":54504,"./de-ch":47497,"./de-ch.js":47497,"./de.js":44713,"./dv":79952,"./dv.js":79952,"./el":36048,"./el.js":36048,"./en-au":82117,"./en-au.js":82117,"./en-ca":63711,"./en-ca.js":63711,"./en-gb":5436,"./en-gb.js":5436,"./en-ie":13436,"./en-ie.js":13436,"./en-il":6295,"./en-il.js":6295,"./en-in":24501,"./en-in.js":24501,"./en-nz":12408,"./en-nz.js":12408,"./en-sg":89469,"./en-sg.js":89469,"./eo":47316,"./eo.js":47316,"./es":78207,"./es-do":21849,"./es-do.js":21849,"./es-mx":59182,"./es-mx.js":59182,"./es-us":912,"./es-us.js":912,"./es.js":78207,"./et":3593,"./et.js":3593,"./eu":3845,"./eu.js":3845,"./fa":32118,"./fa.js":32118,"./fi":38126,"./fi.js":38126,"./fil":47278,"./fil.js":47278,"./fo":87855,"./fo.js":87855,"./fr":72074,"./fr-ca":48925,"./fr-ca.js":48925,"./fr-ch":65258,"./fr-ch.js":65258,"./fr.js":72074,"./fy":56505,"./fy.js":56505,"./ga":5985,"./ga.js":5985,"./gd":96720,"./gd.js":96720,"./gl":63172,"./gl.js":63172,"./gom-deva":65578,"./gom-deva.js":65578,"./gom-latn":24119,"./gom-latn.js":24119,"./gu":10535,"./gu.js":10535,"./he":91133,"./he.js":91133,"./hi":81046,"./hi.js":81046,"./hr":51303,"./hr.js":51303,"./hu":38319,"./hu.js":38319,"./hy-am":41472,"./hy-am.js":41472,"./id":26775,"./id.js":26775,"./is":2480,"./is.js":2480,"./it":74054,"./it-ch":18465,"./it-ch.js":18465,"./it.js":74054,"./ja":27175,"./ja.js":27175,"./jv":70395,"./jv.js":70395,"./ka":19984,"./ka.js":19984,"./kk":58383,"./kk.js":58383,"./km":92940,"./km.js":92940,"./kn":54612,"./kn.js":54612,"./ko":61536,"./ko.js":61536,"./ku":4524,"./ku.js":4524,"./ky":65045,"./ky.js":65045,"./lb":38035,"./lb.js":38035,"./lo":7909,"./lo.js":7909,"./lt":73427,"./lt.js":73427,"./lv":2710,"./lv.js":2710,"./me":99500,"./me.js":99500,"./mi":11493,"./mi.js":11493,"./mk":35501,"./mk.js":35501,"./ml":20348,"./ml.js":20348,"./mn":95733,"./mn.js":95733,"./mr":15180,"./mr.js":15180,"./ms":75829,"./ms-my":27026,"./ms-my.js":27026,"./ms.js":75829,"./mt":81629,"./mt.js":81629,"./my":19474,"./my.js":19474,"./nb":76215,"./nb.js":76215,"./ne":51067,"./ne.js":51067,"./nl":32926,"./nl-be":63867,"./nl-be.js":63867,"./nl.js":32926,"./nn":27272,"./nn.js":27272,"./oc-lnc":16891,"./oc-lnc.js":16891,"./pa-in":56352,"./pa-in.js":56352,"./pl":83397,"./pl.js":83397,"./pt":46723,"./pt-br":86681,"./pt-br.js":86681,"./pt.js":46723,"./ro":26696,"./ro.js":26696,"./ru":68904,"./ru.js":68904,"./sd":75400,"./sd.js":75400,"./se":69796,"./se.js":69796,"./si":45970,"./si.js":45970,"./sk":95438,"./sk.js":95438,"./sl":38088,"./sl.js":38088,"./sq":7608,"./sq.js":7608,"./sr":93897,"./sr-cyrl":30149,"./sr-cyrl.js":30149,"./sr.js":93897,"./ss":15771,"./ss.js":15771,"./sv":68008,"./sv.js":68008,"./sw":94213,"./sw.js":94213,"./ta":11609,"./ta.js":11609,"./te":54876,"./te.js":54876,"./tet":37298,"./tet.js":37298,"./tg":51678,"./tg.js":51678,"./th":79017,"./th.js":79017,"./tk":34378,"./tk.js":34378,"./tl-ph":40173,"./tl-ph.js":40173,"./tlh":1455,"./tlh.js":1455,"./tr":77599,"./tr.js":77599,"./tzl":6804,"./tzl.js":6804,"./tzm":40061,"./tzm-latn":88764,"./tzm-latn.js":88764,"./tzm.js":40061,"./ug-cn":60529,"./ug-cn.js":60529,"./uk":4048,"./uk.js":4048,"./ur":33727,"./ur.js":33727,"./uz":86786,"./uz-latn":7813,"./uz-latn.js":7813,"./uz.js":86786,"./vi":98860,"./vi.js":98860,"./x-pseudo":53514,"./x-pseudo.js":53514,"./yo":40937,"./yo.js":40937,"./zh-cn":33451,"./zh-cn.js":33451,"./zh-hk":38247,"./zh-hk.js":38247,"./zh-mo":27860,"./zh-mo.js":27860,"./zh-tw":11922,"./zh-tw.js":11922};function i(e){var t=s(e);return n(t)}function s(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}i.keys=function(){return Object.keys(o)},i.resolve=s,e.exports=i,i.id=87149},79e3:()=>{}}]);