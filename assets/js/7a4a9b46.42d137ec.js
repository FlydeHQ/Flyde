/*! For license information please see 7a4a9b46.42d137ec.js.LICENSE.txt */
(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[764],{8162:function(e,t,n){"use strict";var r=n(62525),o=60103,i=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var a=60109,u=60110,s=60112;t.Suspense=60113;var c=60115,l=60116;if("function"==typeof Symbol&&Symbol.for){var d=Symbol.for;o=d("react.element"),i=d("react.portal"),t.Fragment=d("react.fragment"),t.StrictMode=d("react.strict_mode"),t.Profiler=d("react.profiler"),a=d("react.provider"),u=d("react.context"),s=d("react.forward_ref"),t.Suspense=d("react.suspense"),c=d("react.memo"),l=d("react.lazy")}var p="function"==typeof Symbol&&Symbol.iterator;function f(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||v}function h(){}function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||v}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(f(85));this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},h.prototype=y.prototype;var b=g.prototype=new h;b.constructor=g,r(b,y.prototype),b.isPureReactComponent=!0;var I={current:null},P=Object.prototype.hasOwnProperty,_={key:!0,ref:!0,__self:!0,__source:!0};function O(e,t,n){var r,i={},a=null,u=null;if(null!=t)for(r in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(a=""+t.key),t)P.call(t,r)&&!_.hasOwnProperty(r)&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return{$$typeof:o,type:e,key:a,ref:u,props:i,_owner:I.current}}function C(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var w=/\/+/g;function x(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function j(e,t,n,r,a){var u=typeof e;"undefined"!==u&&"boolean"!==u||(e=null);var s=!1;if(null===e)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case o:case i:s=!0}}if(s)return a=a(s=e),e=""===r?"."+x(s,0):r,Array.isArray(a)?(n="",null!=e&&(n=e.replace(w,"$&/")+"/"),j(a,t,n,"",(function(e){return e}))):null!=a&&(C(a)&&(a=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,n+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(w,"$&/")+"/")+e)),t.push(a)),1;if(s=0,r=""===r?".":r+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=r+x(u=e[c],c);s+=j(u,t,n,l,a)}else if(l=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"==typeof l)for(e=l.call(e),c=0;!(u=e.next()).done;)s+=j(u=u.value,t,n,l=r+x(u,c++),a);else if("object"===u)throw t=""+e,Error(f(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return s}function E(e,t,n){if(null==e)return e;var r=[],o=0;return j(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function S(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var D={current:null};function k(){var e=D.current;if(null===e)throw Error(f(321));return e}var T={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:I,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:E,forEach:function(e,t,n){E(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return E(e,(function(){t++})),t},toArray:function(e){return E(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error(f(143));return e}},t.Component=y,t.PureComponent=g,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T,t.cloneElement=function(e,t,n){if(null==e)throw Error(f(267,e));var i=r({},e.props),a=e.key,u=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(u=t.ref,s=I.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)P.call(t,l)&&!_.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){c=Array(l);for(var d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}return{$$typeof:o,type:e.type,key:a,ref:u,props:i,_owner:s}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:u,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=O,t.createFactory=function(e){var t=O.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:s,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:l,_payload:{_status:-1,_result:e},_init:S}},t.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return k().useCallback(e,t)},t.useContext=function(e,t){return k().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return k().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return k().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return k().useLayoutEffect(e,t)},t.useMemo=function(e,t){return k().useMemo(e,t)},t.useReducer=function(e,t,n){return k().useReducer(e,t,n)},t.useRef=function(e){return k().useRef(e)},t.useState=function(e){return k().useState(e)},t.version="17.0.2"},93119:function(e,t,n){"use strict";e.exports=n(8162)},8541:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cappedArrayDebounce=void 0;t.cappedArrayDebounce=function(e,t,n,r){void 0===r&&(r=500);var o=[],i=null,a=null;return{addItem:function(u){clearTimeout(i),o.push(u),a||(a=setTimeout((function(){e(o),clearTimeout(i),a=null}),r)),o.length>=n?(e(o),clearTimeout(a),a=null,o=[]):i=setTimeout((function(){e(o),clearTimeout(a),a=null,o=[]}),t)},flush:function(){o.length&&(e(o),o=[],clearTimeout(a))}}}},96615:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.dataShaper=t.DataShapeType=void 0,function(e){e[e.STRING=0]="STRING",e[e.NUMBER=1]="NUMBER",e[e.BOOLEAN=2]="BOOLEAN",e[e.ARRAY=3]="ARRAY",e[e.OBJECT=4]="OBJECT",e[e.NULL=5]="NULL"}(n=t.DataShapeType||(t.DataShapeType={}));var r={string:n.STRING,number:n.NUMBER,boolean:n.BOOLEAN,object:n.OBJECT,array:n.ARRAY,null:n.NULL};t.dataShaper=function(e,n,o){void 0===n&&(n=5),void 0===o&&(o=5);var i,a,u=null===(i=e)?"null":typeof i;if("object"===u){if(Array.isArray(e))return n>1?e.filter((function(e,t){return t<o})).map((function(e){return(0,t.dataShaper)(e,n-1,o)})):r.array;if(n>1){var s={};for(var c in e)s[c]=(0,t.dataShaper)(e[c],n-1,o);return a=s,Object.keys(a).sort().reduce((function(e,t){return e[t]=a[t],e}),{})}return r.object}return r[u]}},40189:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debugLogger=void 0;var r=(0,n(96292).default)("flyde");t.debugLogger=function(e){return r.extend(e)}},68132:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.hashFlow=t.hashPart=void 0;var a=n(61586),u=n(18265),s=function(e){return a(e)};t.hashPart=function(e,t){void 0===t&&(t=!0);var n={id:e.id,completionOutputs:e.completionOutputs,reactiveInputs:e.reactiveInputs,inputs:e.inputs,outputs:e.outputs};if((0,u.isVisualPart)(e)){var a=e.instances,c=e.id,l=e.connections,d=e.inputsPosition,p=e.outputsPosition,f=a.map((function(e){e.pos;return o(e,["pos"])})),v=t?{}:{inputsPosition:d,outputsPosition:p},m=t?f:a;m.sort((function(e,t){return e.id.localeCompare(t.id)}));var y=i([],l,!0);y.sort((function(e,t){var n="".concat(e.from.insId,".").concat(e.from.pinId),r="".concat(t.from.insId,".").concat(t.from.pinId);return n.localeCompare(r)}));var h=JSON.stringify(r(r({id:c,instancesToUse:m,conns:y},n),{maybeIoPos:v}));return s(h)}if((0,u.isInlineValuePart)(e)){var g=e.fnCode,b=e.customViewCode;h=JSON.stringify(r({fnCode:g,customViewCode:b},n));return s(h)}throw new Error("Hashing code parts unsupported")};t.hashFlow=function(e,n){void 0===n&&(n=!0);var o=e.part,i=e.imports,a=(0,t.hashPart)(o,!1),u=Object.entries(i).sort((function(e,t){var n=e[0],r=t[0];return n.localeCompare(r)})).map((function(e){return[e[0],e[1].sort()]})).reduce((function(e,t){var n,o=t[0],i=t[1];return r(r({},e),((n={})[o]=i,n))}),{}),c=JSON.stringify(u);return s(a+c)}},45821:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.DepGraph=void 0,o(n(69985),t),o(n(94919),t),o(n(40189),t),o(n(8541),t),o(n(94919),t),o(n(68132),t),o(n(67748),t),o(n(96615),t),t.DepGraph=n(59280).DepGraph},69985:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.testDataCreator=void 0;t.testDataCreator=function(e){return function(t){void 0===t&&(t={});var r="function"==typeof e?e():e,o=t;return n(n({},r),o)}}},94919:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.eventually=t.delay=t.noop=t.removeDupes=t.ensure=t.isOptionalType=t.callFnOrFnPromise=t.isPromise=t.isDefined=t.containsAll=t.shuffle=t.randomInts=t.repeat=t.pickRandom=t.randomPos=t.randomInt=t.pickSecond=t.pickFirst=t.fromEntries=t.entries=t.okeys=t.values=t.keys=t.filterOMap=t.mapOMap=t.middlePos=t.calcCenter=t.intersectRect=void 0;t.intersectRect=function(e,t){var n=e.x+e.w,r=t.x+t.w;return!(t.x>n||r<e.x||t.y>e.y+e.h||t.y+t.h<e.y)};t.calcCenter=function(e){var t=e.w,n=e.h;return{x:e.x+t/2,y:e.y+n/2}};t.middlePos=function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}};t.mapOMap=function(e,r){return(0,t.entries)(e).map((function(e){var t=e[0],n=e[1];return[t,r(t,n)]})).reduce((function(e,t){var r,o=t[0],i=t[1];return n(n({},e),((r={})[o]=i,r))}),{})};t.filterOMap=function(e,r){return(0,t.entries)(e).filter((function(e){var t=e[0],n=e[1];return r(t,n)})).reduce((function(e,t){var r,o=t[0],i=t[1];return n(n({},e),((r={})[o]=i,r))}),{})};t.keys=function(e){return Object.keys(e)};t.values=function(e){return Object.values(e)},t.okeys=t.keys;t.entries=function(e){return(0,t.okeys)(e).map((function(t){return[t,e[t]]}))};t.fromEntries=function(e){return e.reduce((function(e,t){var r,o=t[0],i=t[1];return n(n({},e),((r={})[o]=i,r))}),{})};t.pickFirst=function(e){return e[0]};t.pickSecond=function(e){return e[1]};t.randomInt=function(e,t){void 0===t&&(t=0);var n=Math.random();return t+Math.floor((e-t)*n)};t.randomPos=function(e,n){return void 0===e&&(e=1e3),void 0===n&&(n=0),{x:(0,t.randomInt)(e,n),y:(0,t.randomInt)(e,n)}};t.pickRandom=function(e){return e[(0,t.randomInt)(e.length)]};t.repeat=function(e,t){return"x".repeat(e).split("").map((function(e,n){return t(n)}))};t.randomInts=function(e,n,r){return void 0===n&&(n=100),void 0===r&&(r=0),(0,t.repeat)(e,(function(){return(0,t.randomInt)(n,r)}))};t.shuffle=function(e){for(var t,n=i([],e,!0),r=n.length-1;r>=0;r--){var o=Math.floor(Math.random()*(r+1));t=[n[o],n[r]],n[r]=t[0],n[o]=t[1]}return n};t.containsAll=function(e,t){return t.every((function(t){return e.includes(t)}))};t.isDefined=function(e){return void 0!==e};t.isPromise=function(e){return e&&"function"==typeof e.then};t.callFnOrFnPromise=function(e,n){if((0,t.isDefined)(e)){var r=function(e){try{e()}catch(t){console.error(t)}};"function"==typeof e?r(e):Promise.resolve(e).then((function(e){"function"==typeof e&&r(e)}))}};t.isOptionalType=function(e){return/\?$/.test(e)};t.ensure=function(e,t){if(void 0===e)throw new Error(t||"Undefined value passed");return e};t.removeDupes=function(e){return Array.from(new Set(e))};t.noop=function(){};t.delay=function(e){return new Promise((function(t){return setTimeout(t,e)}))};t.eventually=function(e,n,i,a){return void 0===n&&(n=3e3),void 0===i&&(i=100),void 0===a&&(a=new Set),r(void 0,void 0,void 0,(function(){var r,u,s,c;return o(this,(function(o){switch(o.label){case 0:if(n<0)throw r=Array.from(a).reduce((function(e,t,n){return"".concat(e,"\n\t\t").concat(n+1,". ").concat(t)}),""),new Error("[Eventually timeout exceeded after: timeout with error]: ".concat(r));o.label=1;case 1:return o.trys.push([1,3,,5]),[4,e()];case 2:return o.sent(),[3,5];case 3:return u=o.sent(),s=Date.now(),[4,(0,t.delay)(i)];case 4:return o.sent(),c=Date.now()-s,a.add(u.message),[2,(0,t.eventually)(e,n-c,i,a)];case 5:return[2]}}))}))}},67748:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compileObjectTemplate=t.compileStringTemplate=void 0;t.compileStringTemplate=function(e,t){var n=decodeURIComponent(e);return Object.keys(t).forEach((function(e){var r=t[e],o=new RegExp("\\$\\{"+e+"\\}","g");n=n.replace(o,r)})),n};t.compileObjectTemplate=function(e,t){var n=decodeURIComponent(e);return Object.keys(t).forEach((function(e){var r=t[e],o=JSON.stringify(r),i=new RegExp('"\\$\\$\\{'+e+'\\}"',"g"),a=new RegExp("\\$\\{"+e+"\\}","g"),u="string"==typeof r?r.replace(/"/g,(function(e,t,n){return"\\"!==n[t-1]?'\\"':n[t]})):r;n=n.replace(i,o).replace(a,u).replace(/\n/g,"\\n")})),JSON.parse(n)}},1076:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.connection=t.connectionData=t.connectionDataEquals=t.connectionNodeEquals=t.connectionNode=t.externalConnectionNode=t.isInternalConnection=t.isExternalConnection=t.isInternalConnectionNode=t.isExternalConnectionNode=t.getPartOutputs=t.getOutputName=t.getInputName=t.getPartInputs=t.TRIGGER_PIN_ID=t.ERROR_PIN_ID=t.THIS_INS_ID=void 0;var o=n(18265);t.THIS_INS_ID="__this",t.ERROR_PIN_ID="__error",t.TRIGGER_PIN_ID="__trigger";t.getPartInputs=function(e){var n;return r(r({},e.inputs),((n={})[t.TRIGGER_PIN_ID]=(0,o.partInput)(),n))};t.getInputName=function(e){return e===t.TRIGGER_PIN_ID?"Trigger Part":e};t.getOutputName=function(e){return e===t.ERROR_PIN_ID?"Error":e};t.getPartOutputs=function(e){var n;return r(r({},e.outputs),((n={})[t.ERROR_PIN_ID]=(0,o.partOutput)(),n))};t.isExternalConnectionNode=function(e){return e.insId===t.THIS_INS_ID};t.isInternalConnectionNode=function(e){return e.insId!==t.THIS_INS_ID};t.isExternalConnection=function(e){var n=e.from,r=e.to;return(0,t.isExternalConnectionNode)(n)||(0,t.isExternalConnectionNode)(r)};t.isInternalConnection=function(e){return!(0,t.isExternalConnection)(e)};t.externalConnectionNode=function(e){return{insId:t.THIS_INS_ID,pinId:e}};t.connectionNode=function(e,t){return{insId:e,pinId:t}};t.connectionNodeEquals=function(e,t){return e.insId===t.insId&&e.pinId===t.pinId};t.connectionDataEquals=function(e,n){return!(!e||!n)&&((0,t.connectionNodeEquals)(e.from,n.from)&&(0,t.connectionNodeEquals)(e.to,n.to))},t.connectionData=function(e,n,r){var o="string"==typeof e?e.split("."):e,i="string"==typeof n?n.split("."):n;if(o.length>2||i.length>2)throw new Error("invalid source or target to connection data - ".concat(e," / ").concat(n));return{from:2===o.length?(0,t.connectionNode)(o[0],o[1]):(0,t.externalConnectionNode)(o[0]),to:2===i.length?(0,t.connectionNode)(i[0],i[1]):(0,t.externalConnectionNode)(i[0]),delayed:r}};t.connection=function(e,t,n){return void 0===n&&(n=!1),{from:e,to:t,delayed:n}}},6485:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.connect=void 0;var u=n(24048),s=n(30385),c=n(45821),l=n(1076);o(n(1076),t);t.connect=function(e,t,n,r,o,d,p,f){void 0===n&&(n={}),void 0===r&&(r="root"),void 0===o&&(o={bob:new Map}),void 0===d&&(d=c.noop),void 0===p&&(p={}),void 0===f&&(f={});var v=e.id,m=e.connections,y=e.instances,h=v||"connected-part"+(0,c.randomInt)(999);return{inputs:e.inputs,outputs:e.outputs,id:h,completionOutputs:e.completionOutputs,reactiveInputs:e.reactiveInputs,fn:function(v,g){var b,I=[],P=new c.DepGraph({}),_=new Map,O=new Map,C=new Map,w=new Map,x=new Map,j=new Map,E=new Set;y.forEach((function(e){var n=(0,u.getPart)(e,t),r=e.id;_.set(e,r),O.set(r,e),P.addNode(r);var o=Object.keys(n.inputs),i=Object.keys(n.outputs),a={},s={};if(o.forEach((function(t){var n=(e.inputConfig||{})[t]||(0,u.queueInputPinConfig)();(0,u.isStaticInputPinConfig)(n)?a[t]=(0,u.staticPartInput)(n.value):a[t]=(0,u.dynamicPartInput)({config:n})})),a[l.TRIGGER_PIN_ID]=(0,u.dynamicPartInput)({config:(0,u.queueInputPinConfig)()}),m.some((function(t){return(0,l.isInternalConnectionNode)(t.to)&&t.to.insId===e.id&&t.to.pinId===l.TRIGGER_PIN_ID}))&&e.inputConfig&&e.inputConfig[l.TRIGGER_PIN_ID])throw"Trigger connection can not be configured";i.forEach((function(e){var t=(0,u.dynamicOutput)();s[e]=t})),m.some((function(t){return(0,l.isInternalConnectionNode)(t.from)&&t.from.insId===e.id&&t.from.pinId===l.ERROR_PIN_ID}))&&(s[l.ERROR_PIN_ID]=(0,u.dynamicOutput)()),C.set(r,a),w.set(r,s)}));var S=new Set;return m.forEach((function(n){var r=n.from,o=n.to,s=r.insId,c=r.pinId,d=o.insId,p=o.pinId,f=w.get(s),v=C.get(d);if((0,l.isInternalConnectionNode)(o)&&S.add("".concat(o.insId,".").concat(o.pinId)),(0,l.isExternalConnection)(n))if((0,l.isExternalConnectionNode)(r)){var m=v[o.pinId];if(!m)throw new Error("Input ".concat(o.pinId," of instance ").concat(d," not found"));(y=x.get(r.pinId)||[]).push(m),x.set(r.pinId,y)}else{var y,g=f[r.pinId];if(!g)throw new Error("Output ".concat(r.pinId," of instance ").concat(s," not found"));(y=j.get(o.pinId)||[]).push(g),j.set(o.pinId,y)}else{if(!f)throw new Error("No outputs found for instance [".concat(s,"]"));if(!v)throw O.has(d)?new Error("No inputs found for instance [".concat(d,"]")):new Error("Instance with id [".concat(d,"] does not exist!"));var b=f[c];if(!b)throw console.log(c),new Error("Output source - [".concat(c,"] not found in part [").concat(h,"]"));var _=v[p],E=O.get(s);if(!E&&s!==l.THIS_INS_ID)throw new Error("Instance [".concat(s,"] does not exist! failed to connect [").concat(r,"] -> [").concat(o,"]"));var D=(E?(0,u.getPart)(E,t):e).outputs[c];if(D&&D.delayed||n.delayed||s!==l.THIS_INS_ID&&d!==l.THIS_INS_ID&&P.addDependency(s,d),!_)throw new Error("Target arg - [".concat(o,"] not found in part [").concat(h,"]"));var k=b.subscribe((function(e){return i(void 0,void 0,void 0,(function(){return a(this,(function(t){if(!(0,u.isDynamicInput)(_))throw console.info(_),new Error("Impossible state listening to non dynamic input - ".concat(d,".").concat(p));return _.subject.next(e),[2]}))}))}));I.push((function(){return k.unsubscribe()}))}})),(0,c.okeys)(g).forEach((function(e){(j.get(e)||[]).forEach((function(t){var n=t.subscribe((function(t){return i(void 0,void 0,void 0,(function(){return a(this,(function(n){return g[e].next(t),[2]}))}))}));I.push((function(){return n.unsubscribe()}))}))})),P.overallOrder().map((function(e){return O.get(e)})).forEach((function(e){var i=C.get(e.id),a=w.get(e.id),c=(0,u.getPart)(e,t);if(!i)throw new Error("Unexpected error - args not found when running ".concat(e));if(!a)throw new Error("Unexpected error - outputs not found when running ".concat(e));for(var l in i){var v=e.inputConfig[l];S.has("".concat(e.id,".").concat(l))||(0,u.isStaticInputPinConfig)(v)||delete i[l]}var m=(0,s.execute)({part:c,inputs:i,outputs:a,partsRepo:t,_debugger:n,insId:e.id,extraContext:f,mainState:o,parentInsId:r,onBubbleError:d,onCompleted:function(){return t=e.id,E.delete(t),void(0===E.size&&b&&b());var t},onStarted:function(){return t=e.id,void E.add(t);var t},env:p});I.push(m)})),Object.keys(v).forEach((function(e){return i(void 0,void 0,void 0,(function(){return a(this,(function(t){return(x.get(e)||[]).forEach((function(t){var n=v[e];if(!(0,u.isDynamicInput)(t))throw new Error("Unsure what to do with key ".concat(e,", input: ").concat(t," of ins ").concat(r));(0,c.isDefined)(n)&&t.subject.next(n)})),[2]}))}))})),void 0===e.completionOutputs&&E.size>0?new Promise((function(e){b=e})):function(){return I.forEach((function(e){try{e()}catch(t){console.error("error unsubscribing",t)}}))}}}}},28674:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MINOR_DEBUGGER_EVENT_TYPES=t.MAJOR_DEBUGGER_EVENT_TYPES=t.DebuggerEventType=void 0,function(e){e.INPUT_CHANGE="i",e.OUTPUT_CHANGE="o",e.PROCESSING_CHANGE="pc",e.ERROR="err",e.INPUTS_STATE_CHANGE="isc"}(n=t.DebuggerEventType||(t.DebuggerEventType={})),t.MAJOR_DEBUGGER_EVENT_TYPES=[n.INPUT_CHANGE,n.OUTPUT_CHANGE,n.ERROR],t.MINOR_DEBUGGER_EVENT_TYPES=[n.PROCESSING_CHANGE,n.INPUTS_STATE_CHANGE]},76296:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(28674),t)},30385:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.execute=t.INPUTS_STATE_SUFFIX=t.INNER_STATE_SUFFIX=void 0;var s=n(71542),c=n(21730);i(n(76296),t);var l=n(24048),d=n(6485),p=n(23939),f=n(45821),v=n(40189),m=n(24048),y=n(18265),h=n(76296);t.INNER_STATE_SUFFIX="_inner",t.INPUTS_STATE_SUFFIX="_inputs";t.execute=function(e){var n=e.part,o=e.inputs,i=e.outputs,g=e.partsRepo,b=e._debugger,I=void 0===b?{}:b,P=e.insId,_=void 0===P?n.id:P,O=e.extraContext,C=void 0===O?{}:O,w=e.mainState,x=void 0===w?{}:w,j=e.parentInsId,E=void 0===j?"root":j,S=e.onBubbleError,D=void 0===S?s.noop:S,k=e.env,T=void 0===k?{}:k,N=e.onCompleted,M=void 0===N?s.noop:N,R=e.onStarted,A=void 0===R?s.noop:R,V=[],z=r(r({},C),{ENV:T}),H=(0,y.customRepoToPartRepo)(g,z),G=function(e){var t=e instanceof Error?e:new Error("Raw error: ".concat(e.toString()));if(t.message="error in child instance ".concat(_,": ").concat(t.message),i[d.ERROR_PIN_ID]?i[d.ERROR_PIN_ID].next(e):(t.insId=_,D(t)),I.onEvent){var n=t;n.insId="".concat(E,".").concat(_),I.onEvent({type:h.DebuggerEventType.ERROR,val:n,insId:_,parentInsId:E})}},L=function(e){return(0,l.isVisualPart)(e)?(0,d.connect)(e,H,I,"".concat(E,".").concat(_),x,G,T,C):(0,l.isInlineValuePart)(e)?(0,y.inlineValuePartToPart)(e,z):e}(n),B=I.onEvent||s.noop,F={},U={};(0,f.entries)(o).forEach((function(e){var t=e[0],n=e[1];if((0,l.isDynamicInput)(n)){var r=(0,l.dynamicPartInput)({config:n.config}),o=n.subject.subscribe((function(e){return a(void 0,void 0,void 0,(function(){var n,o;return u(this,(function(i){switch(i.label){case 0:return(n=B({type:h.DebuggerEventType.INPUT_CHANGE,insId:_,pinId:t,val:e,parentInsId:E}))?[4,n.valuePromise]:[3,2];case 1:return o=i.sent(),r.subject.next(o),[3,5];case 2:return I.debugDelay?[4,(0,f.delay)(I.debugDelay)]:[3,4];case 3:i.sent(),i.label=4;case 4:r.subject.next(e),i.label=5;case 5:return[2]}}))}))}));V.push((function(){return o.unsubscribe()})),U[t]=r}else{B({type:h.DebuggerEventType.INPUT_CHANGE,insId:_,pinId:t,val:n.config.value,parentInsId:E});var i=(0,l.staticPartInput)((0,l.getStaticValue)(n.config.value,H,_));U[t]=i}})),(0,f.entries)(i).forEach((function(e){var t=e[0],n=e[1],r=(0,l.dynamicOutput)(),o=r.subscribe((function(e){return a(void 0,void 0,void 0,(function(){var r,o;return u(this,(function(i){switch(i.label){case 0:return(r=B({type:h.DebuggerEventType.OUTPUT_CHANGE,insId:_,pinId:t,val:e,parentInsId:E}))?[4,r.valuePromise]:[3,2];case 1:return o=i.sent(),n.next(o),[3,3];case 2:n.next(e),i.label=3;case 3:return[2]}}))}))}));V.push((function(){return o.unsubscribe()})),F[t]=r}));var q=function(e){var n,o=e.part,i=e.inputs,a=e.outputs,u=e.repo,d=e._debugger,g=e.insId,b=e.parentInsId,I=e.mainState,P=e.onError,_=e.onStarted,O=e.onCompleted,C=e.env,w=e.extraContext,x=o.fn,j=(0,v.debugLogger)("core"),E=[],S=d.onEvent||s.noop,D="".concat(b||"root",".").concat(g),k="".concat(D).concat(t.INNER_STATE_SUFFIX),T="".concat(D).concat(t.INPUTS_STATE_SUFFIX),N=j.extend(D);I[k]||(I[k]=new Map),I[T]||(I[T]=new Map),I[k];var M,R=I[T],A=function(){var e=Array.from(R.entries()).reduce((function(e,t){var n,o=t[0],a=t[1],u=(0,l.isQueueInputPinConfig)(i[o].config,i[o]);return r(r({},e),((n={})[o]=u?null==a?void 0:a.length:1,n))}),{});S({type:h.DebuggerEventType.INPUTS_STATE_CHANGE,val:e,insId:g,parentInsId:b})},V={execute:function(e,n,r,o){return(0,t.execute)({part:e,inputs:n,outputs:r,partsRepo:u,_debugger:d,insId:o,onCompleted:O,onStarted:_})},insId:g,state:I[k],onCleanup:function(e){E.push(e)},onError:function(e){P(e)},context:w},z=!1,H=(o.reactiveInputs||[]).filter((function(e){return!(0,m.isStaticInputPinConfig)(i[e].config)})),G=function(){I[k].clear(),(0,f.keys)(I).filter((function(e){return e.startsWith("".concat(D,"."))})).forEach((function(e){I[e]=new Map}))},L=function e(t){var u,s=H.includes(null==t?void 0:t.key);if(z&&!s);else{var d=z&&s;if((0,p.isPartStateValid)(i,R,o)||d){var v=void 0;if(z){if(!t)throw new Error("Unexpected state,  got reactive part while not processing and not valid");var m=(0,p.pullValueForExecution)(t.key,i[t.key],R,C);v=r(r({},M),((u={})[t.key]=m,u)),A()}else v=(0,p.pullValuesForExecution)(i,R,C),M=v,A();var I=new Set,w={};if(z=!0,S({type:h.DebuggerEventType.PROCESSING_CHANGE,val:z,insId:g,parentInsId:b}),o.completionOutputs){var j=o.completionOutputs.map((function(e){return e.split("+")})).reduce((function(e,t){return t.forEach((function(n){e.set(n,t)})),e}),new Map);(0,f.entries)(a).forEach((function(t){var r=t[0];t[1].pipe((0,c.first)()).subscribe((function(t){I.add(r),w[r]=t;var a=j.get(r);a&&(a.splice(a.indexOf(r),1),0===a.length&&(z=!1,S({type:h.DebuggerEventType.PROCESSING_CHANGE,val:z,insId:g,parentInsId:b}),O&&O(w),G(),(0,y.callFnOrFnPromise)(n,"Error with cleanup function of ".concat(o.id)),n=void 0,I.clear(),w={},(0,p.hasNewSignificantValues)(i,R,C,o.id)&&e()))}))}))}else G();try{N("Running part %s with values %o",o.id,v),_&&_(),n=x(v,a,V),(0,y.isPromise)(n)?n.then((function(){void 0===o.completionOutputs&&O&&(z=!1,S({type:h.DebuggerEventType.PROCESSING_CHANGE,val:z,insId:g,parentInsId:b}),O(w))})):void 0===o.completionOutputs&&O&&(z=!1,S({type:h.DebuggerEventType.PROCESSING_CHANGE,val:z,insId:g,parentInsId:b}),O(w))}catch(L){console.log(L),z=!1,N("Error in part %s - value %e",o.id,L),S({type:h.DebuggerEventType.PROCESSING_CHANGE,val:z,insId:g,parentInsId:b}),P(L)}var E=H.find((function(e){return i[e]&&(0,p.peekValueForExecution)(e,i[e],R,C,o.id)}));if(E)m=(0,p.peekValueForExecution)(E,i[E],R,C,o.id),e({key:E,value:m});else{var D=(0,f.entries)(i).find((function(e){var t=e[0],n=e[1],r=(0,l.isQueueInputPinConfig)(n.config,n),i=(0,p.peekValueForExecution)(t,n,R,C,o.id);if(r)return(0,f.isDefined)(i)}));if(D){var k=D[0],T=D[1];m=(0,p.peekValueForExecution)(k,T,R,C,o.id),e({key:k,value:m})}}}}};L();var B=(0,p.subscribeInputsToState)(i,R,u,g,(function(e,t){j("Got input %s - value is [%o]",e,t),A();try{L({key:e,value:t})}catch(n){P(n)}}));return E.push(B),function(){(0,y.callFnOrFnPromise)(n,"Error with cleanup function of ".concat(o.id)),E.forEach((function(e){return e()}))}}({part:L,inputs:U,outputs:F,repo:H,_debugger:I,insId:_,mainState:x,parentInsId:E,onError:G,onBubbleError:D,env:T,extraContext:C,onCompleted:M,onStarted:A});return function(){V.forEach((function(e){return e()})),q()}}},23939:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeInputsToState=t.isPartStateValid=t.hasNewSignificantValues=t.peekValuesForExecution=t.pullValuesForExecution=t.pullValueForExecution=t.peekValueForExecution=void 0;var i=n(24048),a=n(45821),u=n(6485),s=function(e,t){var n=(0,i.extractStaticValue)(e);return(0,i.isEnvValue)(n)?function(e,t){for(var n=e.split("."),o=r({},t),i=0,u=n;i<u.length;i++){var s=u[i];if(!o||!(0,a.isDefined)(o[s])||null===o[s])throw new Error("Cannot find key ".concat(e," inside obj ").concat(t));o=o[s]}return o}((0,i.getEnvKeyFromValue)(n),t):n};t.peekValueForExecution=function(e,t,n,r,a){var u=n.get(e);if(!t)throw new Error('Trying to peek value of inexsting input in key "'.concat(e,'" in part "').concat(a,'"'));return(0,i.isStaticInput)(t)?s(t,r):(0,i.isQueueInputPinConfig)(t.config,t)?u?o([],u,!0).shift():void 0:u};t.pullValueForExecution=function(e,t,n,r){var o,a=n.get(e);return(0,i.isStaticInput)(t)?o=s(t,r):(0,i.isQueueInputPinConfig)(t.config,t)?(o=(a||[]).shift(),n.set(e,a)):(o=a,(0,i.isStickyInputPinConfig)(t.config)||n.delete(e)),o};t.pullValuesForExecution=function(e,n,r){return(0,a.entries)(e).reduce((function(e,o){var i=o[0],a=o[1];return e[i]=(0,t.pullValueForExecution)(i,a,n,r),e}),{})};t.peekValuesForExecution=function(e,n,r,o){return(0,a.entries)(e).reduce((function(e,i){var a=i[0],u=i[1];return e[a]=(0,t.peekValueForExecution)(a,u,n,r,o),e}),{})};t.hasNewSignificantValues=function(e,n,r,o){return(0,a.entries)(e).some((function(e){var u=e[0],s=e[1],c=(0,i.isQueueInputPinConfig)(s.config,s),l=(0,t.peekValueForExecution)(u,s,n,r,o);return(0,a.isDefined)(l)&&c}))};t.isPartStateValid=function(e,t,n){var r=(0,a.keys)(e),o=(0,a.keys)(n.inputs).filter((function(e){return"required"===n.inputs[e].mode}));return r.includes(u.TRIGGER_PIN_ID)&&o.push(u.TRIGGER_PIN_ID),!!(0,a.containsAll)(r,o)&&(0,a.entries)(e).filter((function(e){var t=e[0];return!!n.inputs[t]||t===u.TRIGGER_PIN_ID})).every((function(e){var r,o=e[0],u=e[1],s=t.get(o);return"optional"===((null===(r=n.inputs[o])||void 0===r?void 0:r.mode)||"required")||(!!(0,i.isStaticInput)(u)||((0,i.isQueueInputPinConfig)(u.config,u)?(0,a.isDefined)(s)&&s.length>0:(0,a.isDefined)(s)))}))};t.subscribeInputsToState=function(e,t,n,r,o){var u=[];return(0,a.entries)(e).forEach((function(e){var n=e[0],r=e[1];if(r&&!(0,i.isStaticInput)(r)){var a=r.subject.subscribe((function(e){if((0,i.isQueueInputPinConfig)(r.config,r)){var a=t.get(n)||[];if(!Array.isArray(a))throw new Error("impossible state - state of key ".concat(n," is set but not an array"));a.push(e),t.set(n,a),o(n,e)}else t.set(n,e),o(n,e)}));u.push((function(){return a.unsubscribe()}))}})),function(){return u.forEach((function(e){return e()}))}}},19735:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flydeFlowSchema=void 0;var r=n(89510),o=r.z.record(r.z.string(),r.z.string().or(r.z.array(r.z.string()))),i=r.z.strictObject({x:r.z.number(),y:r.z.number()}),a=r.z.discriminatedUnion("mode",[r.z.strictObject({mode:r.z.literal("static"),value:r.z.any()}),r.z.strictObject({mode:r.z.literal("queue")}),r.z.strictObject({mode:r.z.literal("sticky")})]),u=r.z.object({size:r.z.optional(r.z.enum(["small","regular","large"])),icon:r.z.optional(r.z.any()),color:r.z.optional(r.z.string()),cssOverride:r.z.optional(r.z.record(r.z.string()))}),s=r.z.object({pos:i.default({x:0,y:0}),id:r.z.string(),inputConfig:r.z.optional(r.z.record(r.z.string(),a)).default({}),visibleInputs:r.z.optional(r.z.array(r.z.string())),visibleOutputs:r.z.optional(r.z.array(r.z.string())),partId:r.z.optional(r.z.string()),part:r.z.optional(r.z.any()),style:r.z.optional(u)}).refine((function(e){return e.part||e.partId}),{message:"Instance must have either an inline part or refer to a partId"}),c=r.z.union([r.z.string(),r.z.object({mode:r.z.enum(["required","optional","required-if-connected"]),type:r.z.string(),description:r.z.optional(r.z.string()),defaultValue:r.z.optional(r.z.any())})]),l=r.z.object({type:r.z.string(),optional:r.z.optional(r.z.boolean()),delayed:r.z.optional(r.z.boolean()),description:r.z.optional(r.z.string())}),d=r.z.object({id:r.z.optional(r.z.string()),inputs:r.z.record(r.z.string(),c),outputs:r.z.record(r.z.string(),l),inputsPosition:r.z.optional(r.z.record(r.z.string(),i)),outputsPosition:r.z.optional(r.z.record(r.z.string(),i)),customViewCode:r.z.optional(r.z.string()),dataBuilderSource:r.z.optional(r.z.string()),templateType:r.z.optional(r.z.string()),completionOutputs:r.z.optional(r.z.array(r.z.string())),reactiveInputs:r.z.optional(r.z.array(r.z.string())),defaultStyle:r.z.optional(u),description:r.z.optional(r.z.string())}),p=r.z.object({instances:r.z.array(s),connections:r.z.array(r.z.strictObject({from:r.z.strictObject({insId:r.z.string(),pinId:r.z.string()}),to:r.z.strictObject({insId:r.z.string(),pinId:r.z.string()}),delayed:r.z.optional(r.z.boolean()),hidden:r.z.optional(r.z.boolean())}))}).and(d);t.flydeFlowSchema=r.z.strictObject({imports:r.z.optional(o).default({}),part:p})},18265:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.isStaticValueVisualPart=void 0,o(n(45821),t);var i=n(24048);o(n(6485),t),o(n(30385),t),o(n(69789),t),o(n(24048),t),o(n(90163),t),o(n(51922),t),o(n(11302),t),o(n(55281),t),o(n(19735),t);t.isStaticValueVisualPart=function(e){return e&&!!(0,i.maybeGetStaticValuePartId)("".concat(e))}},88004:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.fakeVm=t.VM=t.VMScript=void 0;var o=n(18265),i=function(e){this.script=e};t.VMScript=i;var a=function(){function e(e){this.context=e}return e.prototype.run=function(e){var t=(0,o.okeys)(this.context.sandbox),n=Object.values(this.context.sandbox);Function.apply(void 0,r(r([],t,!1),[e.script],!1)).apply(void 0,n)},e}();t.VM=a,t.fakeVm={VMScript:i,VM:a}},58725:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVM2Instance=void 0;var r=n(88004);t.getVM2Instance=function(){return r.fakeVm}},11302:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.customRepoToPartRepo=t.inlineValuePartToPart=void 0;var a=n(14206),u=n(18265),s=n(24048),c=n(18265),l=(0,n(58725).getVM2Instance)();t.inlineValuePartToPart=function(e,t){void 0===t&&(t={});var n=e.fnCode,d=o(e,["fnCode"]),p=(0,u.debugLogger)("code-part:".concat(e.id)),f="\n  try {\n    ".concat(n,"\n  } catch (e) {\n    adv.onError(e);\n  }\n  "),v=new l.VMScript(f),m=r(r({},d),{fn:function(n,o,d){var f=new l.VM({sandbox:r({inputs:n,outputs:o,setInterval:setInterval,clearInterval:clearInterval,setTimeout:setTimeout,clearTimeout:clearTimeout,encodeURIComponent:encodeURIComponent,adv:d,log:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];p.apply(void 0,i(["Log from code part ".concat(e.id," [").concat(d.insId,"]")],t,!1))},axios:a.default,DEFAULT_AXIOS_TIMEOUT:15e3,dynamicPartInput:s.dynamicPartInput,dynamicPartArg:s.dynamicPartInput,dynamicOutput:c.dynamicOutput,isDefined:c.isDefined,compileStringTemplate:u.compileStringTemplate,compileObjectTemplate:u.compileObjectTemplate,__FLYDE_MODE:"production"},t)});f.run(v)}});return m};t.customRepoToPartRepo=function(e,n){void 0===n&&(n={});var r={};for(var o in e){var i=e[o];r[o]=(0,s.isInlineValuePart)(i)?(0,t.inlineValuePartToPart)(i,n):i}return r}},90163:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.getPartWithDependencies=void 0;var o=n(24048),i=n(18265),a=n(93471);t.getPartWithDependencies=function(e,n,u){if(void 0===u&&(u=[]),(0,o.isInlineValuePart)(e))return[e];if(u.includes(e.id))return[];var s=(0,i.removeDupes)(e.instances.filter((function(e){return(0,a.isRefPartInstance)(e)})).map((function(e){return e.partId})).filter((function(e){return n[e]}))),c=s.map((function(e){return n[e]})).reduce((function(e,o){return r(r([],e,!0),(0,t.getPartWithDependencies)(o,n,r(r([],u,!0),s,!0)),!0)}),[]);return r([e],c,!0)}},24048:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.codeFromFunction=t.getPartDef=t.getPart=t.getStaticValue=t.maybeGetStaticValuePartId=t.fromSimplified=t.inlineValuePart=t.codePart=t.visualPart=t.isInlineValuePart=t.isVisualPart=t.isCodePart=t.InlineValuePartType=void 0;var a=n(45821),u=n(18265),s=n(93471);i(n(93471),t),i(n(85089),t),i(n(34702),t),function(e){e.VALUE="value",e.FUNCTION="function"}(t.InlineValuePartType||(t.InlineValuePartType={}));t.isCodePart=function(e){return!(0,t.isVisualPart)(e)};t.isVisualPart=function(e){return!!e.instances};t.isInlineValuePart=function(e){return(0,a.isDefined)(e)&&(0,a.isDefined)(e.fnCode)},t.visualPart=(0,a.testDataCreator)({id:"visual-part",inputs:{},outputs:{},instances:[],connections:[],outputsPosition:{},inputsPosition:{}}),t.codePart=(0,a.testDataCreator)({id:"part",inputs:{},outputs:{},fn:a.noop}),t.inlineValuePart=(0,a.testDataCreator)({id:"part",inputs:{},outputs:{},fnCode:""});t.fromSimplified=function(e){var t=e.fn,n=e.inputTypes,o=e.outputTypes,i=e.id,u=(0,a.entries)(n).reduce((function(e,t){var n,o=t[0];t[1];return r(r({},e),((n={})[o]={},n))}),{}),s=(0,a.entries)(o).reduce((function(e,t){var n,o=t[0];t[1];return r(r({},e),((n={})[o]={},n))}),{});return{id:i,inputs:u,outputs:s,fn:t}};t.maybeGetStaticValuePartId=function(e){var t="string"==typeof e&&e.match(/^__part\:(.*)/);return t?t[1]:null};t.getStaticValue=function(e,n,r){var o=(0,t.maybeGetStaticValuePartId)(e);if(o){var i=n[o];if(!i)throw new Error("Instance ".concat(r," referrer to a part reference ").concat(o," that does not exist"));return i}return e};t.getPart=function(e,t){if("string"!=typeof e&&(0,s.isInlinePartInstance)(e))return e.part;var n="string"==typeof e?e:e.partId,r=t[n];if(!r)throw new Error("Part with id ".concat(n," not found"));return r};t.getPartDef=function(e,t){if("string"!=typeof e&&(0,s.isInlinePartInstance)(e))return e.part;var n="string"==typeof e?e:e.partId,r=t[n];if(!r)throw console.error("Part with id ".concat(n," not found")),new Error("Part with id ".concat(n," not found"));return r};t.codeFromFunction=function(e){var t,n=e.id,o=e.fn,i=e.inputNames,a=e.outputName,s=e.defaultStyle;return{id:n,inputs:i.reduce((function(e,t){var n;return r(r({},e),((n={})[t]=(0,u.partInput)(),n))}),{}),outputs:(t={},t[a]=(0,u.partOutput)(),t),fn:function(e,t){var n=i.map((function(t){return e[t]})),r=t[a],u=o.apply(void 0,n);return Promise.resolve(u).then((function(e){return r.next(e)}))},completionOutputs:[a],defaultStyle:s}}},93471:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartInstance=t.isRefPartInstance=t.isInlinePartInstance=t.inlinePartInstance=t.partInstance=void 0;t.partInstance=function(e,t,n,r){return{id:e,partId:t,inputConfig:n||{},pos:r||{x:0,y:0}}};t.inlinePartInstance=function(e,t,n,r){return{id:e,part:t,inputConfig:n||{},pos:r||{x:0,y:0}}};t.isInlinePartInstance=function(e){return!!e.part};t.isRefPartInstance=function(e){return!(0,t.isInlinePartInstance)(e)};t.PartInstance=function(e,t,n,r){return{id:e,partId:t.id,inputConfig:n||{},pos:r||{x:0,y:0}}}},85089:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnvKeyFromValue=t.toEnvValue=t.isEnvValue=t.extractStaticValue=t.isStaticInput=t.isDynamicInput=t.staticPartInput=t.dynamicPartInputs=t.dynamicPartInput=t.dynamicOutput=t.partOutputs=t.partOutput=t.partInputs=t.isInputPinOptional=t.partInput=void 0;var r=n(71542),o=n(24048),i=n(45821),a=n(34702);t.partInput=function(e){return void 0===e&&(e="required"),{mode:e}};t.isInputPinOptional=function(e){return"optional"===e.mode};t.partInputs=function(e,n){return(0,i.repeat)(e,(function(e){return(0,t.partInput)(n[e]||"required")}))};t.partOutput=function(e){return void 0===e&&(e=!1),{delayed:e}};t.partOutputs=function(e){return(0,i.repeat)(e,(function(){return(0,t.partOutput)()}))};t.dynamicOutput=function(){return new r.Subject},t.dynamicPartInput=(0,i.testDataCreator)((function(){return{subject:new r.Subject,config:(0,a.queueInputPinConfig)()}}));t.dynamicPartInputs=function(e){return void 0===e&&(e=10),(0,i.repeat)(e,(function(){return(0,i.testDataCreator)((function(){return{subject:new r.Subject,config:(0,a.queueInputPinConfig)()}}))()}))};t.staticPartInput=function(e){return{config:(0,a.staticInputPinConfig)(e)}};t.isDynamicInput=function(e){var t=e;return t&&t.subject&&!!t.subject.next};t.isStaticInput=function(e){return(0,o.isStaticInputPinConfig)(e.config)};t.extractStaticValue=function(e){if((0,t.isStaticInput)(e))return e.config.value;throw new Error("Cannot extract static value from non static arg")};t.isEnvValue=function(e){return"string"==typeof e&&e.startsWith("$ENV.")};t.toEnvValue=function(e){return"$ENV.".concat(e)};t.getEnvKeyFromValue=function(e){return"string"==typeof e?e.replace(/^\$ENV\./,""):e}},34702:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isStaticInputPinConfig=t.isStickyInputPinConfig=t.isQueueInputPinConfig=t.staticInputPinConfig=t.stickyInputPinConfig=t.queueInputPinConfig=t.INPUT_MODES=void 0,t.INPUT_MODES=["queue","sticky","static"];t.queueInputPinConfig=function(){return{mode:"queue"}};t.stickyInputPinConfig=function(){return{mode:"sticky"}};t.staticInputPinConfig=function(e){return{mode:"static",value:e}};t.isQueueInputPinConfig=function(e,t){return"queue"===e.mode};t.isStickyInputPinConfig=function(e){return e&&"sticky"===e.mode},t.isStaticInputPinConfig=function(e){return e&&"static"===e.mode}},69789:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.simplifiedExecute=void 0;var o=n(18265),i=n(30385);t.simplifiedExecute=function(e,t,n,a,u){void 0===u&&(u={});var s=(0,o.keys)(e.outputs),c=Object.keys(n).reduce((function(e,t){var i,a=n[t];return r(r({},e),((i={})[t]=(0,o.isDynamicInput)(a)?a:(0,o.staticPartInput)(a),i))}),{}),l=s.reduce((function(e,t){var n,i=(0,o.dynamicOutput)();return a&&i.subscribe((function(e){a(t,e)})),r(r({},e),((n={})[t]=i,n))}),{});return(0,i.execute)(r({part:e,inputs:c,outputs:l,partsRepo:t,onBubbleError:function(e){throw e}},u))}},51922:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},55281:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isScheduledTrigger=t.isRestApiTrigger=t.isWebAppTrigger=void 0;t.isWebAppTrigger=function(e){return"web-app"===e.type};t.isRestApiTrigger=function(e){return"rest-api"===e.type};t.isScheduledTrigger=function(e){return"scheduled"===e.type}},23489:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.PartPreview=void 0;var o=n(24246),i=n(18265),a=n(57768);t.PartPreview=function(e){var t=e.part,n={part:t,instance:(0,i.partInstance)("bob",t.id,{}),connections:[],connectionsPerInput:{},connectionsPerOutput:{},viewPort:{pos:{x:0,y:0},zoom:1},partDefRepo:{},onUngroup:i.noop,onDblClick:i.noop,onDragEnd:i.noop,onDragMove:i.noop,onDragStart:i.noop,onPinClick:i.noop,onPinDblClick:i.noop,onSelect:i.noop,onTogglePinBreakpoint:i.noop,onTogglePinLog:i.noop,onToggleSticky:i.noop,displayMode:!0,onInspectPin:i.noop,onDetachConstValue:i.noop,onCopyConstValue:i.noop,onPasteConstValue:i.noop,onRequestHistory:i.noop,parentInsId:"",onChangeVisibleInputs:i.noop,onChangeVisibleOutputs:i.noop,onConvertConstToEnv:i.noop,forceShowMinimized:"both",onExtractInlinePart:i.noop,onCloseInlineEditor:i.noop,isConnectedInstanceSelected:!1,inlineEditorPortalDomNode:null,onChangeStyle:i.noop,onDeleteInstance:i.noop,onGroupSelected:i.noop,onSetDisplayName:i.noop};return(0,o.jsx)("div",r({className:"part-preview"},{children:(0,o.jsx)(a.InstanceView,r({},n))}))}},90412:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FlowEditor=void 0;var p=n(24246),f=a(n(27378)),v=n(18265),m=n(41304),y=d(n(63300)),h=n(14648),g=n(13011),b=n(40232),I=n(51424),P=n(24935),_=n(91312),O=n(30537),C=n(31425),w=n(44370),x=n(96149);u(n(91312),t),O.library.add(C.fab,w.fas);var j=["select","drag-move","order-step"],E=function(e){var t;return r(r({},e.dependencies),((t={})[e.main.id]=e.main,t))};t.FlowEditor=f.memo(f.forwardRef((function(e,t){var n=e.state,o=e.resolvedRepoWithDeps,i=e.onChangeEditorState,a=e.onImportPart,u=f.useState([]),d=u[0],O=u[1],C=f.useState([]),w=C[0],S=C[1],D=n.flow,k=n.boardData,T=n.flow.part,N=(0,_.usePorts)().openFile,M=f.useCallback((function(e,t){console.log("onChangeFlow",t.type),"functional"===t.type&&(O(l([{flow:e}],d.slice(0,50),!0)),S([])),i((function(t){return r(r({},t),{flow:e})}))}),[i,d]),R=f.useState({instances:[],connections:[]}),A=R[0],V=R[1],z=f.useState(!1),H=z[0],G=z[1],L=f.useCallback((function(){return G(!1)}),[]),B=f.useCallback((function(){return G(!0)}),[]),F=f.useCallback((function(e){i((function(t){return r(r({},t),{boardData:r(r({},t.boardData),e)})}))}),[i]);f.useEffect((function(){F({selected:[],viewPort:m.defaultViewPort,from:void 0,to:void 0,lastMousePos:{x:0,y:0}})}),[T.id]),(0,h.useHotkeys)("cmd+z",(function(e){S(l(l([],w,!0),[n],!1));var t=d[0],o=d.slice(1);t&&(i((function(e){return r(r({},e),t)})),O(o)),e.preventDefault()}),void 0,[n,d,w]),(0,h.useHotkeys)("a",(function(e){e.preventDefault(),B()}));var U=f.useCallback((function(e,t){j.some((function(e){return t.message.includes(e)}))||S([]);var n=(0,y.default)(D,(function(t){t.part=e}));M(n,t)}),[D,M]),q=f.useCallback((function(e){N({absPath:e.importPath})}),[N]),W=f.useCallback((function(e,t){void 0===t&&(t=-1*m.PART_HEIGHT*1.5);var n=(0,g.createNewPartInstance)(e,t,k.lastMousePos,E(o));if(n){var r=(0,y.default)(D,(function(e){var t=e.part;if(!(0,v.isVisualPart)(t))throw new Error("Impossible state, adding part to non visual part");t.instances.push(n)}));return M(r,(0,I.functionalChange)("add-part")),L(),n}}),[k.lastMousePos,D,M,L,o]),$=f.useCallback((function(e){return s(void 0,void 0,void 0,(function(){var t,n,r;return c(this,(function(i){switch(i.label){case 0:switch(e.type){case P.OmniBarCmdType.ADD:return[3,1];case P.OmniBarCmdType.ADD_VALUE:return[3,2];case P.OmniBarCmdType.CREATE_CODE_PART:return[3,3];case P.OmniBarCmdType.CREATE_GROUPED_PART:return[3,4];case P.OmniBarCmdType.IMPORT:return[3,5]}return[3,7];case 1:return[2,W(e.data)];case 2:return(0,g.domToViewPort)(k.lastMousePos,k.viewPort,m.defaultViewPort),(0,b.toastMsg)("TODO"),[3,8];case 3:case 4:return(0,b.toastMsg)("TODO"),[3,8];case 5:return[4,a(e.data,{pos:k.lastMousePos})];case 6:return i.sent(),t=(0,x.vAdd)({x:0,y:0},k.lastMousePos),n=(0,g.createNewPartInstance)(e.data.part,0,t,E(o)),r=(0,y.default)(D,(function(e){e.part.instances.push(n)})),M(r,(0,I.functionalChange)("add-imported-part")),[3,8];case 7:b.AppToaster.show({intent:"warning",message:"Not supported yet"}),i.label=8;case 8:return L(),[2]}}))}))}),[L,W,k.lastMousePos,k.viewPort,a,o,D,M]);return(0,p.jsx)("div",r({className:"project-editor"},{children:function(){if((0,v.isInlineValuePart)(T))throw new Error("Impossible state");return(0,p.jsxs)(f.Fragment,{children:[(0,p.jsx)(m.VisualPartEditor,{insId:"root.".concat(T.id),ref:t,boardData:k,onChangeBoardData:F,part:T,onGoToPartDef:q,onChangePart:U,resolvedFlow:o,clipboardData:A,onCopy:V,partIoEditable:!T.id.startsWith("Trigger"),onInspectPin:e.onInspectPin,onRequestHistory:e.onRequestHistory,onRequestImportables:e.onQueryImportables,onImportPart:e.onImportPart,onShowOmnibar:B,onExtractInlinePart:e.onExtractInlinePart},T.id),H?(0,p.jsx)(P.Omnibar,{flow:D,repo:o.dependencies,onCommand:$,visible:H,onClose:L,onRequestImportables:e.onQueryImportables}):null]})}()}))})))},57779:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BasePartEditor=t.renderCreateIOOption=void 0;var i=n(24246),a=o(n(27378)),u=n(18265),s=n(42272),c=o(n(63300)),l=n(18185),d=n(23489);t.renderCreateIOOption=function(e,t,n){return(0,i.jsx)(s.MenuItem,{icon:"add",text:'Create "'.concat(e,'"'),active:t,onClick:n,shouldDismissPopover:!1})};var p=l.MultiSelect.ofType();t.BasePartEditor=function(e){var n,o,l=e.part,f=e.onChange,v=(0,u.entries)(l.inputs),m=v.filter((function(e){return"required"===e[1].mode})).map((function(e){return e[0]})),y=v.filter((function(e){return"optional"===e[1].mode})).map((function(e){return e[0]})),h=v.filter((function(e){return"required-if-connected"===e[1].mode})).map((function(e){return e[0]})),g=a.default.useState(!1),b=g[0],I=g[1],P=(0,u.okeys)(l.outputs),_=a.default.useCallback((function(e){f(r(r({},l),{id:e}))}),[l,f]),O=a.default.useCallback((function(e){var t=e?e.split(","):void 0;"[]"===e&&(t=[]),console.log(e,t),f(r(r({},l),{completionOutputs:t}))}),[l,f]),C=a.default.useCallback((function(e){var t=e?e.split(","):void 0;f(r(r({},l),{reactiveInputs:t}))}),[l,f]),w=a.default.useCallback((function(e,t){var n=(0,c.default)(l,(function(n){n.inputs[e]=(0,u.partInput)(t)}));f(n)}),[l,f]),x=a.default.useCallback((function(e){var t=(0,c.default)(l,(function(t){delete t.inputs[e]}));f(t)}),[l,f]),j=a.default.useCallback((function(e){var t=(0,c.default)(l,(function(t){t.outputs[e]=(0,u.partOutput)()}));f(t)}),[l,f]),E=a.default.useCallback((function(e){var t=(0,c.default)(l,(function(t){delete t.outputs[e]}));f(t)}),[l,f]);a.default.useCallback((function(e){try{var t=JSON.parse(e),n=(0,c.default)(l,(function(e){Object.entries(t).forEach((function(t){var n=t[0],o=(t[1],e.inputs[n]),i=e.outputs[n];o?e.inputs[n]=r({},o):i&&(e.outputs[n]=r({},i))}))}));f(n)}catch(o){console.error("cannot parse")}}),[f,l]);return(0,i.jsxs)("div",r({className:"base-part-editor"},{children:[(0,i.jsx)("div",r({className:"form-row"},{children:(0,i.jsx)(s.FormGroup,r({label:"Part Name",labelFor:"text-input",labelInfo:"(required)"},{children:(0,i.jsx)(s.InputGroup,{id:"part-name",disabled:e.idDisabled,placeholder:"Part ID",value:l.id,onChange:function(e){return _(e.target.value)}})}))})),(0,i.jsx)(s.FormGroup,r({label:"Required Inputs"},{children:(0,i.jsx)(p,{selectedItems:m,placeholder:"Enter input names here",items:[],tagRenderer:function(e){return e},onItemSelect:function(e){return w(e,"required")},onRemove:x,resetOnSelect:!0,itemRenderer:function(e){return(0,i.jsx)("span",{children:e})},createNewItemFromQuery:function(e){return e},createNewItemRenderer:t.renderCreateIOOption,fill:!0})})),!0!==e.hiddenOutputs?(0,i.jsx)(s.FormGroup,r({label:"Outputs"},{children:(0,i.jsx)(p,{selectedItems:P,placeholder:"Enter output names here",items:[],tagRenderer:function(e){return e},onItemSelect:j,onRemove:E,resetOnSelect:!0,itemRenderer:function(e){return(0,i.jsx)("span",{children:e})},createNewItemFromQuery:function(e){return e},createNewItemRenderer:t.renderCreateIOOption,fill:!0})})):null,(0,i.jsx)(s.Checkbox,r({checked:b,onChange:function(e){return I(e.target.checked)}},{children:"Show advanced options"})),(0,i.jsxs)(s.Collapse,r({isOpen:b},{children:[(0,i.jsx)(s.FormGroup,r({label:"Optional Inputs"},{children:(0,i.jsx)(p,{selectedItems:y,placeholder:"Enter input names here",items:[],tagRenderer:function(e){return e},onItemSelect:function(e){return w(e,"optional")},onRemove:x,resetOnSelect:!0,itemRenderer:function(e){return(0,i.jsx)("span",{children:e})},createNewItemFromQuery:function(e){return e},createNewItemRenderer:t.renderCreateIOOption,fill:!0})})),(0,i.jsx)(s.FormGroup,r({label:"Required-if-connected Inputs"},{children:(0,i.jsx)(p,{selectedItems:h,placeholder:"Enter input names here",items:[],tagRenderer:function(e){return e},onItemSelect:function(e){return w(e,"required-if-connected")},onRemove:x,resetOnSelect:!0,itemRenderer:function(e){return(0,i.jsx)("span",{children:e})},createNewItemFromQuery:function(e){return e},createNewItemRenderer:t.renderCreateIOOption,fill:!0})})),(0,i.jsx)(s.FormGroup,r({label:"Completion Outputs"},{children:(0,i.jsx)(s.InputGroup,{id:"completion-outputs",placeholder:"completion outputs",value:(null===(n=l.completionOutputs)||void 0===n?void 0:n.join(","))||"",onChange:function(e){return O(e.target.value)}})})),(0,i.jsx)(s.FormGroup,r({label:"Reactive Inputs"},{children:(0,i.jsx)(s.InputGroup,{id:"reactive-inputs",placeholder:"Reactive inputs",value:(null===(o=l.reactiveInputs)||void 0===o?void 0:o.join(","))||"",onChange:function(e){return C(e.target.value)}})}))]})),(0,i.jsx)(s.FormGroup,r({label:"Preview"},{children:(0,i.jsx)("div",r({className:"preview-wrapper"},{children:(0,i.jsx)(d.PartPreview,{part:l})}))}))]}))}},51424:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.metaChange=t.functionalChange=void 0;t.functionalChange=function(e){return{type:"functional",message:e}};t.metaChange=function(e){return void 0===e&&(e="n/a"),{type:"meta",message:e}}},63213:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InlineCodeModal=void 0;var s=n(24246),c=a(n(27378)),l=u(n(77324)),d=n(42272),p=u(n(60042)),f=n(52178),v=n(18265),m=n(28983),y="`Result is ${inputs.a + inputs.b}`";t.InlineCodeModal=c.memo((function(e){var t,n=e.initialValue,o=e.initialType,i=c.useState((0,v.isDefined)(n)?n:y),a=i[0],u=i[1],h=c.useState(o||v.InlineValuePartType.VALUE),g=h[0],b=h[1],I=(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{children:['You can add variables to by referrencing the "inputs" object.',(0,s.jsx)("br",{})," For example:",(0,s.jsx)(d.Code,{children:"`Hello {inputs.name}`"}),' will expose an input pin named "name"']}),(0,s.jsxs)("p",{children:["You can also use ternery expressions, arithmetic operators and more!",(0,s.jsx)("br",{}),"For example:",(0,s.jsx)(d.Code,{children:"inputs.a > inputs.b ? inputs.a + 42 : Math.random() * inputs.b"})]})]}),P=(0,s.jsxs)("span",{children:["Type in any valid JS value, such as ",(0,s.jsx)(d.Code,{children:"true"}),", ",(0,s.jsx)(d.Code,{children:"42"}),","," ",(0,s.jsx)(d.Code,{children:'["bob", "alice", "dave"]'}),".",(0,s.jsx)("br",{})," Dynamic inputs may also be used"]}),_=(0,s.jsxs)("span",{children:["Write any JS code and return a value.",(0,s.jsx)("br",{})," The returned value will be the output.",(0,s.jsx)("br",{})," Example:",(0,s.jsx)(d.Code,{children:"const a = inputs.a; const b = inputs.b; return Math.floor(a/b);"})]}),O=(0,f.getVariables)(a);return c.useEffect((function(){a===y&&g===v.InlineValuePartType.FUNCTION&&u("return ".concat(y)),a==="return ".concat(y)&&g===v.InlineValuePartType.VALUE&&u(y)}),[a,g]),(0,s.jsxs)(d.Dialog,r({isOpen:!0,title:"Inline Value / Code",onClose:e.onCancel,canEscapeKeyClose:!1,className:"inline-code-modal"},{children:[(0,s.jsxs)("main",r({className:(0,p.default)(d.Classes.DIALOG_BODY),onKeyDown:function(t){"Enter"===t.key&&t.metaKey&&e.onSubmit(g,a)},tabIndex:0},{children:[(0,s.jsxs)(d.RadioGroup,r({inline:!0,onChange:function(e){return b(e.target.value)},selectedValue:g},{children:[(0,s.jsx)(d.Radio,{labelElement:(0,s.jsxs)(c.Fragment,{children:["Value"," ",(0,s.jsx)(m.Tooltip2,r({content:P,placement:"top"},{children:(0,s.jsx)(d.Icon,{icon:"info-sign",intent:"primary"})}))]}),value:v.InlineValuePartType.VALUE}),(0,s.jsx)(d.Radio,{labelElement:(0,s.jsxs)(c.Fragment,{children:["Function"," ",(0,s.jsx)(m.Tooltip2,r({content:_,placement:"top"},{children:(0,s.jsx)(d.Icon,{icon:"info-sign",intent:"primary"})}))]}),value:v.InlineValuePartType.FUNCTION})]})),(0,s.jsx)(l.default,{height:"80px",theme:"vs-dark",defaultLanguage:"javascript",value:a,onChange:function(e){return u(e||"")},onMount:function(e){e&&e.updateOptions({lineNumbers:"off",minimap:{enabled:!1}})}}),(t=a.includes("return"),t&&g===v.InlineValuePartType.VALUE?(0,s.jsx)(d.Callout,r({intent:d.Intent.WARNING},{children:'When using the "value" type you are not expected to return anything'})):t||g!==v.InlineValuePartType.FUNCTION?null:(0,s.jsxs)(d.Callout,r({intent:d.Intent.DANGER},{children:['When using the "function" type you are expected to'," ",(0,s.jsx)(d.Code,{children:"return"})," a value.",(0,s.jsx)("br",{}),"Example: ",(0,s.jsx)(d.Code,{children:"return 42 + Date.now();"})]}))),(0,s.jsxs)(d.Callout,r({intent:d.Intent.NONE},{children:["Input pins detected:"," ",O.length?O.map((function(e){return(0,s.jsx)(d.Code,{children:e},e)})):"None",(0,s.jsx)(m.Tooltip2,r({content:I},{children:(0,s.jsx)(d.Icon,{icon:"info-sign",intent:d.Intent.PRIMARY})}))]}))]})),(0,s.jsx)("div",r({className:d.Classes.DIALOG_FOOTER},{children:(0,s.jsxs)("div",r({className:d.Classes.DIALOG_FOOTER_ACTIONS},{children:[(0,s.jsx)(d.Button,r({onClick:e.onCancel},{children:"Cancel"})),(0,s.jsx)(d.Button,r({onClick:function(){return e.onSubmit(g,a)},intent:d.Intent.PRIMARY,className:"save-btn"},{children:"Save"}))]}))}))]}))}))},52178:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.createInlineValuePart=t.getVariables=void 0;var o=n(18265),i=n(18265);t.getVariables=function(e){return(e.match(/inputs\.([a-zA-Z]\w*)/g)||[]).map((function(e){return e.replace(/inputs\./,"")}))};t.createInlineValuePart=function(e){var n=e.code,a=e.customView,u=e.partId,s=e.type,c=(0,t.getVariables)(n).reduce((function(e,t){var n;return r(r({},e),((n={})[t]=(0,o.partInput)(),n))}),{}),l={value:(0,o.partOutput)()},d=s===o.InlineValuePartType.FUNCTION?"const result = (function() { ".concat(n,"}());\n  Promise.resolve(result).then(val => outputs.value.next(val))"):"const result = (".concat(n,"); Promise.resolve(result).then(val => outputs.value.next(val))"),p=btoa(n);return(0,i.inlineValuePart)({id:u||"Inline Code ".concat((0,o.randomInt)(99999)),inputs:c,outputs:l,fnCode:d,customViewCode:a||n,dataBuilderSource:p,templateType:s,completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}},description:"Custom inline ".concat(s===o.InlineValuePartType.VALUE?"value":"function")})}},24935:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Omnibar=t.OmniBarCmdType=void 0;var c,l=n(24246),d=a(n(27378)),p=n(18185),f=n(18265),v=n(42272),m=s(n(60042));!function(e){e.ADD="add",e.ADD_VALUE="add-value",e.CREATE_CODE_PART="create-core-part",e.CREATE_GROUPED_PART="create-visual-part",e.IMPORT="import"}(c=t.OmniBarCmdType||(t.OmniBarCmdType={}));var y=[];t.Omnibar=function(e){var t=e.repo,n=d.useState(""),o=n[0],i=n[1],a=d.useState(null),s=a[0],h=a[1],g=d.useState([]),b=g[0],I=g[1];d.useEffect((function(){var e=(0,f.keys)(t).map((function(e){var n=t[e];return{title:"".concat(n.id),cmd:{type:c.ADD,data:e},extra:"current flow"}})),n=b.map((function(e){return{title:"".concat(e.part.id),description:e.part.description,cmd:{type:c.IMPORT,data:e},extra:"".concat(e.module)}})),r={title:"Add inline value or code",suggestOnEmpty:!0,cmd:{type:c.ADD_VALUE}},o=u(u(u(u([],y,!0),n,!0),[r],!1),e,!0);h(o)}),[t,b]),d.useEffect((function(){e.onRequestImportables&&e.onRequestImportables(o).then((function(e){I(e)}))}),[e,o]);var P=d.useCallback((function(e,t){var n=t.handleClick,o=t.modifiers,i=(t.query,t.index);if(!o.matchesPredicate)return null;var a="".concat(e.title);return(0,l.jsx)(v.MenuItem,{active:o.active,disabled:o.disabled,onClick:n,text:(0,l.jsxs)("div",r({className:(0,m.default)("omnibar-item",{active:o.active})},{children:[(0,l.jsxs)("div",r({className:"title"},{children:[a," ",e.extra?(0,l.jsx)("span",r({className:"extra"},{children:e.extra})):null]})),e.description?(0,l.jsx)("div",r({className:"description"},{children:e.description})):null]}))},i)}),[]),_=d.useCallback((function(e,t){var n=e.toLowerCase().split("").map((function(e){return"".concat(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),".*")})).join(""),r=new RegExp(n);return!!t.title.toLowerCase().match(r)}),[]),O=d.useCallback((function(t){e.onCommand(t.cmd),e.onClose()}),[e]);return s?(0,l.jsx)(p.Omnibar,{query:o,onQueryChange:i,onClose:e.onClose,noResults:(0,l.jsx)(v.MenuItem,{disabled:!0,text:"No results."}),itemPredicate:_,isOpen:e.visible,items:s,initialContent:void 0,onItemSelect:O,itemRenderer:P,inputProps:{placeholder:"Search for parts or commands.."}}):null}},91312:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(2297),t)},2297:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.usePorts=t.useConfirm=t.usePrompt=t.PortsContext=t.defaultPorts=void 0;var i=n(40232),a=n(27378),u=function(){return r(void 0,void 0,void 0,(function(){return o(this,(function(e){throw new Error("Not implemented")}))}))};t.defaultPorts={prompt:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e.text,n=e.defaultValue;return r(void 0,void 0,void 0,(function(){return o(this,(function(e){return[2,prompt("".concat(t),n)]}))}))})),openFile:function(e){return r(void 0,void 0,void 0,(function(){return o(this,(function(t){return(0,i.toastMsg)("Open ".concat(e)),[2]}))}))},confirm:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e.text;return r(void 0,void 0,void 0,(function(){return o(this,(function(e){return[2,confirm(t)]}))}))})),readFlow:u,saveFlow:u,resolveDeps:u,getImportables:u,onFlowChange:u},t.PortsContext=(0,a.createContext)(t.defaultPorts);t.usePrompt=function(){var e=(0,a.useContext)(t.PortsContext).prompt;return function(t,n){return e({text:t,defaultValue:n})}};t.useConfirm=function(){var e=(0,a.useContext)(t.PortsContext).confirm;return function(t){return e({text:t})}};t.usePorts=function(){return(0,a.useContext)(t.PortsContext)}},27234:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.groupSelected=void 0;var s=n(18265),c=u(n(63300)),l=n(78504);t.groupSelected=function(e,t,n,u,d){return o(void 0,void 0,void 0,(function(){var o,p,f,v,m,y,h,g,b,I,P,_;return i(this,(function(i){switch(i.label){case 0:if(o=t.instances,p=t.connections,f=o.filter((function(t){return e.includes(t.id)})),v=p.filter((function(t){var n=t.from,r=t.to;return-1!==e.indexOf(n.insId)||-1!==e.indexOf(r.insId)})),!f.length)throw new Error("visual without selections");return[4,(0,l.createGroup)(f,v,n,d)];case 1:return m=i.sent(),y=m.visualPart,h=m.renamedInputs,g=m.renamedOutputs,b=f.reduce((function(e,t){return(0,s.middlePos)(t.pos,e)}),o[0].pos),I="ref"===u?(0,s.partInstance)("".concat(y.id,"-ins"),y.id,{},b):(0,s.inlinePartInstance)("".concat(y.id,"-ins"),y,{},b),P=o.filter((function(t){return-1===e.indexOf(t.id)})),_=p.map((function(e){var t="".concat(e.from.insId,".").concat(e.from.pinId),n="".concat(e.to.insId,".").concat(e.to.pinId);return h[n]?r(r({},e),{to:{insId:I.id,pinId:h[n]}}):g[t]?r(r({},e),{from:{insId:I.id,pinId:g[t]}}):e})).filter((function(t){return-1===e.indexOf(t.from.insId)&&-1===e.indexOf(t.to.insId)})),[2,{newPart:y,currentPart:(0,c.default)(t,(function(e){e.instances=a(a([],P,!0),[I],!1),e.connections=_}))}]}}))}))}},96149:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(90412),t),o(n(12901),t),o(n(77437),t),o(n(40232),t),o(n(99457),t),o(n(51424),t),o(n(23489),t),o(n(69385),t),o(n(10934),t),o(n(4824),t),o(n(14648),t),o(n(26013),t),o(n(76298),t),o(n(11897),t),o(n(99743),t),o(n(57779),t),o(n(13011),t),o(n(12887),t)},60614:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserOnlyReactJson=void 0;var o=n(24246);t.BrowserOnlyReactJson=function(e){if("undefined"==typeof window)return null;var t=n(51366).default;return(0,o.jsx)(t,r({},e))}},26013:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsValueRenderer=void 0;var r=n(24246),o=n(18265),i=n(60614);t.AnalyticsValueRenderer=function(e){var t=e.val;try{var n=JSON.parse(t),a="object"==typeof n?n:{value:n},u=n&&[n.type,n.key,n.props,n.ref].every(o.isDefined),s=u?{jsxValue:n}:a;return(0,r.jsx)(i.BrowserOnlyReactJson,{src:s,name:!1,collapseStringsAfterLength:50,groupArraysAfterLength:5,collapsed:u})}catch(c){return(0,r.jsx)(i.BrowserOnlyReactJson,{src:{value:t},name:!1,collapseStringsAfterLength:50,groupArraysAfterLength:5})}}},78504:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.createGroup=void 0;var u=n(18265),s=n(18265),c=n(99743);t.createGroup=function(e,t,n,l){return o(void 0,void 0,void 0,(function(){var o,d,p,f,v,m,y,h,g,b,I,P,_,O,C,w,x,j,E,S,D,k,T,N;return i(this,(function(i){switch(i.label){case 0:if(0===e.length)throw new Error("cannot create group without instances");o=e.map((function(e){return e.id})),d=t.filter((function(e){var t=o.includes(e.from.insId),n=o.includes(e.to.insId);return!t&&n})).filter((function(e,t,n){return n.findIndex((function(t){return(0,s.connectionNodeEquals)(t.to,e.to)}))===t})),p=t.filter((function(e){var t=o.includes(e.from.insId),n=o.includes(e.to.insId);return t&&!n})).filter((function(e,t,n){return n.findIndex((function(t){return(0,s.connectionNodeEquals)(t.from,e.from)}))===t})),f={},v={},m={},y={},h=[],g={},b=0,I=d,i.label=1;case 1:return b<I.length?(x=I[b],j="".concat(x.to.insId,".").concat(x.to.pinId),E="".concat(x.from.insId,".").concat(x.from.pinId),S=x.to.pinId,m[E]?(h.push({from:(0,s.externalConnectionNode)(m[E]),to:(0,s.connectionNode)(x.to.insId,x.to.pinId)}),[3,5]):g[S]?[4,l("Name this input (".concat(S," of ").concat(x.to.insId,") is already taken:"))]:[3,3]):[3,6];case 2:return _=i.sent()||"i".concat((0,c.rnd)()),[3,4];case 3:_=S,i.label=4;case 4:P=_,f[j]=P,m[E]=P,h.push({from:(0,s.externalConnectionNode)(P),to:(0,s.connectionNode)(x.to.insId,x.to.pinId)}),g[P]=(0,s.partInput)(),i.label=5;case 5:return b++,[3,1];case 6:O={},C=0,w=p,i.label=7;case 7:return C<w.length?(x=w[C],j="".concat(x.to.insId,".").concat(x.to.pinId),E="".concat(x.from.insId,".").concat(x.from.pinId),S=x.from.pinId,y[j]?(h.push({from:(0,s.connectionNode)(x.from.insId,x.from.pinId),to:(0,s.externalConnectionNode)(y[j])}),[3,11]):O[S]?[4,l("Name this output (".concat(S," of ").concat(x.from.insId," is already taken:"))]:[3,9]):[3,12];case 8:return k=i.sent()||"i".concat((0,c.rnd)()),[3,10];case 9:k=S,i.label=10;case 10:D=k,v[E]=D,y[j]=D,h.push({from:(0,s.connectionNode)(x.from.insId,x.from.pinId),to:(0,s.externalConnectionNode)(D)}),O[D]=(0,u.partOutput)(),i.label=11;case 11:return C++,[3,7];case 12:return e.reduce((function(e,t){return(0,s.middlePos)(t.pos,e)}),e[0].pos),T=t.filter((function(e){return o.includes(e.from.insId)&&o.includes(e.to.insId)})),N={id:n,inputs:g,outputs:O,instances:e,inputsPosition:(0,u.okeys)(g).reduce((function(e,t,n){var o;return r(r({},e),((o={})[t]={x:0+100*n,y:0},o))}),{}),outputsPosition:(0,u.okeys)(O).reduce((function(e,t,n){var o;return r(r({},e),((o={})[t]={x:0+100*n,y:400},o))}),{}),connections:a(a([],T,!0),h,!0),completionOutputs:(0,u.okeys)(O)},[2,{visualPart:N,renamedInputs:f,renamedOutputs:v}]}}))}))}},10934:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.highlightText=void 0;var r=n(24246);function o(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}t.highlightText=function(e,t){var n=0,i=t.split(/\s+/).filter((function(e){return e.length>0})).map(o);if(0===i.length)return[e];for(var a=new RegExp(i.join("|"),"gi"),u=[];;){var s=a.exec(e);if(!s)break;var c=s[0].length,l=e.slice(n,a.lastIndex-c);l.length>0&&u.push(l),n=a.lastIndex,u.push((0,r.jsx)("strong",{children:s[0]},n))}var d=e.slice(n);return d.length>0&&u.push(d),u}},99457:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Loader=void 0;var o=n(24246),i=r(n(44271));t.Loader=function(){return(0,o.jsx)(i.default,{type:"ball-clip-rotate",active:!0})}},12887:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logger=void 0;var r=n(18265);t.logger=(0,r.debugLogger)("editor")},14264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.preloadMonaco=void 0;var r=n(77324),o=n(12887),i=!1;t.preloadMonaco=function(){i||r.loader.init().then((function(){(0,o.logger)("monaco preloaded"),i=!0}))}},4824:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.appHotkeysConfig=t.hotkey=t.EditorHotkeyCmd=t.AppHotkeyCmd=void 0,function(e){e.SAVE_PART="save-part",e.NEW_PROJECT="new-project",e.SAVE_PROJECT="save-project",e.TOGGLE_SIDE="toggle-side",e.RUN="run",e.UNDO="undo"}(n=t.AppHotkeyCmd||(t.AppHotkeyCmd={})),function(e){e.SHOW_OMNIBAR="show-omnibar",e.CLEAR_SELECTION="clear-selection",e.DELETE_COMP="delete-comp",e.DUPLICATE_COMP="duplicate-comp",e.GROUP="group",e.SELECT_ALL="select-all",e.SELECT_CLOSEST="select-closest"}(t.EditorHotkeyCmd||(t.EditorHotkeyCmd={}));t.hotkey=function(e,t,n,r,o){return{combo:e,label:t,cmd:n,global:r,preventDefault:o}},t.appHotkeysConfig=[(0,t.hotkey)("shift+p","Save part",n.SAVE_PART,!0,!0),(0,t.hotkey)("shift+t","New project",n.NEW_PROJECT,!0,!0),(0,t.hotkey)("cmd+shift+s","Toggle side",n.TOGGLE_SIDE,!0,!0),(0,t.hotkey)("cmd+s","Toggle side",n.SAVE_PROJECT,!0,!0),(0,t.hotkey)("shift+r","Run",n.RUN,!0,!0),(0,t.hotkey)("cmd+z","Undo",n.UNDO,!0,!0)]},14648:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useHotkeys=void 0;var i=o(n(34618)),a=n(27378);t.useHotkeys=function(e,t,n,o,u){void 0===o&&(o=[]),void 0===u&&(u={});var s=(0,a.useCallback)((function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n&&!n.current||t.apply(void 0,e)}),r(r([],o,!0),[t],!1));(0,a.useEffect)((function(){return(0,i.default)(e,u,s),function(){return i.default.unbind(e,s)}}),[e,s,u])}},11897:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeSessionStorage=t.safeLocalstorage=void 0,t.safeLocalstorage={getItem:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return localStorage.getItem.apply(localStorage,e)}catch(n){return null}},setItem:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return localStorage.setItem.apply(localStorage,e)}catch(n){return null}}},t.safeSessionStorage={getItem:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return sessionStorage.getItem.apply(sessionStorage,e)}catch(n){return null}},setItem:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return sessionStorage.setItem.apply(sessionStorage,e)}catch(n){return null}}}},49040:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CustomReactTooltip=void 0;var i=n(24246),a=n(27378),u=o(n(31542)),s=o(n(87661));function c(e){var t=e.children,n=e.domNode;return u.default.createPortal(t,n)}t.CustomReactTooltip=function(e){var t=(0,a.useRef)();return(0,a.useEffect)((function(){t.current=document.createElement("div"),document.body.appendChild(t.current)}),[]),t.current?(0,i.jsx)(c,r({domNode:t.current},{children:(0,i.jsx)(s.default,r({},e))})):null},t.default=t.CustomReactTooltip},77437:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.useLocalStorage=t.useResizePref=t.userPreferences=t.useUserPref=void 0;var a,u=i(n(27378)),s=n(12901),c=n(11897);t.useUserPref=function(e,n){var r=u.useState((function(){var r=t.userPreferences.getItem(e);return(0,s.isDefined)(r)?r:n})),o=r[0],i=r[1];u.useEffect((function(){var r=t.userPreferences.getItem(e),o=(0,s.isDefined)(r)?r:n;i(o)}),[e]);return[o,function(n){t.userPreferences.setItem(e,n),console.log("Saved",e,n),i(n)}]},t.userPreferences=(a=function(e){return"up.".concat(e)},{getItem:function(e){var t=c.safeLocalstorage.getItem(a(e))||"",n=c.safeSessionStorage.getItem(a(e))||"";try{return JSON.parse(n||t).value}catch(r){return}},setItem:function(e,t,n){void 0===n&&(n=!1);var r=n?sessionStorage:c.safeLocalstorage;try{var o=JSON.stringify({value:t});return r.setItem(a(e),o),!0}catch(i){return console.error("Error saving user preference",i),!1}}});t.useResizePref=function(e,n){var r="resize.".concat(e);return(0,t.useUserPref)(r,n)};var l=function(e){var t=c.safeLocalstorage.getItem(e);if(!t)return null;try{return JSON.parse(t).value}catch(n){return null}};t.useLocalStorage=function(e,t){var n=u.useState(l(e)||t),r=n[0],o=n[1],i=u.useCallback((function(t){c.safeLocalstorage.setItem(e,JSON.stringify({value:t})),o(t)}),[e]);return u.useEffect((function(){l(e)||c.safeLocalstorage.setItem(e,JSON.stringify({value:t}))}),[e,t,i]),[r,i]}},99743:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.totalEnergy=t.itrPhysics=t.hookes=t.coulombs=t.vToStr=t.vNorm=t.vLen=t.vSub=t.vAdd=t.vDiv=t.vMul=t.vZero=t.rnd=t.vec=t.size=void 0;t.size=function(e,t){return{width:e,height:t}};t.vec=function(e,t){return{x:e,y:t}};t.rnd=function(e,t){return void 0===e&&(e=100),void 0===t&&(t=0),Math.floor(Math.random()*(e-t))+t},t.vZero={x:0,y:0};t.vMul=function(e,t){return{x:e.x*t,y:e.y*t}};t.vDiv=function(e,n){var r=e.x,o=e.y;return(0,t.vMul)({x:r,y:o},1/n)};t.vAdd=function(e,t){return{x:e.x+t.x,y:e.y+t.y}};t.vSub=function(e,n){return(0,t.vAdd)(e,(0,t.vMul)(n,-1))};t.vLen=function(e){var t=e.x,n=e.y;return Math.sqrt(t*t+n*n)};t.vNorm=function(e){return(0,t.vDiv)(e,(0,t.vLen)(e)||1)};t.vToStr=function(e){var t=e.x,n=e.y;return"".concat(t.toFixed(1),",").concat(n.toFixed(1))};t.coulombs=function(e,n,r){var o=(0,t.vLen)((0,t.vSub)(e.p,n.p));if(0===o){var i=(0,t.vec)(2*Math.random()-1,2*Math.random()-1),a=e.m*n.m/Math.pow(10,2);return(0,t.vMul)(i,a*r)}i=(0,t.vNorm)((0,t.vSub)(n.p,e.p)),a=e.m*n.m/Math.pow(o+.1,2);return(0,t.vMul)(i,a*r)};t.hookes=function(e,n,r,o,i){var a=(0,t.vLen)((0,t.vSub)(e.p,n.p)),u=(0,t.vNorm)((0,t.vSub)(e.p,n.p)),s=0;return a<r?s=r-a:a>o&&(s=o-a),(0,t.vMul)(u,i*s)};t.itrPhysics=function(e,r){var o=r.p,i=r.v,a=r.f,u=r.m,s=(0,t.vDiv)(a,u),c=e/1e3,l=(0,t.vAdd)((0,t.vMul)(s,c),i),d=(0,t.vAdd)((0,t.vMul)(l,c),o);return n(n({},r),{p:d,v:l,f:(0,t.vec)(0,0)})};t.totalEnergy=function(e){return e.reduce((function(e,n){var r=(0,t.vLen)(n.v);return e+.5*n.m*r*r}),0)}},40232:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateToast=t.toastMsg=t.AppToaster=void 0;var r=n(42272);t.AppToaster=function(){try{return r.Toaster.create({className:"app-toaster",position:r.Position.BOTTOM_RIGHT})}catch(e){return{}}}();t.toastMsg=function(e,n,r){return t.AppToaster.show({message:e,intent:n,timeout:r})};t.updateToast=function(e,n,r){return t.AppToaster.show({message:n,intent:r},e)}},12901:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.preventDefaultAnd=t.isLocal=t.fullTime=t.timeAgoFromDt=t.timeAgo=t.toString=t.isDefined=t.set=t.createOmap=t.toOmap=t.values=t.keys=t.entries=void 0;var i=n(13011),a=n(18265),u=o(n(61320));t.entries=function(e){return Object.keys(e).map((function(t){return[t,e[t]]}))};t.keys=function(e){return Object.keys(e)};t.values=function(e){return Object.keys(e).map((function(t){return e[t]}))};t.toOmap=function(e){return Array.from(e.entries()).reduce((function(e,t){var n,o=t[0],i=t[1];return r(r({},e),((n={})[o]=i,n))}),{})};t.createOmap=function(e){return void 0===e&&(e=[]),e.reduce((function(e,t){var n;return r(r({},e),((n={})[t[0]]=t[1],n))}),{})};t.set=function(e,t,n){e[t]=n};t.isDefined=function(e){return void 0!==e};t.toString=function(e){var t=typeof e;if(""===e)return"(empty string)";if((0,i.isJsxValue)(e))return"JSX Value";if((0,a.isStaticValueVisualPart)(e))return"Embedded Part";if((0,a.isEnvValue)(e))return(0,a.getEnvKeyFromValue)(e);if("object"===t)try{var n=JSON.stringify(e);return"{}"===n?"Empty object":n}catch(r){return"Object (cannot stringify)"}return"".concat(e)};t.timeAgo=function(e){return(0,u.default)(new Date(e)).fromNow()};t.timeAgoFromDt=function(e){return(0,u.default)(Date.now()-e).fromNow()};t.fullTime=function(e){return(0,u.default)(new Date(e)).toString()};t.isLocal=function(){return location.href.includes(":300")};t.preventDefaultAnd=function(e){return function(t){t.preventDefault(),e(t)}}},41304:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},c=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VisualPartEditor=t.defaultBoardData=t.defaultViewPort=t.PART_HEIGHT=void 0;var d=n(24246),p=a(n(27378)),f=l(n(98739)),v=n(18265),m=n(57768),y=n(95160),h=n(12901),g=n(87944),b=n(13011),I=n(63300),P=n(27378),_=n(14648),O=l(n(54037)),C=n(42272),w=n(43318),x=n(99743),j=n(29841),E=n(18265),S=n(5681),D=n(94e3),k=n(14264),T=n(40232),N=n(51424),M=n(63213),R=n(52178),A=l(n(98784)),V=n(27234),z=n(91312),H=l(n(60042)),G=n(24398),L=n(75012),B=n(97841),F=n(3065),U=n(41978),q=p.memo(C.Slider),W=function(e){return null};t.PART_HEIGHT=28;t.defaultViewPort={pos:{x:0,y:0},zoom:1},t.defaultBoardData={selected:[],viewPort:t.defaultViewPort,lastMousePos:{x:0,y:0}},t.VisualPartEditor=p.memo(p.forwardRef((function(e,n){var o,i=e.onChangePart,a=e.partIoEditable,l=e.onCopy,J=e.onGoToPartDef,Y=e.onRequestHistory,X=e.onInspectPin,Q=e.boardData,K=e.onChangeBoardData,Z=e.insId,ee=e.part,te=e.onShowOmnibar,ne=e.resolvedFlow,re=e.onImportPart,oe=e.parentViewport||t.defaultViewPort,ie=(0,P.useState)(r(r({},ne.dependencies),((o={})[ne.main.id]=ne.main,o))),ae=ie[0],ue=ie[1];(0,P.useEffect)((function(){var e;ue(r(r({},ne.dependencies),((e={})[ne.main.id]=ne.main,e)))}),[ne]);var se=Q.selected,ce=Q.from,le=Q.to,de=ee.instances,pe=ee.connections,fe=ee.inputsPosition,ve=ee.outputsPosition,me=ee.inputs,ye=ee.outputs,he=(0,P.useState)(),ge=he[0],be=he[1],Ie=(0,P.useState)(),Pe=Ie[0],_e=Ie[1],Oe=(0,P.useState)(0),Ce=Oe[0],we=Oe[1],xe=(0,P.useState)(),je=xe[0],Ee=xe[1],Se=(0,P.useState)(!1),De=Se[0],ke=Se[1],Te=(0,P.useState)(),Ne=Te[0],Me=Te[1],Re=(0,P.useState)(),Ae=Re[0],Ve=Re[1],ze=(0,P.useState)(),He=ze[0],Ge=ze[1],Le=(0,P.useState)(),Be=Le[0],Fe=Le[1],Ue=(0,P.useRef)();(0,g.useDidMount)((function(){Ue.current=rt.current.querySelector(".inline-editor-portal-root")}));var qe=(0,z.useConfirm)(),We=(0,z.usePrompt)(),$e=Q.viewPort,Je=(0,P.useRef)(!0),Ye=p.useCallback((function(e){K({viewPort:e})}),[K]),Xe=p.useCallback((function(e,t,n){return Y(e,t,n)}),[Y]),Qe=p.useCallback((function(e,t,n){return X("".concat(Z,".").concat(e),t,n)}),[X,Z]),Ke=p.useCallback((function(e,t){var n=(0,L.handleConnectionCloseEditorCommand)(ee,{from:e,to:t}),r=(0,v.isInternalConnectionNode)(t)?de.find((function(e){return e.id===t.insId})):null,o=(r?r.inputConfig:{})[t.pinId],a=(0,v.isStaticInputPinConfig)(o)?(0,B.handleDetachConstEditorCommand)(n,t.insId,t.pinId):n;i(a,(0,N.functionalChange)("close-connection")),K({from:void 0,to:void 0})}),[de,i,K,ee]),Ze=p.useCallback((function(){return u(void 0,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return[4,We("New visual part name?")];case 1:return e=n.sent(),[4,(0,V.groupSelected)(Q.selected,ee,e,"inline",We)];case 2:return t=n.sent().currentPart,i(t,(0,N.functionalChange)("group part")),(0,T.toastMsg)("Part visual!"),[2]}}))}))}),[We,Q.selected,i,ee]);(0,P.useEffect)((function(){if(je){var e=setTimeout((function(){Ee(void 0)}),350);return function(){return clearTimeout(e)}}}),[je]);var et=(0,P.useState)(),tt=et[0],nt=et[1];(0,P.useEffect)((function(){(0,k.preloadMonaco)()}),[]);var rt=(0,P.useRef)(),ot=(0,O.default)(rt),it=p.useRef({x:400,y:400}),at=(0,g.useBoundingclientrect)(rt)||x.vZero,ut=function(){var e=(0,b.fitViewPortToPart)(ee,ae,ot);(0,b.animateViewPort)($e,e,500,(function(e){Ye(e)}))},st=p.useCallback((function(e,t){var n=Q.to,r=Q.from,o="input"===t?r:n,i="input"===t?n:r,a={pinId:e,insId:v.THIS_INS_ID},u="input"===t?{from:a}:{to:a};o&&o.pinId===e?K({from:void 0,to:void 0}):i?"input"===t&&n?Ke(a,n):r&&Ke(r,a):K(u)}),[Q,K,Ke]),ct=p.useCallback((function(e,t,n){var r=(0,I.produce)(ee,(function(r){"input"===e?r.inputs[t].description=n:r.outputs[t].description=n}));i(r,(0,N.functionalChange)("Part io description"))}),[i,ee]),lt=p.useCallback((function(e,t,n){var r=Q.from,o=Q.to;if(ce&&ce.insId===e.id||le&&le.insId===e.id)K({from:void 0,to:void 0});else if("input"===n){var i={insId:e.id,pinId:t};!o||o.pinId!==t||(0,v.isInternalConnectionNode)(o)&&o.insId!==e.id?ce?Ke(ce,i):K({to:i,selected:[]}):K({to:void 0})}else{var a={insId:e.id,pinId:t};!r||r.pinId!==t||(0,v.isInternalConnectionNode)(r)&&r.insId!==e.id?le?Ke(a,le):K({from:a,selected:[]}):K({from:void 0})}}),[Q,ce,K,Ke,le]);(0,P.useEffect)((function(){if(!De&&ot.width){var t=(0,b.fitViewPortToPart)(ee,ae,ot);e.thumbnailMode||Ye(t);var n=setTimeout((function(){var t=(0,b.fitViewPortToPart)(ee,ae,ot);e.thumbnailMode||Ye(t),ke(!0)}),100);return function(){return clearTimeout(n)}}}),[ee,ot,e.thumbnailMode,De,ae,Ye]);var dt=p.useCallback((function(){var e=Q.selected,t=ee.instances.filter((function(t){return e.includes(t.id)})).map((function(e){return r(r({},e),{id:e.id+"-copy"})})),n=ee.connections.filter((function(t){var n=t.from,r=t.to;return e.includes(n.insId)&&e.includes(r.insId)}));l({instances:t,connections:n})}),[Q,l,ee]),pt=p.useCallback((function(){var t=(0,G.pasteInstancesCommand)(ee,it.current,e.clipboardData),n=t.newPart,r=t.newInstances;i(n,(0,N.functionalChange)("paste instances")),K({selected:r.map((function(e){return e.id}))})}),[i,K,ee,e.clipboardData]),ft=p.useCallback((function(){var e=ee.id;tt?"input"===tt.type?tt.ins.id===e?st(tt.pin,"input"):lt(tt.ins,tt.pin,"input"):tt.ins.id===e?st(tt.pin,"output"):lt(tt.ins,tt.pin,"output"):console.warn("tried selecting closest with no pin nearby")}),[ee.id,tt,st,lt]),vt=p.useCallback((function(e,t){var n="mouse"===t?it.current:{x:$e.pos.x+ot.width/2,y:$e.pos.y+ot.height/2},o=(0,b.centerBoardPosOnTarget)(n,ot,e,$e);Ye(r(r({},$e),{zoom:e,pos:o}))}),[Ye,$e,ot]);(0,_.useHotkeys)("cmd+=",(function(e){vt($e.zoom+.1,"hotkey"),e.preventDefault()}),Je,[$e,vt]),(0,_.useHotkeys)("cmd+-",(function(e){vt($e.zoom-.1,"hotkey"),e.preventDefault()}),Je,[vt,$e.zoom]),(0,_.useHotkeys)("cmd+o",(function(e){e.preventDefault(),(0,T.toastMsg)("Ordering");var t=[];(0,S.orderVisualPart)(ee,ae,200,(function(e,n){n%3==0&&t.push(e)})),u(void 0,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return t.length?(e=t.shift(),(0,T.toastMsg)("Step ".concat(t.length,"!")),[4,(0,v.delay)(200)]):[3,2];case 1:return n.sent(),i(e,(0,N.metaChange)("order-step")),(0,T.toastMsg)("Step ".concat(t.length,"! done")),[3,0];case 2:return[2]}}))}))}),Je,[i,ee,ne]),(0,_.useHotkeys)("cmd+0",(function(e){vt(1),e.preventDefault()}),Je,[$e,vt]);var mt=function(){K({from:void 0,to:void 0,selected:[]})},yt=p.useCallback((function(e,t){be(e.id),i(r({},ee),(0,N.metaChange)("drag-start"))}),[i,ee]),ht=p.useCallback((function(e,t,n){var r=(0,b.handleInstanceDrag)(ee,e,n,t,se,ge),o=r.newValue,a=r.newSelected;i(o,(0,N.metaChange)("drag-move")),a&&K({selected:a})}),[ge,i,K,se,ee]),gt=p.useCallback((function(e,t){t.preventDefault(),t.stopPropagation(),be(void 0)}),[]),bt=p.useCallback((function(e,t){t.preventDefault(),t.stopPropagation(),be(v.THIS_INS_ID)}),[]),It=p.useCallback((function(t,n,r,o){return u(void 0,void 0,void 0,(function(){var i,a,u;return s(this,(function(s){return r.preventDefault(),r.stopPropagation(),i=o.x,a=o.y,u=(0,I.produce)(ee,(function(e){"input"===t?e.inputsPosition[n]={x:i,y:a}:e.outputsPosition[n]={x:i,y:a}})),e.onChangePart(u,(0,N.metaChange)("part-io-drag-move")),[2]}))}))}),[e,ee]),Pt=p.useCallback((function(e,t,n,r){return u(void 0,void 0,void 0,(function(){return s(this,(function(e){return n.preventDefault(),n.stopPropagation(),be(void 0),[2]}))}))}),[]),_t=p.useCallback((function(e,t){var n=e.id,r=t.shiftKey?se.filter((function(e){return e!==n})):[],o=t.shiftKey?c(c([],se,!0),[n],!1):[n],i=se.includes(n)?r:o;K({selected:i,from:void 0,to:void 0})}),[K,se]),Ot=p.useCallback((function(){var e=ee.instances.map((function(e){return e.id}));K({selected:e,from:void 0,to:void 0})}),[K,ee.instances]),Ct=p.useCallback((function(e){var t=pe.filter((function(t){var n=t.from,r=t.to;return-1===e.indexOf(n.insId)&&-1===e.indexOf(r.insId)})),n=(0,I.produce)(ee,(function(n){n.connections=t,n.instances=n.instances.filter((function(t){return!e.includes(t.id)}))}));i(n,(0,N.functionalChange)("delete-ins")),K({selected:[]})}),[pe,i,K,ee]),wt=p.useCallback((function(e){Ct([e.id])}),[Ct]),xt=p.useCallback((function(e,t){var n=(0,I.produce)(ee,(function(n){"input"===e?(delete n.inputs[t],n.connections=n.connections.filter((function(e){return!((0,v.isExternalConnectionNode)(e.from)&&e.from.pinId===t)}))):(n.connections=n.connections.filter((function(e){return!((0,v.isExternalConnectionNode)(e.to)&&e.to.pinId===t)})),n.completionOutputs=(n.completionOutputs||[]).map((function(e){return e.split("+").filter((function(e){return e!==t})).join("+")})).filter((function(e){return!!e})),delete n.outputs[t])}));ce.insId===v.THIS_INS_ID&&ce.pinId===t?K({from:void 0}):le.insId===v.THIS_INS_ID&&le.pinId===t&&K({to:void 0}),i(n,(0,N.functionalChange)("remove io pin"))}),[ee,ce,le,i,K]),jt=p.useCallback((function(){return u(void 0,void 0,void 0,(function(){var e,t,n;return s(this,(function(r){switch(r.label){case 0:return e=Q.selected,t=Q.from,n=Q.to,0!==e.length?[3,5]:(0,v.isExternalConnectionNode)(t)?[4,qe("Are you sure you want to remove main input ".concat(t.pinId,"?"))]:[3,2];case 1:return r.sent()&&xt("input",t.pinId),[3,4];case 2:return(0,v.isExternalConnectionNode)(n)?[4,qe("Are you sure you want to remove main output ".concat(n.pinId,"?"))]:[3,4];case 3:r.sent()&&xt("output",n.pinId),r.label=4;case 4:return[3,6];case 5:Ct(e),r.label=6;case 6:return[2]}}))}))}),[qe,Q,Ct,xt]),Et=p.useCallback((function(e,t,n){i((0,b.toggleStickyPin)(ee,e.id,t,n),(0,N.functionalChange)("toggle-sticky"))}),[i,ee]),St=p.useCallback((function(){var e=(0,F.handleDuplicateSelectedEditorCommand)(ee,se),t=e.newPart,n=e.newInstances;i(t,(0,N.functionalChange)("duplicated instances")),K({selected:n.map((function(e){return e.id}))})}),[i,K,ee,se]),Dt=p.useCallback((function(e){var t=e.nativeEvent.target;if(0===e.button&&$(e.nativeEvent,ee.id)&&t&&"board-editor-inner"===t.className){if(Date.now()-Ce<300)return void te(e);we(Date.now());var n={x:e.clientX,y:e.clientY},r=(0,x.vSub)(n,at),o=(0,b.domToViewPort)(r,$e,oe);_e({from:o,to:o})}}),[ee.id,$e,Ce,at,oe,te]),kt=p.useCallback((function(e){if($(e.nativeEvent,ee.id)&&Pe){if((0,b.calcSelectionBoxArea)(Pe)>50){var t=(0,b.getInstancesInRect)(Pe,ae,$e,Kt.current,ee.instances,at,oe);console.log({toSelect:t,selectionBox:Pe});var n=e.shiftKey?c(c([],se,!0),t,!0):t;K({selected:n})}_e(void 0)}}),[ee.id,ee.instances,Pe,ae,$e,at,oe,se,K]),Tt=p.useCallback((function(e){if($(e.nativeEvent,ee.id)){Je.current=!0;var t={x:e.clientX,y:e.clientY},n=(0,x.vSub)(t,(0,x.vAdd)(at,x.vZero)),o=(0,b.domToViewPort)(n,$e,oe);Pe&&_e(r(r({},Pe),{to:o}));var i=(0,b.findClosestPin)(ee,ae,n,at,Z,$e),a=tt;if(i)(!a||a.ins!==i.ins||a.ins===i.ins&&a.pin!==i.pin)&&nt({ins:i.ins,type:i.type,pin:i.id});it.current=o,K({lastMousePos:it.current})}else Je.current=!1}),[ee,at,$e,oe,Pe,ae,Z,tt,K]),Nt=p.useCallback((function(){nt(void 0),Je.current=!1}),[]),Mt=p.useCallback((function(e,t){if(t){var n=(0,v.isInlinePartInstance)(e)?e.part:(0,v.getPartDef)(e.partId,ae);if(!n)throw new Error("Impossible state inspecting inexisting part");if(!(0,v.isVisualPart)(n))return void(0,T.toastMsg)("Cannot inspect a non visual part","warning");Fe({insId:"".concat(Z,".").concat(e.id),part:n})}else if((0,v.isRefPartInstance)(e)){var r=(0,v.getPartDef)(e,ae);J(r)}else{var o=e.part;if(!(0,v.isInlineValuePart)(o))return void((0,v.isVisualPart)(o)?Fe({insId:e.id,part:o}):(0,T.toastMsg)("Editing this type of part is not supported"));var i=atob(o.dataBuilderSource);Ge({insId:e.id,templateType:o.templateType,value:i,type:"existing"}),(0,T.toastMsg)("Editing inline visual part not supported yet")}}),[J,ae,Z]),Rt=p.useCallback((function(e){if((0,v.isInlinePartInstance)(e)){var t=e.part;if(!(0,v.isVisualPart)(t))return void(0,T.toastMsg)("Not supported","warning");var n=(0,I.produce)(ee,(function(n){var r,o;n.instances=n.instances.filter((function(t){return t.id!==e.id})),n.connections=n.connections.filter((function(t){var n=t.from,r=t.to;return n.insId!==e.id&&r.insId!==e.id})),(r=n.instances).push.apply(r,t.instances),(o=n.connections).push.apply(o,t.connections.filter((function(e){return(0,v.isInternalConnectionNode)(e.from)&&(0,v.isInternalConnectionNode)(e.to)})))}));i(n,{type:"functional",message:"ungroup"}),K({selected:[]})}else{var r=(0,v.getPartDef)(e.partId,ae);if(!(0,v.isVisualPart)(r))return void(0,T.toastMsg)("Not supported","warning")}}),[ee,i,K,ae]),At=p.useCallback((function(e){return u(void 0,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))}),[]),Vt=p.useCallback((function(e,t){var n=(0,B.handleDetachConstEditorCommand)(ee,e.id,t);i(n,(0,N.functionalChange)("detach-const"))}),[i,ee]),zt=p.useCallback((function(e,t){var n=e.inputConfig[t]||(0,E.queueInputPinConfig)();(0,v.isStaticInputPinConfig)(n)&&(Ve(n.value),T.AppToaster.show({message:"Value copied"}))}),[]),Ht=p.useCallback((function(e,t){var n=(0,I.produce)(ee,(function(n){var r=n.instances.find((function(t){return t.id===e.id}));if(!r)throw new Error("Impossible state");r.inputConfig[t]=(0,v.staticInputPinConfig)(Ae),n.connections=n.connections.filter((function(n){return!(0,v.isInternalConnectionNode)(n.to)||!(n.to.insId===e.id&&n.to.pinId===t)}))}));i(n,(0,N.functionalChange)("paste const value"))}),[ee,i,Ae]),Gt=p.useCallback((function(e){return u(void 0,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return[4,We("New name?")];case 1:return(t=r.sent())?(n=(0,I.produce)(ee,(function(n){if("input"===e)ee.inputs||(n.inputs={}),n.inputs[t]=(0,v.partInput)(),n.inputsPosition[t]=it.current;else{ee.outputs||(n.outputs={}),n.outputs[t]=(0,v.partOutput)(),n.outputsPosition[t]=it.current;var r=(n.completionOutputs||[])[0];if(r){var o=r.split("+");n.completionOutputs[0]=c(c([],o,!0),[t],!1).join("+")}else n.completionOutputs=[t]}})),i(n,(0,N.functionalChange)("add new io pin")),[2]):[2]}}))}))}),[We,ee,i]),Lt=p.useCallback((function(){return u(void 0,void 0,void 0,(function(){var e,t,n,r;return s(this,(function(o){switch(o.label){case 0:return e=null===(r=ee.completionOutputs)||void 0===r?void 0:r.join(","),[4,We("Edit completion outputs",e)];case 1:return t=o.sent(),(0,h.isDefined)(t)&&null!==t&&(n=(0,I.produce)(ee,(function(e){e.completionOutputs=""===t?void 0:t.split(",")})),i(n,(0,N.functionalChange)("change part completions"))),[2]}}))}))}),[We,i,ee]),Bt=p.useCallback((function(){return u(void 0,void 0,void 0,(function(){var e,t,n,r;return s(this,(function(o){switch(o.label){case 0:return e=null===(r=ee.reactiveInputs)||void 0===r?void 0:r.join(","),[4,We("Edit reactive inputs",e)];case 1:return t=o.sent(),(0,h.isDefined)(t)&&null!==t&&(n=(0,I.produce)(ee,(function(e){e.reactiveInputs=""===t?void 0:t.split(",")})),i(n,(0,N.functionalChange)("change reactive inputs"))),[2]}}))}))}),[We,i,ee]),Ft=p.useCallback((function(){return u(void 0,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return[4,We("Description?",ee.description)];case 1:return e=n.sent(),t=(0,I.produce)(ee,(function(t){t.description=e})),i(t,(0,N.functionalChange)("Edit part description")),[2]}}))}))}),[We,i,ee]),Ut=p.useCallback((function(e){var t=(0,I.produce)(ee,(function(t){t.defaultStyle=e}));i(t,(0,N.functionalChange)("change default style"))}),[i,ee]),qt=p.useCallback((function(e,t){return u(void 0,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return[4,We("New name?",t)];case 1:return n=o.sent()||t,r=(0,b.handleIoPinRename)(ee,e,t,n),i(r,(0,N.functionalChange)("rename io pin")),[2]}}))}))}),[ee,i,We]),Wt=p.useCallback((function(e,t){var n=(0,b.handleChangePartInputType)(ee,e,t);i(n,(0,N.functionalChange)("toggle io pin optional"))}),[ee,i]),$t=p.useCallback((function(e,t){var n=Z.split(".").reverse()[0];return Y(n,e,t)}),[Y,Z]),Jt=p.useCallback((function(e,t,n,r){return u(void 0,void 0,void 0,(function(){var o,i,a,u;return s(this,(function(s){if("input"===n)o=e.inputConfig[t],i=(0,v.isStaticInputPinConfig)(o)?JSON.stringify(o.value):void 0,Ge({type:"static-input",insId:e.id,pinId:t,value:i});else{if(a=(0,v.getPartDef)(e,ae),u=(0,v.getPartOutputs)(a),!u[t])throw new Error("Dbl clicked on un-existing pin");Me({pos:{x:r.clientX,y:r.clientY},ins:e,part:a,pinId:t,pinType:n})}return[2]}))}))}),[ae]),Yt=p.useCallback((function(e,t){return u(void 0,void 0,void 0,(function(){return s(this,(function(n){if(!ee.inputs[e])throw new Error("Dbl clicked on un-existing pin");return Me({pos:{x:t.clientX,y:t.clientY},pinId:e,pinType:"input",part:ee}),[2]}))}))}),[ee]),Xt=p.useCallback((function(e){if(e.metaKey||e.ctrlKey){var t=-.005*e.deltaY;vt($e.zoom+t,"mouse"),e.preventDefault(),e.stopPropagation()}else{var n=e.deltaX,r=e.deltaY,o=(0,I.produce)($e,(function(e){e.pos.x=e.pos.x+n/e.zoom,e.pos.y=e.pos.y+r/e.zoom}));Ye(o),e.stopPropagation(),e.preventDefault()}}),[vt,Ye,$e]);(0,P.useEffect)((function(){var e=rt.current;if(e)return e.addEventListener("wheel",Xt),function(){e.removeEventListener("wheel",Xt)}}),[Xt]);var Qt={backgroundPositionX:(0,b.roundNumber)(-$e.pos.x*$e.zoom),backgroundPositionY:(0,b.roundNumber)(-$e.pos.y*$e.zoom),backgroundSize:(0,b.roundNumber)(25*$e.zoom)+"px"},Kt=p.useRef(new Map);p.useEffect((function(){var e=de.reduce((function(e,t){var n=(0,v.getPartDef)(t,ae);return n&&e.set(t.id,(0,v.keys)(n.inputs)),e}),new Map),t=de.reduce((function(e,t){var n=(0,v.getPartDef)(t,ae);return n&&e.set(t.id,(0,v.keys)(n.outputs)),e}),new Map);e.set(v.THIS_INS_ID,(0,v.keys)(ee.outputs)),t.set(v.THIS_INS_ID,(0,v.keys)(ee.inputs));var n=pe.filter((function(n){if(n.to.pinId===v.TRIGGER_PIN_ID||n.from.pinId===v.ERROR_PIN_ID)return!1;var r=e.get(n.to.insId)&&e.get(n.to.insId).includes(n.to.pinId),o=t.get(n.from.insId)&&t.get(n.from.insId).includes(n.from.pinId);return!(r&&o)}));if(n.length>0){(0,T.toastMsg)("".concat(n.length," orphan connections removed"),"warning"),console.log("".concat(n.length," orphan connections removed"),n);var r=(0,I.produce)(ee,(function(e){e.connections=ee.connections.filter((function(e){return!n.includes(e)}))}));i(r,(0,N.functionalChange)("prune orphan connections"))}}),[de,i,pe,ne,ee,ae]),(0,P.useEffect)((function(){var e=new Map(de.map((function(e){return[e.id,e]})));Kt.current=pe.reduce((function(t,n){var o,i=t.get(n.to.insId)||{},a=i[n.to.pinId]||[],u=r(r({},i),((o={})[n.to.pinId]=c(c([],a,!0),[e.get(n.from.insId)],!1),o));return t.set(n.to.insId,u),t}),new Map)}),[pe,de]);var Zt=p.useCallback((function(){Me(void 0)}),[]),en=p.useCallback((function(e){return u(void 0,void 0,void 0,(function(){var t,n,r,o;return s(this,(function(a){switch(a.label){case 0:if(!Ne)throw new Error("impossible state - quick add menu invoked but not available");switch(t=Ne.ins,n=Ne.pinId,e.type){case"part":return[3,1];case"import":return[3,2];case"value":return[3,4]}return[3,5];case 1:return(r=(0,b.createNewPartInstance)(e.part.id,100,it.current,ae))&&(o=(0,I.produce)(ee,(function(e){e.instances.push(r),e.connections.push({from:{insId:t?t.id:v.THIS_INS_ID,pinId:n},to:{insId:r.id,pinId:v.TRIGGER_PIN_ID}})})),i(o,(0,N.functionalChange)("add-item-quick-menu")),Zt()),[3,5];case 2:return[4,re(e.importablePart,{pos:it.current,connectTo:{insId:t.id,outputId:n}})];case 3:return a.sent(),Zt(),[3,5];case 4:if(!t)return(0,T.toastMsg)("Cannot add value to main input"),[2];Ge({type:"new-output",insId:t.id,pinId:n}),a.label=5;case 5:return[2]}}))}))}),[Ne,ae,ee,i,Zt,re]),tn=p.useCallback((function(){return u(void 0,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return e=JSON.stringify(ee),[4,navigator.clipboard.writeText(e)];case 1:return t.sent(),T.AppToaster.show({message:"Copied!"}),[2]}}))}))}),[ee]),nn=p.useCallback((function(e){var t,n,o=a?"":" (cannot edit main part, only visual)";return(0,d.jsxs)(C.Menu,{children:[(0,d.jsx)(C.MenuItem,{onMouseDown:function(e){return e.stopPropagation()},text:"New Value",onClick:(0,h.preventDefaultAnd)((function(){return Ge({type:"new-floating",pos:it.current})}))}),(0,d.jsx)(C.MenuItem,{text:"New input ".concat(o),onMouseDown:function(e){return e.stopPropagation()},onClick:(0,h.preventDefaultAnd)((function(){return Gt("input")})),disabled:!a}),(0,d.jsx)(C.MenuItem,{onMouseDown:function(e){return e.stopPropagation()},text:"New output ".concat(o),onClick:(0,h.preventDefaultAnd)((function(){return Gt("output")})),disabled:!a}),(0,d.jsx)(C.MenuItem,{onMouseDown:function(e){return e.stopPropagation()},text:"Copy part to clipboard",onClick:(0,h.preventDefaultAnd)(tn)}),(0,d.jsx)(C.MenuItem,{onMouseDown:function(e){return e.stopPropagation()},text:"Edit Completion Outputs (".concat((null===(t=ee.completionOutputs)||void 0===t?void 0:t.join(","))||"n/a",")"),onClick:(0,h.preventDefaultAnd)((function(){return Lt()}))}),(0,d.jsx)(C.MenuItem,{onMouseDown:function(e){return e.stopPropagation()},text:"Edit Reactive inputs (".concat((null===(n=ee.reactiveInputs)||void 0===n?void 0:n.join(","))||"n/a",")"),onClick:(0,h.preventDefaultAnd)((function(){return Bt()}))}),(0,d.jsx)(C.MenuItem,{onMouseDown:function(e){return e.stopPropagation()},text:"Edit description",onClick:(0,h.preventDefaultAnd)((function(){return Ft()}))}),(0,d.jsx)(C.MenuDivider,{}),(0,d.jsx)(C.MenuItem,r({text:"Default Style"},{children:(0,d.jsx)(U.PartStyleMenu,{style:ee.defaultStyle,onChange:Ut,promptFn:We})}))]})}),[a,tn,ee.completionOutputs,ee.reactiveInputs,ee.defaultStyle,Ut,We,Gt,Lt,Bt,Ft]),rn=p.useCallback((function(e){if(e.preventDefault(),Je.current){var t=(0,b.domToViewPort)({x:e.clientX,y:e.clientY},$e,oe),n=nn(t);C.ContextMenu.show(n,{left:e.clientX,top:e.clientY})}}),[nn,oe,$e]);(0,_.useHotkeys)("shift+c",ut,Je),(0,_.useHotkeys)("cmd+c",dt,Je),(0,_.useHotkeys)("cmd+v",pt,Je),(0,_.useHotkeys)("esc",mt,Je),(0,_.useHotkeys)("backspace",jt,Je),(0,_.useHotkeys)("shift+g",Ze,Je),(0,_.useHotkeys)("shift+d",St,Je),(0,_.useHotkeys)("cmd+a",Ot,Je),(0,_.useHotkeys)("s",ft,Je);var on=p.useCallback((function(e,t){if(!Be)throw new Error("impossible state");var n=(0,I.produce)(ee,(function(t){var n=t.instances.find((function(e){return e.id===Be.insId}));if(!n||!(0,v.isInlinePartInstance)(n))throw new Error("impossible state");n.part=e}));i(n,(0,N.functionalChange)("Inner change: "+t.message)),Fe((function(t){return r(r({},t),{part:e})}))}),[i,Be,ee]),an=(0,P.useState)({selected:[],viewPort:t.defaultViewPort,lastMousePos:{x:0,y:0}}),un=an[0],sn=an[1],cn=p.useCallback((function(e){return sn((function(t){return r(r({},t),e)}))}),[]),ln=function(n){return Be&&Be.insId===n.id?{insId:"".concat(Z,".").concat(Be.insId),boardData:un,onChangeBoardData:cn,resolvedFlow:ne,onCopy:l,clipboardData:e.clipboardData,onInspectPin:e.onInspectPin,onGoToPartDef:e.onGoToPartDef,partIoEditable:e.partIoEditable,onRequestHistory:Y,part:Be.part,onChangePart:on,onShowOmnibar:te,parentViewport:t.defaultViewPort,parentBoardPos:at,onExtractInlinePart:e.onExtractInlinePart,onImportPart:e.onImportPart}:void 0},dn=function(){if(ce&&("input"===(null==tt?void 0:tt.type)&&(null==tt?void 0:tt.ins.id)!==ee.id||(null==tt?void 0:tt.ins.id)===ee.id&&"output"===(null==tt?void 0:tt.type))){var e=tt.ins.id===ee.id?{pinId:tt.pin,insId:v.THIS_INS_ID}:{insId:tt.ins.id,pinId:tt.pin};if(!(0,v.isInternalConnectionNode)(e)&&!(0,v.isInternalConnectionNode)(ce))return;return{from:ce,to:e}}if(le&&("output"===(null==tt?void 0:tt.type)&&(null==tt?void 0:tt.ins.id)!==ee.id||(null==tt?void 0:tt.ins.id)===ee.id&&"input"===(null==tt?void 0:tt.type))){var t=tt.ins.id===ee.id?{pinId:tt.pin,insId:v.THIS_INS_ID}:{insId:tt.ins.id,pinId:tt.pin};if(!(0,v.isInternalConnectionNode)(le)&&!(0,v.isInternalConnectionNode)(t))return;return{from:t,to:le}}},pn=p.useCallback((function(e,t){var n=(0,I.produce)(ee,(function(n){n.instances=n.instances.map((function(n){return n.id===e.id?r(r({},n),{visibleInputs:t}):n}))}));i(n,(0,N.functionalChange)("change instance visible inputs"))}),[ee,i]),fn=p.useCallback((function(e,t){var n=(0,I.produce)(ee,(function(n){n.instances=n.instances.map((function(n){return n.id===e.id?r(r({},n),{style:t}):n}))}));i(n,(0,N.functionalChange)("change instance style"))}),[i,ee]),vn=p.useCallback((function(e,t){var n=(0,I.produce)(ee,(function(n){n.instances=n.instances.map((function(n){return n.id===e.id?r(r({},n),{visibleOutputs:t}):n}))}));i(n,(0,N.functionalChange)("change instance visible outputs"))}),[ee,i]),mn=p.useCallback((function(e,t){var n=(0,I.produce)(ee,(function(n){n.instances=n.instances.map((function(n){return n.id===e.id?r(r({},n),{displayName:t}):n}))}));i(n,(0,N.functionalChange)("change instance display name"))}),[ee,i]);p.useImperativeHandle(n,(function(){return{centerInstance:function(e){var t=ee.instances.find((function(t){return t.id===e}));if(t){var n=(0,x.vSub)(t.pos,(0,x.vec)(ot.width/2,ot.height/2));Ye(r(r({},$e),{pos:n}))}},centerViewPort:function(){ut()},getViewPort:function(){return $e},clearSelection:function(){mt()}}}));p.useCallback((function(e,t){var n={visibleInputs:e.visibleInputs,visibleOutputs:e.visibleOutputs,inputConfig:e.inputConfig,displayName:e.displayName},o=(0,I.produce)(ee,(function(t){t.instances=t.instances.map((function(t){return t.id===e.id?r(r({},t),n):t}))}));i(o,(0,N.functionalChange)("change instance config - "+t))}),[i,ee]);var yn=p.useState([]),hn=(yn[0],yn[1],p.useCallback((function(e,t){var n=t.trim().substr(0,100),r="Inline-value-".concat(n.substr(0,15).replace(/["'`]/g,"")),o=(0,R.createInlineValuePart)({code:t,customView:n,partId:r,type:e});switch(He.type){case"existing":var a=ee.instances.filter((function(e){return e.id===He.insId})).filter((function(e){return(0,v.isInlinePartInstance)(e)})).map((function(e){return e.part}))[0];if(!a)throw new Error("Unable to find inline part to save to");var u=(0,v.keys)(a.inputs),s=(0,v.keys)(o.inputs),c=new Set(A.default.difference(u,s)),l=(0,I.produce)(ee,(function(e){e.instances=e.instances.map((function(e){return e.id===He.insId?(0,v.inlinePartInstance)(e.id,o,e.inputConfig,e.pos):e})),e.connections=e.connections.filter((function(e){return!(e.to.insId===He.insId&&c.has(e.to.pinId))}))}));i(l,(0,N.functionalChange)("change inline value")),Ge(void 0);break;case"static-input":var d;try{var p=t.replace(/^['`]/,'"').replace(/['`]$/,'"');d=JSON.parse(p)}catch(P){return void(0,T.toastMsg)("Input values must not be formulas or code")}l=(0,I.produce)(ee,(function(e){e.instances.find((function(e){return e.id===He.insId})).inputConfig[He.pinId]=(0,v.staticInputPinConfig)(d)}));i(l,(0,N.functionalChange)("set static input value")),Ge(void 0);break;case"new-floating":var m=(0,v.inlinePartInstance)((0,f.default)(),o,{},He.pos);l=(0,I.produce)(ee,(function(e){e.instances.push(m)}));i(l,(0,N.functionalChange)("new floating value")),Ge(void 0);break;case"new-output":var y=He.insId,h=He.pinId,g=ee.instances.find((function(e){return e.id===y}));if(!g)throw new Error("Impossible state");var b=(0,v.inlinePartInstance)((0,f.default)(),o,{},(0,x.vAdd)(g.pos,{x:-50,y:150}));l=(0,I.produce)(ee,(function(e){e.instances.push(b),e.connections.push({from:(0,v.connectionNode)(y,h),to:(0,v.connectionNode)(b.id,v.TRIGGER_PIN_ID)})}));i(l,(0,N.functionalChange)("new value connected to output")),Ge(void 0)}}),[He,i,ee])),gn=pe.filter((function(e){var t=dn();return!t||!(0,v.connectionDataEquals)(t,e)})),bn=p.useCallback((function(){Fe(void 0),sn(t.defaultBoardData)}),[]),In=p.useCallback((function(e){var t=(0,I.produce)(ee,(function(t){var n=t.connections.find((function(t){return(0,v.connectionDataEquals)(t,e)}));n.hidden=!n.hidden}));i(t,(0,N.functionalChange)("toggle connection hidden"))}),[i,ee]),Pn=p.useCallback((function(e){var t=(0,I.produce)(ee,(function(t){t.connections=t.connections.filter((function(t){return!(0,v.connectionDataEquals)(t,e)}))}));i(t,(0,N.functionalChange)("remove connection"))}),[i,ee]);try{return(0,d.jsx)("div",r({className:(0,H.default)("visual-part-editor",e.className),"data-id":ee.id,onContextMenu:rn},{children:(0,d.jsxs)("main",r({className:"board-editor-inner",onMouseDown:Dt,onMouseUp:kt,onMouseMove:Tt,onMouseLeave:Nt,ref:rt,style:Qt},{children:[(0,d.jsx)(p.Fragment,{children:(0,d.jsx)(D.LayoutDebugger,{vp:$e,part:ee,extraDebug:b.emptyList,mousePos:it.current})}),(0,d.jsx)(y.ConnectionView,{repo:ae,parentInsId:Z,size:ot,part:ee,boardPos:at,instances:de,connections:gn,futureConnection:function(){var e=dn();if(e)return{connection:{from:e.from,to:e.to},type:pe.some((function(t){return(0,v.connectionDataEquals)(t,e)}))?"future-remove":"future-add"}}(),onDblClick:v.noop,viewPort:$e,parentVp:oe,selectedInstances:se,toggleHidden:In,removeConnection:Pn}),function(){var e=Q.from;return(0,h.entries)(me).map((function(t){var n=t[0],r=t[1];return(0,d.jsx)(w.PartIoView,{insId:Z,type:"input",pos:fe[n]||{x:0,y:0},id:n,onDelete:a?xt:void 0,onRename:a?qt:void 0,onDblClick:Yt,closest:!(!tt||"input"!==tt.type||tt.ins.id!==ee.id||tt.pin!==n),connected:!1,inputMode:r.mode,onChangeInputMode:Wt,viewPort:$e,onDragStart:bt,onDragEnd:Pt,onDragMove:It,onSelect:st,onSetDescription:ct,selected:(null==e?void 0:e.pinId)===n,description:r.description,onRequestHistory:$t},n)}))}(),de.map((function(e){return(0,d.jsx)(m.InstanceView,{onUngroup:Rt,onExtractInlinePart:At,onDetachConstValue:Vt,onCopyConstValue:zt,onPasteConstValue:Ht,copiedConstValue:Ae,connectionsPerInput:Kt.current.get(e.id)||b.emptyObj,connectionsPerOutput:b.emptyObj,part:(0,v.getPartDef)(e,ae),parentInsId:Z,onPinClick:lt,onPinDblClick:Jt,onDragStart:yt,onDragEnd:gt,partDefRepo:ae,onDragMove:ht,onDblClick:Mt,onSelect:_t,onToggleSticky:Et,selected:-1!==se.indexOf(e.id),dragged:ge===e.id,onInspectPin:Qe,selectedInput:le&&(0,v.isInternalConnectionNode)(le)&&le.insId===e.id?le.pinId:void 0,selectedOutput:ce&&(0,v.isInternalConnectionNode)(ce)&&ce.insId===e.id?ce.pinId:void 0,closestPin:tt&&tt.ins.id===e.id?tt:void 0,instance:e,connections:pe,onTogglePinBreakpoint:v.noop,onTogglePinLog:v.noop,viewPort:$e,onRequestHistory:Xe,onChangeVisibleInputs:pn,onChangeVisibleOutputs:vn,onSetDisplayName:mn,onDeleteInstance:wt,forceShowMinimized:ce?"input":le?"output":void 0,isConnectedInstanceSelected:se.some((function(t){return pe.some((function(n){var r=n.from,o=n.to;return r.insId===e.id&&o.insId===t||r.insId===t&&o.insId===e.id}))})),inlineGroupProps:ln(e),onCloseInlineEditor:bn,inlineEditorPortalDomNode:Ue.current,onChangeStyle:fn,onGroupSelected:Ze},e.id)})),function(){if(Pe){var e=Pe.from,t=Pe.to,n=(0,b.logicalPosToRenderedPos)(e,$e),r=(0,b.logicalPosToRenderedPos)(t,$e);console.log(e.x,t.x," | ",n.x,r.x);var o=(0,b.getSelectionBoxRect)(n,r),i=o.x,a=o.y,u=o.w,s=o.h;return(0,d.jsx)("div",{className:"selection-box",style:{top:a,left:i,width:u,height:s}})}return null}(),function(){var e=Q.to;return(0,h.entries)(ye).map((function(t){var n=t[0],r=t[1];return(0,d.jsx)(w.PartIoView,{insId:Z,type:"output",pos:ve[n]||{x:0,y:0},id:n,onDelete:a?xt:void 0,onRename:a?qt:void 0,closest:!(!tt||"output"!==tt.type||tt.ins.id!==ee.id||tt.pin!==n),connected:!1,viewPort:$e,onDragStart:bt,onDragEnd:Pt,onDragMove:It,onSelect:st,onSetDescription:ct,description:r.description,selected:(null==e?void 0:e.pinId)===n,onRequestHistory:$t},n)}))}(),Ne?(0,d.jsx)(j.QuickAddMenu,{part:Ne.part,pinId:Ne.pinId,pinType:Ne.pinType,pos:Ne.pos,resolvedFlow:ne,onRequestImportables:e.onRequestImportables,onAdd:en,onClose:Zt}):null,(0,d.jsxs)("div",r({className:"viewport-controls"},{children:[(0,d.jsx)(C.Button,r({small:!0,onClick:ut},{children:"Reset view"})),(0,d.jsx)(q,{min:.05,max:3,stepSize:.05,labelStepSize:10,labelRenderer:W,onChange:vt,value:$e.zoom})]})),He?(0,d.jsx)(M.InlineCodeModal,{env:b.emptyObj,initialValue:He.value,initialType:"existing"===He.type?He.templateType:void 0,onCancel:function(){return Ge(void 0)},onSubmit:hn}):null,(0,d.jsx)("div",{className:"inline-editor-portal-root"})]}))}))}catch(_n){return console.error(_n),(0,d.jsxs)("div",{children:["Error rendering board - ",_n.toString()]})}})));var $=function(e,t){var n=e.target.closest(".visual-part-editor");return n&&n.getAttribute("data-id")===t}},12589:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BasePartView=void 0;var s=n(24246),c=a(n(27378)),l=u(n(60042)),d=u(n(48304));t.BasePartView=function(e){var t=e.dragged,n=e.viewPort,o=e.pos,i=e.onDragEnd,a=e.onDragMove,u=e.onDragStart,p=e.displayMode,f=c.useCallback((function(e,t){u(e,t)}),[u]),v=c.useCallback((function(e,t){var a=o,u=(t.x-a.x)/n.zoom,s=(t.y-a.y)/n.zoom,c=a.x+u,l=a.y+s;i(e,r(r({},t),{x:c,y:l}))}),[o,i,n]),m=c.useCallback((function(e,t){a(e,{x:t.x,y:t.y})}),[a]),y={transform:"scale(".concat(n.zoom,")")},h=(0,l.default)("base-part-view",e.className,{dragged:t,"display-mode":p}),g=o.x*n.zoom-n.pos.x*n.zoom,b=o.y*n.zoom-n.pos.y*n.zoom,I=g-o.x,P=b-o.y,_={transform:"translate(".concat(I,"px, ").concat(P,"px)")},O=(0,l.default)("base-part-view-vp-fixer",{"display-mode":p});return(0,s.jsx)("div",r({className:O,style:_},{children:(0,s.jsx)(d.default,r({onStop:v,onStart:f,onDrag:m,position:o,cancel:".no-drag"},{children:(0,s.jsx)("span",r({className:"base-part-view-wrapper"},{children:(0,s.jsx)("div",r({className:h,style:y,id:e.domId},{children:e.children}))}))}))}))}},75012:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleConnectionCloseEditorCommand=void 0;var o=n(18265),i=r(n(63300));t.handleConnectionCloseEditorCommand=function(e,t){var n=t.from,r=t.to;return(0,i.default)(e,(function(e){var t=e.connections.find((function(e){var t=(0,o.connectionNodeEquals)(n,e.from),i=(0,o.connectionNodeEquals)(r,e.to);return t&&i}));t?e.connections=e.connections.filter((function(e){return e!==t})):e.connections.push({from:n,to:r})}))}},97841:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleDetachConstEditorCommand=void 0;var o=n(18265),i=r(n(63300)),a=n(52178);t.handleDetachConstEditorCommand=function(e,t,n){return(0,i.default)(e,(function(e){var r=e.instances.find((function(e){return e.id===t}));if(!r)throw new Error("Impossible state ins id with no matching instance");var i=r.inputConfig[n];if(!i)throw new Error("impossible state detaching const from unexistent config");if(!(0,o.isStaticInputPinConfig)(i))throw new Error("impossible state detaching const with no value");var u=i.value,s=(0,a.createInlineValuePart)({code:"".concat(u),type:o.InlineValuePartType.VALUE}),c=(0,o.inlinePartInstance)("value-".concat((0,o.randomInt)(999)),s,{},{x:r.pos.x,y:r.pos.y-100});if(!e.instances.find((function(e){return e.id===r.id})))throw new Error("impossible state instance not found");r.inputConfig[n]=(0,o.queueInputPinConfig)(),e.instances.push(c),e.connections.push((0,o.connectionData)("".concat(c.id,".r"),"".concat(r.id,".").concat(n)))}))}},3065:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleDuplicateSelectedEditorCommand=void 0;var i=o(n(98739)),a=o(n(63300));t.handleDuplicateSelectedEditorCommand=function(e,t){var n=[];return{newPart:(0,a.default)(e,(function(e){var o=e.instances;t.forEach((function(e){var t=o.find((function(t){return t.id===e}));if(!t)throw new Error("impossible state duplicate selected no matching instance");if(t){var a=t.pos,u=r(r({},t),{pos:{x:a.x+20,y:a.y+20},id:(0,i.default)()});o.push(u),n.push(u.id)}}))})),newInstances:n}}},24398:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.pasteInstancesCommand=void 0;var i=o(n(63300)),a=o(n(98739));t.pasteInstancesCommand=function(e,t,n){var o=n.instances.map((function(e){return r(r({},e),{pos:t,id:(0,a.default)()})})),u=new Map(o.map((function(e,t){return[n.instances[t].id,e.id]})));return{newPart:(0,i.default)(e,(function(e){var t,i;(t=e.instances).push.apply(t,o);var a=n.connections.map((function(e){var t=e.from,n=e.to;return{from:r(r({},t),{insId:u.get(t.insId)||t.insId}),to:r(r({},n),{insId:u.get(n.insId)||n.insId})}}));(i=e.connections).push.apply(i,a)})),newInstances:o}}},95160:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionView=t.SingleConnectionView=void 0;var s=n(27378),c=n(24246),l=a(n(27378)),d=u(n(60042)),p=n(18265),f=n(68488),v=n(64452),m=n(29768),y=n(99743),h=n(42272);t.SingleConnectionView=function(e){var t=(0,m.useSsr)().isBrowser,n=e.connection,o=e.part,i=e.repo,a=e.instances,u=e.type,s=e.viewPort,g=e.toggleHidden,b=e.parentSelected,I=e.removeConnection,P=n.from,_=(0,p.isInternalConnectionNode)(P)&&a.find((function(e){return e.id===P.insId}));if(!_&&(0,p.isInternalConnectionNode)(P))throw new Error('impossible state  - "from instance id - ['.concat(P.insId,'] does not exist"'));var O=((0,p.isInternalConnectionNode)(P)&&_?(0,p.getPartDef)(_,i):o).outputs[P.pinId],C=O&&O.delayed,w=t?function(e){var t=e.connection,n=e.boardPos,r=e.parentInsId,o=e.viewPort,i=t.from;return(0,p.isExternalConnectionNode)(i)?(0,f.calcMainInputPosition)(i.pinId,r,"input",n,o):(0,f.calcPinPosition)(r,i.insId,i.pinId,"output",n,o)}(e):{x:0,y:0},x=t?function(e){var t=e.connection,n=e.boardPos,r=e.parentInsId,o=e.viewPort,i=t.to;return(0,p.isExternalConnectionNode)(i)?(0,f.calcMainOutputPosition)(i.pinId,r,"output",n,o):(0,f.calcPinPosition)(r,i.insId,i.pinId,"input",n,o)}(e):{x:0,y:0},j=(0,y.vDiv)(w,e.parentVp.zoom),E=j.x,S=j.y,D=(0,y.vDiv)(x,e.parentVp.zoom),k=D.x,T=D.y,N=(0,d.default)("connection",{delayed:C,hidden:n.hidden,"parent-selected":b},u),M=(0,v.calcBezierPath)({sourceX:E,sourceY:S,targetX:k,targetY:T,curvature:.15}),R=2*s.zoom,A="regular"===u?void 0:6*s.zoom,V=(E+k)/2,z=(S+T)/2,H=l.useCallback((function(e){e.preventDefault(),e.stopPropagation();var t=(0,c.jsxs)(h.Menu,{children:[(0,c.jsx)(h.MenuItem,{text:n.hidden?"Show connection":"Hide connection",onClick:function(){return g(n)}}),(0,c.jsx)(h.MenuItem,{text:"Remove connection",onClick:function(){return I(n)}})]});h.ContextMenu.show(t,{left:e.pageX,top:e.pageY})}),[n,I,g]);return(0,c.jsxs)(l.Fragment,{children:[(0,c.jsx)("path",{d:M,className:N,style:{strokeWidth:R,strokeDasharray:A},onContextMenu:H}),"future-add"===u?(0,c.jsx)("text",r({className:"label",x:V,y:z,fontSize:"12px"},{children:"Add connection"})):null,"future-remove"===u?(0,c.jsx)("text",r({className:"label",x:V,y:z,fontSize:"12"},{children:"Remove connection"})):null]})};t.ConnectionView=function(e){var n=e.viewPort,o=e.futureConnection,i=e.toggleHidden,a=e.selectedInstances,u=l.useState(0),d=u[0],p=u[1],f=l.useCallback((function(e){return requestAnimationFrame((function(){p((function(e){return(e+1)%9})),e>0&&f(e-1)}))}),[]);l.useEffect((function(){var e=f(10);return function(){cancelAnimationFrame(e)}}),[f]),l.useEffect((function(){var e=function(){f(3)};return window.addEventListener("scroll",e),window.addEventListener("resize",e),function(){window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}}),[f,d]);var v=e.connections.map((function(n){var o=a.includes(n.from.insId)||a.includes(n.to.insId);return(0,s.createElement)(t.SingleConnectionView,r({},e,{connection:n,type:"regular",parentSelected:o,key:n.from.insId+n.from.pinId+n.to.insId+n.to.pinId}))}));return o&&v.push((0,c.jsx)(t.SingleConnectionView,r({},e,{connection:o.connection,type:o.type,toggleHidden:i,parentSelected:!1}))),(0,c.jsx)("span",r({className:"connections-view",style:{opacity:n.zoom}},{children:(0,c.jsx)("svg",r({style:{width:"100%"}},{children:v}))}))}},64452:function(e,t){"use strict";var n;function r(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function o(e){var t,o,i=e.pos,a=e.x1,u=e.y1,s=e.x2,c=e.y2,l=e.c;switch(i){case n.Left:t=a-r(a-s,l),o=u;break;case n.Right:t=a+r(s-a,l),o=u;break;case n.Top:t=a,o=u-r(u-c,l);break;case n.Bottom:t=a,o=u+r(c-u,l)}return[t,o]}Object.defineProperty(t,"__esModule",{value:!0}),t.getBezierCenter=t.calcBezierPath=t.Position=void 0,function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(n=t.Position||(t.Position={}));t.calcBezierPath=function(e){var t=e.sourceX,r=e.sourceY,i=e.sourcePosition,a=void 0===i?n.Bottom:i,u=e.targetX,s=e.targetY,c=e.targetPosition,l=void 0===c?n.Top:c,d=e.curvature,p=void 0===d?.25:d,f=o({pos:a,x1:t,y1:r,x2:u,y2:s,c:p}),v=f[0],m=f[1],y=o({pos:l,x1:u,y1:s,x2:t,y2:r,c:p}),h=y[0],g=y[1];return"M".concat(t,",").concat(r," C").concat(v,",").concat(m," ").concat(h,",").concat(g," ").concat(u,",").concat(s)},t.getBezierCenter=function(e){var t=e.sourceX,r=e.sourceY,i=e.sourcePosition,a=void 0===i?n.Bottom:i,u=e.targetX,s=e.targetY,c=e.targetPosition,l=void 0===c?n.Top:c,d=e.curvature,p=void 0===d?.25:d,f=o({pos:a,x1:t,y1:r,x2:u,y2:s,c:p}),v=f[0],m=f[1],y=o({pos:l,x1:u,y1:s,x2:t,y2:r,c:p}),h=.125*t+.375*v+.375*y[0]+.125*u,g=.125*r+.375*m+.375*y[1]+.125*s;return[h,g,Math.abs(h-t),Math.abs(g-r)]}},68488:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcMainOutputPosition=t.calcMainInputPosition=t.calcPinPosition=void 0;var r=n(90095),o={x:99999,y:99999},i=function(e,t,n,r){if(!e)return console.warn("Cannot find element ".concat(n," to render connection")),o;var i=e.getBoundingClientRect(),a=i.x,u=i.y,s=i.width,c=u+i.height/2;return{x:a+s/2-t.x,y:c-t.y}};t.calcPinPosition=function(e,t,n,o,a,u){var s=(0,r.getPinDomId)(e,t,n,o),c=document.getElementById(s);return i(c,a,s)};t.calcMainInputPosition=function(e,t,n,o,a){var u=(0,r.getMainPinDomId)(t,e,n),s=document.getElementById(u);return i(s,o,u)};t.calcMainOutputPosition=function(e,t,n,o,a){var u=(0,r.getMainPinDomId)(t,e,n),s=document.getElementById(u);return i(s,o,u)}},90095:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMainPinDomId=t.getPinDomId=t.getInstanceDomId=void 0;t.getInstanceDomId=function(e,t){return"ins-view-".concat(e,".").concat(t).replace(/\s+/g,"-")};t.getPinDomId=function(e,t,n,r){return"pin-".concat(e,".").concat(t,"-").concat(n,"-").concat(r).replace(/\s+/g,"-")};t.getMainPinDomId=function(e,t,n){return"pin-".concat(e,"-").concat(t,"-").concat(n).replace(/\s+/g,"-")}},57768:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},c=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceView=t.getVisibleOutputs=t.getVisibleInputs=t.INSTANCE_INFO_TOOLTIP_DELAY=t.MAX_INSTANCE_WIDTH=t.MIN_WIDTH_PER_PIN=t.PIECE_CHAR_WIDTH=t.PIECE_HORIZONTAL_PADDING=void 0;var d=n(24246),p=a(n(27378)),f=n(92739),v=n(18265),m=l(n(60042)),y=n(57076),h=n(18265),g=n(18265),b=n(71462),I=n(12589),P=n(18265),_=n(90095),O=n(41304),C=n(96149),w=n(42272),x=l(n(31542)),j=n(41978),E=l(n(49040));t.PIECE_HORIZONTAL_PADDING=25,t.PIECE_CHAR_WIDTH=11,t.MIN_WIDTH_PER_PIN=40,t.MAX_INSTANCE_WIDTH=400,t.INSTANCE_INFO_TOOLTIP_DELAY=400;t.getVisibleInputs=function(e,t,n){var r=e.visibleInputs;if(r)return r;var o=(0,v.keys)((0,g.getPartInputs)(t)).filter((function(r,o){var i,a=n.some((function(t){return t.to.insId===e.id&&t.to.pinId===r})),u=t.inputs[r]&&"optional"===(null===(i=t.inputs[r])||void 0===i?void 0:i.mode);return a||!u&&r!==h.TRIGGER_PIN_ID}));return 0===o.length?[h.TRIGGER_PIN_ID]:o};t.getVisibleOutputs=function(e,t,n){var r=e.visibleOutputs;if(r)return r;var o=Object.keys(t.outputs);return n.some((function(t){return t.from.insId===e.id&&t.from.pinId===h.ERROR_PIN_ID}))?c(c([],o,!0),[h.ERROR_PIN_ID],!1):o};t.InstanceView=function(e){var n=this,o=e.selected,i=e.selectedInput,a=e.selectedOutput,l=e.closestPin,S=e.dragged,D=e.onTogglePinLog,k=e.onTogglePinBreakpoint,T=e.onDetachConstValue,N=e.onCopyConstValue,M=e.onPasteConstValue,R=e.displayMode,A=e.connections,V=e.instance,z=e.viewPort,H=e.part,G=e.onPinClick,L=e.onPinDblClick,B=e.onDragStart,F=e.onRequestHistory,U=e.onDragEnd,q=e.onDragMove,W=e.onToggleSticky,$=e.onSelect,J=e.onDblClick,Y=e.onChangeVisibleInputs,X=e.onChangeVisibleOutputs,Q=e.onConvertConstToEnv,K=e.inlineGroupProps,Z=e.onUngroup,ee=e.onExtractInlinePart,te=e.onGroupSelected,ne=e.isConnectedInstanceSelected,re=e.inlineEditorPortalDomNode,oe=e.onChangeStyle,ie=e.onDeleteInstance,ae=e.onSetDisplayName,ue=V.id,se=p.useMemo((function(){var e=(0,v.randomInt)(6,1);return{icon:(0,v.pickRandom)([["fab","discord"],["fab","slack"],"bug","cube"]),color:e,size:(0,v.randomInt)(3,1),variation:(0,v.randomInt)(5,1)}}),[]),ce=p.useRef(),le=p.useMemo((function(){return V.style||H.defaultStyle||{}}),[H,V]),de=le.size||"regular",pe=p.useMemo((function(){return new Map(A.filter((function(e){return e.to.insId===ue})).map((function(e){var t=e.to,n=e.hidden;return[t.pinId,n]})))}),[A,ue]),fe=p.useMemo((function(){return new Map(A.filter((function(e){return e.from.insId===ue})).map((function(e){var t=e.from,n=e.hidden;return[t.pinId,n]})))}),[A,ue]),ve=(0,C.usePrompt)(),me=p.useCallback((function(e){return G(V,e,"input")}),[V,G]),ye=p.useCallback((function(e,t){return L(V,e,"input",t)}),[V,L]),he=p.useCallback((function(e,t){return L(V,e,"output",t)}),[V,L]),ge=p.useCallback((function(e){return G(V,e,"output")}),[V,G]),be=p.useCallback((function(e,t){B(V,e,t)}),[V,B]),Ie=p.useCallback((function(e,t){var n=V.pos,o=(t.x-n.x)/z.zoom,i=(t.y-n.y)/z.zoom,a=n.x+o,u=n.y+i;U(V,e,r(r({},t),{x:a,y:u}))}),[V,U,z.zoom]),Pe=p.useCallback((function(e,t){q(V,e,{x:t.x,y:t.y})}),[V,q]),_e=p.useCallback((function(e){return W(V,e)}),[V,W]),Oe=p.useCallback((function(e){return T(V,e)}),[V,T]),Ce=p.useCallback((function(e){return N(V,e)}),[V,N]),we=p.useCallback((function(e){return M(V,e)}),[V,M]),xe=p.useCallback((function(e){return $(V,e)}),[V,$]),je=p.useCallback((function(e){return J(V,e.shiftKey)}),[V,J]),Ee=(0,v.entries)(H.inputs),Se=V.visibleInputs,De=V.visibleOutputs;Se&&Ee.sort((function(e,t){return Se.indexOf(e[0])-Se.indexOf(t[0])}));var ke=(0,v.entries)(H.outputs);De&&ke.sort((function(e,t){return De.indexOf(e[0])-De.indexOf(t[0])}));var Te=(0,t.getVisibleInputs)(V,H,A),Ne=(0,t.getVisibleOutputs)(V,H,A);Ee.push([h.TRIGGER_PIN_ID,(0,v.partInput)()]),ke.push([h.ERROR_PIN_ID,(0,h.partOutput)()]);var Me=Ee.filter((function(e){var t=e[0];return Te.includes(t)||(o||ne)&&pe.has(t)})),Re=ke.filter((function(e){var t=e[0];return Ne.includes(t)||(o||ne)&&fe.has(t)})),Ae=(0,m.default)("ins-view",{"no-inputs":0===Ee.length,"no-outputs":0===ke.length,"display-mode":R,"force-minimized-input":"input"===e.forceShowMinimized||"both"===e.forceShowMinimized,"force-minimized-output":"output"===e.forceShowMinimized||"both"===e.forceShowMinimized,"inline-part-edited":!!K}),Ve=(0,m.default)({selected:o,dragged:S,closest:l&&l.ins.id===V.id},"size-".concat(de)),ze=new Set((0,v.entries)(H.inputs).filter((function(e){e[0];var t=e[1];return(0,h.isInputPinOptional)(t)})).map(v.pickFirst)),He=(0,v.entries)(V.inputConfig).reduce((function(e,t){var n,o=t[0],i=t[1];return(0,h.isStickyInputPinConfig)(i)||i.sticky?r(r({},e),((n={})[o]=!0,n)):e}),{}),Ge=(0,b.calcPartContent)(V,H),Le=function(e){var t=V.inputConfig[e];if((0,P.isStaticInputPinConfig)(t))return t.value},Be=p.useCallback((function(){return u(n,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return e=(0,v.okeys)(H.inputs),[4,ve("New order?",(V.visibleInputs||e).join(","))];case 1:return(t=n.sent())&&Y(V,t.split(",")),[2]}}))}))}),[H.inputs,ve,V,Y]),Fe=p.useCallback((function(){return u(n,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return e=(0,v.okeys)(H.outputs),[4,ve("New order?",(V.visibleOutputs||e).join(","))];case 1:return(t=n.sent())&&X(V,t.split(",")),[2]}}))}))}),[H.outputs,ve,V,X]),Ue=p.useCallback((function(){ie(V)}),[ie,V]),qe=p.useCallback((function(){return u(n,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,ve("Set custom display name",V.displayName||H.id)];case 1:return e=t.sent(),ae(V,e),[2]}}))}))}),[ve,V,ae,H.id]),We=Object.keys((0,g.getPartInputs)(H)),$e=Object.keys((0,v.getPartOutputs)(H)),Je=p.useCallback((function(e,t){return F(V.id,e,t)}),[V,F]),Ye=p.useCallback((function(e){Q&&Q(V,e)}),[V,Q]),Xe=function(){return(0,d.jsx)("div",r({className:"inputs no-drag"},{children:Me.map((function(t){var n=t[0],r=t[1];return(0,d.jsx)(y.PinView,{type:"input",insId:V.id,parentInsId:e.parentInsId,id:n,optional:ze.has(n),connected:pe.has(n),isSticky:He[n],minimized:!o&&1===Me.length,onToggleSticky:_e,onDetachConstValue:Oe,onCopyConstValue:Ce,onPasteConstValue:we,copiedConstValue:e.copiedConstValue,selected:n===i,onClick:me,onDoubleClick:ye,isClosestToMouse:!!l&&"input"===l.type&&l.pin===n,onToggleLogged:D,onToggleBreakpoint:k,onInspect:e.onInspectPin,constValue:Le(n),onRequestHistory:Je,onConvertConstToEnv:e.onConvertConstToEnv?Ye:void 0,description:r.description},n)}))}))},Qe=function(){return(0,d.jsx)("div",r({className:"outputs no-drag"},{children:Re.map((function(t){var n=t[0],r=t[1];return(0,d.jsx)(y.PinView,{insId:V.id,parentInsId:e.parentInsId,connected:fe.has(n),type:"output",id:n,minimized:!o&&1===Re.length,isClosestToMouse:!!l&&"output"===l.type&&l.pin===n,selected:n===a,onClick:ge,onDoubleClick:he,onToggleLogged:D,onToggleBreakpoint:k,onInspect:e.onInspectPin,onRequestHistory:Je,description:r.description},n)}))}))},Ke=p.useCallback((function(e){oe(V,e)}),[V,oe]),Ze=p.useCallback((function(){var e=We.map((function(e){var t=Te.includes(e),n=pe.has(e)&&!0!==pe.get(e),r=(0,v.getInputName)(e);return{text:t?'Hide input "'.concat(r,n?'" (disconnect first)':'"'):'Show input "'.concat(r,'"'),onClick:function(){return Y(V,t?Te.filter((function(t){return t!==e})):c(c([],Te,!0),[e],!1))},disabled:n&&t}})),t=$e.map((function(e){var t=Ne.includes(e),n=fe.has(e),r=(0,v.getOutputName)(e);return{text:t?'Hide output "'.concat(r,n?'" (disconnect first)':'"'):'Show output "'.concat(r,'"'),onClick:function(){return X(V,t?Ne.filter((function(t){return t!==e})):c(c([],Ne,!0),[e],!1))},disabled:n&&t}})),n=c(c(c(c(c([],e,!0),t,!0),(0,v.isInlinePartInstance)(V)&&(0,g.isVisualPart)(V.part)?[{text:"Ungroup inline part",onClick:function(){return Z(V)}}]:[],!0),(0,v.isInlinePartInstance)(V)?[{text:"Extract inline part to file",onClick:function(){return ee(V)}}]:[],!0),[{text:"Reorder inputs",onClick:Be},{text:"Reorder outputs",onClick:Fe},{text:"Set display name",onClick:qe},{text:"Group selected instances",onClick:te},{text:"Delete instance",intent:"danger",onClick:Ue}],!1);return(0,d.jsxs)(w.Menu,{children:[(0,d.jsx)(w.MenuItem,r({text:"Style"},{children:(0,d.jsx)(j.PartStyleMenu,{style:le,onChange:Ke,promptFn:ve})})),n.map((function(e){return(0,d.jsx)(w.MenuItem,r({},e))}))]})}),[We,$e,V,Be,Fe,qe,Ue,le,Ke,ve,Te,pe,Y,Ne,fe,X,Z,ee,te]),et=p.useCallback((function(e){e.preventDefault(),e.stopPropagation();var t=Ze();w.ContextMenu.show(t,{left:e.clientX,top:e.clientY})}),[Ze]),tt=r({"--part-color":le.color},le.cssOverride||{}),nt=(0,_.getInstanceDomId)(e.parentInsId,V.id);return(0,d.jsx)("div",r({className:Ae},{children:(0,d.jsxs)(I.BasePartView,r({pos:V.pos,viewPort:z,onDragStart:be,onDragMove:Pe,onDragEnd:Ie,upperRenderer:Xe,bottomRenderer:Qe,displayMode:R,domId:nt},{children:[(0,d.jsx)(E.default,{className:"instance-info-tooltip",html:!0,id:nt+"__tooltip",delayShow:t.INSTANCE_INFO_TOOLTIP_DELAY}),Xe(),K?x.default.createPortal((0,d.jsxs)("div",r({className:"inline-group-editor-container no-drag"},{children:[(0,d.jsxs)("header",{children:[Ge," ",(0,d.jsx)("button",r({onClick:e.onCloseInlineEditor},{children:"close"}))]}),(0,d.jsx)(O.VisualPartEditor,r({},e.inlineGroupProps,{className:"no-drag",ref:ce}))]})),re):(0,d.jsxs)("div",r({className:(0,m.default)("ins-view-inner",Ve,"size-".concat(se.size)),onClick:xe,onDoubleClick:je,onContextMenu:et,style:tt,"data-tip":H.description,"data-for":nt+"__tooltip"},{children:[le.icon?(0,d.jsx)(f.FontAwesomeIcon,{icon:le.icon}):null," ",Ge]})),Qe()]}))}))}},91530:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.PartStyleMenu=void 0;var c=n(24246),l=n(42272),d=a(n(27378)),p=n(40232),f={size:"regular"};t.PartStyleMenu=function(e){var t=e.onChange,n=e.style||f,o=e.promptFn,i=d.default.useCallback((function(e,o){var i;t(r(r({},n),((i={})[e]=o,i)))}),[n,t]),a=d.default.useCallback((function(){return u(void 0,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return[4,o("Icon name? (Font Awesome conventions)","rocket")];case 1:return e=n.sent(),t=e.includes(",")?e.split(","):e,i("icon",t),[2]}}))}))}),[o,i]),v=(0,d.useCallback)((function(){return u(void 0,void 0,void 0,(function(){var e,t;return s(this,(function(r){switch(r.label){case 0:return[4,o("Enter a custom style (valid JSON representing a React CSS object)",n.cssOverride?JSON.stringify(n.cssOverride):"")];case 1:e=r.sent();try{t=JSON.parse(e),i("cssOverride",t)}catch(a){console.error(a),(0,p.toastMsg)("Invalid object","danger")}return[2]}}))}))}),[o,i,n.cssOverride]);return(0,c.jsxs)(d.default.Fragment,{children:[(0,c.jsxs)(l.MenuItem,r({text:"Color"},{children:[(0,c.jsx)(l.MenuItem,{text:"Amethyst",onClick:function(){return i("color","#9b5de5")}}),(0,c.jsx)(l.MenuItem,{text:"Magenta",onClick:function(){return i("color","#f15bb5")}}),(0,c.jsx)(l.MenuItem,{text:"Yellow",onClick:function(){return i("color","#fee440")}}),(0,c.jsx)(l.MenuItem,{text:"Capri",onClick:function(){return i("color","#00bbf9")}}),(0,c.jsx)(l.MenuItem,{text:"Sea Green",onClick:function(){return i("color","#00f5d4")}}),(0,c.jsx)(l.MenuDivider,{}),(0,c.jsx)(l.MenuItem,{text:"Remove Color",onClick:function(){return i("color",void 0)}})]})),(0,c.jsxs)(l.MenuItem,r({text:"Size (".concat(n.size,")")},{children:[(0,c.jsx)(l.MenuItem,{text:"Small",onClick:function(){return i("size","small")}}),(0,c.jsx)(l.MenuItem,{text:"Regular",onClick:function(){return i("size","regular")}}),(0,c.jsx)(l.MenuItem,{text:"Large",onClick:function(){return i("size","large")}})]})),(0,c.jsxs)(l.MenuItem,r({text:"Icon"},{children:[(0,c.jsx)(l.MenuItem,{text:"Choose Icon",onClick:a}),(0,c.jsx)(l.MenuItem,{text:"Remove Icon",onClick:function(){return i("icon",void 0)}})]})),(0,c.jsx)(l.MenuItem,{text:"Custom Styling",onClick:v})]})}},41978:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(91530),t)},41756:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(57768),t)},71462:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.calcInstancePosition=t.calcPartWidth=t.calcPartContent=void 0;var u=n(18265),s=a(n(78284)),c=n(12901),l=n(57768),d=n(98784),p=n(90095);t.calcPartContent=function(e,t){if(e.displayName)return e.displayName;if(t.customViewCode)try{var n=Object.entries(e.inputConfig).filter((function(e){var t=e[1];return(0,u.isStaticInputPinConfig)(t)})).reduce((function(e,t){var n,o=t[0],i=t[1];return r(r({},e),((n={})[o]=i.value,n))}),{});return s.render(t.customViewCode,{inputs:n,isDefined:c.isDefined}).trim()}catch(o){return console.error("Error with custom view",o),"Error in custom view [".concat(t.id,"]")}return t.id};t.calcPartWidth=function(e,n){var r=(0,u.okeys)(n.inputs).length*l.MIN_WIDTH_PER_PIN,o=(0,t.calcPartContent)(e,n),i=l.PIECE_CHAR_WIDTH;return(0,d.clamp)(o.length*i+2*l.PIECE_HORIZONTAL_PADDING,r,l.MAX_INSTANCE_WIDTH)};t.calcInstancePosition=function(e,t,n){var r=(0,p.getInstanceDomId)(t,e),o=document.getElementById(r);if(o){var i=o.getBoundingClientRect(),a=i.x,u=i.y,s=i.width,c=u+i.height/2;return{x:a+s/2-n.x,y:c-n.y}}return console.warn("Cannot find element to draw connection to",r),{x:99999,y:99999}}},10616:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LayoutDebugger=t.LayoutDebuggerItem=t.PosDebugger=void 0;var a=n(27378),u=n(24246),s=n(18265),c=i(n(27378)),l=n(13011),d=function(e){var t=e.pos;return(0,u.jsxs)("span",{children:[t.x.toFixed(1),", ",t.y.toFixed(1)]})};t.PosDebugger=function(e){return(0,u.jsx)("span",r({className:"pos-debugger"},{children:(0,u.jsx)(d,{pos:e.pos})}))};t.LayoutDebuggerItem=function(e){var n=e.pos,o=e.viewPort,i=e.size,a=e.color,s=o.zoom,c=n.x*s-o.pos.x*s,l=n.y*s-o.pos.y*s,d=c-n.x,p=l-n.y,f={transform:"translate(".concat(d,"px, ").concat(p,"px)")},v={transform:"scale(".concat(o.zoom,")")},m={transform:"translate(".concat(n.x,"px, ").concat(n.y,"px)")},y={width:"".concat(i.width,"px"),height:"".concat(i.height,"px"),backgroundColor:a};return(0,u.jsx)("div",r({className:"layout-debugger",style:f},{children:(0,u.jsxs)("span",r({className:"drag-sim",style:m},{children:[(0,u.jsx)(t.PosDebugger,{pos:n}),(0,u.jsx)("div",r({className:"layout-debugger-zoom-wrapper",style:v},{children:(0,u.jsx)("div",{className:"layout-debugger-inner",style:y})}))]}))}))};var p=function(){try{return"true"===localStorage.getItem("pos-debugger")}catch(e){return!1}}();t.LayoutDebugger=function(e){var n=e.extraDebug,i=e.vp,f=e.part,v=e.mousePos;if(!p)return null;var m=n.map((function(e,n){return(0,a.createElement)(t.LayoutDebuggerItem,r({},e,{key:n}))})),y=o(o(o([],f.instances.map((function(e){return e.pos})),!0),(0,s.values)(f.inputsPosition),!0),(0,s.values)(f.outputsPosition),!0).map((function(e){return(0,u.jsx)(t.LayoutDebuggerItem,{pos:e,viewPort:i,size:{width:0,height:0},color:"red"})})),h=(0,l.logicalPosToRenderedPos)(v,i),g=(0,u.jsxs)("div",r({className:"viewport-data"},{children:[(0,u.jsxs)("div",{children:["Pos: ",(0,u.jsx)(d,{pos:i.pos})]}),(0,u.jsxs)("div",{children:["Zoom: ",i.zoom.toFixed(2)," "]}),(0,u.jsxs)("div",{children:["Mouse (logical): ",(0,u.jsx)(d,{pos:v})]}),(0,u.jsxs)("div",{children:["Rendered (rendered): ",(0,u.jsx)(d,{pos:h})]})]}));return(0,u.jsxs)(c.default.Fragment,{children:[g,m,y]})}},94e3:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(10616),t)},5681:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.orderVisualPart=t.layoutToInstances=void 0;var i=n(41304),a=n(18265),u=n(72913),s=o(n(63300)),c=n(80807),l=n(99743),d=n(71462);t.layoutToInstances=function(e,t){return(0,s.default)(t,(function(t){(0,a.entries)(e.nodes).forEach((function(e){var n=e[0],r=e[1];if(n.startsWith("ins-")){var o=n.replace("ins-",""),i=t.instances.find((function(e){return e.id===o}));i?i.pos=r.p:console.warn("WAT")}if(n.startsWith("part-input-")){var a=n.replace("part-input-","");t.inputsPosition[a]=r.p}if(n.startsWith("part-output-")){a=n.replace("part-output-","");t.outputsPosition[a]=r.p}}))}))};t.orderVisualPart=function(e,n,o,s){var p=e.instances,f=e.connections,v=p.reduce((function(e,t){var o,u=(0,l.size)((0,d.calcPartWidth)(t,(0,a.getPartDef)(t,n)),i.PART_HEIGHT);return r(r({},e),((o={})["ins-".concat(t.id)]={p:t.pos,s:u},o))}),{}),m=(0,a.okeys)(e.inputsPosition).reduce((function(t,n){var o,a=e.inputsPosition[n],u=(0,l.size)((0,c.calcPartIoWidth)(n),i.PART_HEIGHT);return r(r({},t),((o={})["part-input-".concat(n)]={p:a,s:u},o))}),{}),y=(0,a.okeys)(e.outputsPosition).reduce((function(t,n){var o,a=e.outputsPosition[n],u=(0,l.size)((0,c.calcPartIoWidth)(n),i.PART_HEIGHT);return r(r({},t),((o={})["part-output-".concat(n)]={p:a,s:u},o))}),{}),h=r(r(r({},v),m),y),g=f.map((function(e){return[(0,a.isExternalConnectionNode)(e.from)?"part-input-".concat(e.from.pinId):"ins-".concat(e.from.insId),(0,a.isExternalConnectionNode)(e.to)?"part-output-".concat(e.to.pinId):"ins-".concat(e.to.insId)]})),b=(0,u.orderLayout)({nodes:h,edges:g},o,(function(n,r){s&&s((0,t.layoutToInstances)(n,e),r)}));return(0,t.layoutToInstances)(b,e)}},72913:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.orderLayout=void 0;var o=n(99743),i=400,a=function(e){return e.reduce((function(e,t){var n,i=(0,o.vSub)(t.p,(0,o.vec)(t.s.width/2,t.s.height/2));return r(r({},e),((n={})[t.id]={p:i,s:t.s},n))}),{})};t.orderLayout=function(e,t,n){for(var u=e.nodes,s=e.edges,c=Object.entries(u).map((function(e){var t=e[0],n=e[1];return{id:t,p:(0,o.vAdd)(n.p,(0,o.vec)(n.s.width/2,n.s.height/2)),f:(0,o.vec)(0,0),v:(0,o.vec)(0,0),m:1,s:n.s}})),l=0,d=function(){for(var e=c,t=0;t<e.length;t++)for(var u=t+1;u<e.length;u++)if(t!==u){var d=e[t],p=e[u],f=(0,o.vSub)(d.p,p.p),v=Math.abs(f.x),m=Math.abs(f.y),y=d.id.startsWith("part-input"),h=d.id.startsWith("part-output"),g=p.id.startsWith("part-input"),b=p.id.startsWith("part-output");if(v<i&&m<80){var I=1e3*(i-v);d.f=(0,o.vAdd)(d.f,(0,o.vec)(.5*I,0)),p.f=(0,o.vAdd)(p.f,(0,o.vec)(-.5*I,0))}if(m<50){var P=100*f.y;d.f=(0,o.vAdd)(d.f,(0,o.vec)(0,.5*P)),p.f=(0,o.vAdd)(p.f,(0,o.vec)(0,-.5*P))}if(y&&b){var _=(0,o.vSub)(d.p,p.p).y;if(_<-500){var O=100*(i-_);d.f=(0,o.vAdd)(d.f,(0,o.vec)(0,-.5*O)),p.f=(0,o.vAdd)(p.f,(0,o.vec)(0,.5*O))}}else if(h&&g){var C=(0,o.vSub)(d.p,p.p).y;if(C<500){var w=100*(i-C);d.f=(0,o.vAdd)(d.f,(0,o.vec)(0,-.5*w)),p.f=(0,o.vAdd)(p.f,(0,o.vec)(0,.5*w))}}var x=(0,o.vSub)(d.p,(0,o.vec)(0,d.p.y)),j=(0,o.vLen)(x),E=(0,o.vMul)((0,o.vNorm)(x),-50*j);d.f=(0,o.vAdd)(d.f,E)}s.forEach((function(t){var n=e.find((function(e){return e.id===t[0]})),r=e.find((function(e){return e.id===t[1]}));if(n&&r){var i=(0,o.vec)(0,-200),a=(0,o.vSub)(n.p,r.p),u=(0,o.vSub)(i,a),s=1e3*(0,o.vLen)(u),c=(0,o.vMul)((0,o.vNorm)(u),.5*s),l=(0,o.vMul)((0,o.vNorm)(u),-.5*s);n.f=(0,o.vAdd)(n.f,c),r.f=(0,o.vAdd)(r.f,l)}else console.warn("weoops",t[0],t[1])})),e=(e=e.map((function(e){return(0,o.itrPhysics)(15,e)}))).map((function(e){var t=(0,o.vMul)(e.v,.5),n=(0,o.vLen)(t)>100?(0,o.vMul)((0,o.vNorm)(t),100):t;return r(r({},e),{v:n})})),c=e,n&&n({nodes:a(e),edges:s},l),l++};l<t&&(l<2||(0,o.totalEnergy)(c)>.01);)d();return{nodes:a(c),edges:s,itrs:l,timeout:l>=t,total:(0,o.totalEnergy)(c)}}},52688:function(e,t){"use strict";var n=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.calculateInstancesWithSingleConstPinsMap=t.getLeafInstancesOfSelection=void 0;t.getLeafInstancesOfSelection=function(e,t,r){return e.reduce((function(e,o){var i=r.filter((function(e){return e.to.insId===o.id})).map((function(e){return t.find((function(t){return t.id===e.from.insId}))})).filter((function(e){return!!e}));return n(n([],e,!0),i,!0)}),[]).filter((function(t){return 1===r.filter((function(e){return e.from.insId===t.id||e.to.insId===t.id})).length&&!e.includes(t)}))};t.calculateInstancesWithSingleConstPinsMap=function(e,t){return e.connections.filter((function(e){return t.has(e.from.insId)})).reduce((function(e,n){var r=t.get(n.from.insId),o=n.to.insId,i=e.get(o)||new Map;return i.set(n.to.pinId,{val:r,insId:n.from.insId}),e.set(o,i),e}),new Map)}},16914:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(s){u=[6,s],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},c=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PartIoView=void 0;var d=n(24246),p=a(n(27378)),f=n(18265),v=n(12589),m=n(90095),y=l(n(60042)),h=n(42272),g=n(91312),b=n(40411),I=n(18265),P=l(n(49040));t.PartIoView=p.memo((function(e){var t=this,n=e.viewPort,o=e.selected,i=e.pos,a=e.type,l=e.id,_=e.onDblClick,O=e.onRename,C=e.onDelete,w=e.onChangeInputMode,x=e.inputMode,j=e.onSelect,E=e.closest,S=e.onSetDescription,D=e.description,k=e.onRequestHistory,T=(0,b.useHistoryHelpers)(k,l,a),N=T.history,M=T.resetHistory,R=T.refreshHistory,A=(0,g.usePrompt)(),V=p.useCallback((function(){return u(t,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,A("Description?",D)];case 1:return e=t.sent(),S(a,l,e),[2]}}))}))}),[A,D,S,a,l]),z=p.useCallback((function(){C&&C(a,l)}),[a,l,C]),H=p.useCallback((function(){O&&O(a,l)}),[a,l,O]),G=p.useCallback((function(e){w&&w(l,e)}),[l,w]),L=p.useCallback((function(){return c(c([{text:"Current mode - ".concat(x),onClick:f.noop},{text:"Make required",onClick:function(){return G("required")}},{text:"Make optional",onClick:function(){return G("optional")}},{text:"Make required-if-connected",onClick:function(){return G("required-if-connected")}},{text:"Set description",onClick:V}],e.onRename?[{text:"Rename",onClick:H}]:[],!0),e.onDelete?[{text:"Delete",onClick:z}]:[],!0)}),[V,x,G,z,H,e.onDelete,e.onRename]),B=p.useCallback((function(t){_&&_(e.id,t)}),[_,e.id]),F=p.useCallback((function(){j(l,a)}),[l,a,j]),U=p.useCallback((function(){return(0,d.jsx)(h.Menu,{children:L().map((function(e){return(0,d.jsx)(h.MenuItem,r({},e))}))})}),[L]),q=p.useCallback((function(e){e.preventDefault(),e.stopPropagation();var t=U();h.ContextMenu.show(t,{left:e.clientX,top:e.clientY})}),[U]),W="input"===a?(0,I.getInputName)(l):(0,f.getOutputName)(l);return(0,d.jsxs)(v.BasePartView,r({className:(0,y.default)("part-io-view",a),pos:i,onDragEnd:function(t,o){var i=e.pos,u=(o.x-i.x)/n.zoom,s=(o.y-i.y)/n.zoom,c=i.x+u,d=i.y+s;e.onDragEnd(a,l,t,r(r({},o),{x:c,y:d}))},onDragStart:function(t,n){e.onDragStart(l,t,n)},onDragMove:function(t,o){var i=e.pos,u=(o.x-i.x)/n.zoom,s=(o.y-i.y)/n.zoom,c=i.x+u,d=i.y+s;e.onDragMove(a,l,t,r(r({},o),{x:c,y:d}))},viewPort:n},{children:[(0,d.jsx)(P.default,{className:"pin-info-tooltip",html:!0,id:l+e.insId,getContent:[function(){var t=(0,b.calcHistoryContent)(N),n=e.description?"<em>".concat(e.description,"</em>"):"";return"<div><div><strong>".concat(W,"</strong> (").concat(a,") </div>\n      ").concat(n,"\n      <hr/>\n      ").concat(t,"\n    ")},25]}),(0,d.jsx)("div",r({onMouseEnter:R,onMouseOut:M,"data-tip":"","data-html":!0,"data-for":l+e.insId,className:(0,y.default)("part-io-view-inner",{closest:E,selected:o}),id:(0,m.getMainPinDomId)(e.insId,l,a),onClick:F,onDoubleClick:B,onContextMenu:q},{children:l}))]}))}))},43318:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(16914),t)},80807:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcPartIoWidth=t.MIN_WIDTH_PER_PIN=t.PIECE_CHAR_WIDTH=t.PIECE_HORIZONTAL_PADDING=void 0,t.PIECE_HORIZONTAL_PADDING=15,t.PIECE_CHAR_WIDTH=9,t.MIN_WIDTH_PER_PIN=40;t.calcPartIoWidth=function(e){return Math.max(t.MIN_WIDTH_PER_PIN,e.length*t.PIECE_CHAR_WIDTH+2*t.PIECE_HORIZONTAL_PADDING)}},57076:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PinView=t.PIN_HEIGHT=void 0;var s=n(24246),c=a(n(27378)),l=u(n(60042)),d=n(42272),p=n(12901),f=n(18265),v=n(90095),m=n(75579),y=u(n(49040)),h=n(40411);t.PIN_HEIGHT=23;t.PinView=c.memo((function(e){var t=e.selected,n=e.type,o=e.connected,i=e.rotate,a=e.optional,u=e.isClosestToMouse,g=e.id,b=e.onRequestHistory,I=(0,h.useHistoryHelpers)(b,g,n),P=I.history,_=I.resetHistory,O=I.refreshHistory,C="input"===n?(0,f.getInputName)(g):(0,f.getOutputName)(g),w="input"===e.type&&(0,p.isDefined)(e.constValue)?e.constValue:void 0,x=i&&"input"===n;return(0,s.jsxs)("div",r({className:function(){if("input"===e.type){var r=e.isSticky,s=e.constValue;return(0,l.default)("pin",{sticky:r,selected:t,closest:u,optional:a,connected:o,rotate:i,"const-value":(0,p.isDefined)(s),"env-value":(0,p.isDefined)(s)&&(0,f.isEnvValue)(s),minimized:e.minimized},n)}return(0,l.default)("pin",{selected:t,connected:o,closest:u,rotate:i,optional:a,minimized:e.minimized},n,i)}(),onContextMenu:function(t){t.preventDefault(),t.stopPropagation();var n=function(){var t=(0,s.jsx)(d.MenuItem,{onClick:function(){return e.onToggleLogged(e.insId,e.id,e.type)}}),n=(0,s.jsx)(d.MenuItem,{onClick:function(){return e.onToggleBreakpoint(e.insId,e.id,e.type)}}),r=(0,s.jsx)(d.MenuItem,{onClick:function(){return e.onInspect(e.insId,e.id,e.type)},text:"Inspect"});if("input"===e.type){var o=e.onConvertConstToEnv;return(0,p.isDefined)(w)?(0,s.jsxs)(d.Menu,{children:[(0,s.jsx)(d.MenuItem,{onClick:function(){return e.onDetachConstValue(e.id)},text:"Detach value"}),(0,s.jsx)(d.MenuItem,{onClick:function(){return e.onCopyConstValue(e.id)},text:"Copy value"}),(0,p.isDefined)(e.copiedConstValue)?(0,s.jsx)(d.MenuItem,{onClick:function(){return e.onPasteConstValue(e.id)},text:"Paste value"}):null,o?(0,s.jsx)(d.MenuItem,{onClick:function(){return o(e.id)},text:"Convert to Env Var"}):null]}):(0,s.jsxs)(d.Menu,{children:[(0,s.jsx)(d.MenuItem,{onClick:function(){return e.onToggleSticky(e.id)},text:"Toggle sticky (square means sticky)"}),t,n,r,(0,p.isDefined)(e.copiedConstValue)?(0,s.jsx)(d.MenuItem,{onClick:function(){return e.onPasteConstValue(e.id)},text:"Paste value"}):null]})}return(0,s.jsxs)(d.Menu,{children:[t,n,r]})}();d.ContextMenu.show(n,{left:t.clientX,top:t.clientY})},"data-pin-id":g},{children:[(0,s.jsx)(y.default,{className:"pin-info-tooltip",html:!0,id:g+e.insId,getContent:[function(){var t=(0,h.calcHistoryContent)(P),r=e.description?"<em>".concat(e.description,"</em>"):"";return"<div><div><strong>".concat(C,"</strong> (").concat(n,") </div>\n      ").concat(r,"\n      <hr/>\n      ").concat((0,p.isDefined)(w)?"<div>Static value: <strong>".concat((0,m.valuePreview)(w).substr(0,200),"</strong></div>"):t,"\n    ")},25]}),(0,s.jsxs)("div",r({onMouseEnter:O,onMouseOut:_,"data-tip":"","data-html":!0,"data-for":g+e.insId,id:(0,v.getPinDomId)(e.parentInsId,e.insId,g,n),"data-place":x?"bottom":null,onDoubleClick:function(t){return e.onDoubleClick&&e.onDoubleClick(g,t)},className:"pin-inner",onClick:function(t){var r=e.onShiftClick,o=e.onClick,i=e.id;t.shiftKey&&r?r(i,t):o(i,n,t)}},{children:[C," ",(0,p.isDefined)(w)?(0,s.jsxs)(c.Fragment,{children:[":",(0,s.jsx)("span",r({className:"value"},{children:(0,p.toString)(w)}))]}):null,"input"===e.type&&e.isSticky?(0,s.jsx)("span",r({className:"suffix"},{children:"s"})):null,"input"===e.type&&e.queueSize?(0,s.jsxs)("span",r({className:"suffix"},{children:[e.queueSize," in Q"]})):null]})),(0,s.jsx)("div",{className:"wire"})]}))}))},40411:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useHistoryHelpers=t.calcHistoryContent=void 0;var o=n(75579),i=r(n(27378)),a=n(27378);t.calcHistoryContent=function(e){if(e){var t=e.total,n=e.lastSamples,r="<strong>Activated ".concat(t," times this session</strong>"),i=n.length>0?"<div>Last value: <strong>".concat((0,o.valuePreview)(n[0].val).substr(0,200),"</strong></div>"):"";return"".concat(r," ").concat(i)}return"Loading session data.."};t.useHistoryHelpers=function(e,t,n){var r=(0,a.useRef)(),o=(0,a.useState)(),u=o[0],s=o[1];return{history:u,refreshHistory:(0,a.useCallback)((function(){clearInterval(r.current),e(t,n).then((function(e){s(e)})),r.current=setInterval((function(){e(t,n).then((function(e){s(e)}))}),500)}),[e,t,n]),resetHistory:i.default.useCallback((function(){clearInterval(r.current),s(void 0)}),[])}}},40490:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.QuickAddMenu=void 0;var u=n(24246),s=a(n(27378)),c=n(18265),l=n(42272),d=n(18185),p=n(10934),f=d.Select.ofType(),v=function(e){switch(e.type){case"part":return"".concat(e.part.id);case"value":return"Add inline value or function";case"import":return"Import ".concat(e.importablePart.part.id," from ").concat(e.importablePart.module)}},m=function(e,t){var n=t.handleClick,r=t.modifiers,o=t.query;if(!r.matchesPredicate)return null;var i=v(e);return"value"===e.type?(0,u.jsxs)(s.Fragment,{children:[(0,u.jsx)(l.MenuDivider,{}),(0,u.jsx)(l.MenuItem,{active:r.active,disabled:r.disabled,onClick:n,text:(0,p.highlightText)(i,o)},v(e))]}):(0,u.jsx)(l.MenuItem,{active:r.active,disabled:r.disabled,onClick:n,text:(0,p.highlightText)(i,o)},v(e))},y=function(e,t,n,r){var o=v(t).toLocaleLowerCase(),i=e.toLowerCase();return r?o===i:o.includes(i)};t.QuickAddMenu=function(e){var t,n=e.resolvedFlow,o=e.onRequestImportables,i={left:e.pos.x,top:e.pos.y},a=s.useState(),d=a[0],p=a[1];s.useEffect((function(){o&&o("").then(p)}),[o]);var v=(0,c.values)(r(r({},n.dependencies),((t={})[n.main.id]=n.main,t))),h=v.map((function(e){return{type:"part",part:e}})),g=new Set(v.map((function(e){return e.id}))),b=d?d.filter((function(e){return!g.has(e.part.id)})).map((function(e){return{type:"import",importablePart:e}})):[],I=h.concat(b).concat({type:"value"});return(0,u.jsx)("div",r({className:"quick-add-menu",style:i},{children:(0,u.jsx)(f,{className:"quick-add-parts-select",items:I,itemPredicate:y,itemRenderer:m,inputProps:{className:"quick-add-input"},noResults:(0,u.jsx)(l.MenuItem,{disabled:!0,text:"No results."}),onItemSelect:function(t){return e.onAdd(t)},popoverProps:{isOpen:!0,onClose:function(){return e.onClose()}}})}))}},29841:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(40490),t)},76298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRuntimePlayer=void 0;var r=n(18265),o=n(22940),i=(0,r.debugLogger)("runtime-player");t.createRuntimePlayer=function(e){var t=0,n=[],r=!1,a=Date.now(),u=t,s=function s(){return requestAnimationFrame((function(){var c,l,d,p=Date.now();u=t,t+=p-a,a=p,c=u,l=t,d=n,n=[],d.length&&i("Playing ".concat(d.length," events from"),c,l),d.forEach((function(t){i("Playing event",t),(0,o.playEvent)(e,t)})),r&&s()}))},c=function(){r=!1},l=function(){n=[],document.querySelectorAll("[data-runtime]").forEach((function(e){e.removeAttribute("data-runtime")})),document.querySelectorAll("[data-runtime-queue]").forEach((function(e){e.removeAttribute("data-runtime-queue")}))};return{stop:c,start:function(e){void 0===e&&(e=0),r=!0,t=e,a=Date.now(),s()},addEvents:function(e){n.push.apply(n,e)},destroy:function(){c(),l()},clear:l,status:function(){return{running:r,currDt:t,lastDt:u,queue:n,last:a}}}}},22940:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.playEvent=t.cancelTimers=void 0;var o=n(18265),i=n(90095),a=5e3,u=(0,o.debugLogger)("runtime-player:play-event"),s=function(e){return e.type===o.DebuggerEventType.INPUT_CHANGE||e.type===o.DebuggerEventType.OUTPUT_CHANGE?"".concat(e.parentInsId,".").concat(e.insId,".").concat(e.pinId):"".concat(e.parentInsId,".").concat(e.insId)};t.cancelTimers=new Map;t.playEvent=function(e,n){var c,l,d=s(n);switch(n.type){case o.DebuggerEventType.INPUT_CHANGE:case o.DebuggerEventType.OUTPUT_CHANGE:var p=n.pinId,f=n.insId,v=n.parentInsId,m=n.type===o.DebuggerEventType.INPUT_CHANGE?"input":"output",y=f===e?(0,i.getMainPinDomId)(f,p,m):(0,i.getPinDomId)(v,f,p,m),h=document.getElementById(y),g="".concat(f,".").concat(p),b=n.type===o.DebuggerEventType.OUTPUT_CHANGE?document.querySelectorAll('[data-from-id="'.concat(g,'"]')):[];if(h){clearTimeout(t.cancelTimers.get(d)),h.removeAttribute("data-runtime"),b.forEach((function(e){e.removeAttribute("data-runtime")})),setTimeout((function(){h.setAttribute("data-runtime","active"),b.forEach((function(e){e.setAttribute("data-runtime","active")}))}),0);var I=setTimeout((function(){h.removeAttribute("data-runtime"),b.forEach((function(e){e.removeAttribute("data-runtime")})),t.cancelTimers.delete(d)}),a);t.cancelTimers.set(s(n),I)}else console.warn("No DOM element with Id [".concat(y,"] found to play event")),u("No DOM element with Id [".concat(y,"] found to play event"),n);break;case o.DebuggerEventType.PROCESSING_CHANGE:f=n.insId,v=n.parentInsId,y=(0,i.getInstanceDomId)(v,f);var P=null===(c=document.getElementById(y))||void 0===c?void 0:c.parentElement;if(!P)return void u("No DOM element with Id [".concat(y,"] found to play event"),n);if(!0===n.val)P.setAttribute("data-runtime","processing"),clearTimeout(t.cancelTimers.get(d));else{P.removeAttribute("data-runtime"),setTimeout((function(){P.setAttribute("data-runtime","done")}),0);I=setTimeout((function(){P.removeAttribute("data-runtime"),t.cancelTimers.delete(d)}),a);t.cancelTimers.set(d,I)}break;case o.DebuggerEventType.ERROR:f=n.insId,v=n.parentInsId,y=(0,i.getInstanceDomId)(v,f);var _=null===(l=document.getElementById(y))||void 0===l?void 0:l.parentElement;if(!_)return void u("No DOM element with Id [".concat(y,"] found to play event"),n);clearTimeout(t.cancelTimers.get(d)),_.removeAttribute("data-runtime"),setTimeout((function(){_.setAttribute("data-runtime","error")}));I=setTimeout((function(){_.removeAttribute("data-runtime"),t.cancelTimers.delete(d)}),a);t.cancelTimers.set(d,I);var O=r(r({},n),{type:o.DebuggerEventType.OUTPUT_CHANGE,pinId:o.ERROR_PIN_ID});(0,t.playEvent)(e,O);break;case o.DebuggerEventType.INPUTS_STATE_CHANGE:(0,o.entries)(n.val).forEach((function(e){var t=e[0],r=e[1],o=n.insId,a=n.parentInsId,s=(0,i.getPinDomId)(a,o,t,"input"),c=document.getElementById(s);c?r>0?c.setAttribute("data-runtime-queue","".concat(r)):c.removeAttribute("data-runtime-queue"):u("No DOM element with Id [".concat(s,"] found to play event"),n)}))}}},69385:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDebounce=void 0;var r=n(27378);t.useDebounce=function(e,t){var n=(0,r.useState)(e),o=n[0],i=n[1];return(0,r.useEffect)((function(){var n=setTimeout((function(){i(e)}),t);return function(){clearTimeout(n)}}),[e,t]),[o,i]}},13011:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.handleChangePartInputType=t.handleIoPinRename=t.handleInstanceDrag=t.getInstancesInRect=t.isJsxValue=t.fitViewPortToPart=t.centerBoardPosOnTarget=t.renderedPosToLogicalPos=t.logicalPosToRenderedPos=t.getEffectivePartDimensions=t.calcPartsPositions=t.calcSelectionBoxArea=t.animateViewPort=t.easeInOutNum=t.easeInOutPos=t.easeInOutQuad=t.center=t.distance=t.clamp=t.domToViewPort=t.roundNumber=t.createNewPartInstance=t.createNewInlinePartInstance=t.parseInputOutputTypes=t.parsePromptValue=t.getSelectionBoxRect=t.findClosestPin=t.toggleStickyPin=t.emptyList=t.emptyObj=void 0;var s=a(n(63300)),c=n(41304),l=n(18265),d=n(68488),p=n(18265),f=n(71462),v=n(80807),m=n(99743),y=n(52688),h=n(41756);t.emptyObj={},t.emptyList=[];t.toggleStickyPin=function(e,t,n,o){return s.produce(e,(function(e){var o=e.instances,i=o.find((function(e){return e.id===t}));if(!i)throw new Error("blah");var a=i.inputConfig||{},u=a[n]||(0,l.queueInputPinConfig)();(0,l.isStickyInputPinConfig)(u)?a[n]=(0,l.queueInputPinConfig)():a[n]=(0,l.stickyInputPinConfig)(),e.instances=o.map((function(e){return e===i?r(r({},i),{inputConfig:a}):e}))}))};t.findClosestPin=function(e,t,n,r,o,i){var a=(0,l.partInstance)(e.id,e.id),s=(0,p.okeys)(e.inputs).map((function(e){return{id:e,type:"input",pos:(0,d.calcMainInputPosition)(e,o,"input",r,i),ins:a}})),c=(0,p.okeys)(e.outputs).map((function(e){return{id:e,type:"output",pos:(0,d.calcMainOutputPosition)(e,o,"output",r,i),ins:a}})),f=e.instances.reduce((function(n,a){var s=(0,l.getPartDef)(a,t),c=(0,h.getVisibleInputs)(a,s,e.connections),p=(0,h.getVisibleOutputs)(a,s,e.connections),f=c.map((function(e){return{ins:a,type:"input",pos:(0,d.calcPinPosition)(o,a.id,e,"input",r,i),id:e}})),v=p.map((function(e){return{ins:a,type:"output",pos:(0,d.calcPinPosition)(o,a.id,e,"output",r,i),id:e}}));return u(u(u([],n,!0),f,!0),v,!0)}),[]),v=u(u(u([],s,!0),f,!0),c,!0),m={dis:1e5,item:v[0]};return v.forEach((function(e){var t=e.pos.x-n.x,r=e.pos.y-n.y,o=Math.sqrt(t*t+r*r);o<m.dis&&(m.dis=o,m.item=e)})),m.item};t.getSelectionBoxRect=function(e,t){var n=Math.min(e.x,t.x),r=Math.min(e.y,t.y);return{x:n,y:r,w:Math.max(e.x,t.x)-n,h:Math.max(e.y,t.y)-r}};t.parsePromptValue=function(e){if(null!==e){var t=parseInt(e,10),n=e;return t.toString()!=e||isNaN(t)||(n=t),n}};t.parseInputOutputTypes=function(e){var t=e.match(/part\((.+)\|(.+)\)/)||[],n=t[1],r=t[2],o=(0,p.entries)(JSON.parse(n)).map((function(e){var t=e[0],n={type:e[1],optional:(0,p.isOptionalType)(t)};return[t.replace(/\?$/,""),n]})),i=(0,p.entries)(JSON.parse(r)).map((function(e){var t=e[0],n={type:e[1],optional:(0,p.isOptionalType)(t)};return[t.replace(/\?$/,""),n]}));return{inputs:(0,p.fromEntries)(o),outputs:(0,p.fromEntries)(i)}};t.createNewInlinePartInstance=function(e,t,n){void 0===t&&(t=-1*c.PART_HEIGHT*1.5);var o=(0,l.inlinePartInstance)("".concat(e.id,"-").concat((0,p.randomInt)(999)),e,{},{x:0,y:0}),i=(0,f.calcPartWidth)(o,e),a={x:n.x-i/2,y:n.y+t};return r(r({},o),{pos:a})};t.createNewPartInstance=function(e,t,n,o){void 0===t&&(t=-1*c.PART_HEIGHT*1.5);var i="string"==typeof e?(0,l.getPartDef)(e,o):e;if(!i)throw new Error("".concat(e," part not found in repo"));var a=(0,p.entries)(i.inputs).reduce((function(e,t){var n=t[0],r=t[1];return r.defaultValue&&(e[n]=(0,l.staticInputPinConfig)(r.defaultValue)),e}),{}),u=(0,l.partInstance)("".concat(i.id,"-").concat((0,p.randomInt)(999)),i.id,a,{x:0,y:0}),s=(0,f.calcPartWidth)(u,i),d={x:n.x-s/2,y:n.y+t};return r(r({},u),{pos:d})};t.roundNumber=function(e){return Math.round(100*e)/100};t.domToViewPort=function(e,n,r){return{x:(0,t.roundNumber)(n.pos.x+e.x/n.zoom/r.zoom),y:(0,t.roundNumber)(n.pos.y+e.y/n.zoom/r.zoom)}};t.clamp=function(e,t,n){return Math.max(e,Math.min(t,n))};t.distance=function(e,t){var n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)};t.center=function(e,t,n){var r=n.zoom,o=e.x+e.w/2,i=e.y+e.h/2;return{x:o-t.w/r/2,y:i-t.h/r/2}};t.easeInOutQuad=function(e){return e<.5?2*e*e:(4-2*e)*e-1};t.easeInOutPos=function(e,n,r,o,i){var a=(0,t.clamp)(0,1,(i-r)/o),u=(0,t.easeInOutQuad)(a),s=n.x-e.x,c=n.y-e.y;return{x:e.x+s*u,y:e.y+c*u}};t.easeInOutNum=function(e,n,r,o,i){var a=(0,t.clamp)(0,1,(i-r)/o);return e+(n-e)*(0,t.easeInOutQuad)(a)};t.animateViewPort=function(e,n,r,o){var i=(0,t.distance)(e.pos,n.pos),a=Date.now(),u=r;if(0!==i){requestAnimationFrame((function r(){var i=Date.now(),s=(0,t.easeInOutPos)(e.pos,n.pos,a,u,i),c=(0,t.easeInOutNum)(e.zoom,n.zoom,a,u,i);i-a<u?(o({pos:s,zoom:c}),requestAnimationFrame(r)):o({pos:s,zoom:c})}))}else o(e)};t.calcSelectionBoxArea=function(e){var n=(0,t.getSelectionBoxRect)(e.from,e.to);return n.h*n.w};var g=function(e,t,n,o){return{left:n.x,right:n.x+e,top:n.y,bottom:n.y+t,tag:o,center:(0,l.calcCenter)(r({w:e,h:t},n))}};t.calcPartsPositions=function(e,t){var n=e.instances.map((function(e){var n=(0,f.calcPartWidth)(e,(0,l.getPartDef)(e,t)),r=c.PART_HEIGHT;return g(n,r,e.pos,e.id)})),r=(0,p.okeys)(e.inputs).map((function(t){var n=(0,v.calcPartIoWidth)(t),r=c.PART_HEIGHT,o=e.inputsPosition[t]||{x:0,y:0};return g(n,r,o,"input_"+t)})),o=(0,p.okeys)(e.outputs).map((function(t){var n=(0,v.calcPartIoWidth)(t),r=c.PART_HEIGHT,o=e.outputsPosition[t]||{x:0,y:0};return g(n,r,o,"output"+t)}));return u(u(u([],n,!0),r,!0),o,!0)};t.getEffectivePartDimensions=function(e,n){var o=(0,t.calcPartsPositions)(e,n),i=o[0]||{left:0,right:0,top:0,bottom:0},a=o.reduce((function(e,t){return t.left<e?t.left:e}),i.left),u=o.reduce((function(e,t){return t.right>e?t.right:e}),i.right),s=o.reduce((function(e,t){return t.top<e?t.top:e}),i.top),c=u-a,d=o.reduce((function(e,t){return t.bottom>e?t.bottom:e}),i.bottom)-s,p={x:a,y:s};return{size:{width:c,height:d},pos:p,center:(0,l.calcCenter)(r({w:c,h:d},p))}};t.logicalPosToRenderedPos=function(e,t){var n=(0,m.vSub)(e,t.pos);return(0,m.vMul)(n,t.zoom)};t.renderedPosToLogicalPos=function(e,t){var n=(0,m.vDiv)(e,t.zoom);return(0,m.vAdd)(t.pos,n)};t.centerBoardPosOnTarget=function(e,n,o,i){var a=(0,t.logicalPosToRenderedPos)(e,i),u=(0,t.renderedPosToLogicalPos)(a,r(r({},i),{zoom:o})),s=Math.max(e.x,u.x)-Math.min(e.x,u.x),c=Math.max(e.y,u.y)-Math.min(e.y,u.y);return{x:o>i.zoom?i.pos.x+s:i.pos.x-s,y:o>i.zoom?i.pos.y+c:i.pos.y-c}};t.fitViewPortToPart=function(e,n,r){var o=(0,t.getEffectivePartDimensions)(e,n),i=o.size,a=o.center,u=i.width+0,s=i.height+0,c=r.width/u,l=r.height/s,d=Math.min(c,l)/1.15,p=(0,t.clamp)(.3,1.2,d);return{zoom:p,pos:{x:a.x-r.width/2/p,y:a.y-r.height/2/p}}};t.isJsxValue=function(e){var t=function(e){return(0,p.isDefined)(e.ref)&&(0,p.isDefined)(e.type)&&(0,p.isDefined)(e.props)};try{var n=JSON.parse(e);return t(n)||Array.isArray(n)&&t(n[0])}catch(r){return!1}};t.getInstancesInRect=function(e,n,o,i,a,u,s){var d=e.from,p=e.to,v=(0,t.getSelectionBoxRect)(d,p);return a.filter((function(e){var t=e.pos,i=(0,f.calcPartWidth)(e,(0,l.getPartDef)(e,n))*o.zoom*s.zoom,a=r(r({},t),{w:i,h:c.PART_HEIGHT*o.zoom*s.zoom});return console.log(e.id,a,"main",v),(0,l.intersectRect)(v,a)||(0,l.intersectRect)(a,v)})).map((function(e){return e.id}))};t.handleInstanceDrag=function(e,t,n,r,o,i){r.preventDefault(),r.stopPropagation();var a,c=(0,m.vSub)(n,t.pos),l=s.produce(e,(function(e){var s=e.instances.find((function(e){return e.id===t.id}));if(!s)throw new Error("impossible state dragging instance that does not exist");!r.shiftKey&&i&&(a=[i]);var l=e.instances.filter((function(e){return o.includes(e.id)&&e!==s})),d=u([s],l,!0),p=(0,y.getLeafInstancesOfSelection)(d,e.instances,e.connections);u(u([],l,!0),p,!0).forEach((function(e){e.pos=(0,m.vAdd)(e.pos,c)})),s.pos=n,!r.shiftKey&&i&&(a=[i])}));return{newValue:l,newSelected:a}};t.handleIoPinRename=function(e,t,n,o){return s.produce(e,(function(e){"input"===t?(e.inputs[o]=e.inputs[n],e.inputsPosition[o]=e.inputsPosition[n],delete e.inputs[n],e.connections=e.connections.map((function(e){return(0,l.isExternalConnectionNode)(e.from)&&e.from.pinId===n?r(r({},e),{from:r(r({},e.from),{pinId:o})}):e}))):(e.outputs[o]=e.outputs[n],e.outputsPosition[o]=e.outputsPosition[n],e.connections=e.connections.map((function(e){return(0,l.isExternalConnectionNode)(e.to)&&e.to.pinId===n?r(r({},e),{to:r(r({},e.to),{pinId:o})}):e})),e.completionOutputs=(e.completionOutputs||[]).map((function(e){return e.split("+").map((function(e){return e===n?o:n})).join("+")})),delete e.outputs[n])}))};t.handleChangePartInputType=function(e,t,n){return s.produce(e,(function(e){var r=e.inputs[t];if(!r)throw new Error("Wat");r.mode=n}))}},17229:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorClient=void 0;var r=n(18265),o=n(14206),i=n(50208),a=n(19389),u=(0,r.debugLogger)("runtime-editor-client");t.createEditorClient=function(e,t){var n=new URL(e),r=(0,i.default)(n.origin,{path:"".concat("/"===n.pathname?"":n.pathname,"/socket.io/editor")});return r.emit("join-room-editor",t),{emitChange:function(e){r.emit(a.DebuggerServerEventType.CHANGE_EVENT_NAME,e)},emitBreakpointsChange:function(e){r.emit(a.DebuggerServerEventType.UPDATE_BREAKPOINTS,e)},interceptInput:function(e){r.emit(a.DebuggerServerEventType.INPUT_VALUE_OVERRIDE,e)},interceptOutput:function(e){r.emit(a.DebuggerServerEventType.OUTPUT_VALUE_OVERRIDE,e)},onRuntimeReady:function(e){return r.on(a.DebuggerServerEventType.RUNTIME_READY,e),function(){return r.off(a.DebuggerServerEventType.RUNTIME_READY,e)}},onChangeAwk:function(e){return r.on(a.DebuggerServerEventType.CHANGE_AWK,e),function(){return r.off(a.DebuggerServerEventType.CHANGE_AWK,e)}},onChangeError:function(e){return r.on(a.DebuggerServerEventType.CHANGE_ERROR,e),function(){return r.off(a.DebuggerServerEventType.CHANGE_ERROR,e)}},onIsAlive:function(e){return r.on(a.DebuggerServerEventType.IS_ALIVE,e),function(){return r.off(a.DebuggerServerEventType.IS_ALIVE,e)}},emitInputValue:function(e,t){u("Emitting push input value to ".concat(e," %o"),t),r.emit(a.DebuggerServerEventType.PUSH_INPUT_VALUE,{pinId:e,value:t})},destroy:function(){r.disconnect(),(0,a.enumToArray)(a.DebuggerServerEventType).forEach((function(e){return r.off(e)}))},onDisconnect:function(e){return r.on("disconnect",e),function(){return r.off("disconnect",e)}},debugInfo:function(){return"Remote debugger for ".concat(e)},onBatchedEvents:function(e){return r.on(a.DebuggerServerEventType.EVENTS_BATCH,e),function(){return r.off(a.DebuggerServerEventType.EVENTS_BATCH,e)}},requestState:function(){return o.default.get("".concat(e,"/state")).then((function(e){return e.data.state}))},getHistory:function(t){return o.default.get("".concat(e,"/history"),{params:{insId:t.insId,pinId:t.pinId,limit:t.limit}}).then((function(e){return e.data}))},clearHistory:function(){return o.default.delete("".concat(e,"/history")).then((function(){}))},triggerPart:function(t,n){return o.default.post("".concat(e,"/trigger"),{partId:t,inputs:n}).then((function(e){return e.data}))}}}},4278:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRuntimeClient=t.DEFAULT_DT_SCALE=void 0;var r=n(18265),o=n(50208),i=n(19389),a=(0,r.debugLogger)("debugger-runtime-client");t.DEFAULT_DT_SCALE=1;t.createRuntimeClient=function(e,t){var n=new URL(e),u=(0,o.io)(n.origin,{path:"".concat("/"===n.pathname?"":n.pathname,"/socket.io/runtime")});u.emit("join-room-runtime",t);new Set;u.on(i.DebuggerServerEventType.UPDATE_BREAKPOINTS,(function(e){new Set(e)}));Date.now();var s=(0,r.cappedArrayDebounce)((function(e){a("Emitting debounced batched events - ".concat(e.length)),u.emit(i.DebuggerServerEventType.EVENTS_BATCH,e)}),100,200),c={onChange:function(e){return u.on(i.DebuggerServerEventType.CHANGE_EVENT_NAME,e),function(){return u.off(i.DebuggerServerEventType.CHANGE_EVENT_NAME,e)}},onInput:function(e){return u.on(i.DebuggerServerEventType.PUSH_INPUT_VALUE,e),function(){return u.off(i.DebuggerServerEventType.PUSH_INPUT_VALUE,e)}},emitEvent:function(e){a("Emitting event ".concat(e.type," change event of ").concat(e.insId)),s.addItem(e)},emitRuntimeReady:function(){u.emit(i.DebuggerServerEventType.RUNTIME_READY,{})},emitChangeAwk:function(){u.emit(i.DebuggerServerEventType.CHANGE_AWK,{})},emitChangeError:function(e){u.emit(i.DebuggerServerEventType.CHANGE_ERROR,{error:e})},emitIsAlive:function(e){u.emit(i.DebuggerServerEventType.IS_ALIVE,{time:e})},destroy:function(){s.flush(),(0,i.enumToArray)(i.DebuggerServerEventType).forEach((function(e){return u.off(e)})),u.disconnect()},onDisconnect:function(e){return u.on("disconnect",e),function(){return u.off("disconnect",e)}}};return new Promise((function(e,t){u.connected?e(c):(u.on("connect_error",(function(e){t("Socket connect error: ".concat(e))})),u.on("connect",(function(){e(c)})))}))}},19389:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebuggerServerEventType=t.enumToArray=t.isNumber=t.isSimpleType=t.valuePreview=t.toString=void 0;var r=n(63726);t.toString=function(e){if("object"===typeof e){if(e instanceof Error)return JSON.stringify((0,r.serializeError)(e));try{return JSON.stringify(e).substr(0,250)}catch(t){return"Object (cannot stringify)"}}return"".concat(e).substr(0,250)};t.valuePreview=function(e){return(0,t.toString)(e).substr(0,100)};t.isSimpleType=function(e){return["number","string","boolean"].includes(typeof e)};t.isNumber=function(e){return!1===isNaN(Number(e))},t.enumToArray=function(e){return Object.keys(e).filter(t.isNumber).map((function(t){return e[t]}))},function(e){e.RUNTIME_READY="runtime-ready",e.CHANGE_EVENT_NAME="change",e.PUSH_INPUT_VALUE="push-input-value",e.CHANGE_AWK="live-change-awk",e.CHANGE_ERROR="live-change-error",e.IS_ALIVE="is-alive",e.UPDATE_BREAKPOINTS="update-breakpoints",e.INPUT_VALUE_OVERRIDE="input-value-override",e.OUTPUT_VALUE_OVERRIDE="output-value-override",e.INPUT_VALUE_CHANGE="input-value-changed",e.OUTPUT_VALUE_CHANGE="output-value-changed",e.PROCESSING_CHANGE="processing-changed",e.INPUTS_STATE_CHANGE="inputs-state-changed",e.PART_ERROR="part-error",e.EVENTS_BATCH="events-batch"}(t.DebuggerServerEventType||(t.DebuggerServerEventType={}))},75579:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(19389),t),o(n(17229),t),o(n(4278),t)},99186:function(e){e.exports={id:"Add",inputs:{n1:{mode:"required",type:"any"},n2:{mode:"required",type:"any"}},outputs:{sum:{type:"any"}},customViewCode:'<%= typeof inputs.n1 !== "undefined" ? inputs.n1 : "n1" %> + <%= typeof inputs.n2 !== "undefined" ? inputs.n2 : "n2" %>',completionOutputs:["sum"],fn:function(e,t,n){var r=e.n1,o=e.n2;t.sum.next(r+o)}}},58044:function(e){e.exports={id:"ListFrom3",inputs:{item1:{mode:"required",type:"any"},item2:{mode:"required",type:"any"},item3:{mode:"required",type:"any"}},outputs:{list:{type:"any"}},completionOutputs:["list"],fn:function(e,t,n){t.list.next([e.item1,e.item2,e.item3])}}},44163:function(e,t,n){var r=n(67651);e.exports={id:"Publish",inputs:{key:{mode:"required",type:"any"},value:{mode:"required",type:"any"}},outputs:{},fn:function(e,t,n){r.publish(e.key,e.value)}}},48842:function(e,t,n){var r=n(67651);e.exports={id:"Subscribe",inputs:{key:{mode:"required",type:"any"},initial:{mode:"required-if-connected",type:"any"}},outputs:{val:{type:"any"}},completionOutputs:["never"],fn:function(e,t,n){var o=r.subscribe(e.key,(function(e,n){t.val.next(n)}));void 0!==e.initial&&t.val.next(e.initial),n.onCleanup((function(){r.unsubscribe(o)}))}}},38941:function(e,t,n){"use strict";n.d(t,{I:function(){return O}});var r=n(27378),o=n(67651),i=n(59821),a=n(38944),u=n(96149),s=n(18265),c={VMScript:function(e){this.script=e},VM:function(){function e(e){this.context=e}return e.prototype.run=function(e){var t=(0,s.okeys)(this.context.sandbox),n=Object.values(this.context.sandbox);Function.apply(void 0,t.concat([e.script])).apply(void 0,n)},e}()},l=n(81884),d=n(44305),p=n(13127),f=200,v=n(60512),m=n(1706),y=n(12902),h=n(33099);n.g.vm2=c;var g,b,I=(b=new Map,{requestHistory:(g=(0,p.Z)((0,d.Z)().mark((function e(t,n,r){var o,i,a,u;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="input"===r?s.DebuggerEventType.INPUT_CHANGE:s.DebuggerEventType.OUTPUT_CHANGE,console.log({insId:t,pinId:n,type:o}),i=t+"."+n+"."+o,a=b.get(i)||{total:0,lastSamples:[]},u=a.lastSamples.slice(0,f),e.abrupt("return",Object.assign({},a,{lastSamples:u}));case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return g.apply(this,arguments)}),addEvents:function(e){e.forEach((function(e){if(e.type===s.DebuggerEventType.ERROR){var t=e;t.type=s.DebuggerEventType.OUTPUT_CHANGE,t.pinId=s.ERROR_PIN_ID}if(e.type===s.DebuggerEventType.INPUT_CHANGE||e.type===s.DebuggerEventType.OUTPUT_CHANGE){var n=e.insId,r=e.type,o=n+"."+e.pinId+"."+r,i=b.get(o)||{total:0,lastSamples:[]};i.lastSamples.unshift(e),i.lastSamples.length>f&&i.lastSamples.splice(f,i.lastSamples.length-f),i.total++,b.set(o,i)}}))}}),P=[{title:"Hello World",key:"hello-world"},{title:"React Counter",key:"react-counter"},{title:"BMI Calculator",key:"bmi"},{title:"REST API Usage",key:"apis"},{title:"Debounce vs. Throttling",key:"debounce-throttling"},{title:"Fibonacci Seq.",key:"fibonacci"}],_=function(e){var t,n,r=e.flow,i=e.output,a=e.inputs,u=e.onError,c=e.debugDelay,l=function(e,t){return{onEvent:function(n){console.info("Got debugger event",n),t.addEvents([n]),e.addEvents([n])}}}(e.player,I);l.debugDelay=c;var d=(0,s.keys)(r.main.outputs)[0];return(0,s.execute)({part:r.main,inputs:a,outputs:(t={},t[d]=i,t),partsRepo:Object.assign({},r.dependencies,(n={},n[r.main.id]=r.main,n)),_debugger:l,onBubbleError:function(e){u(e)},extraContext:{PubSub:o}})},O=function(e){var t=e.flowProps,n=t.flow,o=t.inputs,c=t.output,d=(0,r.useState)(e.initWidth||500),p=d[0],f=d[1],g=(0,r.useState)(e.defaultDelay||0),b=g[0],O=g[1],C=(0,r.useState)(!1),w=C[0],x=C[1],j=(0,r.useRef)((0,u.createRuntimePlayer)("root."+e.flowProps.flow.part.id)),E=(0,r.useState)(e.flowProps.resolvedFlow),S=E[0],D=E[1],k=(0,r.useState)({flow:n,boardData:{viewPort:{pos:{x:0,y:0},zoom:1},lastMousePos:{x:0,y:0},selected:[]}}),T=k[0],N=k[1];(0,r.useEffect)((function(){D((function(e){return Object.assign({},e,{main:T.flow.part})}))}),[T.flow.part]);var M={state:T,resolvedRepoWithDeps:S,onChangeEditorState:N,onInspectPin:s.noop,onRequestHistory:I.requestHistory,hideTemplatingTips:!0,onImportPart:s.noop,onExtractInlinePart:s.noop,onQueryImportables:s.noop};(0,r.useEffect)((function(){j.current.start()}),[]),(0,r.useEffect)((function(){var t=_({flow:S,output:c,inputs:o,onError:s.noop,debugDelay:b,player:j.current}),n=e.flowProps.output.subscribe((function(){return x(!0)}));return function(){t(),n.unsubscribe()}}),[b,S]);var R=(0,r.useCallback)((function(e,t){var n=t.size;f(n.width),N((function(e){var t=document.querySelector(".flow-container"),n=t?t.getBoundingClientRect():{width:500,height:500};return(0,y.ZP)(e,(function(e){e.boardData.viewPort=(0,u.fitViewPortToPart)(e.flow.part,S.dependencies,n)}))}))}),[]),A=r.createElement("div",{className:"delay-container"},r.createElement("input",{type:"range",id:"volume",name:"delay",value:b,step:"100",min:"0",max:"300",onChange:function(e){return O(Number(e.target.value))}}),r.createElement("label",{htmlFor:"volume"},"Debug Delay: ",b,"ms")),V=P.findIndex((function(t){return t.key===e.meta.key})),z=P[V+1],H=P[V-1];return r.createElement(i.Z,{title:e.meta.title+" | Playground",description:"Flyde Playground - "+e.meta.title+" example"},r.createElement("header",{className:(0,a.Z)("hero hero--primary",v.Z.heroBanner,"playground-hero")},r.createElement("div",{className:"container"},r.createElement("h1",{className:"hero__title"},"Welcome to Flyde's Online Playground"),r.createElement("p",{className:"hero__subtitle"},"Choose one of the examples below to get started. Feel free to play around with the canvas and see how your changes affect the result!"))),r.createElement("ul",{className:"examples__menu"},P.map((function(e){return r.createElement("li",{key:e.key},r.createElement(l.Z,{to:"/playground/"+e.key,className:"button button--primary"},e.title))}))),r.createElement("div",{className:"playground-container"},r.createElement("header",null,r.createElement("h2",{className:"playground-title"},e.meta.title),r.createElement("div",{className:"playground-description"},e.meta.description),w?r.createElement(r.Fragment,null,r.createElement("hr",null),r.createElement("div",{className:"playground-extra"},e.extraInfo||e.meta.extraInfo)):null,e.prefixComponent),r.createElement("div",{className:"playground"},r.createElement("div",{className:"flow-container"},!0!==e.hideDelay?A:null,r.createElement(h.Z,null,(function(){return r.createElement(u.FlowEditor,M)}))),r.createElement(m.Resizable,{height:0,width:p,onResize:R,axis:"x",handle:r.createElement("div",{className:"handle"}),resizeHandles:["w"]},r.createElement("div",{className:"output-container",style:{flexBasis:p}},e.children))),r.createElement("nav",{className:"pagination-nav"},r.createElement("div",{className:"pagination-nav__item"},H?r.createElement("a",{className:"pagination-nav__link",href:"/playground/"+H.key},r.createElement("div",{className:"pagination-nav__sublabel"},"Previous Example"),r.createElement("div",{className:"pagination-nav__label"},H.title)):null),r.createElement("div",{className:"pagination-nav__item pagination-nav__item--next"},z?r.createElement("a",{className:"pagination-nav__link",href:"/playground/"+z.key},r.createElement("div",{className:"pagination-nav__sublabel"},"Next Example"),r.createElement("div",{className:"pagination-nav__label"},z.title)):null))))}},18047:function(e,t,n){var r=n(93119);e.exports={id:"Button",inputs:{children:{type:"any",mode:"required"}},outputs:{jsx:{type:"any"},click:{type:"any"}},completionOutputs:["jsx"],fn:function(e,t){var n=r.createElement("button",{onClick:function(e){return t.click.next(e)},className:"button button--outline button--primary"},e.children);t.jsx.next(n)}}},20474:function(e,t,n){var r=n(93119);e.exports={id:"Span",inputs:{children:{type:"any",mode:"required"}},outputs:{jsx:{type:"any"}},completionOutputs:["jsx"],fn:function(e,t){var n=r.createElement("span",{},e.children);t.jsx.next(n)}}},66602:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var r=n(27378),o=n(18265),i=n(38941),a={resolvedFlow:{main:{instances:[{pos:{x:-115.26095214843747,y:226.5338534545898},id:"Button-410",inputConfig:{children:{mode:"static",value:"+"}},visibleInputs:["children"],partId:"Button",style:{size:"large",color:"#00bbf9"}},{pos:{x:-329.9831323242188,y:226.03836868286135},id:"Span-677",inputConfig:{children:{mode:"queue"}},visibleInputs:["children"],partId:"Span",style:{size:"large",color:"#9b5de5"}},{pos:{x:-350.2094360351563,y:412.6782791137695},id:"ListFrom3-404",inputConfig:{item1:{mode:"sticky"},item3:{mode:"sticky"},item2:{mode:"queue"}},partId:"ListFrom3",style:{size:"small"}},{pos:{x:-518.7030297851562,y:216.28152648925777},id:"Button-410-d44",inputConfig:{children:{mode:"static",value:"-"}},visibleInputs:["children"],partId:"Button",style:{size:"large",color:"#00bbf9"}},{pos:{x:-42.589892578125,y:414.4257174682617},id:"Publish-107",inputConfig:{key:{mode:"static",value:"inc"},value:{mode:"static",value:1}},visibleInputs:["key","value","__trigger"],partId:"Publish",style:{color:"#00bbf9"}},{pos:{x:-201.807001953125,y:-187.86253479003906},id:"Subscribe-896",inputConfig:{key:{mode:"static",value:"inc"}},partId:"Subscribe",style:{color:"#00f5d4"}},{pos:{x:-272.72882080078125,y:-9.603830566406259},id:"Add-138",inputConfig:{n1:{mode:"sticky"}},partId:"Add"},{pos:{x:-387.2609814453125,y:-186.2929638671875},id:"Subscribe-227",inputConfig:{key:{mode:"static",value:"value"},initial:{mode:"static",value:0}},partId:"Subscribe",style:{color:"#00f5d4"}},{pos:{x:-676.053251953125,y:420.80437835693357},id:"Publish-441",inputConfig:{key:{mode:"static",value:"inc"},value:{mode:"static",value:-1}},visibleInputs:["key","value","__trigger"],partId:"Publish",style:{color:"#00bbf9"}},{pos:{x:-122.10039184570314,y:113.89903961181642},id:"Publish-817-d15",inputConfig:{key:{mode:"static",value:"value"},value:{mode:"queue"}},visibleInputs:["value"],partId:"Publish",style:{color:"#00bbf9"}},{pos:{x:-393.0812890625,y:110.83120086669919},id:"Inline-value-Value is ${inp-308",inputConfig:{},part:{id:"Inline-value-${inputs.count",inputs:{count:{type:"any",mode:"required"}},outputs:{r:{type:"any",delayed:!1,optional:!1}},fnCode:"outputs.r.next((`${inputs.count}`))",customViewCode:"`${inputs.count}`",dataBuilderSource:"YCR7aW5wdXRzLmNvdW50fWA=",templateType:"value",completionOutputs:["r"],defaultStyle:{size:"small",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"300"}}}},{pos:{x:-416.83026611328125,y:12.137357788085978},id:"Inline-value-0-783",inputConfig:{},part:{id:"Inline-value-0",inputs:{},outputs:{r:{type:"any",delayed:!1,optional:!1}},fnCode:"outputs.r.next((0))",customViewCode:"0",dataBuilderSource:"MA==",templateType:"value",completionOutputs:["r"],defaultStyle:{size:"small",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"300"}}}}],connections:[{from:{insId:"Span-677",pinId:"jsx"},to:{insId:"ListFrom3-404",pinId:"item2"}},{from:{insId:"Button-410",pinId:"jsx"},to:{insId:"ListFrom3-404",pinId:"item3"}},{from:{insId:"Button-410-d44",pinId:"jsx"},to:{insId:"ListFrom3-404",pinId:"item1"}},{from:{insId:"ListFrom3-404",pinId:"list"},to:{insId:"__this",pinId:"jsx"}},{from:{insId:"Button-410",pinId:"click"},to:{insId:"Publish-107",pinId:"__trigger"}},{from:{insId:"Subscribe-896",pinId:"val"},to:{insId:"Add-138",pinId:"n2"}},{from:{insId:"Button-410-d44",pinId:"click"},to:{insId:"Publish-441",pinId:"__trigger"}},{from:{insId:"Subscribe-227",pinId:"val"},to:{insId:"Add-138",pinId:"n1"}},{from:{insId:"Inline-value-Value is ${inp-308",pinId:"r"},to:{insId:"Span-677",pinId:"children"}},{from:{insId:"Inline-value-0-783",pinId:"r"},to:{insId:"Inline-value-Value is ${inp-308",pinId:"count"}},{from:{insId:"Add-138",pinId:"sum"},to:{insId:"Inline-value-Value is ${inp-308",pinId:"count"}},{from:{insId:"Add-138",pinId:"sum"},to:{insId:"Publish-817-d15",pinId:"value"}}],id:"Main",inputs:{},outputs:{jsx:{type:"any"}},inputsPosition:{},outputsPosition:{jsx:{x:-283.81852447487364,y:588.5155366362267}},completionOutputs:["result"]},dependencies:{Button:{id:"Button",inputs:{children:{type:"any",mode:"required"}},outputs:{jsx:{type:"any"},click:{type:"any"}},completionOutputs:["jsx"],fn:n(18047).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/website/src/pages/playground/_flows/react-counter/Button.flyde.js",part:{id:"Button",inputs:{children:{type:"any",mode:"required"}},outputs:{jsx:{type:"any"},click:{type:"any"}},completionOutputs:["jsx"],fn:n(18047).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/website/src/pages/playground/_flows/react-counter/Button.flyde.js"}},Span:{id:"Span",inputs:{children:{type:"any",mode:"required"}},outputs:{jsx:{type:"any"}},completionOutputs:["jsx"],fn:n(20474).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/website/src/pages/playground/_flows/react-counter/Span.flyde.js",part:{id:"Span",inputs:{children:{type:"any",mode:"required"}},outputs:{jsx:{type:"any"}},completionOutputs:["jsx"],fn:n(20474).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/website/src/pages/playground/_flows/react-counter/Span.flyde.js"}},ListFrom3:{id:"ListFrom3",inputs:{item1:{mode:"required",type:"any"},item2:{mode:"required",type:"any"},item3:{mode:"required",type:"any"}},outputs:{list:{type:"any"}},completionOutputs:["list"],fn:n(58044).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/ListFrom3.flyde.js",part:{id:"ListFrom3",inputs:{item1:{mode:"required",type:"any"},item2:{mode:"required",type:"any"},item3:{mode:"required",type:"any"}},outputs:{list:{type:"any"}},completionOutputs:["list"],fn:n(58044).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/ListFrom3.flyde.js"}},Publish:{id:"Publish",inputs:{key:{mode:"required",type:"any"},value:{mode:"required",type:"any"}},outputs:{},fn:n(44163).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/Publish.flyde.js",part:{id:"Publish",inputs:{key:{mode:"required",type:"any"},value:{mode:"required",type:"any"}},outputs:{},fn:n(44163).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/Publish.flyde.js"}},Subscribe:{id:"Subscribe",inputs:{key:{mode:"required",type:"any"},initial:{mode:"required-if-connected",type:"any"}},outputs:{val:{type:"any"}},completionOutputs:["never"],fn:n(48842).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/Subscribe.flyde.js",part:{id:"Subscribe",inputs:{key:{mode:"required",type:"any"},initial:{mode:"required-if-connected",type:"any"}},outputs:{val:{type:"any"}},completionOutputs:["never"],fn:n(48842).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/Subscribe.flyde.js"}},Add:{id:"Add",inputs:{n1:{mode:"required",type:"any"},n2:{mode:"required",type:"any"}},outputs:{sum:{type:"any"}},customViewCode:'<%= typeof inputs.n1 !== "undefined" ? inputs.n1 : "n1" %> + <%= typeof inputs.n2 !== "undefined" ? inputs.n2 : "n2" %>',completionOutputs:["sum"],fn:n(99186).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/Add.flyde.js",part:{id:"Add",inputs:{n1:{mode:"required",type:"any"},n2:{mode:"required",type:"any"}},outputs:{sum:{type:"any"}},customViewCode:'<%= typeof inputs.n1 !== "undefined" ? inputs.n1 : "n1" %> + <%= typeof inputs.n2 !== "undefined" ? inputs.n2 : "n2" %>',completionOutputs:["sum"],fn:n(99186).fn,importPath:"/Users/gabrielgrinberg/projects/flyde/stdlib/parts/Add.flyde.js"}}}},flow:{imports:{"@flyde/stdlib":["ListFrom3","Boolean Split","Publish","Subscribe","Add","HtmlBtn"],"./Button.flyde.js":["Button"],"./Span.flyde.js":["Span"]},part:{instances:[{pos:{x:-115.26095214843747,y:226.5338534545898},id:"Button-410",inputConfig:{children:{mode:"static",value:"+"}},visibleInputs:["children"],partId:"Button",style:{size:"large",color:"#00bbf9"}},{pos:{x:-329.9831323242188,y:226.03836868286135},id:"Span-677",inputConfig:{children:{mode:"queue"}},visibleInputs:["children"],partId:"Span",style:{size:"large",color:"#9b5de5"}},{pos:{x:-350.2094360351563,y:412.6782791137695},id:"ListFrom3-404",inputConfig:{item1:{mode:"sticky"},item3:{mode:"sticky"},item2:{mode:"queue"}},partId:"ListFrom3",style:{size:"small"}},{pos:{x:-518.7030297851562,y:216.28152648925777},id:"Button-410-d44",inputConfig:{children:{mode:"static",value:"-"}},visibleInputs:["children"],partId:"Button",style:{size:"large",color:"#00bbf9"}},{pos:{x:-42.589892578125,y:414.4257174682617},id:"Publish-107",inputConfig:{key:{mode:"static",value:"inc"},value:{mode:"static",value:1}},visibleInputs:["key","value","__trigger"],partId:"Publish",style:{color:"#00bbf9"}},{pos:{x:-201.807001953125,y:-187.86253479003906},id:"Subscribe-896",inputConfig:{key:{mode:"static",value:"inc"}},partId:"Subscribe",style:{color:"#00f5d4"}},{pos:{x:-272.72882080078125,y:-9.603830566406259},id:"Add-138",inputConfig:{n1:{mode:"sticky"}},partId:"Add"},{pos:{x:-387.2609814453125,y:-186.2929638671875},id:"Subscribe-227",inputConfig:{key:{mode:"static",value:"value"},initial:{mode:"static",value:0}},partId:"Subscribe",style:{color:"#00f5d4"}},{pos:{x:-676.053251953125,y:420.80437835693357},id:"Publish-441",inputConfig:{key:{mode:"static",value:"inc"},value:{mode:"static",value:-1}},visibleInputs:["key","value","__trigger"],partId:"Publish",style:{color:"#00bbf9"}},{pos:{x:-122.10039184570314,y:113.89903961181642},id:"Publish-817-d15",inputConfig:{key:{mode:"static",value:"value"},value:{mode:"queue"}},visibleInputs:["value"],partId:"Publish",style:{color:"#00bbf9"}},{pos:{x:-393.0812890625,y:110.83120086669919},id:"Inline-value-Value is ${inp-308",inputConfig:{},part:{id:"Inline-value-${inputs.count",inputs:{count:{type:"any",mode:"required"}},outputs:{r:{type:"any",delayed:!1,optional:!1}},fnCode:"outputs.r.next((`${inputs.count}`))",customViewCode:"`${inputs.count}`",dataBuilderSource:"YCR7aW5wdXRzLmNvdW50fWA=",templateType:"value",completionOutputs:["r"],defaultStyle:{size:"small",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"300"}}}},{pos:{x:-416.83026611328125,y:12.137357788085978},id:"Inline-value-0-783",inputConfig:{},part:{id:"Inline-value-0",inputs:{},outputs:{r:{type:"any",delayed:!1,optional:!1}},fnCode:"outputs.r.next((0))",customViewCode:"0",dataBuilderSource:"MA==",templateType:"value",completionOutputs:["r"],defaultStyle:{size:"small",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"300"}}}}],connections:[{from:{insId:"Span-677",pinId:"jsx"},to:{insId:"ListFrom3-404",pinId:"item2"}},{from:{insId:"Button-410",pinId:"jsx"},to:{insId:"ListFrom3-404",pinId:"item3"}},{from:{insId:"Button-410-d44",pinId:"jsx"},to:{insId:"ListFrom3-404",pinId:"item1"}},{from:{insId:"ListFrom3-404",pinId:"list"},to:{insId:"__this",pinId:"jsx"}},{from:{insId:"Button-410",pinId:"click"},to:{insId:"Publish-107",pinId:"__trigger"}},{from:{insId:"Subscribe-896",pinId:"val"},to:{insId:"Add-138",pinId:"n2"}},{from:{insId:"Button-410-d44",pinId:"click"},to:{insId:"Publish-441",pinId:"__trigger"}},{from:{insId:"Subscribe-227",pinId:"val"},to:{insId:"Add-138",pinId:"n1"}},{from:{insId:"Inline-value-Value is ${inp-308",pinId:"r"},to:{insId:"Span-677",pinId:"children"}},{from:{insId:"Inline-value-0-783",pinId:"r"},to:{insId:"Inline-value-Value is ${inp-308",pinId:"count"}},{from:{insId:"Add-138",pinId:"sum"},to:{insId:"Inline-value-Value is ${inp-308",pinId:"count"}},{from:{insId:"Add-138",pinId:"sum"},to:{insId:"Publish-817-d15",pinId:"value"}}],id:"Main",inputs:{},outputs:{jsx:{type:"any"}},inputsPosition:{},outputsPosition:{jsx:{x:-283.81852447487364,y:588.5155366362267}},completionOutputs:["result"]}}},u=function(e){return r.createElement("div",{className:"output-jsx"},r.createElement("header",null,"Output JSX "),r.createElement("main",null,e.element))},s={title:"React Counter Example",description:'This examples how Flyde can be used to build functional reactive UIs using React! Each time the "jsx" output receives a new value, it is rendered to the output pane.',key:"react-counter",extraInfo:'Another powerful feature of Flyde is that a part can have more than 1 output. For example, "Button" outputs JSX, but also outputs "click" signals. Cool, right?'};function c(){var e,t,n=(0,r.useState)(r.createElement("div",null,"Loading")),c=n[0],l=n[1],d=(0,r.useRef)((e=function(e){return l(e)},(t=(0,o.dynamicOutput)()).subscribe(e),t)),p=(0,r.useRef)({}),f=(0,r.useState)({flow:a.flow,resolvedFlow:a.resolvedFlow,inputs:p.current,output:d.current}),v=f[0];f[1];return r.createElement(i.I,{meta:s,flowProps:v},r.createElement(u,{element:c}))}},60512:function(e,t){"use strict";t.Z={heroBanner:"heroBanner_qdFl",buttons:"buttons_AeoN","gh-stars-wrapper":"gh-stars-wrapper_LiAa","project-editor":"project-editor_XBpx",_hj_feedback_container:"_hj_feedback_container_Af03"}},95126:function(e,t,n){var r={"./af":1009,"./af.js":1009,"./ar":88769,"./ar-dz":23739,"./ar-dz.js":23739,"./ar-kw":93745,"./ar-kw.js":93745,"./ar-ly":99576,"./ar-ly.js":99576,"./ar-ma":67408,"./ar-ma.js":67408,"./ar-sa":48781,"./ar-sa.js":48781,"./ar-tn":87856,"./ar-tn.js":87856,"./ar.js":88769,"./az":2030,"./az.js":2030,"./be":56476,"./be.js":56476,"./bg":25304,"./bg.js":25304,"./bm":48125,"./bm.js":48125,"./bn":34,"./bn-bd":29835,"./bn-bd.js":29835,"./bn.js":34,"./bo":64082,"./bo.js":64082,"./br":8317,"./br.js":8317,"./bs":93107,"./bs.js":93107,"./ca":68272,"./ca.js":68272,"./cs":98567,"./cs.js":98567,"./cv":61583,"./cv.js":61583,"./cy":10076,"./cy.js":10076,"./da":31760,"./da.js":31760,"./de":8973,"./de-at":63214,"./de-at.js":63214,"./de-ch":74728,"./de-ch.js":74728,"./de.js":8973,"./dv":54053,"./dv.js":54053,"./el":7499,"./el.js":7499,"./en-au":67876,"./en-au.js":67876,"./en-ca":47010,"./en-ca.js":47010,"./en-gb":34239,"./en-gb.js":34239,"./en-ie":99830,"./en-ie.js":99830,"./en-il":28438,"./en-il.js":28438,"./en-in":25322,"./en-in.js":25322,"./en-nz":43264,"./en-nz.js":43264,"./en-sg":55449,"./en-sg.js":55449,"./eo":39486,"./eo.js":39486,"./es":32430,"./es-do":16310,"./es-do.js":16310,"./es-mx":27038,"./es-mx.js":27038,"./es-us":73099,"./es-us.js":73099,"./es.js":32430,"./et":34975,"./et.js":34975,"./eu":87063,"./eu.js":87063,"./fa":68073,"./fa.js":68073,"./fi":50957,"./fi.js":50957,"./fil":8764,"./fil.js":8764,"./fo":81775,"./fo.js":81775,"./fr":74179,"./fr-ca":14306,"./fr-ca.js":14306,"./fr-ch":73791,"./fr-ch.js":73791,"./fr.js":74179,"./fy":47014,"./fy.js":47014,"./ga":46911,"./ga.js":46911,"./gd":62958,"./gd.js":62958,"./gl":87344,"./gl.js":87344,"./gom-deva":33161,"./gom-deva.js":33161,"./gom-latn":35798,"./gom-latn.js":35798,"./gu":68485,"./gu.js":68485,"./he":27917,"./he.js":27917,"./hi":52159,"./hi.js":52159,"./hr":95842,"./hr.js":95842,"./hu":30005,"./hu.js":30005,"./hy-am":51312,"./hy-am.js":51312,"./id":60781,"./id.js":60781,"./is":64101,"./is.js":64101,"./it":43467,"./it-ch":4759,"./it-ch.js":4759,"./it.js":43467,"./ja":44164,"./ja.js":44164,"./jv":70079,"./jv.js":70079,"./ka":57036,"./ka.js":57036,"./kk":92022,"./kk.js":92022,"./km":63418,"./km.js":63418,"./kn":43655,"./kn.js":43655,"./ko":30986,"./ko.js":30986,"./ku":91902,"./ku.js":91902,"./ky":4604,"./ky.js":4604,"./lb":99026,"./lb.js":99026,"./lo":20537,"./lo.js":20537,"./lt":22288,"./lt.js":22288,"./lv":1495,"./lv.js":1495,"./me":60690,"./me.js":60690,"./mi":2571,"./mi.js":2571,"./mk":93959,"./mk.js":93959,"./ml":97225,"./ml.js":97225,"./mn":88,"./mn.js":88,"./mr":46622,"./mr.js":46622,"./ms":11070,"./ms-my":48899,"./ms-my.js":48899,"./ms.js":11070,"./mt":63931,"./mt.js":63931,"./my":95393,"./my.js":95393,"./nb":4274,"./nb.js":4274,"./ne":8914,"./ne.js":8914,"./nl":33114,"./nl-be":68479,"./nl-be.js":68479,"./nl.js":33114,"./nn":4513,"./nn.js":4513,"./oc-lnc":46549,"./oc-lnc.js":46549,"./pa-in":28264,"./pa-in.js":28264,"./pl":32848,"./pl.js":32848,"./pt":90899,"./pt-br":55077,"./pt-br.js":55077,"./pt.js":90899,"./ro":92512,"./ro.js":92512,"./ru":21753,"./ru.js":21753,"./sd":16840,"./sd.js":16840,"./se":78362,"./se.js":78362,"./si":50464,"./si.js":50464,"./sk":66324,"./sk.js":66324,"./sl":41963,"./sl.js":41963,"./sq":53039,"./sq.js":53039,"./sr":93454,"./sr-cyrl":10466,"./sr-cyrl.js":10466,"./sr.js":93454,"./ss":95158,"./ss.js":95158,"./sv":28859,"./sv.js":28859,"./sw":57594,"./sw.js":57594,"./ta":26915,"./ta.js":26915,"./te":15677,"./te.js":15677,"./tet":92154,"./tet.js":92154,"./tg":74098,"./tg.js":74098,"./th":89071,"./th.js":89071,"./tk":49381,"./tk.js":49381,"./tl-ph":1869,"./tl-ph.js":1869,"./tlh":92346,"./tlh.js":92346,"./tr":71483,"./tr.js":71483,"./tzl":30266,"./tzl.js":30266,"./tzm":33138,"./tzm-latn":32960,"./tzm-latn.js":32960,"./tzm.js":33138,"./ug-cn":29456,"./ug-cn.js":29456,"./uk":50805,"./uk.js":50805,"./ur":61127,"./ur.js":61127,"./uz":29628,"./uz-latn":80840,"./uz-latn.js":80840,"./uz.js":29628,"./vi":56962,"./vi.js":56962,"./x-pseudo":49257,"./x-pseudo.js":49257,"./yo":62423,"./yo.js":62423,"./zh-cn":61002,"./zh-cn.js":61002,"./zh-hk":6046,"./zh-hk.js":6046,"./zh-mo":36903,"./zh-mo.js":36903,"./zh-tw":24710,"./zh-tw.js":24710};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id=95126},91764:function(){}}]);