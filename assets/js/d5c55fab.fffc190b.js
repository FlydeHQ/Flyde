(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1988],{19121:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cappedArrayDebounce=void 0;t.cappedArrayDebounce=function(e,t,n,o){void 0===o&&(o=500);let i=[],s=null,r=null;return{addItem:a=>{clearTimeout(s),i.push(a),r||(r=setTimeout((()=>{e(i),clearTimeout(s),r=null}),o)),i.length>=n?(e(i),clearTimeout(r),r=null,i=[]):s=setTimeout((()=>{e(i),clearTimeout(r),r=null,i=[]}),t)},flush:()=>{i.length&&(e(i),i=[],clearTimeout(r))},pendingItems:()=>i.length}}},59792:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.dataShaper=t.DataShapeType=void 0,function(e){e[e.STRING=0]="STRING",e[e.NUMBER=1]="NUMBER",e[e.BOOLEAN=2]="BOOLEAN",e[e.ARRAY=3]="ARRAY",e[e.OBJECT=4]="OBJECT",e[e.NULL=5]="NULL",e[e.UNSUPPORTED=6]="UNSUPPORTED"}(n=t.DataShapeType||(t.DataShapeType={}));const o={string:n.STRING,number:n.NUMBER,boolean:n.BOOLEAN,object:n.OBJECT,array:n.ARRAY,null:n.NULL,symbol:n.UNSUPPORTED,undefined:n.UNSUPPORTED,function:n.UNSUPPORTED,bigint:n.UNSUPPORTED};t.dataShaper=function(e,n,i){void 0===n&&(n=5),void 0===i&&(i=5);const s=null===(r=e)?"null":typeof r;var r,a;if("object"===s){if(Array.isArray(e))return n>1?e.filter(((e,t)=>t<i)).map((e=>(0,t.dataShaper)(e,n-1,i))):o.array;if(n>1){const o={};for(const s in e)o[s]=(0,t.dataShaper)(e[s],n-1,i);return a=o,Object.keys(a).sort().reduce(((e,t)=>(e[t]=a[t],e)),{})}return o.object}return o[s]}},23046:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.debugLogger=void 0;const i=(0,o(n(55899)).default)("flyde");t.debugLogger=e=>i.extend(e)},24331:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fullInsIdPath=void 0,t.fullInsIdPath=function(e,t){if(!e)throw new Error("insId is not defined");return t?`${t}.${e}`:e}},34459:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.hashFlow=t.hashNode=void 0;const i=o(n(68805)),s=n(30292),r=e=>(0,i.default)(e);t.hashNode=function(e,t){var n;void 0===t&&(t=!0);const{id:o,completionOutputs:i,reactiveInputs:a,inputs:u,outputs:l}=e,c={id:o,completionOutputs:i,reactiveInputs:a,inputs:u,outputs:l};if((0,s.isVisualNode)(e)){const{instances:n,connections:o,inputsPosition:i,outputsPosition:s}=e,a=n.map((e=>{const{pos:t,...n}=e;return n})),u=t?{}:{inputsPosition:i,outputsPosition:s},l=t?a:n;l.sort(((e,t)=>e.id.localeCompare(t.id)));const d=[...o];d.sort(((e,t)=>{const n=`${e.from.insId}.${e.from.pinId}`,o=`${t.from.insId}.${t.from.pinId}`;return n.localeCompare(o)}));const p=JSON.stringify({instancesToUse:l,conns:d,...c,maybeIoPos:u});return r(p)}if((0,s.isInlineValueNode)(e)){const{customViewCode:t}=e,o=null!==(n=e.fnCode)&&void 0!==n?n:e.runFnRawCode,i=JSON.stringify({fnCode:o,customViewCode:t,...c});return r(i)}throw new Error("Hashing code nodes unsupported")};t.hashFlow=e=>{const{node:n,imports:o}=e,i=(0,t.hashNode)(n,!1),s=Object.entries(null!=o?o:{}).sort(((e,t)=>{let[n]=e,[o]=t;return n.localeCompare(o)})).map((e=>{let[t,n]=e;return[t,n.sort()]})).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o}}),{}),a=JSON.stringify(s);return r(i+a)}},86873:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.DepGraph=void 0,i(n(3172),t),i(n(59962),t),i(n(23046),t),i(n(19121),t),i(n(59962),t),i(n(34459),t),i(n(39043),t),i(n(59792),t),i(n(24331),t),t.DepGraph=n(60359).DepGraph},3172:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testDataCreator=void 0;t.testDataCreator=e=>function(t){void 0===t&&(t={});return{..."function"==typeof e?e():e,...t}}},59962:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simplePluralize=t.eventually=t.delay=t.noop=t.removeDupes=t.ensure=t.isOptionalType=t.callFnOrFnPromise=t.isPromise=t.isDefined=t.containsAll=t.shuffle=t.randomInts=t.repeat=t.pickRandom=t.randomPos=t.randomInt=t.pickSecond=t.pickFirst=t.fromEntries=t.entries=t.okeys=t.values=t.keys=t.filterOMap=t.mapOMap=t.middlePos=t.calcCenter=t.intersectRect=void 0;t.intersectRect=(e,t)=>{const n=e.x+e.w,o=t.x+t.w;return!(t.x>n||o<e.x||t.y>e.y+e.h||t.y+t.h<e.y)};t.calcCenter=e=>{let{w:t,h:n,x:o,y:i}=e;return{x:o+t/2,y:i+n/2}};t.middlePos=(e,t)=>({x:(e.x+t.x)/2,y:(e.y+t.y)/2});t.mapOMap=(e,n)=>(0,t.entries)(e).map((e=>{let[t,o]=e;return[t,n(t,o)]})).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o}}),{});t.filterOMap=(e,n)=>(0,t.entries)(e).filter((e=>{let[t,o]=e;return n(t,o)})).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o}}),{});t.keys=e=>Object.keys(e);t.values=e=>Object.values(e),t.okeys=t.keys;t.entries=e=>(0,t.okeys)(e).map((t=>[t,e[t]]));t.fromEntries=e=>e.reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o}}),{});t.pickFirst=e=>e[0];t.pickSecond=e=>e[1];t.randomInt=function(e,t){void 0===t&&(t=0);const n=Math.random();return t+Math.floor((e-t)*n)};t.randomPos=function(e,n){void 0===e&&(e=1e3),void 0===n&&(n=0);return{x:(0,t.randomInt)(e,n),y:(0,t.randomInt)(e,n)}};t.pickRandom=e=>e[(0,t.randomInt)(e.length)];t.repeat=(e,t)=>"x".repeat(e).split("").map(((e,n)=>t(n)));t.randomInts=function(e,n,o){return void 0===n&&(n=100),void 0===o&&(o=0),(0,t.repeat)(e,(()=>(0,t.randomInt)(n,o)))};t.shuffle=e=>{const t=[...e];for(let n=t.length-1;n>=0;n--){const e=Math.floor(Math.random()*(n+1));[t[n],t[e]]=[t[e],t[n]]}return t};t.containsAll=(e,t)=>t.every((t=>e.includes(t)));t.isDefined=e=>void 0!==e;t.isPromise=e=>e&&"function"==typeof e.then;t.callFnOrFnPromise=(e,n)=>{if(!(0,t.isDefined)(e))return;const o=e=>{try{e()}catch(t){console.error(n,t)}};"function"==typeof e?o(e):Promise.resolve(e).then((e=>{"function"==typeof e&&o(e)}))};t.isOptionalType=e=>/\?$/.test(e);t.ensure=(e,t)=>{if(void 0===e)throw new Error(t||"Undefined value passed");return e};t.removeDupes=e=>Array.from(new Set(e));t.noop=()=>{};t.delay=e=>new Promise((t=>setTimeout(t,e)));t.eventually=async function(e,n,o,i){if(void 0===n&&(n=1e3),void 0===o&&(o=100),void 0===i&&(i=new Set),n<0){const e=Array.from(i).reduce(((e,t,n)=>`${e}\n\t\t${n+1}. ${t}`),"");throw new Error(`[Eventually timeout exceeded after: timeout with error]: ${e}`)}try{await e()}catch(s){const r=Date.now();await(0,t.delay)(o);const a=Date.now()-r;return i.add(null==s?void 0:s.message),(0,t.eventually)(e,n-a,o,i)}},t.simplePluralize=function(e,t){return`${e} ${t}${1!==e?"s":""}`}},39043:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compileObjectTemplate=t.compileStringTemplate=void 0;t.compileStringTemplate=(e,t)=>{let n=decodeURIComponent(e);return Object.keys(t).forEach((e=>{const o=t[e],i=new RegExp("\\$\\{"+e+"\\}","g");n=n.replace(i,o)})),n};t.compileObjectTemplate=(e,t)=>{let n=decodeURIComponent(e);return Object.keys(t).forEach((e=>{const o=t[e],i=JSON.stringify(o),s=new RegExp('"\\$\\$\\{'+e+'\\}"',"g"),r=new RegExp("\\$\\{"+e+"\\}","g"),a="string"==typeof o?o.replace(/"/g,((e,t,n)=>"\\"!==n[t-1]?'\\"':n[t])):o;n=n.replace(s,i).replace(r,a).replace(/\n/g,"\\n")})),JSON.parse(n)}},69150:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.connection=t.connectionData=t.connectionDataEquals=t.connectionNodeEquals=t.connectionNode=t.externalConnectionNode=t.isInternalConnection=t.isExternalConnection=t.isInternalConnectionNode=t.isExternalConnectionNode=t.getNodeOutputs=t.getOutputName=t.getInputName=t.getNodeInputs=t.TRIGGER_PIN_ID=t.ERROR_PIN_ID=t.THIS_INS_ID=void 0;const o=n(30292);t.THIS_INS_ID="__this",t.ERROR_PIN_ID="__error",t.TRIGGER_PIN_ID="__trigger";t.getNodeInputs=e=>({...e.inputs,[t.TRIGGER_PIN_ID]:(0,o.nodeInput)()});t.getInputName=e=>e===t.TRIGGER_PIN_ID?"Trigger Node":e;t.getOutputName=e=>e===t.ERROR_PIN_ID?"Error":e;t.getNodeOutputs=e=>({...e.outputs,[t.ERROR_PIN_ID]:(0,o.nodeOutput)()});t.isExternalConnectionNode=e=>e&&e.insId===t.THIS_INS_ID;t.isInternalConnectionNode=e=>e.insId!==t.THIS_INS_ID;t.isExternalConnection=e=>{let{from:n,to:o}=e;return(0,t.isExternalConnectionNode)(n)||(0,t.isExternalConnectionNode)(o)};t.isInternalConnection=e=>!(0,t.isExternalConnection)(e);t.externalConnectionNode=e=>({insId:t.THIS_INS_ID,pinId:e});t.connectionNode=(e,t)=>({insId:e,pinId:t});t.connectionNodeEquals=(e,t)=>e.insId===t.insId&&e.pinId===t.pinId;t.connectionDataEquals=(e,n)=>!(!e||!n)&&((0,t.connectionNodeEquals)(e.from,n.from)&&(0,t.connectionNodeEquals)(e.to,n.to)),t.connectionData=function(e,n,o){const i="string"==typeof e?e.split("."):e,s="string"==typeof n?n.split("."):n;if(i.length>2||s.length>2)throw new Error(`invalid source or target to connection data - ${e} / ${n}`);return{from:2===i.length?(0,t.connectionNode)(i[0],i[1]):(0,t.externalConnectionNode)(i[0]),to:2===s.length?(0,t.connectionNode)(s[0],s[1]):(0,t.externalConnectionNode)(s[0]),delayed:o}};t.connection=function(e,t,n){return void 0===n&&(n=!1),{from:e,to:t,delayed:n}}},6775:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.connect=void 0;const s=n(30292),r=n(47025),a=n(86873),u=n(69150);i(n(69150),t);t.connect=function(e,t,n,o,i,l,c,d){void 0===n&&(n={}),void 0===i&&(i={}),void 0===l&&(l=a.noop),void 0===c&&(c={}),void 0===d&&(d={});const{id:p,connections:f,instances:m}=e,g=p||"connected-node"+(0,a.randomInt)(999);return{inputs:e.inputs,outputs:e.outputs,id:g,completionOutputs:e.completionOutputs,reactiveInputs:e.reactiveInputs,run:(p,v)=>{let h=[];const I=new a.DepGraph({}),y=new Map,b=new Map,C=new Map,_=new Map,x=new Map,N=new Map;let j;const w=new Set;m.forEach((e=>{const n=(0,s.getNode)(e,t),o=e.id;y.set(e,o),b.set(o,e),I.addNode(o);const i=Object.keys(n.inputs),r=Object.keys(n.outputs),a={},l={};i.forEach((t=>{const n=(e.inputConfig||{})[t]||(0,s.queueInputPinConfig)();(0,s.isStaticInputPinConfig)(n)?a[t]=(0,s.staticNodeInput)(n.value):a[t]=(0,s.dynamicNodeInput)({config:n})})),a[u.TRIGGER_PIN_ID]=(0,s.dynamicNodeInput)({config:(0,s.queueInputPinConfig)()});if(f.some((t=>(0,u.isInternalConnectionNode)(t.to)&&t.to.insId===e.id&&t.to.pinId===u.TRIGGER_PIN_ID))&&e.inputConfig&&e.inputConfig[u.TRIGGER_PIN_ID])throw"Trigger connection can not be configured";r.forEach((e=>{const t=(0,s.dynamicOutput)();l[e]=t}));f.some((t=>(0,u.isInternalConnectionNode)(t.from)&&t.from.insId===e.id&&t.from.pinId===u.ERROR_PIN_ID))&&(l[u.ERROR_PIN_ID]=(0,s.dynamicOutput)()),C.set(o,a),_.set(o,l)}));const P=new Set;return f.forEach((n=>{const{from:o,to:i}=n,{insId:r,pinId:a}=o,{insId:l,pinId:c}=i,d=_.get(r),p=C.get(l);if((0,u.isInternalConnectionNode)(i)&&P.add(`${i.insId}.${i.pinId}`),(0,u.isExternalConnection)(n)){if((0,u.isExternalConnectionNode)(o)){const e=null==p?void 0:p[i.pinId];if(!e)throw new Error(`Input ${i.pinId} of instance ${l} not found`);const t=x.get(o.pinId)||[];t.push(e),x.set(o.pinId,t)}else{let e=null==d?void 0:d[o.pinId];if(!e)throw new Error(`Output ${o.pinId} of instance ${r} not found`);const t=N.get(i.pinId)||[];t.push(e),N.set(i.pinId,t)}return}if(!d)throw new Error(`No outputs found for instance [${r}]`);if(!p)throw b.has(l)?new Error(`No inputs found for instance [${l}]`):new Error(`Instance with id [${l}] does not exist!`);const f=d[a];if(!f)throw console.log(a),new Error(`Output source - [${a}] not found in node [${g}]`);const m=p[c],v=b.get(r);if(!v&&r!==u.THIS_INS_ID)throw new Error(`Instance [${r}] does not exist! failed to connect [${o}] -> [${i}]`);const y=(v?(0,s.getNode)(v,t):e).outputs[a];if(y&&y.delayed||n.delayed||r!==u.THIS_INS_ID&&l!==u.THIS_INS_ID&&I.addDependency(r,l),!m)throw new Error(`Target arg - [${i}] not found in node [${g}]`);const j=f.subscribe((async e=>{if(!(0,s.isDynamicInput)(m))throw console.info(m),new Error(`Impossible state listening to non dynamic input - ${l}.${c}`);m.subject.next(e)}));h.push((()=>j.unsubscribe()))})),(0,a.okeys)(v).forEach((e=>{(N.get(e)||[]).forEach((t=>{const n=t.subscribe((async t=>{if(!v[e])throw new Error(`Impossible state - output ${e} does not exist`);v[e].next(t)}));h.push((()=>n.unsubscribe()))}))})),I.overallOrder().map((e=>b.get(e))).forEach((e=>{const a=C.get(e.id),u=_.get(e.id),p=(0,s.getNode)(e,t);if(!a)throw new Error(`Unexpected error - args not found when running ${e}`);if(!u)throw new Error(`Unexpected error - outputs not found when running ${e}`);for(const t in a){const n=e.inputConfig[t];P.has(`${e.id}.${t}`)||(0,s.isStaticInputPinConfig)(n)||delete a[t]}const f=(0,r.execute)({node:p,inputs:a,outputs:u,resolvedDeps:t,_debugger:n,insId:e.id,extraContext:d,mainState:i,ancestorsInsIds:o,onBubbleError:l,onCompleted:()=>{return t=e.id,w.delete(t),void(0===w.size&&j&&j());var t},onStarted:()=>{return t=e.id,void w.add(t);var t},env:c});h.push(f)})),Object.keys(p).forEach((async e=>{(x.get(e)||[]).forEach((t=>{const n=p[e];if(!(0,s.isDynamicInput)(t))throw new Error(`Unsure what to do with key ${e}, input: ${t} of ins ${o}`);(0,a.isDefined)(n)&&t.subject.next(n)}))})),void 0===e.completionOutputs&&w.size>0?new Promise((e=>{j=e})):()=>h.forEach((e=>{try{e()}catch(t){console.error("error unsubscribing",t)}}))}}}},26488:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MINOR_DEBUGGER_EVENT_TYPES=t.MAJOR_DEBUGGER_EVENT_TYPES=t.DebuggerEventType=void 0,function(e){e.INPUT_CHANGE="i",e.OUTPUT_CHANGE="o",e.PROCESSING_CHANGE="pc",e.ERROR="err",e.INPUTS_STATE_CHANGE="isc"}(n=t.DebuggerEventType||(t.DebuggerEventType={})),t.MAJOR_DEBUGGER_EVENT_TYPES=[n.INPUT_CHANGE,n.OUTPUT_CHANGE,n.ERROR],t.MINOR_DEBUGGER_EVENT_TYPES=[n.PROCESSING_CHANGE,n.INPUTS_STATE_CHANGE]},43686:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatEvent=void 0;const o=n(26488);t.formatEvent=function(e){var t,n,i;const s=[e.insId,...null!==(n=null===(t=e.ancestorsInsIds)||void 0===t?void 0:t.split("."))&&void 0!==n?n:[]];(null===(i=e.ancestorsInsIds)||void 0===i?void 0:i.length)>0&&e.ancestorsInsIds;const r=`Node <${e.nodeId}> `,a=`(${s.join(" -> ")})`;return`${r} - ${function(e){switch(e.type){case o.DebuggerEventType.PROCESSING_CHANGE:return e.val?"started processing":"stopped processing";case o.DebuggerEventType.INPUT_CHANGE:return`Input pin <${e.pinId}> changed to ${e.val}`;case o.DebuggerEventType.OUTPUT_CHANGE:return`Output pin <${e.pinId}> changed to ${e.val}`;case o.DebuggerEventType.INPUTS_STATE_CHANGE:return`Inputs queue size changed to ${Object.entries(e.val).map((e=>{let[t,n]=e;return`${t}: ${n}`})).join(", ")}`;case o.DebuggerEventType.ERROR:return`Error: ${e.val}`}}(e)} ${a}`}},99896:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(26488),t),i(n(43686),t)},47025:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.execute=t.GLOBAL_STATE_NS=t.ROOT_INS_ID=t.INPUTS_STATE_SUFFIX=t.INNER_STATE_SUFFIX=void 0;const s=n(62600),r=n(87794);i(n(99896),t);const a=n(30292),u=n(6775),l=n(84479),c=n(86873),d=n(23046),p=n(30292),f=n(99896),m=n(79804);t.INNER_STATE_SUFFIX="_inner",t.INPUTS_STATE_SUFFIX="_inputs";t.ROOT_INS_ID="__root",t.GLOBAL_STATE_NS="____global";t.execute=e=>{let{node:n,inputs:o,outputs:i,resolvedDeps:g,_debugger:v={},insId:h=t.ROOT_INS_ID,extraContext:I={},mainState:y={},ancestorsInsIds:b,onBubbleError:C=s.noop,env:_={},onCompleted:x=s.noop,onStarted:N=s.noop}=e;const j=[];y[t.GLOBAL_STATE_NS]||(y[t.GLOBAL_STATE_NS]=new Map);const w={...I,ENV:_},P=(0,m.customNodesToNodesCollection)(g,w),O=e=>{const t=e instanceof a.NodeInstanceError?e:new a.NodeInstanceError(e,(0,c.fullInsIdPath)(h,b),n.id);v.onEvent&&v.onEvent({type:f.DebuggerEventType.ERROR,val:t,insId:h,ancestorsInsIds:b,nodeId:n.id}),i[u.ERROR_PIN_ID]?i[u.ERROR_PIN_ID].next(t):C(t)},E=(e=>(0,a.isVisualNode)(e)?(0,u.connect)(e,P,v,(0,c.fullInsIdPath)(h,b),y,O,_,I):(0,a.isInlineValueNode)(e)?(0,m.inlineValueNodeToNode)(e,w):e)(n),D=v.onEvent||s.noop,S={},M={};(0,c.entries)(o).forEach((e=>{let[t,o]=e;if((0,a.isDynamicInput)(o)){const e=(0,a.dynamicNodeInput)({config:o.config}),i=o.subject.subscribe((async o=>{const i=D({type:f.DebuggerEventType.INPUT_CHANGE,insId:h,pinId:t,val:o,ancestorsInsIds:b,nodeId:n.id});if(i){const t=await i.valuePromise;e.subject.next(t)}else v.debugDelay&&await(0,c.delay)(v.debugDelay),e.subject.next(o)}));j.push((()=>i.unsubscribe())),M[t]=e}else{D({type:f.DebuggerEventType.INPUT_CHANGE,insId:h,pinId:t,val:o.config.value,ancestorsInsIds:b,nodeId:n.id});const e=(0,a.staticNodeInput)((0,a.getStaticValue)(o.config.value,P,h));M[t]=e}})),(0,c.entries)(i).forEach((e=>{let[t,o]=e;const i=(0,a.dynamicOutput)(),s=i.subscribe((async e=>{const i=D({type:f.DebuggerEventType.OUTPUT_CHANGE,insId:h,pinId:t,val:e,ancestorsInsIds:b,nodeId:n.id});if(i){const e=await i.valuePromise;o.next(e)}else o.next(e)}));j.push((()=>s.unsubscribe())),S[t]=i}));const T=(e=>{var n,o;const{node:i,inputs:u,outputs:m,resolvedDeps:g,_debugger:v,insId:h,ancestorsInsIds:I,mainState:y,onError:b,onStarted:C,onCompleted:_,env:x,extraContext:N}=e,{run:j,fn:w}=i,P=(0,d.debugLogger)("core"),O=[];let E;const D=(null==v?void 0:v.onEvent)||s.noop,S=(0,c.fullInsIdPath)(h,I),M=`${S}${t.INNER_STATE_SUFFIX}`,T=`${S}${t.INPUTS_STATE_SUFFIX}`,k=P.extend(S),A=y[t.GLOBAL_STATE_NS];y[M]||(y[M]=new Map),y[T]||(y[T]=new Map);let R=null!==(n=y[T])&&void 0!==n?n:new Map;const V=()=>{const e=Array.from(R.entries()).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:(0,a.isQueueInputPinConfig)(u[n].config)?null==o?void 0:o.length:1}}),{});D({type:f.DebuggerEventType.INPUTS_STATE_CHANGE,val:e,insId:h,ancestorsInsIds:I,nodeId:i.id})},z={execute:(e,n,o,i)=>(0,t.execute)({node:e,inputs:n,outputs:o,resolvedDeps:g,_debugger:v,insId:i,onCompleted:_,onStarted:C}),insId:h,state:null!==(o=y[M])&&void 0!==o?o:new Map,onCleanup:e=>{O.push(e)},onError:e=>{b(e)},context:null!=N?N:{},ancestorsInsIds:I,globalState:A};let $,H=!1;const G=(i.reactiveInputs||[]).filter((e=>{var t;return!(0,p.isStaticInputPinConfig)(null===(t=u[e])||void 0===t?void 0:t.config)})),L=()=>{var e;null===(e=y[M])||void 0===e||e.clear(),(0,c.keys)(y).filter((e=>e.startsWith(`${S}.`))).forEach((e=>{y[e]=new Map}))},B=e=>{const t=(null==e?void 0:e.key)&&G.includes(null==e?void 0:e.key);if(H&&!t);else{const o=H&&t;if((0,l.isNodeStateValid)(u,R,i)||o){let t;if(H){if(!e)throw new Error("Unexpected state,  got reactive node while not processing and not valid");const n=(0,l.pullValueForExecution)(e.key,u[e.key],R,x);t={...$,[e.key]:n},V()}else t=(0,l.pullValuesForExecution)(u,R,x),$=t,V();let o=new Set,s={};if(H=!0,D({type:f.DebuggerEventType.PROCESSING_CHANGE,val:H,insId:h,ancestorsInsIds:I,nodeId:i.id}),i.completionOutputs){const e=i.completionOutputs.map((e=>e.split("+"))).reduce(((e,t)=>(t.forEach((n=>{e.set(n,t)})),e)),new Map);(0,c.entries)(m).forEach((t=>{let[n,a]=t;a.pipe((0,r.first)()).subscribe((t=>{o.add(n),s[n]=t;let r=e.get(n);r&&(r.splice(r.indexOf(n),1),0===r.length&&(H=!1,D({type:f.DebuggerEventType.PROCESSING_CHANGE,val:H,insId:h,ancestorsInsIds:I,nodeId:i.id}),_&&_(s),L(),(0,c.callFnOrFnPromise)(E,`Error with cleanup function of ${i.id}`),E=void 0,o.clear(),s={},(0,l.hasNewSignificantValues)(u,R,x,i.id)&&B()))}))}))}else(0,c.entries)(m).forEach((e=>{let[t,n]=e;n.subscribe((e=>{s[t]=e}))}));try{k("Running node %s with values %o",i.id,t),C&&C(),E=(null!=w?w:j)(t,m,z),(0,c.isPromise)(E)?E.then((()=>{void 0===i.completionOutputs&&_&&(H=!1,D({type:f.DebuggerEventType.PROCESSING_CHANGE,val:H,insId:h,ancestorsInsIds:I,nodeId:i.id}),_(s),L(),(0,l.hasNewSignificantValues)(u,R,x,i.id)&&B())})).catch((e=>{b(e),H=!1,k("Error in node %s - value %e",i.id,e),D({type:f.DebuggerEventType.PROCESSING_CHANGE,val:H,insId:h,ancestorsInsIds:I,nodeId:i.id})})):void 0===i.completionOutputs&&_&&(H=!1,D({type:f.DebuggerEventType.PROCESSING_CHANGE,val:H,insId:h,ancestorsInsIds:I,nodeId:i.id}),_(s),L())}catch(n){b(n),H=!1,k("Error in node %s - value %e",i.id,n),D({type:f.DebuggerEventType.PROCESSING_CHANGE,val:H,insId:h,ancestorsInsIds:I,nodeId:i.id})}const d=G.find((e=>u[e]&&(0,l.peekValueForExecution)(e,u[e],R,x,i.id)));if(d){const e=(0,l.peekValueForExecution)(d,u[d],R,x,i.id);B({key:d,value:e})}else{const e=(0,c.entries)(u).find((e=>{let[t,n]=e;const o=(0,a.isQueueInputPinConfig)(n.config),s=(0,l.peekValueForExecution)(t,n,R,x,i.id);return!!o&&(0,c.isDefined)(s)}));if(e){const[t,n]=e,o=(0,l.peekValueForExecution)(t,n,R,x,i.id);B({key:t,value:o})}}}}};B();const F=(0,l.subscribeInputsToState)(u,R,((e,t)=>{P("Got input %s - value is [%o]",e,t),V();try{B({key:e,value:t})}catch(n){b(n)}}));return O.push(F),()=>{(0,c.callFnOrFnPromise)(E,`Error with cleanup function of ${i.id}`),O.forEach((e=>e()))}})({node:E,inputs:M,outputs:S,resolvedDeps:P,_debugger:v,insId:h,mainState:y,ancestorsInsIds:b,onError:O,onBubbleError:C,env:_,extraContext:I,onCompleted:x,onStarted:N});return()=>{j.forEach((e=>e())),T()}}},84479:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeInputsToState=t.isNodeStateValid=t.hasNewSignificantValues=t.peekValuesForExecution=t.pullValuesForExecution=t.pullValueForExecution=t.peekValueForExecution=void 0;const o=n(30292),i=n(86873),s=n(6775),r=(e,t)=>{const n=(0,o.extractStaticValue)(e);if((0,o.isEnvValue)(n)){return((e,t)=>{const n=e.split(".");let o={...t};for(let s of n){if(!o||!(0,i.isDefined)(o[s])||null===o[s])throw new Error(`Cannot find key ${e} inside obj ${t}`);o=o[s]}return o})((0,o.getEnvKeyFromValue)(n),t)}return n};t.peekValueForExecution=(e,t,n,i,s)=>{const a=n.get(e);let u;if(!t)throw new Error(`Trying to peek value of inexsting input in key "${e}" in node "${s}"`);return u=(0,o.isStaticInput)(t)?r(t,i):(0,o.isQueueInputPinConfig)(t.config)?a?[...a].shift():void 0:a,u};t.pullValueForExecution=(e,t,n,i)=>{const s=n.get(e);let a;return(0,o.isStaticInput)(t)?a=r(t,i):(0,o.isQueueInputPinConfig)(t.config)?(a=(s||[]).shift(),n.set(e,s)):(a=s,(0,o.isStickyInputPinConfig)(t.config)||n.delete(e)),a};t.pullValuesForExecution=(e,n,o)=>(0,i.entries)(e).reduce(((e,i)=>{let[s,r]=i;return e[s]=(0,t.pullValueForExecution)(s,r,n,o),e}),{});t.peekValuesForExecution=(e,n,o,s)=>(0,i.entries)(e).reduce(((e,i)=>{let[r,a]=i;return e[r]=(0,t.peekValueForExecution)(r,a,n,o,s),e}),{});t.hasNewSignificantValues=(e,n,s,r)=>(0,i.entries)(e).some((e=>{let[a,u]=e;const l=(0,o.isQueueInputPinConfig)(u.config),c=(0,t.peekValueForExecution)(a,u,n,s,r);return(0,i.isDefined)(c)&&l}));t.isNodeStateValid=(e,t,n)=>{const r=(0,i.keys)(e),a=(0,i.keys)(n.inputs).filter((e=>{var t;const o=null===(t=n.inputs[e])||void 0===t?void 0:t.mode;return!o||"required"===o}));r.includes(s.TRIGGER_PIN_ID)&&a.push(s.TRIGGER_PIN_ID);return!!(0,i.containsAll)(r,a)&&(0,i.entries)(e).filter((e=>{let[t]=e;return!!n.inputs[t]||t===s.TRIGGER_PIN_ID})).every((e=>{let[s,r]=e;var a;const u=t.get(s);return"optional"===((null===(a=n.inputs[s])||void 0===a?void 0:a.mode)||"required")||(!!(0,o.isStaticInput)(r)||((0,o.isQueueInputPinConfig)(r.config)?(0,i.isDefined)(u)&&u.length>0:(0,i.isDefined)(u)))}))};t.subscribeInputsToState=(e,t,n)=>{const s=[];return(0,i.entries)(e).forEach((e=>{let[i,r]=e;if(!r)return;if((0,o.isStaticInput)(r))return;const a=r.subject.subscribe((e=>{if((0,o.isQueueInputPinConfig)(r.config)){const o=t.get(i)||[];if(!Array.isArray(o))throw new Error(`impossible state - state of key ${i} is set but not an array`);o.push(e),t.set(i,o),n(i,e)}else t.set(i,e),n(i,e)}));s.push((()=>a.unsubscribe()))})),()=>s.forEach((e=>e()))}},5474:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flydeFlowSchema=void 0;const o=n(29022),i=o.z.record(o.z.string(),o.z.string().or(o.z.array(o.z.string()))),s=o.z.strictObject({x:o.z.number(),y:o.z.number()}),r=o.z.discriminatedUnion("mode",[o.z.strictObject({mode:o.z.literal("static"),value:o.z.any()}),o.z.strictObject({mode:o.z.literal("queue")}),o.z.strictObject({mode:o.z.literal("sticky")})]),a=o.z.object({size:o.z.optional(o.z.enum(["small","regular","large"])),icon:o.z.optional(o.z.any()),color:o.z.optional(o.z.string()),cssOverride:o.z.optional(o.z.record(o.z.string()))}),u=o.z.object({pos:s.default({x:0,y:0}),id:o.z.string(),inputConfig:o.z.optional(o.z.record(o.z.string(),r)).default({}),visibleInputs:o.z.optional(o.z.array(o.z.string())),visibleOutputs:o.z.optional(o.z.array(o.z.string())),nodeId:o.z.optional(o.z.string()),node:o.z.optional(o.z.any()),style:o.z.optional(a)}).refine((e=>e.node||e.nodeId),{message:"Instance must have either an inline node or refer to a nodeId"}),l=o.z.union([o.z.string(),o.z.object({mode:o.z.enum(["required","optional","required-if-connected"]),type:o.z.optional(o.z.string()),description:o.z.optional(o.z.string()),defaultValue:o.z.optional(o.z.any())})]),c=o.z.object({type:o.z.optional(o.z.string()),optional:o.z.optional(o.z.boolean()),delayed:o.z.optional(o.z.boolean()),description:o.z.optional(o.z.string())}),d=o.z.object({id:o.z.optional(o.z.string()),inputs:o.z.record(o.z.string(),l),outputs:o.z.record(o.z.string(),c),inputsPosition:o.z.optional(o.z.record(o.z.string(),s)),outputsPosition:o.z.optional(o.z.record(o.z.string(),s)),customViewCode:o.z.optional(o.z.string()),dataBuilderSource:o.z.optional(o.z.string()),templateType:o.z.optional(o.z.string()),completionOutputs:o.z.optional(o.z.array(o.z.string())),reactiveInputs:o.z.optional(o.z.array(o.z.string())),defaultStyle:o.z.optional(a),description:o.z.optional(o.z.string()),searchKeywords:o.z.optional(o.z.array(o.z.string()))}),p=o.z.object({instances:o.z.array(u),connections:o.z.array(o.z.strictObject({from:o.z.strictObject({insId:o.z.string(),pinId:o.z.string()}),to:o.z.strictObject({insId:o.z.string(),pinId:o.z.string()}),delayed:o.z.optional(o.z.boolean()),hidden:o.z.optional(o.z.boolean())}))}).and(d);t.flydeFlowSchema=o.z.strictObject({imports:o.z.optional(i).default({}),node:p})},74762:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.isStaticValueVisualNode=void 0,i(n(86873),t);const s=n(30292);i(n(6775),t),i(n(47025),t),i(n(10418),t),i(n(30292),t),i(n(3320),t),i(n(79804),t),i(n(98133),t),i(n(5474),t);t.isStaticValueVisualNode=e=>!!e&&!!(0,s.maybeGetStaticValueNodeId)(`${e}`)},87093:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fakeVm=t.VM=t.VMScript=void 0;const o=n(86873);class i{constructor(e){this.script=e}}t.VMScript=i;class s{constructor(e){this.context=e}run(e){const t=(0,o.okeys)(this.context.sandbox),n=Object.values(this.context.sandbox);Function(...t,e.script)(...n)}}t.VM=s,t.fakeVm={VMScript:i,VM:s}},28145:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVM2Instance=void 0;const o=n(87093);t.getVM2Instance=()=>o.fakeVm},79804:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.customNodesToNodesCollection=t.inlineValueNodeToNode=void 0;const i=o(n(18706)),s=n(86873),r=n(30292),a=(0,n(28145).getVM2Instance)();t.inlineValueNodeToNode=function(e,t){void 0===t&&(t={});const{runFnRawCode:n,...o}=e,u=(0,s.debugLogger)(`code-node:${e.id}`),l=`\n  try {\n    ${n}\n  } catch (e) {\n    adv.onError(e);\n  }\n  `,c=new a.VMScript(l),d={...o,run:(n,o,l)=>{const d=new a.VM({sandbox:{inputs:n,outputs:o,setInterval:setInterval,clearInterval:clearInterval,setTimeout:setTimeout,clearTimeout:clearTimeout,encodeURIComponent:encodeURIComponent,adv:l,log:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];u(`Log from code node ${e.id} [${l.insId}]`,...n)},axios:i.default,DEFAULT_AXIOS_TIMEOUT:15e3,dynamicNodeInput:r.dynamicNodeInput,dynamicNodeArg:r.dynamicNodeInput,dynamicOutput:r.dynamicOutput,isDefined:s.isDefined,compileStringTemplate:s.compileStringTemplate,compileObjectTemplate:s.compileObjectTemplate,process:{env:{}},...t}});d.run(c)}};return d};t.customNodesToNodesCollection=function(e,n){void 0===n&&(n={});const o={};for(let i in e){const s=e[i];o[i]=(0,r.isInlineValueNode)(s)?(0,t.inlineValueNodeToNode)(s,n):s}return o}},3320:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeWithDependencies=void 0;const o=n(30292),i=n(74762),s=n(88270);t.getNodeWithDependencies=function(e,n,r){if(void 0===r&&(r=[]),(0,o.isInlineValueNode)(e))return[e];if(r.includes(e.id))return[];const a=(0,i.removeDupes)(e.instances.filter((e=>(0,s.isRefNodeInstance)(e))).map((e=>e.nodeId)).filter((e=>n[e])));return[e,...a.flatMap((e=>{var t;return null!==(t=n[e])&&void 0!==t?t:[]})).reduce(((e,o)=>[...e,...(0,t.getNodeWithDependencies)(o,n,[...r,...a])]),[])]}},30292:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(88270),t),i(n(43069),t),i(n(79426),t),i(n(44535),t),i(n(18063),t),i(n(20359),t)},18063:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeInstanceError=void 0;class n extends Error{constructor(e,t,n){let o="Unknown error";o="string"==typeof e?e:e instanceof Error?e.message:null!==e&&"object"==typeof e?JSON.stringify(e):String(e),super(`${o} (insId: ${t}, nodeId: ${n})`),this.name=this.constructor.name,this.message=`${o} (insId: ${t}, nodeId: ${n})`,Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.fullInsIdsPath=t,this.nodeId=n}}t.NodeInstanceError=n},88270:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInsId=t.NodeInstance=t.isRefNodeInstance=t.isInlineNodeInstance=t.inlineNodeInstance=t.nodeInstance=void 0;const o=n(36618);t.nodeInstance=(e,t,n,o)=>({id:e,nodeId:t,inputConfig:n||{},pos:o||{x:0,y:0}});t.inlineNodeInstance=(e,t,n,o)=>({id:e,node:t,inputConfig:n||{},pos:o||{x:0,y:0}});t.isInlineNodeInstance=e=>!!e.node;t.isRefNodeInstance=e=>!(0,t.isInlineNodeInstance)(e);t.NodeInstance=(e,t,n,o)=>({id:e,nodeId:t.id,inputConfig:n||{},pos:o||{x:0,y:0}});t.createInsId=e=>`${e.id}-${(0,o.slug)()}`},43069:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnvKeyFromValue=t.toEnvValue=t.isEnvValue=t.extractStaticValue=t.isStaticInput=t.isDynamicInput=t.staticNodeInput=t.dynamicNodeInputs=t.dynamicNodeInput=t.dynamicOutput=t.nodeOutputs=t.nodeOutput=t.nodeInputs=t.isInputPinOptional=t.nodeInput=void 0;const o=n(62600),i=n(30292),s=n(86873),r=n(79426);t.nodeInput=function(e){return void 0===e&&(e="required"),{mode:e}};t.isInputPinOptional=e=>"optional"===e.mode;t.nodeInputs=(e,n)=>(0,s.repeat)(e,(e=>(0,t.nodeInput)((null==n?void 0:n[e])||"required")));t.nodeOutput=function(e){return void 0===e&&(e=!1),{delayed:e}};t.nodeOutputs=e=>(0,s.repeat)(e,(()=>(0,t.nodeOutput)()));t.dynamicOutput=()=>new o.Subject,t.dynamicNodeInput=(0,s.testDataCreator)((()=>({subject:new o.Subject,config:(0,r.queueInputPinConfig)()})));t.dynamicNodeInputs=function(e){return void 0===e&&(e=10),(0,s.repeat)(e,(()=>(0,s.testDataCreator)((()=>({subject:new o.Subject,config:(0,r.queueInputPinConfig)()})))()))};t.staticNodeInput=e=>({config:(0,r.staticInputPinConfig)(e)});t.isDynamicInput=e=>{const t=e;return t&&t.subject&&!!t.subject.next};t.isStaticInput=e=>(0,i.isStaticInputPinConfig)(null==e?void 0:e.config);t.extractStaticValue=e=>{if((0,t.isStaticInput)(e))return e.config.value;throw new Error("Cannot extract static value from non static arg")};t.isEnvValue=e=>"string"==typeof e&&e.startsWith("$ENV.");t.toEnvValue=e=>`$ENV.${e}`;t.getEnvKeyFromValue=e=>"string"==typeof e?e.replace(/^\$ENV\./,""):e},20359:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codeFromFunction=t.getNodeDef=t.getNode=t.getStaticValue=t.maybeGetStaticValueNodeId=t.fromSimplified=t.inlineValueNode=t.codeNode=t.visualNode=t.isInlineValueNode=t.isVisualNode=t.isCodeNode=t.isBaseNode=t.InlineValueNodeType=void 0;const o=n(86873),i=n(88270),s=n(43069);!function(e){e.VALUE="value",e.FUNCTION="function"}(t.InlineValueNodeType||(t.InlineValueNodeType={}));t.isBaseNode=e=>e&&e.id&&e.inputs&&e.outputs;t.isCodeNode=e=>(0,t.isBaseNode)(e)&&"function"==typeof e.run;t.isVisualNode=e=>!!e.instances;t.isInlineValueNode=e=>(0,o.isDefined)(e)&&(0,o.isDefined)(e.runFnRawCode),t.visualNode=(0,o.testDataCreator)({id:"visual-node",inputs:{},outputs:{},instances:[],connections:[],outputsPosition:{},inputsPosition:{}}),t.codeNode=(0,o.testDataCreator)({id:"node",inputs:{},outputs:{},run:o.noop}),t.inlineValueNode=(0,o.testDataCreator)({id:"node",inputs:{},outputs:{},runFnRawCode:""});t.fromSimplified=e=>{let{run:t,inputTypes:n,outputTypes:i,id:s}=e;return{id:s,inputs:(0,o.entries)(n).reduce(((e,t)=>{let[n]=t;return{...e,[n]:{}}}),{}),outputs:(0,o.entries)(i).reduce(((e,t)=>{let[n]=t;return{...e,[n]:{}}}),{}),run:t}};t.maybeGetStaticValueNodeId=e=>{const t="string"==typeof e&&e.match(/^__node\:(.*)/);if(t){return t[1]}return null};t.getStaticValue=(e,n,o)=>{const i=(0,t.maybeGetStaticValueNodeId)(e);if(i){const e=n[i];if(!e)throw new Error(`Instance ${o} referrer to a node reference ${i} that does not exist`);return e}return e};t.getNode=(e,t)=>{if("string"!=typeof e&&(0,i.isInlineNodeInstance)(e))return e.node;const n="string"==typeof e?e:e.nodeId,o=t[n];if(!o)throw new Error(`Node with id ${n} not found`);return o};t.getNodeDef=(e,t)=>{if("string"!=typeof e&&(0,i.isInlineNodeInstance)(e))return e.node;const n="string"==typeof e?e:e.nodeId,o=t[n];if(!o)throw console.error(`Node with id ${n} not found`),new Error(`Node with id ${n} not found`);return o};t.codeFromFunction=e=>{let{id:t,fn:n,inputNames:o,outputName:i,defaultStyle:r}=e;return{id:t,inputs:o.reduce(((e,t)=>({...e,[t]:(0,s.nodeInput)()})),{}),outputs:{[i]:(0,s.nodeOutput)()},run:(e,t)=>{const s=o.map((t=>e[t])),r=t[i],a=n(...s);return Promise.resolve(a).then((e=>null==r?void 0:r.next(e)))},completionOutputs:[i],defaultStyle:r}}},44535:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nodeFromSimpleFunction=void 0,t.nodeFromSimpleFunction=function(e){var t;return{...e,id:e.id,description:e.description,namespace:e.namespace,inputs:e.inputs?e.inputs.reduce(((e,t)=>{let{name:n,description:o,mode:i,defaultValue:s}=t;return{...e,[n]:{description:o,mode:null!=i?i:"required",defaultValue:s}}}),{}):{},outputs:e.output?{[e.output.name]:{description:e.output.description}}:{},defaultStyle:{icon:e.icon,size:e.size},run:null!==(t=e.fullRunFn)&&void 0!==t?t:async function(t,n,o){var i,s;const r=(null!==(i=e.inputs)&&void 0!==i?i:[]).map((e=>{let{name:n}=e;return t[n]}));try{const t=await Promise.resolve(e.run(...r));e.output&&(null===(s=n[e.output.name])||void 0===s||s.next(t))}catch(a){console.error("Error in node",a),o.onError(a)}},customViewCode:e.customViewCode}}},79426:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isStaticInputPinConfig=t.isStickyInputPinConfig=t.isQueueInputPinConfig=t.staticInputPinConfig=t.stickyInputPinConfig=t.queueInputPinConfig=t.INPUT_MODES=void 0,t.INPUT_MODES=["queue","sticky","static"];t.queueInputPinConfig=()=>({mode:"queue"});t.stickyInputPinConfig=()=>({mode:"sticky"});t.staticInputPinConfig=e=>({mode:"static",value:e});t.isQueueInputPinConfig=e=>"queue"===e.mode;t.isStickyInputPinConfig=e=>!!e&&"sticky"===e.mode,t.isStaticInputPinConfig=function(e){return!!e&&"static"===e.mode}},10418:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simplifiedExecute=void 0;const o=n(74762),i=n(47025);t.simplifiedExecute=function(e,t,n,s,r){void 0===r&&(r={});const a=(0,o.keys)(e.outputs),u=Object.keys(n).reduce(((e,t)=>{const i=n[t];return{...e,[t]:(0,o.isDynamicInput)(i)?i:(0,o.staticNodeInput)(i)}}),{}),l=a.reduce(((e,t)=>{const n=(0,o.dynamicOutput)();return s&&n.subscribe((e=>{s(t,e)})),{...e,[t]:n}}),{});return(0,i.execute)({node:e,inputs:u,outputs:l,resolvedDeps:t,onBubbleError:e=>{throw e},...r})}},98133:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isScheduledTrigger=t.isRestApiTrigger=t.isWebAppTrigger=void 0;t.isWebAppTrigger=e=>"web-app"===e.type;t.isRestApiTrigger=e=>"rest-api"===e.type;t.isScheduledTrigger=e=>"scheduled"===e.type},25779:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodePreview=void 0;const o=n(35250),i=n(74762),s=n(86553);t.NodePreview=e=>{let{node:t}=e;const n={node:t,instance:(0,i.nodeInstance)("bob",t.id,{}),connections:[],viewPort:{pos:{x:0,y:0},zoom:1},resolvedDeps:{},connectionsPerInput:{},onUngroup:i.noop,onDblClick:i.noop,onDragEnd:i.noop,onDragMove:i.noop,onDragStart:i.noop,onPinClick:i.noop,onPinDblClick:i.noop,onSelect:i.noop,onTogglePinBreakpoint:i.noop,onTogglePinLog:i.noop,onToggleSticky:i.noop,displayMode:!0,onInspectPin:i.noop,onDetachConstValue:i.noop,onCopyConstValue:i.noop,onPasteConstValue:i.noop,ancestorsInsIds:"",onChangeVisibleInputs:i.noop,onChangeVisibleOutputs:i.noop,onConvertConstToEnv:i.noop,forceShowMinimized:"both",onExtractInlineNode:i.noop,onCloseInlineEditor:i.noop,isConnectedInstanceSelected:!1,inlineEditorPortalDomNode:null,onChangeStyle:i.noop,onDeleteInstance:i.noop,onGroupSelected:i.noop,onSetDisplayName:i.noop,hadError:!1,queuedInputsData:{},onPinMouseDown:i.noop,onPinMouseUp:i.noop};return(0,o.jsx)("div",{className:"node-preview",children:(0,o.jsx)(s.InstanceView,{...n})})}},29183:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DataInspectionModal=void 0;const a=n(35250),u=n(50382),l=r(n(26372)),c=s(n(70079)),d=n(74089),p=n(83938),f=n(17102),m=n(98158);t.DataInspectionModal=e=>{var t;const{onRequestHistory:n}=(0,m.useDebuggerContext)(),{item:o}=e,[i,s]=c.default.useState(),[r,g]=c.default.useState(0),[v,h]=c.default.useState(""),[I,y]=c.default.useState(),[b]=(0,d.useDebounce)(v,300);(0,c.useEffect)((()=>{y(null==i?void 0:i.lastSamples.filter((e=>"object"==typeof e.val?JSON.stringify(e.val).includes(b):e.val.toString().includes(b)))),g(0)}),[null==i?void 0:i.lastSamples,b]),c.default.useEffect((()=>{!async function(){var e,t;const i=await n(o.insId,null===(e=o.pin)||void 0===e?void 0:e.id,null===(t=o.pin)||void 0===t?void 0:t.type);s(i)}()}),[o,n]);const C=e=>{const t=e.val;return"object"==typeof t?(0,a.jsx)(p.BrowserOnlyReactJson,{src:t}):(0,a.jsx)(u.Code,{children:t.toString()})},_=`"${o.insId}" ${(null===(t=o.pin)||void 0===t?void 0:t.id)?`(${o.pin.id})`:""}`;return(0,a.jsx)(u.Dialog,{isOpen:!0,title:`Inspecting data for instance ${_}`,onClose:e.onClose,canEscapeKeyClose:!1,className:"data-inspection-modal",children:(0,a.jsx)("main",{className:(0,l.default)(u.Classes.DIALOG_BODY),tabIndex:0,children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("header",{children:[i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("em",{children:[_," called ",i.total," time(s)"]}),i.total>10&&(0,a.jsx)("span",{children:"Showing last 10 samples"})]}):null,(0,a.jsx)("input",{className:"bp5-input bp5-small bp5-fill",type:"search",placeholder:"Search for values",dir:"auto",onChange:e=>h(e.target.value),value:v}),b.length>0&&(0,a.jsxs)("span",{children:["Showing ",null==I?void 0:I.length," of ",i.lastSamples.length," ",'samples matching query "',b,'"']})]}),(0,a.jsx)("main",{className:"main-wrapper",children:(()=>{if(!i)return(0,a.jsx)(f.Loader,{});if(0===i.total)return(0,a.jsxs)(u.Callout,{intent:"warning",children:["No events captured for instance ",(0,a.jsx)("em",{children:o.insId})," ",o.pin?(0,a.jsxs)(c.default.Fragment,{children:["and pin ",(0,a.jsx)("em",{children:o.pin.id})]}):null,". Make sure debugger is running and your program was triggered."]});const e=null==I?void 0:I[r];return e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.Card,{className:"content-wrapper",children:[e?(0,a.jsxs)("div",{className:"info",children:[(0,a.jsxs)("div",{children:["Showing sample ",r," of event from"," ",(0,a.jsx)("strong",{children:(0,d.timeAgo)(e.time)})," (",new Date(e.time).toLocaleString(),")"]}),(0,a.jsxs)("div",{children:["Instance: ",(0,a.jsx)("strong",{children:e.insId}),", Pin id:"," ",(0,a.jsx)("strong",{children:e.pinId})," "]}),(0,a.jsx)("div",{children:"Value:"})]}):null,C(e)]}),(0,a.jsx)(u.Menu,{className:"samples-menu",children:I.map(((e,t)=>{const n=e.pinId,o=`${i.total-t}. from pin "${n}"`;return(0,a.jsx)(u.MenuItem,{text:o,onClick:()=>g(t)},t)}))})]}):i.lastSamples.length>0&&v.length>0?(0,a.jsxs)(u.Callout,{intent:"warning",children:['No data found for search query "',v,'"']}):(0,a.jsxs)(u.Callout,{intent:"warning",children:["No events captured for instance ",o.insId," ",o.pin?`and ${o.pin.id}`:"",". Make sure a debugger is connected and your program was triggered."]})})()})]})})})}},40471:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(29183),t)},98158:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDebuggerContext=t.DebuggerContextProvider=void 0;const o=n(70079),i=(0,o.createContext)({onRequestHistory:()=>Promise.reject(new Error("Not implemented"))});t.DebuggerContextProvider=i.Provider;t.useDebuggerContext=()=>(0,o.useContext)(i)},86125:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDependenciesContext=t.DependenciesContextProvider=void 0;const o=n(70079),i=(0,o.createContext)({resolvedDependencies:{},onImportNode:()=>Promise.reject(new Error("Not implemented")),onRequestImportables:()=>Promise.reject(new Error("Not implemented"))});t.DependenciesContextProvider=i.Provider;t.useDependenciesContext=()=>(0,o.useContext)(i)},97106:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FlowEditor=void 0;const u=n(35250),l=s(n(70079)),c=n(74762),d=n(63521),p=a(n(53865)),f=n(68120),m=n(7047),g=n(84472),v=n(82232),h=n(49283),I=n(43490),y=n(68840),b=n(78087),C=n(20079),_=n(60190),x=n(40471),N=n(98158),j=n(86125);r(n(43490),t),r(n(98158),t),r(n(86125),t),y.library.add(b.fab,C.fas);const w=["select","drag-move","order-step"];console.log({rendering:!0,React1:l.version}),t.FlowEditor=l.memo(l.forwardRef(((e,t)=>{const{state:n,onChangeEditorState:o}=e,{resolvedDependencies:i,onImportNode:s}=(0,j.useDependenciesContext)(),[r,a]=l.useState([]),[y,b]=l.useState([]),{flow:C,boardData:P}=n,O=n.flow.node,[E,D]=l.useState({}),[S,M]=l.useState(new Set),{debuggerClient:T}=(0,N.useDebuggerContext)();l.useEffect((()=>{if(T)return T.onBatchedEvents((e=>{e.forEach((e=>{e.type===c.DebuggerEventType.INPUTS_STATE_CHANGE&&(console.log("INPUTS_STATE_CHANGE",e.insId,e.val),D((t=>({...t,[e.insId]:e.val})))),e.type===c.DebuggerEventType.ERROR&&M((t=>{const n=new Set(t);return n.add(e.insId),n}))}))}))}),[T]);const{openFile:k,reportEvent:A}=(0,I.usePorts)(),R=l.useCallback(((e,t)=>{console.info("onChangeFlow",t.type),"functional"===t.type&&(a([{flow:{...n.flow,...e}},...r.slice(0,50)]),b([])),o((t=>({...t,flow:{...t.flow,...e}})))}),[o,n.flow,r]),[V,z]=l.useState({instances:[],connections:[]}),[$,H]=l.useState(!1),G=l.useCallback((()=>H(!1)),[]),L=l.useCallback((()=>H(!0)),[]),B=l.useCallback((e=>{o((t=>({...t,boardData:{...t.boardData,...e}})))}),[o]);l.useEffect((()=>{B({selected:[],viewPort:d.defaultViewPort,from:void 0,to:void 0,lastMousePos:{x:0,y:0}})}),[O.id]),(0,f.useHotkeys)("cmd+z",(e=>{b([...y,n]);const[t,...i]=r;t&&(o((e=>({...e,...t}))),a(i)),e.preventDefault()}),{text:"Undo last change",group:"Editing"},[n,r,y]);const F=l.useCallback(((e,t)=>{w.some((e=>t.message.includes(e)))||b([]),R({node:e},t)}),[R]),U=l.useCallback((e=>{k({absPath:e.source.path})}),[k]),q=l.useCallback((function(e,t){void 0===t&&(t=-1*d.NODE_HEIGHT*1.5);const n=(0,m.createNewNodeInstance)(e,t,P.lastMousePos,i);if(n){const e=(0,p.default)(C,(e=>{const t=e.node;if(!(0,c.isVisualNode)(t))throw new Error("Impossible state, adding node to non visual node");t.instances.push(n)}));return R(e,(0,v.functionalChange)("add-node")),G(),n}}),[P.lastMousePos,C,R,G,i]),W=l.useCallback((async e=>{switch(e.type){case h.OmniBarCmdType.ADD:return A("addNode",{nodeId:e.data,source:"omnibar"}),q(e.data);case h.OmniBarCmdType.ADD_VALUE:{const e=t.current;null==e||e.requestNewInlineValue();break}case h.OmniBarCmdType.IMPORT:{await s(e.data,{pos:P.lastMousePos});const t=(0,_.vAdd)({x:0,y:0},P.lastMousePos),n=(0,m.createNewNodeInstance)(e.data.node,0,t,i),o=(0,p.default)(C,(e=>{e.node.instances.push(n)}));R(o,(0,v.functionalChange)("add-imported-node")),A("addNode",{nodeId:e.data.node.id,source:"omnibar"});break}default:g.AppToaster.show({intent:"warning",message:"Not supported yet"})}G()}),[G,A,q,t,s,P.lastMousePos,i,C,R]),[Z,J]=l.useState(),Y=l.useCallback((()=>J(void 0)),[]),K=l.useCallback(((e,t)=>{J({insId:e,pin:t})}),[]);return(0,u.jsx)("div",{className:"flyde-flow-editor",children:(()=>{if((0,c.isInlineValueNode)(O))throw new Error("Impossible state");return(0,u.jsxs)(l.Fragment,{children:[Z?(0,u.jsx)(x.DataInspectionModal,{item:Z,onClose:Y}):null,(0,u.jsx)(d.VisualNodeEditor,{currentInsId:c.ROOT_INS_ID,ref:t,boardData:P,onChangeBoardData:B,node:O,onGoToNodeDef:U,onChangeNode:F,resolvedDependencies:i,clipboardData:V,onCopy:z,nodeIoEditable:!O.id.startsWith("Trigger"),onInspectPin:K,onShowOmnibar:L,onExtractInlineNode:e.onExtractInlineNode,queuedInputsData:E,initialPadding:e.initialPadding,instancesWithErrors:S,disableScrolling:e.disableScrolling},O.id),$?(0,u.jsx)(h.Omnibar,{flow:C,resolvedNodes:i,onCommand:W,visible:$,onClose:G}):null]})})()})})))},9001:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseNodeEditor=t.renderCreateIOOption=void 0;const i=n(35250),s=o(n(70079)),r=n(74762),a=n(50382),u=o(n(53865)),l=n(70457),c=n(25779);t.renderCreateIOOption=(e,t,n)=>(0,i.jsx)(a.MenuItem,{icon:"add",text:`Create "${e}"`,active:t,onClick:n,shouldDismissPopover:!1});const d=l.MultiSelect.ofType();t.BaseNodeEditor=e=>{var n,o;const{node:l,onChange:p}=e,f=(0,r.entries)(l.inputs),m=f.filter((e=>{let[,t]=e;return"required"===t.mode})).map((e=>{let[t]=e;return t})),g=f.filter((e=>{let[,t]=e;return"optional"===t.mode})).map((e=>{let[t]=e;return t})),v=f.filter((e=>{let[,t]=e;return"required-if-connected"===t.mode})).map((e=>{let[t]=e;return t})),[h,I]=s.default.useState(!1),y=(0,r.okeys)(l.outputs),b=s.default.useCallback((e=>{p({...l,id:e})}),[l,p]),C=s.default.useCallback((e=>{let t=e?e.split(","):void 0;"[]"===e&&(t=[]),console.log(e,t),p({...l,completionOutputs:t})}),[l,p]),_=s.default.useCallback((e=>{let t=e?e.split(","):void 0;p({...l,reactiveInputs:t})}),[l,p]),x=s.default.useCallback(((e,t)=>{const n=(0,u.default)(l,(n=>{n.inputs[e]=(0,r.nodeInput)(t)}));p(n)}),[l,p]),N=s.default.useCallback((e=>{const t=(0,u.default)(l,(t=>{delete t.inputs[e]}));p(t)}),[l,p]),j=s.default.useCallback((e=>{const t=(0,u.default)(l,(t=>{t.outputs[e]=(0,r.nodeOutput)()}));p(t)}),[l,p]),w=s.default.useCallback((e=>{const t=(0,u.default)(l,(t=>{delete t.outputs[e]}));p(t)}),[l,p]);s.default.useCallback((e=>{try{const t=JSON.parse(e),n=(0,u.default)(l,(e=>{Object.entries(t).forEach((t=>{let[n,o]=t;const i=e.inputs[n],s=e.outputs[n];i?e.inputs[n]={...i}:s&&(e.outputs[n]={...s})}))}));p(n)}catch(t){console.error("cannot parse")}}),[p,l]);return(0,i.jsxs)("div",{className:"base-node-editor",children:[(0,i.jsx)("div",{className:"form-row",children:(0,i.jsx)(a.FormGroup,{label:"Node Name",labelFor:"text-input",labelInfo:"(required)",children:(0,i.jsx)(a.InputGroup,{id:"node-name",disabled:e.idDisabled,placeholder:"Node ID",value:l.id,onChange:e=>b(e.target.value)})})}),(0,i.jsx)(a.FormGroup,{label:"Required Inputs",children:(0,i.jsx)(d,{selectedItems:m,placeholder:"Enter input names here",items:[],tagRenderer:e=>e,onItemSelect:e=>x(e,"required"),onRemove:N,resetOnSelect:!0,itemRenderer:e=>(0,i.jsx)("span",{children:e}),createNewItemFromQuery:e=>e,createNewItemRenderer:t.renderCreateIOOption,fill:!0})}),!0!==e.hiddenOutputs?(0,i.jsx)(a.FormGroup,{label:"Outputs",children:(0,i.jsx)(d,{selectedItems:y,placeholder:"Enter output names here",items:[],tagRenderer:e=>e,onItemSelect:j,onRemove:w,resetOnSelect:!0,itemRenderer:e=>(0,i.jsx)("span",{children:e}),createNewItemFromQuery:e=>e,createNewItemRenderer:t.renderCreateIOOption,fill:!0})}):null,(0,i.jsx)(a.Checkbox,{checked:h,onChange:e=>I(e.target.checked),children:"Show advanced options"}),(0,i.jsxs)(a.Collapse,{isOpen:h,children:[(0,i.jsx)(a.FormGroup,{label:"Optional Inputs",children:(0,i.jsx)(d,{selectedItems:g,placeholder:"Enter input names here",items:[],tagRenderer:e=>e,onItemSelect:e=>x(e,"optional"),onRemove:N,resetOnSelect:!0,itemRenderer:e=>(0,i.jsx)("span",{children:e}),createNewItemFromQuery:e=>e,createNewItemRenderer:t.renderCreateIOOption,fill:!0})}),(0,i.jsx)(a.FormGroup,{label:"Required-if-connected Inputs",children:(0,i.jsx)(d,{selectedItems:v,placeholder:"Enter input names here",items:[],tagRenderer:e=>e,onItemSelect:e=>x(e,"required-if-connected"),onRemove:N,resetOnSelect:!0,itemRenderer:e=>(0,i.jsx)("span",{children:e}),createNewItemFromQuery:e=>e,createNewItemRenderer:t.renderCreateIOOption,fill:!0})}),(0,i.jsx)(a.FormGroup,{label:"Completion Outputs",children:(0,i.jsx)(a.InputGroup,{id:"completion-outputs",placeholder:"completion outputs",value:(null===(n=l.completionOutputs)||void 0===n?void 0:n.join(","))||"",onChange:e=>C(e.target.value)})}),(0,i.jsx)(a.FormGroup,{label:"Reactive Inputs",children:(0,i.jsx)(a.InputGroup,{id:"reactive-inputs",placeholder:"Reactive inputs",value:(null===(o=l.reactiveInputs)||void 0===o?void 0:o.join(","))||"",onChange:e=>_(e.target.value)})})]}),(0,i.jsx)(a.FormGroup,{label:"Preview",children:(0,i.jsx)("div",{className:"preview-wrapper",children:(0,i.jsx)(c.NodePreview,{node:l})})})]})}},82232:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.metaChange=t.functionalChange=void 0;t.functionalChange=e=>({type:"functional",message:e});t.metaChange=function(e){return void 0===e&&(e="n/a"),{type:"meta",message:e}}},41032:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safelyGetNodeDef=t.loadingDef=void 0;const o=n(74762);t.loadingDef={id:"Loading",inputs:{},outputs:{}};t.safelyGetNodeDef=(e,n)=>{try{return(0,o.getNodeDef)(e,n)}catch(i){const n="string"==typeof e?e:e.nodeId;return{...t.loadingDef,id:n}}}},72125:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InlineCodeModal=void 0;const a=n(35250),u=s(n(70079)),l=r(n(51848)),c=n(50382),d=r(n(26372)),p=n(68371),f=n(74762),m=n(31745),g="`Result is ${inputs.a + inputs.b}`";t.InlineCodeModal=u.memo((function(e){const{initialValue:t,initialType:n}=e,[o,i]=u.useState((0,f.isDefined)(t)?t:g),[s,r]=u.useState(n||f.InlineValueNodeType.VALUE),v=(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:['You can add variables to by referrencing the "inputs" object.',(0,a.jsx)("br",{})," For example:",(0,a.jsx)(c.Code,{children:"`Hello {inputs.name}`"}),' will expose an input pin named "name"']}),(0,a.jsxs)("p",{children:["You can also use ternery expressions, arithmetic operators and more!",(0,a.jsx)("br",{}),"For example:",(0,a.jsx)(c.Code,{children:"inputs.a > inputs.b ? inputs.a + 42 : Math.random() * inputs.b"})]})]}),h=(0,a.jsxs)("span",{children:["Type in any valid JS value, such as ",(0,a.jsx)(c.Code,{children:"true"}),", ",(0,a.jsx)(c.Code,{children:"42"}),","," ",(0,a.jsx)(c.Code,{children:'["bob", "alice", "dave"]'}),".",(0,a.jsx)("br",{})," Dynamic inputs may also be used"]}),I=(0,a.jsxs)("span",{children:["Write any JS code and return a value.",(0,a.jsx)("br",{})," The returned value will be the output.",(0,a.jsx)("br",{})," Example:",(0,a.jsx)(c.Code,{children:"const a = inputs.a; const b = inputs.b; return Math.floor(a/b);"})]}),y=(0,p.getVariables)(o);return u.useEffect((()=>{o===g&&s===f.InlineValueNodeType.FUNCTION&&i(`return ${g}`),o===`return ${g}`&&s===f.InlineValueNodeType.VALUE&&i(g)}),[o,s]),(0,a.jsxs)(c.Dialog,{isOpen:!0,title:"Inline Value / Code",onClose:e.onCancel,className:"inline-code-modal",children:[(0,a.jsxs)("main",{className:(0,d.default)(c.Classes.DIALOG_BODY),onKeyDown:t=>{"Enter"===t.key&&t.metaKey&&e.onSubmit(s,o)},tabIndex:0,children:[(0,a.jsxs)(c.RadioGroup,{inline:!0,onChange:e=>r(e.target.value),selectedValue:s,children:[(0,a.jsx)(c.Radio,{labelElement:(0,a.jsxs)(u.Fragment,{children:["Value ",(0,a.jsx)(m.InfoTooltip,{content:h})]}),value:f.InlineValueNodeType.VALUE}),(0,a.jsx)(c.Radio,{labelElement:(0,a.jsxs)(u.Fragment,{children:["Function ",(0,a.jsx)(m.InfoTooltip,{content:I})]}),value:f.InlineValueNodeType.FUNCTION})]}),(0,a.jsx)(l.default,{height:"80px",theme:"vs-dark",defaultLanguage:"javascript",value:o,onChange:e=>i(e||""),onMount:e=>{e&&e.updateOptions({lineNumbers:"off",minimap:{enabled:!1}})}}),(()=>{const e=o.includes("return");return e&&s===f.InlineValueNodeType.VALUE?(0,a.jsx)(c.Callout,{intent:c.Intent.WARNING,children:'When using the "value" type you are not expected to return anything'}):e||s!==f.InlineValueNodeType.FUNCTION?null:(0,a.jsxs)(c.Callout,{intent:c.Intent.DANGER,children:['When using the "function" type you are expected to'," ",(0,a.jsx)(c.Code,{children:"return"})," a value.",(0,a.jsx)("br",{}),"Example: ",(0,a.jsx)(c.Code,{children:"return 42 + Date.now();"})]})})(),(0,a.jsxs)(c.Callout,{intent:c.Intent.NONE,children:["Input pins detected:"," ",y.length?y.map((e=>(0,a.jsx)(c.Code,{children:e},e))):"None",(0,a.jsx)(m.InfoTooltip,{content:v})]})]}),(0,a.jsx)("div",{className:c.Classes.DIALOG_FOOTER,children:(0,a.jsxs)("div",{className:c.Classes.DIALOG_FOOTER_ACTIONS,children:[(0,a.jsx)(c.Button,{onClick:e.onCancel,children:"Cancel"}),(0,a.jsx)(c.Button,{onClick:()=>e.onSubmit(s,o),intent:c.Intent.PRIMARY,className:"save-btn",children:"Save"})]})})]})}))},18594:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(72125),t)},68371:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInlineValueNode=t.getVariables=void 0;const o=n(74762),i=n(74762);t.getVariables=e=>(e.match(/inputs\.([a-zA-Z]\w*)/g)||[]).map((e=>e.replace(/inputs\./,"")));t.createInlineValueNode=e=>{let{code:n,customView:s,nodeId:r,type:a}=e;const u=(0,t.getVariables)(n).reduce(((e,t)=>({...e,[t]:(0,o.nodeInput)()})),{}),l={value:(0,o.nodeOutput)()},c=a===o.InlineValueNodeType.FUNCTION?`const result = (function() { ${n}}());\n  Promise.resolve(result).then(val => outputs.value.next(val))`:`const result = (${n}); Promise.resolve(result).then(val => outputs.value.next(val))`,d=btoa(n);return(0,i.inlineValueNode)({id:r||`Inline Code ${(0,o.randomInt)(99999)}`,inputs:u,outputs:l,runFnRawCode:c,customViewCode:s||n,dataBuilderSource:d,templateType:a,completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}},description:"Custom inline "+(a===o.InlineValueNodeType.VALUE?"value":"function")})}},49283:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Omnibar=t.OmniBarCmdType=void 0;const a=n(35250),u=s(n(70079)),l=n(70457),c=n(74762),d=n(50382),p=r(n(26372));var f;!function(e){e.ADD="add",e.ADD_VALUE="add-value",e.IMPORT="import"}(f=t.OmniBarCmdType||(t.OmniBarCmdType={}));const m=[];t.Omnibar=e=>{const{resolvedNodes:t}=e,[n,o]=u.useState(""),[i,s]=u.useState(null),[r,g]=u.useState([]);u.useEffect((()=>{const e=(0,c.keys)(t).map((e=>({title:`${t[e].id}`,cmd:{type:f.ADD,data:e},extra:"current flow"}))),n=r.map((e=>({title:`${e.node.id}`,description:e.node.description,cmd:{type:f.IMPORT,data:e},extra:`${e.module}`}))),o={title:"Add inline value or code",suggestOnEmpty:!0,cmd:{type:f.ADD_VALUE}},i=[...m,...n,o,...e];s(i)}),[t,r]),u.useEffect((()=>{e.onRequestImportables&&e.onRequestImportables(n).then((e=>{g(e)}))}),[e,n]);const v=u.useCallback(((e,t)=>{let{handleClick:n,modifiers:o,query:i,index:s}=t;if(!o.matchesPredicate)return null;const r=`${e.title}`;return(0,a.jsx)(d.MenuItem,{active:o.active,disabled:o.disabled,onClick:n,text:(0,a.jsxs)("div",{className:(0,p.default)("omnibar-item",{active:o.active}),children:[(0,a.jsxs)("div",{className:"title",children:[r," ",e.extra?(0,a.jsx)("span",{className:"extra",children:e.extra}):null]}),e.description?(0,a.jsx)("div",{className:"description",children:e.description}):null]})},s)}),[]),h=u.useCallback(((e,t)=>{const n=e.toLowerCase().split("").map((e=>{return`${t=e,t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}.*`;var t})).join(""),o=new RegExp(n);return!!t.title.toLowerCase().match(o)}),[]),I=u.useCallback((t=>{e.onCommand(t.cmd),e.onClose()}),[e]);return i?(0,a.jsx)(l.Omnibar,{query:n,onQueryChange:o,onClose:e.onClose,noResults:(0,a.jsx)(d.MenuItem,{disabled:!0,text:"No results."}),itemPredicate:h,isOpen:e.visible,items:i,initialContent:void 0,onItemSelect:I,itemRenderer:v,inputProps:{placeholder:"Search for nodes or commands.."}}):null}},60698:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},43490:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(31874),t)},31874:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.usePorts=t.useConfirm=t.usePrompt=t.PortsContext=t.defaultPorts=void 0;const s=n(70079),r=n(74762),a=n(84472);i(n(60698),t);const u=e=>async()=>{console.warn(`${e} Not implemented`),(0,a.toastMsg)("Feature not implemented in this context yet","warning")};t.defaultPorts={prompt:async e=>{let{text:t,defaultValue:n}=e;return prompt(`${t}`,n)},openFile:async e=>{},confirm:async e=>{let{text:t}=e;return confirm(t)},readFlow:u("readFlow"),setFlow:u("setFlow"),resolveDeps:u("resolveDeps"),getImportables:u("getImportables"),onExternalFlowChange:u("onExternalFlowChange"),onInstallRuntimeRequest:u("onInstallRuntimeRequest"),onRunFlow:u("onRunFlow"),onStopFlow:u("onStopFlow"),reportEvent:r.noop,generateNodeFromPrompt:u("generateNodeFromPrompt"),hasOpenAiToken:()=>Promise.resolve(!1)},t.PortsContext=(0,s.createContext)(t.defaultPorts);t.usePrompt=()=>{const e=(0,s.useContext)(t.PortsContext).prompt;return(t,n)=>e({text:t,defaultValue:n})};t.useConfirm=()=>{const e=(0,s.useContext)(t.PortsContext).confirm;return t=>e({text:t})};t.usePorts=()=>(0,s.useContext)(t.PortsContext)},65758:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.groupSelected=void 0;const i=n(74762),s=o(n(53865)),r=n(22513);t.groupSelected=async(e,t,n,o,a)=>{const{instances:u,connections:l}=t,c=u.filter((t=>e.includes(t.id))),d=l.filter((t=>{let{from:n,to:o}=t;return-1!==e.indexOf(n.insId)||-1!==e.indexOf(o.insId)}));if(!c.length)throw new Error("visual without selections");const{visualNode:p,renamedInputs:f,renamedOutputs:m}=await(0,r.createGroup)(c,d,n,a),g=c.reduce(((e,t)=>(0,i.middlePos)(t.pos,e)),u[0].pos),v="ref"===o?(0,i.nodeInstance)((0,i.createInsId)(p),p.id,{},g):(0,i.inlineNodeInstance)((0,i.createInsId)(p),p,{},g),h=u.filter((t=>-1===e.indexOf(t.id))),I=l.map((e=>{const t=`${e.from.insId}.${e.from.pinId}`,n=`${e.to.insId}.${e.to.pinId}`;return f[n]?{...e,to:{insId:v.id,pinId:f[n]}}:m[t]?{...e,from:{insId:v.id,pinId:m[t]}}:e})).filter((t=>-1===e.indexOf(t.from.insId)&&-1===e.indexOf(t.to.insId)));return{newNode:p,currentNode:(0,s.default)(t,(e=>{e.instances=[...h,v],e.connections=I}))}}},74089:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(97106),t),i(n(18420),t),i(n(90680),t),i(n(84472),t),i(n(17102),t),i(n(82232),t),i(n(25779),t),i(n(25804),t),i(n(9958),t),i(n(68120),t),i(n(94651),t),i(n(73470),t),i(n(94007),t),i(n(60190),t),i(n(9001),t),i(n(7047),t),i(n(23386),t)},31745:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfoTooltip=void 0;const o=n(35250),i=n(50382),s=n(50382),r=n(44470),a=n(50382);t.InfoTooltip=e=>{const{content:t}=e;return(0,o.jsx)(s.Tooltip,{content:t,placement:"top",className:"info-tooltip",children:(0,o.jsx)(i.Icon,{icon:(0,o.jsx)(r.InfoSign,{className:a.Classes.INTENT_PRIMARY}),intent:i.Intent.SUCCESS,className:"info-tooltip-icon"})})}},83938:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserOnlyReactJson=void 0;const o=n(35250);t.BrowserOnlyReactJson=e=>{if("undefined"==typeof window)return null;const t=n(73541).Z;return(0,o.jsx)(t,{...e})}},94651:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsValueRenderer=void 0;const o=n(35250),i=n(74762),s=n(83938);t.AnalyticsValueRenderer=e=>{let{val:t}=e;try{const e=JSON.parse(t),n="object"==typeof e?e:{value:e},r=e&&[e.type,e.key,e.props,e.ref].every(i.isDefined),a=r?{jsxValue:e}:n;return(0,o.jsx)(s.BrowserOnlyReactJson,{src:a,collapseStringsAfterLength:50,collapsed:r})}catch(n){return(0,o.jsx)(s.BrowserOnlyReactJson,{src:{value:t},collapseStringsAfterLength:50})}}},22513:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGroup=void 0;const o=n(74762),i=n(74762),s=n(60190),r=n(88593);t.createGroup=async(e,t,n,a)=>{if(0===e.length)throw new Error("cannot create group without instances");const u=e.map((e=>e.id)),l=t.filter((e=>{const t=u.includes(e.from.insId),n=u.includes(e.to.insId);return!t&&n})).filter(((e,t,n)=>n.findIndex((t=>(0,i.connectionNodeEquals)(t.to,e.to)))===t)),c=t.filter((e=>{const t=u.includes(e.from.insId),n=u.includes(e.to.insId);return t&&!n})).filter(((e,t,n)=>n.findIndex((t=>(0,i.connectionNodeEquals)(t.from,e.from)))===t));let d={},p={},f={},m={};const g=[],v={};for(const o of l){const e=`${o.to.insId}.${o.to.pinId}`,t=`${o.from.insId}.${o.from.pinId}`,n=o.to.pinId;if(f[t]){g.push({from:(0,i.externalConnectionNode)(f[t]),to:(0,i.connectionNode)(o.to.insId,o.to.pinId)});continue}const r=v[n]?await a(`Name this input (${n} of ${o.to.insId}) is already taken:`)||`i${(0,s.rnd)()}`:n;d[e]=r,f[t]=r,g.push({from:(0,i.externalConnectionNode)(r),to:(0,i.connectionNode)(o.to.insId,o.to.pinId)}),v[r]=(0,i.nodeInput)()}const h={};for(const r of c){const e=`${r.to.insId}.${r.to.pinId}`,t=`${r.from.insId}.${r.from.pinId}`,n=r.from.pinId;if(m[e]){g.push({from:(0,i.connectionNode)(r.from.insId,r.from.pinId),to:(0,i.externalConnectionNode)(m[e])});continue}const u=h[n]?await a(`Name this output (${n} of ${r.from.insId} is already taken:`)||`i${(0,s.rnd)()}`:n;p[t]=u,m[e]=u,g.push({from:(0,i.connectionNode)(r.from.insId,r.from.pinId),to:(0,i.externalConnectionNode)(u)}),h[u]=(0,o.nodeOutput)()}e.reduce(((e,t)=>(0,i.middlePos)(t.pos,e)),e[0].pos);const I=t.filter((e=>u.includes(e.from.insId)&&u.includes(e.to.insId)));return{visualNode:{id:n,inputs:v,outputs:h,instances:e,defaultStyle:{size:"large",color:(0,o.pickRandom)(r.nodeStylePresetColors.map((e=>e.color)))},inputsPosition:(0,o.okeys)(v).reduce(((e,t,n)=>({...e,[t]:{x:0+100*n,y:0}})),{}),outputsPosition:(0,o.okeys)(h).reduce(((e,t,n)=>({...e,[t]:{x:0+100*n,y:400}})),{}),connections:[...I,...g],completionOutputs:(0,o.okeys)(h)},renamedInputs:d,renamedOutputs:p}}},9958:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.highlightText=void 0;const o=n(35250);function i(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}t.highlightText=(e,t)=>{let n=0;const s=t.split(/\s+/).filter((e=>e.length>0)).map(i);if(0===s.length)return[e];const r=new RegExp(s.join("|"),"gi"),a=[];for(;;){const t=r.exec(e);if(!t)break;const i=t[0].length,s=e.slice(n,r.lastIndex-i);s.length>0&&a.push(s),n=r.lastIndex,a.push((0,o.jsx)("strong",{children:t[0]},n))}const u=e.slice(n);return u.length>0&&a.push(u),a}},17102:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Loader=void 0;const o=n(35250);t.Loader=()=>(0,o.jsx)("div",{className:"loader",children:(0,o.jsx)("svg",{width:"38",height:"38",viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:"#007ec6",children:(0,o.jsx)("g",{fill:"none",fillRule:"evenodd",children:(0,o.jsxs)("g",{transform:"translate(1 1)",strokeWidth:"2",children:[(0,o.jsx)("circle",{strokeOpacity:".5",cx:"18",cy:"18",r:"18"}),(0,o.jsx)("path",{d:"M36 18c0-9.94-8.06-18-18-18",children:(0,o.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"1s",repeatCount:"indefinite"})})]})})})})},23386:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logger=void 0;const o=n(74762);t.logger=(0,o.debugLogger)("editor")},561:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.preloadMonaco=void 0;const o=n(51848),i=n(23386);let s=!1;t.preloadMonaco=()=>{s||o.loader.init().then((()=>{(0,i.logger)("monaco preloaded"),s=!0}))}},68120:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useHotkeys=t.currentHotkeys=void 0;const i=o(n(45240)),s=n(70079);t.currentHotkeys=new Map,t.useHotkeys=function(e,n,o,r,a){void 0===r&&(r=[]);const u=(0,s.useCallback)((function(){a&&!a.current||n(...arguments)}),[...r,n]);(0,s.useEffect)((()=>((0,i.default)(e,{},u),t.currentHotkeys.set(e,o),()=>{t.currentHotkeys.delete(e),i.default.unbind(e,u)})),[e,u,o])}},94007:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeSessionStorage=t.safeLocalStorage=void 0,t.safeLocalStorage={getItem:function(){try{return localStorage.getItem(...arguments)}catch(e){return null}},setItem:function(){try{return localStorage.setItem(...arguments)}catch(e){return null}}},t.safeSessionStorage={getItem:function(){try{return sessionStorage.getItem(...arguments)}catch(e){return null}},setItem:function(){try{return sessionStorage.setItem(...arguments)}catch(e){return null}}}},90680:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.useLocalStorage=t.useResizePref=t.userPreferences=t.useUserPref=void 0;const r=s(n(70079)),a=n(18420),u=n(94007);t.useUserPref=(e,n)=>{const[o,i]=r.useState((()=>{const o=t.userPreferences.getItem(e);return(0,a.isDefined)(o)?o:n}));r.useEffect((()=>{const o=t.userPreferences.getItem(e),s=(0,a.isDefined)(o)?o:n;i(s)}),[e]);return[o,n=>{t.userPreferences.setItem(e,n),console.log("Saved",e,n),i(n)}]},t.userPreferences=(()=>{const e=e=>`up.${e}`;return{getItem:t=>{const n=u.safeLocalStorage.getItem(e(t))||"",o=u.safeSessionStorage.getItem(e(t))||"";try{return JSON.parse(o||n).value}catch(i){return}},setItem:function(t,n,o){void 0===o&&(o=!1);const i=o?sessionStorage:u.safeLocalStorage;try{const o=JSON.stringify({value:n});return i.setItem(e(t),o),!0}catch(s){return console.error("Error saving user preference",s),!1}}}})();t.useResizePref=(e,n)=>{const o=`resize.${e}`;return(0,t.useUserPref)(o,n)};const l=e=>{const t=u.safeLocalStorage.getItem(e);if(!t)return null;try{return JSON.parse(t).value}catch(n){return null}};t.useLocalStorage=(e,t)=>{const[n,o]=r.useState(l(e)||t),i=r.useCallback((t=>{u.safeLocalStorage.setItem(e,JSON.stringify({value:t})),o(t)}),[e]);return r.useEffect((()=>{l(e)||u.safeLocalStorage.setItem(e,JSON.stringify({value:t}))}),[e,t,i]),[n,i]}},60190:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.totalEnergy=t.itrPhysics=t.hookes=t.coulombs=t.vToStr=t.vNorm=t.vLen=t.vSub=t.vAdd=t.vDiv=t.vMul=t.vZero=t.rnd=t.vec=t.size=void 0;t.size=(e,t)=>({width:e,height:t});t.vec=(e,t)=>({x:e,y:t});t.rnd=function(e,t){return void 0===e&&(e=100),void 0===t&&(t=0),Math.floor(Math.random()*(e-t))+t},t.vZero={x:0,y:0};t.vMul=(e,t)=>{let{x:n,y:o}=e;return{x:n*t,y:o*t}};t.vDiv=(e,n)=>{let{x:o,y:i}=e;return(0,t.vMul)({x:o,y:i},1/n)};t.vAdd=(e,t)=>({x:e.x+t.x,y:e.y+t.y});t.vSub=(e,n)=>(0,t.vAdd)(e,(0,t.vMul)(n,-1));t.vLen=e=>{let{x:t,y:n}=e;return Math.sqrt(t*t+n*n)};t.vNorm=e=>(0,t.vDiv)(e,(0,t.vLen)(e)||1);t.vToStr=e=>{let{x:t,y:n}=e;return`${t.toFixed(1)},${n.toFixed(1)}`};t.coulombs=(e,n,o)=>{const i=(0,t.vLen)((0,t.vSub)(e.p,n.p));if(0===i){const i=(0,t.vec)(2*Math.random()-1,2*Math.random()-1),s=e.m*n.m/Math.pow(10,2);return(0,t.vMul)(i,s*o)}{const s=(0,t.vNorm)((0,t.vSub)(n.p,e.p)),r=e.m*n.m/Math.pow(i+.1,2);return(0,t.vMul)(s,r*o)}};t.hookes=(e,n,o,i,s)=>{const r=(0,t.vLen)((0,t.vSub)(e.p,n.p)),a=(0,t.vNorm)((0,t.vSub)(e.p,n.p));let u=0;return r<o?u=o-r:r>i&&(u=i-r),(0,t.vMul)(a,s*u)};t.itrPhysics=(e,n)=>{const{p:o,v:i,f:s,m:r}=n,a=(0,t.vDiv)(s,r),u=e/1e3,l=(0,t.vAdd)((0,t.vMul)(a,u),i),c=(0,t.vAdd)((0,t.vMul)(l,u),o);return{...n,p:c,v:l,f:(0,t.vec)(0,0)}};t.totalEnergy=e=>e.reduce(((e,n)=>{const o=(0,t.vLen)(n.v);return e+.5*n.m*o*o}),0)},84472:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateToast=t.toastMsg=t.AppToaster=void 0;const o=n(50382);t.AppToaster=(()=>{try{return o.OverlayToaster.create({className:"app-toaster",position:o.Position.BOTTOM_RIGHT})}catch(e){return{}}})();t.toastMsg=(e,n,o)=>t.AppToaster.show({message:e,intent:n,timeout:o});t.updateToast=(e,n,o)=>t.AppToaster.show({message:n,intent:o},e)},18420:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.preventDefaultAnd=t.isLocal=t.fullTime=t.timeAgoFromDt=t.timeAgo=t.toString=t.isDefined=t.set=t.createOmap=t.toOmap=t.values=t.keys=t.entries=void 0;const i=n(7047),s=n(74762),r=o(n(73136));t.entries=e=>Object.keys(e).map((t=>[t,e[t]]));t.keys=e=>Object.keys(e);t.values=e=>Object.keys(e).map((t=>e[t]));t.toOmap=e=>Array.from(e.entries()).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o}}),{});t.createOmap=function(e){return void 0===e&&(e=[]),e.reduce(((e,t)=>({...e,[t[0]]:t[1]})),{})};t.set=(e,t,n)=>{e[t]=n};t.isDefined=e=>void 0!==e;t.toString=e=>{const t=typeof e;if(""===e)return"(empty string)";if((0,i.isJsxValue)(e))return"JSX Value";if((0,s.isStaticValueVisualNode)(e))return"Embedded Node";if((0,s.isEnvValue)(e))return(0,s.getEnvKeyFromValue)(e);if("object"===t)try{const t=JSON.stringify(e);return"{}"===t?"Empty object":t}catch(n){return"Object (cannot stringify)"}return`${e}`};t.timeAgo=e=>(0,r.default)(new Date(e)).fromNow();t.timeAgoFromDt=e=>(0,r.default)(Date.now()-e).fromNow();t.fullTime=e=>(0,r.default)(new Date(e)).toString();t.isLocal=()=>location.href.includes(":300");t.preventDefaultAnd=e=>t=>{t.preventDefault(),e(t)}},67181:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ActionButton=t.ActionsMenu=t.ActionType=void 0;const r=n(35250),a=n(50382),u=n(50382),l=n(74762),c=s(n(70079)),d=n(86125),p=n(43490),f=n(68120),m=n(90680),g=n(84472),v=n(9971),h=n(47749),I=n(46334),y=n(47230),b=n(41032);var C;!function(e){e.AddNode="add-node",e.RemoveNode="remove-node",e.Group="group",e.UnGroup="un-group",e.AddInlineValue="add-inline-value",e.Inspect="inspect",e.Run="run",e.AI="ai"}(C=t.ActionType||(t.ActionType={}));t.ActionsMenu=e=>{const{onAction:n,selectedInstances:o,resolvedNodes:i,node:s,from:u,to:h,hotkeysEnabled:x,showRunFlowOptions:N}=e,{onRequestImportables:j}=(0,d.useDependenciesContext)(),[w,P]=c.default.useState(!1),[O,E]=c.default.useState(!1),[D,S]=c.default.useState(!1),[M,T]=c.default.useState(null),[k,A]=(0,m.useLocalStorage)("hideHotkeyHintMap",{}),R=(0,c.useCallback)((()=>{P(!1)}),[]),{onRunFlow:V,generateNodeFromPrompt:z,reportEvent:$}=(0,p.usePorts)(),H=(0,c.useCallback)((e=>(E(!1),V(e))),[V]),G=[];if(G.push(C.AddNode),G.push(C.AddInlineValue),1===o.length){const e=s.instances.find((e=>e.id===o[0]));if(e)try{const t=(0,b.safelyGetNodeDef)(e,i);(0,l.isVisualNode)(t)&&G.push(C.UnGroup)}catch(q){console.error(`Could not find node with id ${o[0]} - ${q}`)}else console.error(`Could not find instance with id ${o[0]}`)}N&&G.push(C.Run),o.length>0&&G.push(C.Group),(1===o.length||u||h)&&G.push(C.Inspect),o.length>0&&G.push(C.RemoveNode),G.push(C.AI);const L=(0,c.useCallback)(((e,t)=>{A({...k,[e]:!0}),g.AppToaster.dismiss(t)}),[k,A]),B=(0,c.useCallback)(((e,t)=>{const{hotkey:o}=_[e];if("click"===t.type&&o&&!k[o]){const t=(0,g.toastMsg)((0,r.jsxs)(r.Fragment,{children:["Did you know? you can also use the hotkey"," ",(0,r.jsx)("kbd",{className:"hotkey",children:o})," to"," ",_[e].text.replace(/^[A-Z]/,(e=>e.toLowerCase())),(0,r.jsxs)(a.Button,{minimal:!0,small:!0,onClick:()=>L(o,t),children:[" ","Don't show again"," "]})]}),"none",3e3)}switch(e){case C.AddNode:P(!0);break;case C.Run:!async function(){Object.keys(s.inputs).length>0?E(!0):V({})}();break;case C.AI:S(!0);break;default:n({type:e,data:void 0})}}),[k,n,L,V,s.inputs]);Object.entries(_).forEach((e=>{let[t,n]=e;n.hotkey&&(0,f.useHotkeys)(n.hotkey,(e=>{e.preventDefault(),G.includes(t)&&(B(t,e),A({...k,[n.hotkey]:!0}))}),{text:n.text,group:"Action menu hotkeys"},[G],x)}));const F=(0,c.useCallback)((e=>{n({type:C.AddNode,data:{importableNode:e}})}),[n]),U=(0,c.useCallback)((async e=>{const t=Date.now();T(t);try{$("generateNodeFromPrompt:start",{promptLength:e.length});const o=await z({prompt:e}),{inputs:i,outputs:s}=o.importableNode.node,r=Date.now()-t;$("generateNodeFromPrompt:success",{totalTime:r,inputs:Object.keys(i),outputs:Object.keys(s)}),T(null),n({type:C.AI,data:o}),S(!1)}catch(q){T(null),g.AppToaster.show({message:"Failed to generate node",intent:"danger"}),$("generateNodeFromPrompt:failure",{error:q.message})}}),[z,n,$]);return(0,r.jsxs)("div",{className:"actions-menu",children:[G.map((e=>(0,r.jsx)(t.ActionButton,{type:e,onClick:B},e))),w?(0,r.jsx)(v.AddNodeMenu,{onRequestImportables:j,onAddNode:F,onClose:R}):null,O?(0,r.jsx)(y.RunFlowModal,{onClose:()=>E(!1),onRun:H,node:s}):null,D?(0,r.jsx)(I.PromptAIMenu,{onClose:()=>{S(!1),T(null)},onSubmit:U,submitting:null!==M,submitTime:M}):null]})};const _={[C.AddNode]:{icon:h.addNodeIcon,text:'Open the "add node" menu',hotkey:"a"},[C.RemoveNode]:{icon:h.removeNodeIcon,text:"Remove selected instances",hotkey:"backspace"},[C.Group]:{icon:h.groupIcon,text:"Group selection into a new node",hotkey:"g"},[C.UnGroup]:{icon:h.ungroupIcon,text:"Ungroup selected visual node"},[C.Inspect]:{icon:h.inspectIcon,text:"Inspect data",hotkey:"i"},[C.AddInlineValue]:{icon:h.pencilIcon,text:"Add value / inline function",hotkey:"v"},[C.Run]:{icon:h.playIcon,text:"Run flow",hotkey:"r"},[C.AI]:{icon:h.starIcon,text:"Generate new code node using AI \u2728"}},x={icon:"",text:"N/A",hotkey:void 0};t.ActionButton=e=>{var t;const{onClick:n,type:o}=e,i=(0,c.useCallback)((e=>n(o,e)),[n,o]),s=null!==(t=_[o])&&void 0!==t?t:x,a=s.hotkey?(0,r.jsxs)("span",{children:[s.text," ",(0,r.jsx)("kbd",{className:"hotkey",children:s.hotkey})]}):s.text;return(0,r.jsx)("div",{className:"action-button",onClick:i,children:(0,r.jsx)(u.Tooltip,{hoverOpenDelay:100,content:a,className:"icon-wrapper",popoverClassName:"action-button-tooltip",children:(0,r.jsx)("span",{dangerouslySetInnerHTML:{__html:s.icon}})})})}},40149:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AddNodeMenu=t.AddNodeMenuFilterTree=void 0;const a=n(35250),u=n(50382),l=n(74762),c=r(n(26372)),d=s(n(70079)),p=n(43490),f=n(31745),m=n(17102),g=n(87935),v=n(74657),h=n(44470);t.AddNodeMenuFilterTree=u.Tree.ofType();function I(e,t,n){return[...e.external.map((e=>({id:e.module,label:e.module,hasCaret:!0,nodeData:{type:"external",module:e.module},isSelected:"external"===(null==t?void 0:t.type)&&t.module===e.module,isExpanded:n.has(e.module),childNodes:e.namespaces.map((o=>({id:`${e.module}/${o}`,label:o,hasCaret:!1,isSelected:"external"===(null==t?void 0:t.type)&&t.module===e.module&&t.namespace===o,isExpanded:n.has(`${e.module}/${o}`),nodeData:{type:"external",module:e.module,namespace:o}})))}))),{id:"internal",label:"Current Project",nodeData:{type:"internal"},isExpanded:n.has("internal"),hasCaret:!0,isSelected:"internal"===t.type,childNodes:e.internal.files.map((e=>({id:e,label:e,isSelected:"internal"===t.type&&t.file===e,hasCaret:!1,isExpanded:n.has(e),nodeData:{type:"internal",file:e}})))}]}function y(e){return/\.flyde(\.[jt]s)?$/.test(e.module)}t.AddNodeMenu=e=>{const{onRequestImportables:n,onAddNode:o,onClose:i}=e,[s,r]=d.default.useState(),[b,C]=d.default.useState([]),[_,x]=d.default.useState(new Set),[N,j]=d.default.useState(""),[w,P]=d.default.useState({type:"all"}),[O,E]=d.default.useState(null),[D,S]=d.default.useState(null),[M,T]=d.default.useState(null),k=(0,d.useCallback)((e=>{_.add(e.id),x(new Set(_))}),[_]),A=(0,d.useCallback)((e=>{_.delete(e.id),x(new Set(_))}),[_]),R=(0,d.useCallback)((e=>{o(e),i()}),[o,i]),{onInstallRuntimeRequest:V,reportEvent:z}=(0,p.usePorts)();(0,d.useEffect)((()=>{z("addNodeMenuOpen",{})}),[z]),(0,d.useEffect)((()=>{S(null==s?void 0:s.flatMap((e=>{var t,n,o;if(w)if("external"===w.type){if((e.module!==w.module||w.namespace)&&e.node.namespace!==w.namespace)return[]}else if("internal"===w.type&&(!y(e)||w.file&&e.module!==w.file))return[];if(N){const i=`${null!==(n=null===(t=e.node.searchKeywords)||void 0===t?void 0:t.join(" "))&&void 0!==n?n:[]} ${e.node.id} ${null!==(o=e.node.namespace)&&void 0!==o?o:""} ${e.node.description}`.toLowerCase().indexOf(N.toLowerCase());return-1===i?[]:[{importable:e,score:i}]}return[{importable:e,score:1}]})).sort(((e,t)=>e.score-t.score)).map((e=>{let{importable:t}=e;return t})))}),[s,w,N]),(0,d.useEffect)((()=>{n().then((e=>{let{importables:t,errors:n}=e;C(n);const o=t.filter((e=>!y(e))).reduce(((e,t)=>{var n,o,i;null!==(n=e[i=t.module])&&void 0!==n||(e[i]=[]);const s=null!==(o=t.node.namespace)&&void 0!==o?o:"";return e[t.module].includes(s)||e[t.module].push(s),e}),{}),i=t.filter(y).map((e=>e.module));E({external:Object.entries(o).map((e=>{let[t,n]=e;return{module:t,namespaces:n}})),internal:{files:i}}),r(t),x(new Set(["internal",...Object.keys(o)]))}))}),[n]);const $=(0,d.useCallback)((e=>{switch(e.key){case"ArrowDown":case"ArrowUp":if(e.preventDefault(),D&&!M)return void T(D["ArrowDown"===e.key?0:D.length-1]);if(D&&M){const t=D.findIndex((e=>e===M));let n="ArrowDown"===e.key?t+1:t-1;n=n<0?D.length-1:n,n=n>=D.length?0:n,T(D[n])}break;case"Enter":M&&R(M)}}),[D,M,R]),H=(0,d.useCallback)((e=>{let{nodeData:t}=e;JSON.stringify(t)===JSON.stringify(w)?"external"===t.type?t.namespace?P({type:"external",module:t.module}):P({type:"all"}):"internal"===t.type&&(t.file?P({type:"internal"}):P({type:"all"})):P(t)}),[w]),G=!s||s.some((e=>e.module.includes("@flyde/stdlib"))),L=(0,d.useCallback)((()=>{V(),i()}),[i,V]);return(0,a.jsx)(u.Dialog,{isOpen:!0,title:"Add Node Menu",onClose:e.onClose,className:"add-node-menu",isCloseButtonShown:!0,children:(0,a.jsxs)("main",{className:(0,c.default)(u.Classes.DIALOG_BODY),children:[(0,a.jsxs)("header",{children:[(0,a.jsxs)("div",{className:"bp5-input-group",children:[(0,a.jsx)(h.Search,{}),(0,a.jsx)("input",{className:"bp5-input",type:"search",placeholder:"Search input",dir:"auto",autoFocus:!0,onChange:e=>j(e.target.value),value:N,onKeyDown:$})]}),G?null:(0,a.jsxs)(u.Callout,{intent:u.Intent.NONE,style:{marginTop:10},children:["Using built-in @flyde/stdlib. It's recommended to explicitly install it instead."," ",(0,a.jsx)(u.Button,{minimal:!0,small:!0,intent:u.Intent.PRIMARY,onClick:L,children:"Click here to install it using npm/yarn"})]})]}),(0,a.jsx)("div",{className:"content-wrapper",children:s?(0,a.jsxs)(d.default.Fragment,{children:[(0,a.jsxs)("aside",{children:[(0,a.jsxs)("div",{className:"filter-header",children:["Filter by package"," ",(0,a.jsx)(u.Tooltip,{content:(0,a.jsxs)("span",{children:["Click to learn more about how packages work in Flyde"," "]}),hoverCloseDelay:1500,children:(0,a.jsx)("a",{target:"_blank",href:"https://www.flyde.dev/docs/packages",rel:"noreferrer",children:(0,a.jsx)(u.Icon,{icon:(0,a.jsx)(h.Help,{}),intent:"primary",iconSize:12})})})]}),(0,a.jsx)("div",{className:"tree-container",children:(0,a.jsx)(t.AddNodeMenuFilterTree,{contents:I(O,w,_),onNodeCollapse:A,onNodeExpand:k,onNodeClick:H,className:u.Classes.ELEVATION_0})})]}),(0,a.jsx)("main",{children:D?0===D.length?(0,a.jsxs)("div",{className:"no-results",children:[(0,a.jsx)(v.AddNodeMenuResultsSummary,{filter:w,onChangeFilter:P,query:N,onChangeQuery:j,resultsCount:D.length}),(0,a.jsxs)(u.Callout,{className:"callout",intent:"primary",children:["Can't find a suitable node? Create one yourself!"," ",(0,a.jsx)("a",{href:"https://www.flyde.dev/docs/code-nodes",target:"_blank",rel:"noreferrer",children:"Learn more"})]})]}):(0,a.jsxs)(d.default.Fragment,{children:[(0,a.jsx)(v.AddNodeMenuResultsSummary,{filter:w,onChangeFilter:P,query:N,onChangeQuery:j,resultsCount:D.length}),(0,a.jsx)("div",{className:"results",children:D.map((e=>(0,a.jsx)(g.AddNodeMenuListItem,{importableNode:e,onAdd:R,selected:(null==M?void 0:M.node)===e.node,onSelect:T,onSetFilter:P},e.node.id+e.node.namespace+e.module)))})]}):(0,a.jsx)(m.Loader,{})})]}):(0,a.jsx)(m.Loader,{})}),b.length>0?(0,a.jsxs)(u.Callout,{intent:"warning",style:{marginTop:"10px"},children:["Found ",(0,l.simplePluralize)(b.length,"corrupt flow"),(0,a.jsx)(f.InfoTooltip,{content:b.map((e=>{let{path:t,message:n}=e;return`${t}: ${n}`})).join(", ")})," "]}):null]})})}},8470:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AddNodeMenuListItem=void 0;const a=n(35250),u=n(50382),l=r(n(26372)),c=s(n(70079));t.AddNodeMenuListItem=e=>{const{importableNode:t,onSetFilter:n,onAdd:o,onSelect:i}=e,{node:s,module:r}=t,{id:d,description:p}=s,f=c.default.useRef(null);c.default.useEffect((()=>{e.selected&&f.current&&f.current.scrollIntoView({block:"center"})}),[e.selected]);const m=(0,c.useCallback)((()=>{o(t)}),[o,t]),g=(0,c.useCallback)((()=>{i(t)}),[i,t]);return(0,a.jsxs)("div",{className:(0,l.default)("add-node-menu-list-item",{selected:e.selected}),ref:f,onClick:g,children:[(0,a.jsxs)("div",{className:"content",children:[(0,a.jsxs)("header",{children:[(0,a.jsx)("span",{className:"id",children:d}),(0,a.jsxs)(u.Tag,{interactive:!0,onClick:()=>n({type:"external",module:r,namespace:s.namespace}),className:"source",minimal:!0,children:[r,s.namespace?` / ${s.namespace}`:null]})]}),(0,a.jsx)("div",{className:"description",children:p||(0,a.jsx)("em",{children:"No description"})})]}),(0,a.jsx)("aside",{children:(0,a.jsx)(u.Button,{onClick:m,children:"Add"})})]})}},87935:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(8470),t)},88671:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddNodeMenuResultsSummary=void 0;const o=n(35250),i=n(50382);t.AddNodeMenuResultsSummary=e=>{const{resultsCount:t,query:n,filter:s,onChangeFilter:r,onChangeQuery:a}=e;return(0,o.jsxs)("div",{className:"add-node-menu-results-summary",children:[t?`Showing ${t} result${t>1?"s":""}`:"No results found","\xa0",n?(0,o.jsxs)(o.Fragment,{children:["matching query\xa0",(0,o.jsxs)(i.Tag,{minimal:!0,interactive:!0,onRemove:()=>a(""),children:['"',n,'"']})]}):null,"all"===s.type?null:"external"===s.type?(0,o.jsxs)(o.Fragment,{children:["from \xa0",(0,o.jsxs)(i.Tag,{minimal:!0,interactive:!0,onRemove:()=>r({type:"all"}),children:["package ",s.module,s.namespace?` / ${s.namespace}`:null]})]}):(0,o.jsxs)(o.Fragment,{children:["from \xa0",(0,o.jsxs)(i.Tag,{minimal:!0,interactive:!0,onRemove:()=>r({type:"all"}),children:["\xa0this project ",s.file?` / ${s.file}`:null]})]})]})}},74657:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(88671),t)},9971:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(40149),t)},83159:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PromptAIMenu=void 0;const a=n(35250),u=n(50382),l=r(n(26372)),c=s(n(70079)),d=1e4;t.PromptAIMenu=e=>{const{onClose:t}=e,[n,o]=c.default.useState(""),[i,s]=c.default.useState(0);return(0,c.useEffect)((()=>{s(0);const t=setInterval((()=>{s((t=>{const n=(Date.now()-e.submitTime)/d;return Math.min(n+.05*Math.random()/2,.95)}))}),500);return()=>clearInterval(t)}),[e.submitTime]),(0,a.jsxs)(u.Dialog,{isOpen:!0,onClose:t,className:"prompt-ai-menu",title:"\u2728 Generate Code Node using AI",children:[(0,a.jsx)("main",{className:(0,l.default)(u.Classes.DIALOG_BODY),tabIndex:0,children:(0,a.jsx)(u.TextArea,{value:n,disabled:e.submitting,onChange:e=>o(e.target.value),placeholder:"Describe your node in details",fill:!0})}),e.submitTime?(0,a.jsx)("div",{className:"progress-bar-container",children:(0,a.jsx)(u.ProgressBar,{value:i})}):null,(0,a.jsx)("div",{className:u.Classes.DIALOG_FOOTER,children:(0,a.jsxs)("div",{className:u.Classes.DIALOG_FOOTER_ACTIONS,children:[(0,a.jsx)(u.Button,{onClick:t,children:"Close"}),(0,a.jsx)(u.Button,{intent:u.Intent.PRIMARY,className:"run-btn",disabled:e.submitting||!n,loading:e.submitting,onClick:()=>{s(0),e.onSubmit(n)},children:"Create \u2728"})]})})]})}},46334:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(83159),t)},3152:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RunFlowModal=void 0;const a=n(35250),u=s(n(70079)),l=r(n(51848)),c=n(50382),d=r(n(26372)),p=n(90680);t.RunFlowModal=u.memo((function(e){const{onRun:t,onClose:n,node:o}=e,[i,s]=(0,p.useLocalStorage)(`run-inputs-${o.id}`,Object.keys(o.inputs).reduce(((e,t)=>(e[t]=`Enter a value for input ${t}`,e)),{})),[r,f]=u.useState(JSON.stringify(i,null,2)),m=u.useCallback((()=>{const e=JSON.parse(r);s(e),t(e)}),[t,s,r]),g=Object.keys(o.inputs).filter((e=>"required"!==o.inputs[e].mode));return(0,a.jsxs)(c.Dialog,{isOpen:!0,onClose:e.onClose,className:"run-flow-modal",children:[(0,a.jsxs)("main",{className:(0,d.default)(c.Classes.DIALOG_BODY),onKeyDown:e=>{"Enter"===e.key&&e.metaKey&&m()},tabIndex:0,children:[(0,a.jsx)("strong",{children:"This node receives external inputs. Enter values for each input below:"}),(0,a.jsx)(l.default,{height:"80px",theme:"vs-dark",defaultLanguage:"json",value:r,onChange:e=>f(null!=e?e:""),onMount:e=>{e&&e.updateOptions({lineNumbers:"off",minimap:{enabled:!1}})}}),g.length>0?(0,a.jsxs)(c.Callout,{intent:c.Intent.NONE,children:["Note: input(s) ",(0,a.jsx)("code",{children:g.join(", ")})," are optional"]}):null]}),(0,a.jsx)("div",{className:c.Classes.DIALOG_FOOTER,children:(0,a.jsxs)("div",{className:c.Classes.DIALOG_FOOTER_ACTIONS,children:[(0,a.jsx)(c.Button,{onClick:n,children:"Close"}),(0,a.jsx)(c.Button,{onClick:m,intent:c.Intent.PRIMARY,className:"run-btn",children:"Run"})]})})]})}))},47230:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(3152),t)},47749:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.starIcon=t.stopIcon=t.playIcon=t.pencilIcon=t.ungroupIcon=t.groupIcon=t.inspectIcon=t.removeNodeIcon=t.addNodeIcon=void 0,t.addNodeIcon='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M15 7H9V1C9 0.734784 8.89464 0.48043 8.70711 0.292893C8.51957 0.105357 8.26522 0 8 0C7.73478 0 7.48043 0.105357 7.29289 0.292893C7.10536 0.48043 7 0.734784 7 1V7H1C0.734784 7 0.48043 7.10536 0.292893 7.29289C0.105357 7.48043 0 7.73478 0 8C0 8.26522 0.105357 8.51957 0.292893 8.70711C0.48043 8.89464 0.734784 9 1 9H7V15C7 15.2652 7.10536 15.5196 7.29289 15.7071C7.48043 15.8946 7.73478 16 8 16C8.26522 16 8.51957 15.8946 8.70711 15.7071C8.89464 15.5196 9 15.2652 9 15V9H15C15.2652 9 15.5196 8.89464 15.7071 8.70711C15.8946 8.51957 16 8.26522 16 8C16 7.73478 15.8946 7.48043 15.7071 7.29289C15.5196 7.10536 15.2652 7 15 7Z"/>\n</svg>',t.removeNodeIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M10.0002 18C10.2655 18 10.5198 17.8946 10.7074 17.7071C10.8949 17.5196 11.0002 17.2652 11.0002 17V11C11.0002 10.7348 10.8949 10.4804 10.7074 10.2929C10.5198 10.1054 10.2655 10 10.0002 10C9.73503 10 9.48067 10.1054 9.29314 10.2929C9.1056 10.4804 9.00024 10.7348 9.00024 11V17C9.00024 17.2652 9.1056 17.5196 9.29314 17.7071C9.48067 17.8946 9.73503 18 10.0002 18ZM20.0002 6H16.0002V5C16.0002 4.20435 15.6842 3.44129 15.1216 2.87868C14.559 2.31607 13.7959 2 13.0002 2H11.0002C10.2046 2 9.44153 2.31607 8.87892 2.87868C8.31631 3.44129 8.00024 4.20435 8.00024 5V6H4.00024C3.73503 6 3.48067 6.10536 3.29314 6.29289C3.1056 6.48043 3.00024 6.73478 3.00024 7C3.00024 7.26522 3.1056 7.51957 3.29314 7.70711C3.48067 7.89464 3.73503 8 4.00024 8H5.00024V19C5.00024 19.7956 5.31631 20.5587 5.87892 21.1213C6.44153 21.6839 7.20459 22 8.00024 22H16.0002C16.7959 22 17.559 21.6839 18.1216 21.1213C18.6842 20.5587 19.0002 19.7956 19.0002 19V8H20.0002C20.2655 8 20.5198 7.89464 20.7074 7.70711C20.8949 7.51957 21.0002 7.26522 21.0002 7C21.0002 6.73478 20.8949 6.48043 20.7074 6.29289C20.5198 6.10536 20.2655 6 20.0002 6ZM10.0002 5C10.0002 4.73478 10.1056 4.48043 10.2931 4.29289C10.4807 4.10536 10.735 4 11.0002 4H13.0002C13.2655 4 13.5198 4.10536 13.7074 4.29289C13.8949 4.48043 14.0002 4.73478 14.0002 5V6H10.0002V5ZM17.0002 19C17.0002 19.2652 16.8949 19.5196 16.7074 19.7071C16.5198 19.8946 16.2655 20 16.0002 20H8.00024C7.73503 20 7.48067 19.8946 7.29314 19.7071C7.1056 19.5196 7.00024 19.2652 7.00024 19V8H17.0002V19ZM14.0002 18C14.2655 18 14.5198 17.8946 14.7074 17.7071C14.8949 17.5196 15.0002 17.2652 15.0002 17V11C15.0002 10.7348 14.8949 10.4804 14.7074 10.2929C14.5198 10.1054 14.2655 10 14.0002 10C13.735 10 13.4807 10.1054 13.2931 10.2929C13.1056 10.4804 13.0002 10.7348 13.0002 11V17C13.0002 17.2652 13.1056 17.5196 13.2931 17.7071C13.4807 17.8946 13.735 18 14.0002 18Z"/>\n</svg>',t.inspectIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M21.07 16.8302L19 14.7102C18.5547 14.2869 17.9931 14.0065 17.3872 13.9049C16.7813 13.8034 16.1589 13.8853 15.6 14.1402L14.7 13.2402C15.7605 11.8231 16.2449 10.0569 16.0555 8.29702C15.8662 6.53718 15.0172 4.91441 13.6794 3.75539C12.3417 2.59636 10.6145 1.98714 8.84565 2.05037C7.07678 2.1136 5.39754 2.84458 4.14596 4.09615C2.89438 5.34773 2.1634 7.02698 2.10017 8.79585C2.03695 10.5647 2.64617 12.2919 3.80519 13.6296C4.96421 14.9674 6.58699 15.8164 8.34683 16.0057C10.1067 16.1951 11.8729 15.7107 13.29 14.6502L14.18 15.5402C13.8951 16.0998 13.793 16.7348 13.8881 17.3555C13.9831 17.9762 14.2706 18.5515 14.71 19.0002L16.83 21.1202C17.3925 21.682 18.155 21.9975 18.95 21.9975C19.745 21.9975 20.5075 21.682 21.07 21.1202C21.3557 20.8408 21.5828 20.5071 21.7378 20.1388C21.8928 19.7704 21.9726 19.3748 21.9726 18.9752C21.9726 18.5756 21.8928 18.1799 21.7378 17.8116C21.5828 17.4432 21.3557 17.1096 21.07 16.8302V16.8302ZM12.59 12.5902C11.8902 13.2882 10.9993 13.7631 10.0297 13.955C9.06017 14.1469 8.05549 14.0472 7.14259 13.6684C6.2297 13.2896 5.44955 12.6487 4.9007 11.8267C4.35185 11.0048 4.05893 10.0386 4.05893 9.05019C4.05893 8.06182 4.35185 7.09562 4.9007 6.27365C5.44955 5.45168 6.2297 4.81081 7.14259 4.432C8.05549 4.05319 9.06017 3.95343 10.0297 4.14534C10.9993 4.33724 11.8902 4.81219 12.59 5.51019C13.0556 5.97464 13.4251 6.5264 13.6771 7.13385C13.9292 7.7413 14.0589 8.39251 14.0589 9.05019C14.0589 9.70786 13.9292 10.3591 13.6771 10.9665C13.4251 11.574 13.0556 12.1257 12.59 12.5902V12.5902ZM19.66 19.6602C19.567 19.7539 19.4564 19.8283 19.3346 19.8791C19.2127 19.9298 19.082 19.956 18.95 19.956C18.818 19.956 18.6873 19.9298 18.5654 19.8791C18.4436 19.8283 18.333 19.7539 18.24 19.6602L16.12 17.5402C16.0263 17.4472 15.9519 17.3366 15.9011 17.2148C15.8503 17.0929 15.8242 16.9622 15.8242 16.8302C15.8242 16.6982 15.8503 16.5675 15.9011 16.4456C15.9519 16.3237 16.0263 16.2131 16.12 16.1202C16.213 16.0265 16.3236 15.9521 16.4454 15.9013C16.5673 15.8505 16.698 15.8244 16.83 15.8244C16.962 15.8244 17.0927 15.8505 17.2146 15.9013C17.3364 15.9521 17.447 16.0265 17.54 16.1202L19.66 18.2402C19.7537 18.3331 19.8281 18.4437 19.8789 18.5656C19.9297 18.6875 19.9558 18.8182 19.9558 18.9502C19.9558 19.0822 19.9297 19.2129 19.8789 19.3348C19.8281 19.4566 19.7537 19.5672 19.66 19.6602V19.6602Z"/>\n</svg>\n',t.groupIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M16 9.99998H14V7.99998C14 7.73477 13.8946 7.48041 13.7071 7.29288C13.5196 7.10534 13.2652 6.99998 13 6.99998H7.99998C7.73477 6.99998 7.48041 7.10534 7.29288 7.29288C7.10534 7.48041 6.99998 7.73477 6.99998 7.99998V13C6.99998 13.2652 7.10534 13.5196 7.29288 13.7071C7.48041 13.8946 7.73477 14 7.99998 14H9.99998V16C9.99998 16.2652 10.1053 16.5196 10.2929 16.7071C10.4804 16.8946 10.7348 17 11 17H16C16.2652 17 16.5196 16.8946 16.7071 16.7071C16.8946 16.5196 17 16.2652 17 16V11C17 10.7348 16.8946 10.4804 16.7071 10.2929C16.5196 10.1053 16.2652 9.99998 16 9.99998ZM9.99998 11V12H8.99998V8.99998H12V9.99998H11C10.7348 9.99998 10.4804 10.1053 10.2929 10.2929C10.1053 10.4804 9.99998 10.7348 9.99998 11ZM15 15H12V12H15V15ZM21 18.28V5.71998C21.2704 5.56955 21.5023 5.3584 21.6773 5.10317C21.8523 4.84793 21.9657 4.55556 22.0085 4.24906C22.0514 3.94257 22.0225 3.63031 21.9242 3.33686C21.8259 3.04342 21.6608 2.77679 21.442 2.55795C21.2232 2.33912 20.9565 2.17406 20.6631 2.07575C20.3697 1.97745 20.0574 1.94858 19.7509 1.99143C19.4444 2.03427 19.152 2.14766 18.8968 2.32267C18.6416 2.49768 18.4304 2.72953 18.28 2.99998H5.71998C5.56955 2.72953 5.3584 2.49768 5.10317 2.32267C4.84793 2.14766 4.55556 2.03427 4.24906 1.99143C3.94257 1.94858 3.63031 1.97745 3.33686 2.07575C3.04342 2.17406 2.77679 2.33912 2.55795 2.55795C2.33912 2.77679 2.17406 3.04342 2.07575 3.33686C1.97745 3.63031 1.94858 3.94257 1.99143 4.24906C2.03427 4.55556 2.14766 4.84793 2.32267 5.10317C2.49768 5.3584 2.72953 5.56955 2.99998 5.71998V18.28C2.72953 18.4304 2.49768 18.6416 2.32267 18.8968C2.14766 19.152 2.03427 19.4444 1.99143 19.7509C1.94858 20.0574 1.97745 20.3697 2.07575 20.6631C2.17406 20.9565 2.33912 21.2232 2.55795 21.442C2.77679 21.6608 3.04342 21.8259 3.33686 21.9242C3.63031 22.0225 3.94257 22.0514 4.24906 22.0085C4.55556 21.9657 4.84793 21.8523 5.10317 21.6773C5.3584 21.5023 5.56955 21.2704 5.71998 21H18.28C18.4304 21.2704 18.6416 21.5023 18.8968 21.6773C19.152 21.8523 19.4444 21.9657 19.7509 22.0085C20.0574 22.0514 20.3697 22.0225 20.6631 21.9242C20.9565 21.8259 21.2232 21.6608 21.442 21.442C21.6608 21.2232 21.8259 20.9565 21.9242 20.6631C22.0225 20.3697 22.0514 20.0574 22.0085 19.7509C21.9657 19.4444 21.8523 19.152 21.6773 18.8968C21.5023 18.6416 21.2704 18.4304 21 18.28ZM19 18.28C18.6993 18.4504 18.4504 18.6993 18.28 19H5.71998C5.54956 18.6993 5.30071 18.4504 4.99998 18.28V5.71998C5.30071 5.54956 5.54956 5.30071 5.71998 4.99998H18.28C18.4504 5.30071 18.6993 5.54956 19 5.71998V18.28Z"/>\n</svg>\n',t.ungroupIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M21.0002 18.28V11.72C21.2707 11.5695 21.5025 11.3584 21.6775 11.1032C21.8525 10.8479 21.9659 10.5556 22.0088 10.2491C22.0516 9.94257 22.0228 9.63031 21.9245 9.33686C21.8262 9.04342 21.6611 8.77679 21.4423 8.55795C21.2234 8.33912 20.9568 8.17406 20.6633 8.07575C20.3699 7.97745 20.0576 7.94858 19.7511 7.99143C19.4447 8.03427 19.1523 8.14766 18.897 8.32267C18.6418 8.49768 18.4307 8.72953 18.2802 8.99998H15.0002V5.71998C15.2707 5.56955 15.5025 5.3584 15.6775 5.10317C15.8525 4.84793 15.9659 4.55556 16.0088 4.24906C16.0516 3.94257 16.0228 3.63031 15.9245 3.33686C15.8262 3.04342 15.6611 2.77679 15.4423 2.55795C15.2234 2.33912 14.9568 2.17406 14.6633 2.07575C14.3699 1.97745 14.0576 1.94858 13.7511 1.99143C13.4447 2.03427 13.1523 2.14766 12.897 2.32267C12.6418 2.49768 12.4307 2.72953 12.2802 2.99998H5.72023C5.56979 2.72953 5.35865 2.49768 5.10341 2.32267C4.84817 2.14766 4.5558 2.03427 4.24931 1.99143C3.94281 1.94858 3.63055 1.97745 3.33711 2.07575C3.04366 2.17406 2.77703 2.33912 2.5582 2.55795C2.33937 2.77679 2.1743 3.04342 2.076 3.33686C1.97769 3.63031 1.94883 3.94257 1.99167 4.24906C2.03452 4.55556 2.14791 4.84793 2.32291 5.10317C2.49792 5.3584 2.72977 5.56955 3.00023 5.71998V12.28C2.72977 12.4304 2.49792 12.6416 2.32291 12.8968C2.14791 13.152 2.03452 13.4444 1.99167 13.7509C1.94883 14.0574 1.97769 14.3697 2.076 14.6631C2.1743 14.9565 2.33937 15.2232 2.5582 15.442C2.77703 15.6608 3.04366 15.8259 3.33711 15.9242C3.63055 16.0225 3.94281 16.0514 4.24931 16.0085C4.5558 15.9657 4.84817 15.8523 5.10341 15.6773C5.35865 15.5023 5.56979 15.2704 5.72023 15H9.00023V18.28C8.72977 18.4304 8.49792 18.6416 8.32291 18.8968C8.14791 19.152 8.03452 19.4444 7.99167 19.7509C7.94883 20.0574 7.97769 20.3697 8.076 20.6631C8.1743 20.9565 8.33937 21.2232 8.5582 21.442C8.77703 21.6608 9.04366 21.8259 9.33711 21.9242C9.63055 22.0225 9.94281 22.0514 10.2493 22.0085C10.5558 21.9657 10.8482 21.8523 11.1034 21.6773C11.3586 21.5023 11.5698 21.2704 11.7202 21H18.2802C18.4307 21.2704 18.6418 21.5023 18.897 21.6773C19.1523 21.8523 19.4447 21.9657 19.7511 22.0085C20.0576 22.0514 20.3699 22.0225 20.6633 21.9242C20.9568 21.8259 21.2234 21.6608 21.4423 21.442C21.6611 21.2232 21.8262 20.9565 21.9245 20.6631C22.0228 20.3697 22.0516 20.0574 22.0088 19.7509C21.9659 19.4444 21.8525 19.152 21.6775 18.8968C21.5025 18.6416 21.2707 18.4304 21.0002 18.28ZM8.00023 9.99998C8.00233 10.349 8.09574 10.6914 8.27118 10.9932C8.44661 11.2949 8.69795 11.5455 9.00023 11.72V13H5.72023C5.5498 12.6993 5.30096 12.4504 5.00023 12.28V5.71998C5.30096 5.54956 5.5498 5.30071 5.72023 4.99998H12.2802C12.4507 5.30071 12.6995 5.54956 13.0002 5.71998V8.99998H11.7202C11.4975 8.62457 11.1581 8.33233 10.7538 8.16784C10.3495 8.00335 9.90245 7.97565 9.48092 8.08896C9.05939 8.20228 8.6865 8.45039 8.41915 8.79543C8.15181 9.14047 8.00468 9.56351 8.00023 9.99998V9.99998ZM13.0002 11V12.28C12.6995 12.4504 12.4507 12.6993 12.2802 13H11.0002V11.72C11.301 11.5496 11.5498 11.3007 11.7202 11H13.0002ZM19.0002 18.28C18.6995 18.4504 18.4507 18.6993 18.2802 19H11.7202C11.5498 18.6993 11.301 18.4504 11.0002 18.28V15H12.2802C12.4307 15.2704 12.6418 15.5023 12.897 15.6773C13.1523 15.8523 13.4447 15.9657 13.7511 16.0085C14.0576 16.0514 14.3699 16.0225 14.6633 15.9242C14.9568 15.8259 15.2234 15.6608 15.4423 15.442C15.6611 15.2232 15.8262 14.9565 15.9245 14.6631C16.0228 14.3697 16.0516 14.0574 16.0088 13.7509C15.9659 13.4444 15.8525 13.152 15.6775 12.8968C15.5025 12.6416 15.2707 12.4304 15.0002 12.28V11H18.2802C18.4507 11.3007 18.6995 11.5496 19.0002 11.72V18.28Z"/>\n</svg>\n',t.pencilIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M5 17.9999H9.24C9.37161 18.0007 9.50207 17.9755 9.62391 17.9257C9.74574 17.8759 9.85656 17.8026 9.95 17.7099L16.87 10.7799L19.71 7.99994C19.8037 7.90698 19.8781 7.79637 19.9289 7.67452C19.9797 7.55266 20.0058 7.42195 20.0058 7.28994C20.0058 7.15793 19.9797 7.02722 19.9289 6.90536C19.8781 6.7835 19.8037 6.6729 19.71 6.57994L15.47 2.28994C15.377 2.19621 15.2664 2.12182 15.1446 2.07105C15.0227 2.02028 14.892 1.99414 14.76 1.99414C14.628 1.99414 14.4973 2.02028 14.3754 2.07105C14.2536 2.12182 14.143 2.19621 14.05 2.28994L11.23 5.11994L4.29 12.0499C4.19732 12.1434 4.12399 12.2542 4.07423 12.376C4.02446 12.4979 3.99924 12.6283 4 12.7599V16.9999C4 17.2652 4.10536 17.5195 4.29289 17.707C4.48043 17.8946 4.73478 17.9999 5 17.9999ZM14.76 4.40994L17.59 7.23994L16.17 8.65994L13.34 5.82994L14.76 4.40994ZM6 13.1699L11.93 7.23994L14.76 10.0699L8.83 15.9999H6V13.1699ZM21 19.9999H3C2.73478 19.9999 2.48043 20.1053 2.29289 20.2928C2.10536 20.4804 2 20.7347 2 20.9999C2 21.2652 2.10536 21.5195 2.29289 21.707C2.48043 21.8946 2.73478 21.9999 3 21.9999H21C21.2652 21.9999 21.5196 21.8946 21.7071 21.707C21.8946 21.5195 22 21.2652 22 20.9999C22 20.7347 21.8946 20.4804 21.7071 20.2928C21.5196 20.1053 21.2652 19.9999 21 19.9999Z"/>\n</svg>',t.playIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M18.54 9.00027L8.87997 3.46027C8.35725 3.15843 7.76397 3.00031 7.16036 3.00197C6.55676 3.00362 5.96435 3.165 5.4433 3.46971C4.92225 3.77442 4.49112 4.2116 4.19372 4.73685C3.89631 5.2621 3.74321 5.8567 3.74997 6.46027V17.5803C3.74997 18.4873 4.11029 19.3572 4.75167 19.9986C5.39304 20.6399 6.26293 21.0003 7.16997 21.0003C7.77041 20.9993 8.36006 20.8406 8.87997 20.5403L18.54 15.0003C19.059 14.6999 19.49 14.2682 19.7896 13.7487C20.0891 13.2292 20.2468 12.64 20.2468 12.0403C20.2468 11.4405 20.0891 10.8514 19.7896 10.3318C19.49 9.8123 19.059 9.38068 18.54 9.08027V9.00027ZM17.54 13.1903L7.87997 18.8103C7.66346 18.933 7.41884 18.9975 7.16997 18.9975C6.9211 18.9975 6.67648 18.933 6.45997 18.8103C6.24407 18.6856 6.06479 18.5063 5.94015 18.2904C5.81552 18.0745 5.74993 17.8296 5.74997 17.5803V6.42027C5.74993 6.17097 5.81552 5.92605 5.94015 5.71013C6.06479 5.49422 6.24407 5.31492 6.45997 5.19027C6.67738 5.06943 6.92127 5.00416 7.16997 5.00027C7.4185 5.00537 7.66211 5.07056 7.87997 5.19027L17.54 10.7703C17.756 10.8949 17.9353 11.0741 18.06 11.2901C18.1847 11.506 18.2504 11.7509 18.2504 12.0003C18.2504 12.2496 18.1847 12.4946 18.06 12.7105C17.9353 12.9264 17.756 13.1057 17.54 13.2303V13.1903Z"/>\n</svg>\n',t.stopIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M15 8H9C8.73479 8 8.48043 8.10536 8.2929 8.29289C8.10536 8.48043 8 8.73478 8 9V15C8 15.2652 8.10536 15.5196 8.2929 15.7071C8.48043 15.8946 8.73479 16 9 16H15C15.2652 16 15.5196 15.8946 15.7071 15.7071C15.8946 15.5196 16 15.2652 16 15V9C16 8.73478 15.8946 8.48043 15.7071 8.29289C15.5196 8.10536 15.2652 8 15 8ZM14 14H10V10H14V14ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2V2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20V20Z"/>\n</svg>\n',t.starIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M22 9.66966C21.9368 9.48674 21.822 9.32608 21.6693 9.20716C21.5167 9.08823 21.3328 9.01615 21.14 8.99966L15.45 8.16966L12.9 2.99966C12.8181 2.83059 12.6902 2.688 12.5311 2.58823C12.3719 2.48846 12.1878 2.43555 12 2.43555C11.8121 2.43555 11.6281 2.48846 11.4689 2.58823C11.3097 2.688 11.1819 2.83059 11.1 2.99966L8.54998 8.15966L2.85998 8.99966C2.6749 9.02596 2.5009 9.10362 2.35773 9.22381C2.21455 9.34401 2.10794 9.50193 2.04998 9.67966C1.99692 9.85333 1.99216 10.0382 2.03621 10.2143C2.08025 10.3905 2.17144 10.5514 2.29998 10.6797L6.42998 14.6797L5.42998 20.3597C5.3896 20.5481 5.40453 20.7442 5.47296 20.9243C5.54139 21.1044 5.66041 21.261 5.81571 21.3751C5.971 21.4891 6.15595 21.5559 6.34831 21.5674C6.54066 21.5789 6.73224 21.5345 6.89998 21.4397L12 18.7697L17.1 21.4397C17.2403 21.5188 17.3988 21.5602 17.56 21.5597C17.7718 21.5604 17.9784 21.4939 18.15 21.3697C18.3051 21.2585 18.4252 21.1053 18.4961 20.9281C18.567 20.7509 18.5857 20.5571 18.55 20.3697L17.55 14.6897L21.68 10.6897C21.8244 10.5673 21.9311 10.4066 21.9877 10.226C22.0444 10.0455 22.0486 9.85253 22 9.66966ZM15.85 13.6697C15.7342 13.7821 15.6474 13.9208 15.5969 14.074C15.5464 14.2273 15.5337 14.3905 15.56 14.5497L16.28 18.7497L12.52 16.7497C12.3738 16.6774 12.213 16.6398 12.05 16.6398C11.8869 16.6398 11.7261 16.6774 11.58 16.7497L7.81998 18.7497L8.53998 14.5497C8.56622 14.3905 8.55354 14.2273 8.50305 14.074C8.45255 13.9208 8.36572 13.7821 8.24998 13.6697L5.24998 10.6697L9.45998 10.0597C9.62198 10.0371 9.77598 9.9752 9.90848 9.87931C10.041 9.78342 10.1479 9.65649 10.22 9.50966L12 5.69966L13.88 9.51966C13.952 9.66649 14.059 9.79342 14.1915 9.88931C14.324 9.9852 14.478 10.0471 14.64 10.0697L18.85 10.6797L15.85 13.6697Z"/>\n</svg>\n\n\n'},1237:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HelpBubble=void 0;const i=n(70079),s=n(35250),r=n(50382),a=n(99489),u=n(50382),l=o(n(70079)),c=n(68120),d=n(71644),p=n(43490),f={offset:{enabled:!0,options:{offset:[0,20]}},preventOverflow:{enabled:!0,options:{padding:10}}};const m=["Viewport Controls","Editing","Selection"];t.HelpBubble=()=>{const[e,t]=l.default.useState(!1),n=Array.from(c.currentHotkeys.entries()).map((e=>{let[t,n]=e;return{combo:(o={key:t,menuData:n}).key,label:o.menuData.text,group:o.menuData.group};var o})).reduce(((e,t)=>(e[t.group]||(e[t.group]=[]),e[t.group].push(t),e)),{}),o=Object.entries(n).sort(((e,t)=>m.indexOf(t[0])-m.indexOf(e[0]))),{reportEvent:g}=(0,p.usePorts)(),v=(0,s.jsx)(r.Dialog,{isOpen:e,onClose:()=>t(!1),children:(0,s.jsx)("div",{className:r.Classes.DIALOG_BODY,children:o.map((e=>{let[t,n]=e;return(0,s.jsxs)(l.default.Fragment,{children:[(0,s.jsx)(r.H4,{children:t}),n.map((e=>(0,i.createElement)(a.Hotkey,{...e,key:e.combo})))]},t)}))})}),h=(0,s.jsxs)(r.Menu,{children:[(0,s.jsx)(r.MenuItem,{text:"Hotkeys",onClick:()=>{t(!0),g("helpMenuItem",{item:"hotkeys"})}}),(0,s.jsx)(r.MenuItem,{text:"Documentation",onClick:()=>g("helpMenuItem",{item:"documentation"}),href:"https://www.flyde.dev/docs",target:"_blank"}),(0,s.jsx)(r.MenuDivider,{}),(0,s.jsx)(r.MenuItem,{text:"Discord",onClick:()=>g("helpMenuItem",{item:"discord"}),href:"https://discord.gg/x7t4tjZQP8",target:"_blank"})]});return(0,s.jsxs)("div",{className:"help-bubble","data-tip":"Help",children:[(0,s.jsx)(u.Popover,{content:h,modifiers:f,onOpened:()=>g("helpMenuOpen",{}),children:(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:d.helpIcon}})}),v]})}},71644:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.helpIcon=void 0,t.helpIcon='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M11.29 15.29C11.247 15.3375 11.2069 15.3876 11.17 15.44C11.1322 15.4957 11.1019 15.5563 11.08 15.62C11.0512 15.6767 11.031 15.7374 11.02 15.8C11.0151 15.8666 11.0151 15.9334 11.02 16C11.0166 16.1312 11.044 16.2613 11.1 16.38C11.1449 16.5041 11.2166 16.6168 11.3099 16.7101C11.4032 16.8034 11.5159 16.8751 11.64 16.92C11.7597 16.9729 11.8891 17.0002 12.02 17.0002C12.1509 17.0002 12.2803 16.9729 12.4 16.92C12.5241 16.8751 12.6368 16.8034 12.7301 16.7101C12.8234 16.6168 12.8951 16.5041 12.94 16.38C12.9844 16.2584 13.0048 16.1294 13 16C13.0008 15.8684 12.9755 15.7379 12.9258 15.6161C12.876 15.4943 12.8027 15.3834 12.71 15.29C12.617 15.1963 12.5064 15.1219 12.3846 15.0711C12.2627 15.0203 12.132 14.9942 12 14.9942C11.868 14.9942 11.7373 15.0203 11.6154 15.0711C11.4936 15.1219 11.383 15.1963 11.29 15.29ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2V2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20V20ZM12 7C11.4731 6.99966 10.9553 7.13812 10.4989 7.40144C10.0425 7.66476 9.66347 8.04366 9.4 8.5C9.32765 8.61382 9.27907 8.7411 9.25718 8.87418C9.23529 9.00726 9.24055 9.14339 9.27263 9.27439C9.30472 9.40538 9.36297 9.52854 9.44389 9.63643C9.5248 9.74433 9.62671 9.83475 9.74348 9.90224C9.86024 9.96974 9.98945 10.0129 10.1233 10.0292C10.2572 10.0454 10.393 10.0345 10.5225 9.99688C10.6521 9.9593 10.7727 9.89591 10.8771 9.81052C10.9814 9.72513 11.0675 9.61951 11.13 9.5C11.2181 9.3474 11.345 9.22078 11.4978 9.13298C11.6505 9.04518 11.8238 8.9993 12 9C12.2652 9 12.5196 9.10536 12.7071 9.29289C12.8946 9.48043 13 9.73478 13 10C13 10.2652 12.8946 10.5196 12.7071 10.7071C12.5196 10.8946 12.2652 11 12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V13C11 13.2652 11.1054 13.5196 11.2929 13.7071C11.4804 13.8946 11.7348 14 12 14C12.2652 14 12.5196 13.8946 12.7071 13.7071C12.8946 13.5196 13 13.2652 13 13V12.82C13.6614 12.58 14.2174 12.1152 14.5708 11.5069C14.9242 10.8985 15.0525 10.1853 14.9334 9.49189C14.8143 8.79849 14.4552 8.16902 13.919 7.71352C13.3828 7.25801 12.7035 7.00546 12 7V7Z"/>\n</svg>\n'},3354:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(1237),t)},7011:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MainInstanceEventsIndicator=void 0;const o=n(35250),i=n(30994),s=n(66189),r=n(50382);t.MainInstanceEventsIndicator=e=>{const{currentInsId:t,ancestorsInsIds:n}=e,{history:a,refreshHistory:u,resetHistory:l}=(0,s.useHistoryHelpers)(t),c=`main-indicator-${t}}`;return(0,o.jsx)("div",{className:"main-instance-events-indicator",children:(0,o.jsx)(r.Tooltip,{content:(0,s.calcHistoryContent)(a),children:(0,o.jsx)("span",{onMouseEnter:u,onMouseOut:l,id:(0,i.getMainInstanceIndicatorDomId)(t,n),className:"status-text","data-tip":"","data-html":!0,"data-for":c})})})}},22714:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(7011),t)},63521:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VisualNodeEditor=t.defaultBoardData=t.defaultViewPort=t.NODE_HEIGHT=void 0;const a=n(35250),u=s(n(70079)),l=n(74762),c=n(86553),d=n(65082),p=n(18420),f=n(26701),m=n(7047),g=n(53865),v=n(70079),h=n(68120),I=r(n(27942)),y=n(50382),b=n(66005),C=n(60190),_=n(71033),x=n(74762),N=n(99942),j=n(44338),w=n(561),P=n(84472),O=n(82232),E=n(18594),D=n(68371),S=r(n(61888)),M=n(65758),T=n(43490),k=r(n(26372)),A=n(25044),R=n(80510),V=n(1788),z=n(2130),$=n(88593),H=n(97106),G=n(67181),L=n(22714),B=n(3354),F=n(41032),U=u.memo(y.Slider),q=()=>null;t.NODE_HEIGHT=28;t.defaultViewPort={pos:{x:0,y:0},zoom:1},t.defaultBoardData={selected:[],viewPort:t.defaultViewPort,lastMousePos:{x:0,y:0}},t.VisualNodeEditor=u.memo(u.forwardRef(((e,n)=>{const{onChangeNode:o,nodeIoEditable:i,onCopy:s,onGoToNodeDef:r,onInspectPin:Z,boardData:J,onChangeBoardData:Y,currentInsId:K,ancestorsInsIds:X,node:Q,onShowOmnibar:ee,resolvedDependencies:te,queuedInputsData:ne,initialPadding:oe,disableScrolling:ie}=e,{onImportNode:se}=(0,H.useDependenciesContext)(),{reportEvent:re}=(0,T.usePorts)(),ae=e.parentViewport||t.defaultViewPort,[ue,le]=(0,v.useState)({...te,[Q.id]:Q});(0,v.useEffect)((()=>{le({...te,[Q.id]:Q})}),[te,Q]);const{selected:ce,from:de,to:pe}=J,{instances:fe,connections:me,inputsPosition:ge,outputsPosition:ve,inputs:he,outputs:Ie}=Q,[ye,be]=(0,v.useState)(),[Ce,_e]=(0,v.useState)(),xe=void 0===X,[Ne,je]=(0,v.useState)(0),[we,Pe]=(0,v.useState)(),[Oe,Ee]=(0,v.useState)(!1),[De,Se]=(0,v.useState)(),[Me,Te]=(0,v.useState)(),[ke,Ae]=(0,v.useState)(),[Re,Ve]=(0,v.useState)(),ze=(0,v.useRef)();(0,f.useDidMount)((()=>{ze.current=Ke.current.querySelector(".inline-editor-portal-root")}));const $e=(0,T.useConfirm)(),He=(0,T.usePrompt)(),Ge=J.viewPort,Le=(0,v.useRef)(!0),[Be,Fe]=(0,v.useState)(null),Ue=u.useCallback((e=>{Y({viewPort:e})}),[Y]),qe=u.useCallback(((e,t)=>Z(e,t)),[Z]),We=u.useCallback(((e,t,n)=>{const i=(0,R.handleConnectionCloseEditorCommand)(Q,{from:e,to:t}),s=(0,l.isInternalConnectionNode)(t)?fe.find((e=>e.id===t.insId)):null,r=(s?s.inputConfig:{})[t.pinId],a=(0,l.isStaticInputPinConfig)(r)?(0,V.handleDetachConstEditorCommand)(i,t.insId,t.pinId):i;o(a,(0,O.functionalChange)("close-connection")),Y({from:void 0,to:void 0}),re("createConnection",{source:n})}),[fe,o,Y,Q,re]),Ze=u.useCallback((async()=>{const e=await He("New visual node name?");if(!e)return;const{currentNode:t}=await(0,M.groupSelected)(J.selected,Q,e,"inline",He);o(t,(0,O.functionalChange)("group node")),(0,P.toastMsg)("Node grouped"),re("groupSelected",{count:J.selected.length})}),[He,J.selected,o,Q,re]);(0,v.useEffect)((()=>{if(we){const e=setTimeout((()=>{Pe(void 0)}),350);return()=>clearTimeout(e)}}),[we]);const[Je,Ye]=(0,v.useState)();(0,v.useEffect)((()=>{(0,w.preloadMonaco)()}),[]);const Ke=(0,v.useRef)(),Xe=(0,I.default)(Ke),Qe=u.useRef({x:400,y:400}),et=(0,f.useBoundingclientrect)(Ke)||C.vZero,tt=()=>{const e=(0,m.fitViewPortToNode)(Q,ue,Xe);(0,m.animateViewPort)(Ge,e,500,(e=>{Ue(e)}))},nt=u.useCallback(((e,t)=>{const{to:n,from:o}=J,i="input"===t?o:n,s="input"===t?n:o,r={pinId:e,insId:l.THIS_INS_ID},a="input"===t?{from:r}:{to:r};i&&i.pinId===e?Y({from:void 0,to:void 0}):s?"input"===t&&n?We(r,n,"nodeIoClick"):o&&We(o,r,"nodeIoClick"):Y(a)}),[J,Y,We]),ot=u.useCallback(((e,t,n)=>{const i=(0,g.produce)(Q,(o=>{"input"===e?o.inputs[t].description=n:o.outputs[t].description=n}));o(i,(0,O.functionalChange)("Node io description"))}),[o,Q]),it=u.useCallback(((e,t,n)=>{const{from:o,to:i}=J;if(de&&de.insId===e.id||pe&&pe.insId===e.id)Y({from:void 0,to:void 0});else if("input"===n){const n={insId:e.id,pinId:t};!i||i.pinId!==t||(0,l.isInternalConnectionNode)(i)&&i.insId!==e.id?de?We(de,n,"pinClick"):Y({to:n,selected:[]}):Y({to:void 0})}else{const n={insId:e.id,pinId:t};!o||o.pinId!==t||(0,l.isInternalConnectionNode)(o)&&o.insId!==e.id?pe?We(n,pe,"pinClick"):Y({from:n,selected:[]}):Y({from:void 0})}}),[J,de,Y,We,pe]);(0,v.useEffect)((()=>{if(!Oe&&Xe.width){const t=(0,m.fitViewPortToNode)(Q,ue,Xe,oe);Ue(t);const n=setTimeout((()=>{const t=(0,m.fitViewPortToNode)(Q,ue,Xe,oe);e.thumbnailMode||Ue(t),Ee(!0)}),100);return()=>clearTimeout(n)}}),[Q,oe,Xe,e.thumbnailMode,Oe,ue,Ue]);const st=u.useCallback((()=>{const{selected:e}=J,t=Q.instances.filter((t=>e.includes(t.id))).map((e=>({...e,id:e.id+"-copy"}))),n=Q.connections.filter((t=>{let{from:n,to:o}=t;return e.includes(n.insId)&&e.includes(o.insId)}));s({instances:t,connections:n})}),[J,s,Q]),rt=u.useCallback((()=>{const{newNode:t,newInstances:n}=(0,A.pasteInstancesCommand)(Q,Qe.current,e.clipboardData);o(t,(0,O.functionalChange)("paste instances")),Y({selected:n.map((e=>e.id))})}),[o,Y,Q,e.clipboardData]),at=u.useCallback((()=>{const e=Q.id;Je?"input"===Je.type?Je.ins.id===e?nt(Je.pin,"input"):it(Je.ins,Je.pin,"input"):Je.ins.id===e?nt(Je.pin,"output"):it(Je.ins,Je.pin,"output"):console.warn("tried selecting closest with no pin nearby")}),[Q.id,Je,nt,it]),ut=u.useCallback(((e,t)=>{const n=Math.min(Math.max(e,.1),3),o="mouse"===t?Qe.current:{x:Ge.pos.x+Xe.width/2,y:Ge.pos.y+Xe.height/2},i=(0,m.centerBoardPosOnTarget)(o,Xe,n,Ge);Ue({...Ge,zoom:n,pos:i})}),[Ue,Ge,Xe]);(0,h.useHotkeys)("cmd+=",(e=>{ut(Ge.zoom+.1,"hotkey"),e.preventDefault()}),{text:"Zoom in board",group:"Viewport Controls"},[Ge,ut],Le),(0,h.useHotkeys)("cmd+-",(e=>{ut(Ge.zoom-.1,"hotkey"),e.preventDefault()}),{text:"Zoom out board",group:"Viewport Controls"},[ut,Ge.zoom],Le),(0,h.useHotkeys)("cmd+o",(e=>{e.preventDefault(),(0,P.toastMsg)("Ordering");const t=[];(0,N.orderVisualNode)(Q,ue,200,((e,n)=>{n%3==0&&t.push(e)})),(async()=>{for(;t.length;){const e=t.shift();(0,P.toastMsg)(`Step ${t.length}!`),await(0,l.delay)(200),o(e,(0,O.metaChange)("order-step")),(0,P.toastMsg)(`Step ${t.length}! done`)}})()}),{text:"Auto-layout (experimental)",group:"Misc."},[o,Q,te],Le),(0,h.useHotkeys)("cmd+0",(e=>{ut(1),e.preventDefault()}),{text:"Reset zoom",group:"Viewport Controls"},[Ge,ut],Le);const lt=()=>{Y({from:void 0,to:void 0,selected:[]})},ct=u.useCallback(((e,t)=>{be(e.id),o({...Q},(0,O.metaChange)("drag-start"))}),[o,Q]),dt=u.useCallback(((e,t,n)=>{const{newValue:i,newSelected:s}=(0,m.handleInstanceDrag)(Q,e,n,t,ce,ye);o(i,(0,O.metaChange)("drag-move")),s&&Y({selected:s})}),[ye,o,Y,ce,Q]),pt=u.useCallback(((e,t)=>{t.preventDefault(),t.stopPropagation(),be(void 0)}),[]),ft=u.useCallback(((e,t)=>{t.preventDefault(),t.stopPropagation(),be(l.THIS_INS_ID)}),[]),mt=u.useCallback((async(t,n,o,i)=>{o.preventDefault(),o.stopPropagation();const{x:s,y:r}=i,a=(0,g.produce)(Q,(e=>{"input"===t?e.inputsPosition[n]={x:s,y:r}:e.outputsPosition[n]={x:s,y:r}}));e.onChangeNode(a,(0,O.metaChange)("node-io-drag-move"))}),[e,Q]),gt=u.useCallback((async(e,t,n,o)=>{n.preventDefault(),n.stopPropagation(),be(void 0)}),[]),vt=u.useCallback(((e,t)=>{let{id:n}=e;const o=t.shiftKey?ce.filter((e=>e!==n)):[],i=t.shiftKey?[...ce,n]:[n],s=ce.includes(n)?o:i;Y({selected:s,from:void 0,to:void 0})}),[Y,ce]),ht=u.useCallback((()=>{const e=Q.instances.map((e=>e.id));Y({selected:e,from:void 0,to:void 0})}),[Y,Q.instances]),It=u.useCallback((e=>{const t=me.filter((t=>{let{from:n,to:o}=t;return-1===e.indexOf(n.insId)&&-1===e.indexOf(o.insId)})),n=(0,g.produce)(Q,(n=>{n.connections=t,n.instances=n.instances.filter((t=>!e.includes(t.id)))}));Y({selected:[]}),o(n,(0,O.functionalChange)("delete-ins"))}),[me,o,Y,Q]),yt=u.useCallback((e=>{It([e.id])}),[It]),bt=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{"input"===e?(delete n.inputs[t],n.connections=n.connections.filter((e=>!((0,l.isExternalConnectionNode)(e.from)&&e.from.pinId===t)))):(n.connections=n.connections.filter((e=>!((0,l.isExternalConnectionNode)(e.to)&&e.to.pinId===t))),n.completionOutputs=(n.completionOutputs||[]).map((e=>e.split("+").filter((e=>e!==t)).join("+"))).filter((e=>!!e)),delete n.outputs[t])}));de&&de.insId===l.THIS_INS_ID&&de.pinId===t?Y({from:void 0}):pe&&pe.insId===l.THIS_INS_ID&&pe.pinId===t&&Y({to:void 0}),o(n,(0,O.functionalChange)("remove io pin"))}),[Q,de,pe,o,Y]),Ct=u.useCallback((async()=>{const{selected:e,from:t,to:n}=J;0===e.length?t&&(0,l.isExternalConnectionNode)(t)?await $e(`Are you sure you want to remove main input ${t.pinId}?`)&&bt("input",t.pinId):n&&(0,l.isExternalConnectionNode)(n)&&await $e(`Are you sure you want to remove main output ${n.pinId}?`)&&bt("output",n.pinId):It(e)}),[$e,J,It,bt]),_t=u.useCallback(((e,t,n)=>{const i=(0,m.getInstancePinConfig)(Q,e.id,t),s=(0,l.isStickyInputPinConfig)(i)?(0,x.queueInputPinConfig)():(0,l.stickyInputPinConfig)();o((0,m.changePinConfig)(Q,e.id,t,s),(0,O.functionalChange)("toggle-sticky")),re("togglePinSticky",{isSticky:(0,l.isStickyInputPinConfig)(s)})}),[o,Q,re]),xt=u.useCallback((()=>{const{newNode:e,newInstances:t}=(0,z.handleDuplicateSelectedEditorCommand)(Q,ce);o(e,(0,O.functionalChange)("duplicated instances")),Y({selected:t.map((e=>e.id))})}),[o,Y,Q,ce]),Nt=u.useCallback((e=>{const t=e.nativeEvent.target;if(0===e.button&&W(e.nativeEvent,Q.id)&&t&&"board-editor-inner"===t.className){if(Date.now()-Ne<300)return void ee(e);je(Date.now());const t={x:e.clientX,y:e.clientY},n=(0,C.vSub)(t,et),o=(0,m.domToViewPort)(n,Ge,ae);_e({from:o,to:o})}}),[Q.id,Ge,Ne,et,ae,ee]),jt=u.useCallback((e=>{if(Fe(null),W(e.nativeEvent,Q.id)&&Ce){if((0,m.calcSelectionBoxArea)(Ce)>50){const t=(0,m.getInstancesInRect)(Ce,ue,Ge,Jt.current,Q.instances,et,ae);console.log({toSelect:t,selectionBox:Ce});const n=e.shiftKey?[...ce,...t]:t;Y({selected:n})}_e(void 0)}}),[Q.id,Q.instances,Ce,ue,Ge,et,ae,ce,Y]),wt=u.useCallback((e=>{if(!W(e.nativeEvent,Q.id))return void(Le.current=!1);Le.current=!0;const t={x:e.clientX,y:e.clientY},n=(0,C.vSub)(t,(0,C.vAdd)(et,C.vZero)),o=(0,m.domToViewPort)(n,Ge,ae);Ce&&_e({...Ce,to:o});const i=(0,m.findClosestPin)(Q,ue,n,et,K,X,Ge),s=Je;if(i){(!s||s.ins!==i.ins||s.ins===i.ins&&s.pin!==i.pin)&&Ye({ins:i.ins,type:i.type,pin:i.id})}Qe.current=o,Y({lastMousePos:Qe.current})}),[Q,et,Ge,ae,Ce,ue,K,X,Je,Y]),Pt=u.useCallback((e=>{var t;"bp5-menu"!==(null===(t=e.relatedTarget)||void 0===t?void 0:t.className)&&(Ye(void 0),Le.current=!1)}),[]),Ot=u.useCallback(((e,t)=>{if(t){const t=(0,l.isInlineNodeInstance)(e)?e.node:(0,F.safelyGetNodeDef)(e.nodeId,ue);if(!t)throw new Error("Impossible state inspecting inexisting node");if(!(0,l.isVisualNode)(t))return void(0,P.toastMsg)("Cannot inspect a non visual node","warning");Ve({insId:`${K}.${e.id}`,node:t})}else if((0,l.isRefNodeInstance)(e)){const t=(0,F.safelyGetNodeDef)(e,ue);r(t)}else{const t=e.node;if(!(0,l.isInlineValueNode)(t))return void((0,l.isVisualNode)(t)?Ve({insId:e.id,node:t}):(0,P.toastMsg)("Editing this type of node is not supported"));const n=atob(t.dataBuilderSource);Ae({insId:e.id,templateType:t.templateType,value:n,type:"existing"}),(0,P.toastMsg)("Editing inline visual node not supported yet")}}),[r,ue,K]),Et=u.useCallback((e=>{if((0,l.isInlineNodeInstance)(e)){const t=e.node;if(!(0,l.isVisualNode)(t))return void(0,P.toastMsg)("Not supported","warning");const n=(0,g.produce)(Q,(n=>{n.instances=n.instances.filter((t=>t.id!==e.id)),n.connections=n.connections.filter((t=>{let{from:n,to:o}=t;return n.insId!==e.id&&o.insId!==e.id})),n.instances.push(...t.instances),n.connections.push(...t.connections.filter((e=>(0,l.isInternalConnectionNode)(e.from)&&(0,l.isInternalConnectionNode)(e.to))))}));o(n,{type:"functional",message:"ungroup"}),Y({selected:[]})}else{const t=(0,F.safelyGetNodeDef)(e.nodeId,ue);if(!(0,l.isVisualNode)(t))return void(0,P.toastMsg)("Not supported","warning")}}),[Q,o,Y,ue]),Dt=u.useCallback((async e=>{}),[]),St=u.useCallback(((e,t)=>{const n=(0,V.handleDetachConstEditorCommand)(Q,e.id,t);o(n,(0,O.functionalChange)("detach-const"))}),[o,Q]),Mt=u.useCallback(((e,t)=>{const n=e.inputConfig[t]||(0,x.queueInputPinConfig)();(0,l.isStaticInputPinConfig)(n)&&(Te(n.value),P.AppToaster.show({message:"Value copied"}))}),[]),Tt=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{const o=n.instances.find((t=>t.id===e.id));if(!o)throw new Error("Impossible state");o.inputConfig[t]=(0,l.staticInputPinConfig)(Me),n.connections=n.connections.filter((n=>!(0,l.isInternalConnectionNode)(n.to)||!(n.to.insId===e.id&&n.to.pinId===t)))}));o(n,(0,O.functionalChange)("paste const value"))}),[Q,o,Me]),kt=u.useCallback((async e=>{const t=await He("New name?");if(!t)return;const n=(0,g.produce)(Q,(n=>{var o;"input"===e?(Q.inputs||(n.inputs={}),n.inputs[t]=(0,l.nodeInput)(),n.inputsPosition[t]=Qe.current):(Q.outputs||(n.outputs={}),n.outputs[t]=(0,l.nodeOutput)(),n.outputsPosition[t]=Qe.current,(null===(o=n.completionOutputs)||void 0===o?void 0:o.length)&&(0,P.toastMsg)("Note that this node has explicit completion outputs set. You may need to update them."))}));o(n,(0,O.functionalChange)("add new io pin")),re("addIoPin",{type:e})}),[He,Q,o,re]),At=u.useCallback((async()=>{var e;const t=null===(e=Q.completionOutputs)||void 0===e?void 0:e.join(","),n=await He("Edit completion outputs",t);if((0,p.isDefined)(n)&&null!==n){const e=(0,g.produce)(Q,(e=>{e.completionOutputs=""===n?void 0:n.split(",")}));o(e,(0,O.functionalChange)("change node completions")),re("editCompletionOutputs",{count:n?n.split(",").length:0})}}),[He,o,Q,re]),Rt=u.useCallback((async()=>{var e;const t=null===(e=Q.reactiveInputs)||void 0===e?void 0:e.join(","),n=await He("Edit reactive inputs",t);if((0,p.isDefined)(n)&&null!==n){const e=(0,g.produce)(Q,(e=>{e.reactiveInputs=""===n?void 0:n.split(",")}));o(e,(0,O.functionalChange)("change reactive inputs")),re("editReactiveInputs",{count:n?n.split(",").length:0})}}),[He,o,Q,re]),Vt=u.useCallback((async()=>{const e=await He("Description?",Q.description),t=(0,g.produce)(Q,(t=>{t.description=e}));o(t,(0,O.functionalChange)("Edit node description"))}),[He,o,Q]),zt=u.useCallback((e=>{const t=(0,g.produce)(Q,(t=>{t.defaultStyle=e}));o(t,(0,O.functionalChange)("change default style")),re("changeStyle",{isDefault:!0})}),[o,Q,re]),$t=u.useCallback((async(e,t)=>{const n=await He("New name?",t)||t,i=(0,m.handleIoPinRename)(Q,e,t,n);o(i,(0,O.functionalChange)("rename io pin"))}),[Q,o,He]),Ht=u.useCallback(((e,t)=>{const n=(0,m.handleChangeNodeInputType)(Q,e,t);o(n,(0,O.functionalChange)("toggle io pin optional"))}),[Q,o]),Gt=u.useCallback((e=>{switch(e.type){case G.ActionType.RemoveNode:{const e=(0,g.produce)(Q,(e=>{if(!(0,l.isVisualNode)(Q))throw new Error("Impossible state, deleting instances opf non visual node");e.instances=e.instances.filter((e=>!ce.includes(e.id))),e.connections=e.connections.filter((e=>!ce.includes(e.from.insId)&&!ce.includes(e.to.insId)))}));Y({selected:[]}),o(e,(0,O.functionalChange)("remove-instances")),(0,P.toastMsg)(`Removed ${ce.length} instances(s)`),re("deleteInstances",{count:ce.length});break}case G.ActionType.Inspect:if(1===ce.length)Z(ce[0]);else if(de||pe){const e=null!=de?de:pe,t=(0,l.isExternalConnectionNode)(e)?l.ROOT_INS_ID:e.insId;Z(t,{type:de?"output":"input",id:e.pinId})}re("openInspectMenu",{source:"actionMenu"});break;case G.ActionType.Group:(async()=>{await Ze()})();break;case G.ActionType.UnGroup:{const e=Q.instances.find((e=>e.id===ce[0]));Et(e);const t=(0,F.safelyGetNodeDef)(e,ue);(0,P.toastMsg)(`Ungrouped inline node ${t.id}`),re("unGroupNode",{instancesCount:t.instances.length});break}case G.ActionType.AddInlineValue:Ae({type:"new-floating",pos:Qe.current}),re("addValueModalOpen",{source:"actionMenu"});break;case G.ActionType.AddNode:!async function(){const t=(0,m.getMiddleOfViewPort)(Ge,Xe),{importableNode:n}=e.data,i=await se(n),s=(0,C.vSub)(t,{x:0,y:50*Ge.zoom}),r=(0,m.createNewNodeInstance)(n.node.id,0,s,i),a=(0,g.produce)(Q,(e=>{e.instances.push(r)})),u=(0,g.produce)(J,(e=>{e.selected=[r.id]}));o(a,(0,O.functionalChange)("add new instance")),Y(u),(0,P.toastMsg)(`Node ${n.node.id} successfully imported from ${n.module}`),re("addNode",{nodeId:n.node.id,source:"actionMenu"})}();break;case G.ActionType.AI:!async function(){const t=(0,m.getMiddleOfViewPort)(Ge,Xe),{importableNode:n}=e.data,i=await se(n),s=(0,C.vSub)(t,{x:0,y:50*Ge.zoom}),r=(0,m.createNewNodeInstance)(n.node.id,0,s,i),a=(0,g.produce)(Q,(e=>{e.instances.push(r)})),u=(0,g.produce)(J,(e=>{e.selected=[r.id]}));o(a,(0,O.functionalChange)("add new instance")),Y(u),(0,P.toastMsg)(`Node ${n.node.id} successfully imported from ${n.module}`),re("addNode",{nodeId:n.node.id,source:"actionMenu"})}();break;default:(0,P.toastMsg)(`${e.type} not supported yet`)}}),[J,de,o,Y,Ze,se,Z,Et,Q,ue,re,ce,pe,Ge,Xe]),Lt=()=>{const t=J.from;return(0,p.entries)(he).map((n=>{let[o,s]=n;return(0,a.jsx)(b.NodeIoView,{currentInsId:K,ancestorInsIds:e.ancestorsInsIds,type:"input",pos:ge[o]||{x:0,y:0},id:o,onDelete:i?bt:void 0,onRename:i?$t:void 0,onDblClick:qt,closest:!(!Je||"input"!==Je.type||Je.ins.id!==Q.id||Je.pin!==o),connected:!1,inputMode:s.mode,onChangeInputMode:Ht,viewPort:Ge,onDragStart:ft,onDragEnd:gt,onDragMove:mt,onSelect:nt,onSetDescription:ot,selected:(null==t?void 0:t.pinId)===o,description:s.description,onMouseUp:_n,onMouseDown:Cn},o)}))},Bt=()=>{const{to:t}=J;return(0,p.entries)(Ie).map((n=>{let[o,s]=n;return(0,a.jsx)(b.NodeIoView,{currentInsId:K,ancestorInsIds:e.ancestorsInsIds,type:"output",pos:ve[o]||{x:0,y:0},id:o,onDelete:i?bt:void 0,onRename:i?$t:void 0,closest:!(!Je||"output"!==Je.type||Je.ins.id!==Q.id||Je.pin!==o),connected:!1,viewPort:Ge,onDragStart:ft,onDragEnd:gt,onDragMove:mt,onSelect:nt,onSetDescription:ot,description:s.description,selected:(null==t?void 0:t.pinId)===o,onMouseUp:_n,onMouseDown:Cn},o)}))},Ft=()=>{if(Ce){const{from:e,to:t}=Ce,n=(0,m.logicalPosToRenderedPos)(e,Ge),o=(0,m.logicalPosToRenderedPos)(t,Ge);console.log(e.x,t.x," | ",n.x,o.x);const{x:i,y:s,w:r,h:u}=(0,m.getSelectionBoxRect)(n,o);return(0,a.jsx)("div",{className:"selection-box",style:{top:s,left:i,width:r,height:u}})}return null},Ut=u.useCallback((async(e,t,n,o)=>{if("input"===n){const n=e.inputConfig[t],o=(0,l.isStaticInputPinConfig)(n)?JSON.stringify(n.value):void 0;Ae({type:"static-input",insId:e.id,pinId:t,value:null!=o?o:JSON.stringify("Some static value")}),re("addValueModalOpen",{source:"dblClickPin"})}else{const i=(0,F.safelyGetNodeDef)(e,ue);if(!(0,l.getNodeOutputs)(i)[t])throw new Error("Dbl clicked on un-existing pin");Se({pos:{x:o.clientX,y:o.clientY},ins:e,targetNode:i,pinId:t,pinType:n})}}),[ue,re]),qt=u.useCallback((async(e,t)=>{if(!Q.inputs[e])throw new Error("Dbl clicked on un-existing pin");Se({pos:{x:t.clientX,y:t.clientY},pinId:e,pinType:"input",targetNode:Q})}),[Q]),Wt=u.useCallback((e=>{if(e.metaKey||e.ctrlKey){const t=-.005*e.deltaY;ut(Ge.zoom+t,"mouse"),e.preventDefault(),e.stopPropagation()}else{if(ie)return;const t=e.deltaX,n=e.deltaY,o=(0,g.produce)(Ge,(e=>{e.pos.x=e.pos.x+t/e.zoom,e.pos.y=e.pos.y+n/e.zoom}));Ue(o),e.stopPropagation(),e.preventDefault()}}),[ie,ut,Ue,Ge]);(0,v.useEffect)((()=>{const{current:e}=Ke;if(e)return e.addEventListener("wheel",Wt),()=>{e.removeEventListener("wheel",Wt)}}),[Wt]);const Zt={backgroundPositionX:(0,m.roundNumber)(-Ge.pos.x*Ge.zoom),backgroundPositionY:(0,m.roundNumber)(-Ge.pos.y*Ge.zoom),backgroundSize:(0,m.roundNumber)(25*Ge.zoom)+"px"},Jt=u.useRef(new Map);u.useEffect((()=>{const e=fe.reduce(((e,t)=>{const n=(0,F.safelyGetNodeDef)(t,ue);return n&&e.set(t.id,(0,l.keys)((0,l.getNodeInputs)(n))),e}),new Map),t=fe.reduce(((e,t)=>{const n=(0,F.safelyGetNodeDef)(t,ue);return n&&e.set(t.id,(0,l.keys)((0,l.getNodeOutputs)(n))),e}),new Map);e.set(l.THIS_INS_ID,(0,l.keys)(Q.outputs)),t.set(l.THIS_INS_ID,(0,l.keys)(Q.inputs));const n=me.filter((n=>{const o=e.get(n.to.insId)&&e.get(n.to.insId).includes(n.to.pinId),i=t.get(n.from.insId)&&t.get(n.from.insId).includes(n.from.pinId);return!(o&&i)}));if(n.length>0){(0,P.toastMsg)(`${n.length} orphan connections removed`,"warning"),console.log(`${n.length} orphan connections removed`,n);const e=(0,g.produce)(Q,(e=>{e.connections=Q.connections.filter((e=>!n.includes(e)))}));o(e,(0,O.functionalChange)("prune orphan connections"))}}),[fe,o,me,Q,ue]),u.useEffect((()=>{let e=[];const t=(0,g.produce)(Q,(t=>{t.instances=t.instances.map((t=>{const n=(0,F.safelyGetNodeDef)(t,ue);if(n){const o=(0,l.getNodeInputs)(n),i=(0,l.getNodeOutputs)(n);if(t.visibleInputs){const n=t.visibleInputs.filter((e=>!o[e]));n.length>0&&(t.visibleInputs=(0,l.keys)(o),e.push(...n))}if(t.visibleOutputs){const n=t.visibleOutputs.filter((e=>!i[e]));n.length>0&&(t.visibleOutputs=(0,l.keys)(i),e.push(...n))}}return t}))}));e.length>0&&((0,P.toastMsg)(`Found ${e.length} invalid visible inputs/outputs: ${e.join(", ")}. Reset them`,"warning"),o(t,(0,O.functionalChange)("reset corrupt visible inputs/outputs")))}),[fe,o,Q,ue]),(0,v.useEffect)((()=>{const e=new Map(fe.map((e=>[e.id,e])));Jt.current=me.reduce(((t,n)=>{const o=t.get(n.to.insId)||{},i=o[n.to.pinId]||[],s={...o,[n.to.pinId]:[...i,e.get(n.from.insId)]};return t.set(n.to.insId,s),t}),new Map)}),[me,fe]);const Yt=u.useCallback((()=>{Se(void 0)}),[]),Kt=u.useCallback((async e=>{if(!De)throw new Error("impossible state - quick add menu invoked but not available");const{ins:t,pinId:n}=De;switch(e.type){case"import":case"node":{const i="import"===e.type?await se(e.importableNode):ue,s="import"===e.type?e.importableNode.node:e.node,r=(0,m.createNewNodeInstance)(s.id,100,Qe.current,i);if(r){const e=(0,g.produce)(Q,(e=>{e.instances.push(r),e.connections.push({from:{insId:t?t.id:l.THIS_INS_ID,pinId:n},to:{insId:r.id,pinId:l.TRIGGER_PIN_ID}})}));o(e,(0,O.functionalChange)("add-item-quick-menu")),Yt()}re("addNode",{nodeId:s.id,source:"quickAdd"});break}case"value":if(!t)return void(0,P.toastMsg)("Cannot add value to main input");Ae({type:"new-output",insId:t.id,pinId:n}),re("addValueModalOpen",{source:"quickAdd"})}}),[De,ue,re,Q,o,Yt,se]),Xt=u.useCallback((async()=>{const e=JSON.stringify(Q);await navigator.clipboard.writeText(e),P.AppToaster.show({message:"Copied!"})}),[Q]),Qt=u.useCallback((()=>{var e,t;const n=i?"":" (cannot edit main node, only visual)";return(0,a.jsxs)(y.Menu,{children:[(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:"New Value",onClick:(0,p.preventDefaultAnd)((()=>{Ae({type:"new-floating",pos:Qe.current}),re("addValueModalOpen",{source:"contextMenu"})}))}),(0,a.jsx)(y.MenuItem,{text:`New input ${n}`,onMouseDown:e=>e.stopPropagation(),onClick:(0,p.preventDefaultAnd)((()=>kt("input"))),disabled:!i}),(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:`New output ${n}`,onClick:(0,p.preventDefaultAnd)((()=>kt("output"))),disabled:!i}),(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:"Copy node to clipboard",onClick:(0,p.preventDefaultAnd)(Xt)}),(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:`Edit Completion Outputs (${(null===(e=Q.completionOutputs)||void 0===e?void 0:e.join(","))||"n/a"})`,onClick:(0,p.preventDefaultAnd)((()=>At()))}),(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:`Edit Reactive inputs (${(null===(t=Q.reactiveInputs)||void 0===t?void 0:t.join(","))||"n/a"})`,onClick:(0,p.preventDefaultAnd)((()=>Rt()))}),(0,a.jsx)(y.MenuItem,{onMouseDown:e=>e.stopPropagation(),text:"Edit description",onClick:(0,p.preventDefaultAnd)((()=>Vt()))}),(0,a.jsx)(y.MenuDivider,{}),(0,a.jsx)(y.MenuItem,{text:"Default Style",children:(0,a.jsx)($.NodeStyleMenu,{style:Q.defaultStyle,onChange:zt,promptFn:He})})]})}),[i,Xt,Q.completionOutputs,Q.reactiveInputs,Q.defaultStyle,zt,He,re,kt,At,Rt,Vt]);(0,h.useHotkeys)("shift+c",tt,{text:"Center viewport",group:"Viewport Controls"},[],Le),(0,h.useHotkeys)("cmd+c",st,{text:"Copy instances",group:"Editing"},[],Le),(0,h.useHotkeys)("cmd+v",rt,{text:"Paste instances",group:"Editing"},[],Le),(0,h.useHotkeys)("esc",lt,{text:"Clear selections",group:"Selection"},[],Le),(0,h.useHotkeys)("backspace",Ct,{text:"Delete instances",group:"Editing"},[],Le),(0,h.useHotkeys)("shift+d",xt,{text:"Duplicate selected instances",group:"Editing"},[],Le),(0,h.useHotkeys)("cmd+a",ht,{text:"Select all",group:"Selection"},[],Le),(0,h.useHotkeys)("s",at,{text:"Select pin closest to mouse",group:"Selection"},[],Le);const en=u.useCallback(((e,t)=>{if(!Re)throw new Error("impossible state");const n=(0,g.produce)(Q,(t=>{const n=t.instances.find((e=>e.id===Re.insId));if(!n||!(0,l.isInlineNodeInstance)(n))throw new Error("impossible state");n.node=e}));o(n,(0,O.functionalChange)("Inner change: "+t.message)),Ve((t=>({...t,node:e})))}),[o,Re,Q]),[tn,nn]=(0,v.useState)({selected:[],viewPort:t.defaultViewPort,lastMousePos:{x:0,y:0}}),on=u.useCallback((e=>nn((t=>({...t,...e})))),[]),sn=n=>Re&&Re.insId===n.id?{currentInsId:Re.insId,ancestorsInsIds:(0,l.fullInsIdPath)(K,X),boardData:tn,onChangeBoardData:on,resolvedDependencies:te,onCopy:s,clipboardData:e.clipboardData,onInspectPin:e.onInspectPin,onGoToNodeDef:e.onGoToNodeDef,nodeIoEditable:e.nodeIoEditable,node:Re.node,onChangeNode:en,onShowOmnibar:ee,parentViewport:t.defaultViewPort,parentBoardPos:et,onExtractInlineNode:e.onExtractInlineNode,queuedInputsData:e.queuedInputsData}:void 0,rn=()=>{if(de&&("input"===(null==Je?void 0:Je.type)&&(null==Je?void 0:Je.ins.id)!==Q.id||(null==Je?void 0:Je.ins.id)===Q.id&&"output"===(null==Je?void 0:Je.type))){const e=Je.ins.id===Q.id?{pinId:Je.pin,insId:l.THIS_INS_ID}:{insId:Je.ins.id,pinId:Je.pin};if(!(0,l.isInternalConnectionNode)(e)&&!(0,l.isInternalConnectionNode)(de))return;return{from:de,to:e}}if(pe&&("output"===(null==Je?void 0:Je.type)&&(null==Je?void 0:Je.ins.id)!==Q.id||(null==Je?void 0:Je.ins.id)===Q.id&&"input"===(null==Je?void 0:Je.type))){const e=Je.ins.id===Q.id?{pinId:Je.pin,insId:l.THIS_INS_ID}:{insId:Je.ins.id,pinId:Je.pin};if(!(0,l.isInternalConnectionNode)(pe)&&!(0,l.isInternalConnectionNode)(e))return;return{from:e,to:pe}}},an=()=>{const e=rn();if(e){const{from:t,to:n}=e;return{connection:{from:t,to:n},type:me.some((t=>(0,l.connectionDataEquals)(t,e)))?"future-remove":"future-add"}}},un=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{n.instances=n.instances.map((n=>n.id===e.id?{...n,visibleInputs:t}:n))}));o(n,(0,O.functionalChange)("change instance visible inputs"))}),[Q,o]),ln=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{n.instances=n.instances.map((n=>n.id===e.id?{...n,style:t}:n))}));o(n,(0,O.functionalChange)("change instance style")),re("changeStyle",{isDefault:!1})}),[o,Q,re]),cn=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{n.instances=n.instances.map((n=>n.id===e.id?{...n,visibleOutputs:t}:n))}));o(n,(0,O.functionalChange)("change instance visible outputs"))}),[Q,o]),dn=u.useCallback(((e,t)=>{const n=(0,g.produce)(Q,(n=>{n.instances=n.instances.map((n=>n.id===e.id?{...n,displayName:t}:n))}));o(n,(0,O.functionalChange)("change instance display name"))}),[Q,o]);u.useImperativeHandle(n,(()=>({centerInstance(e){const t=Q.instances.find((t=>t.id===e));if(t){const e=(0,C.vSub)(t.pos,(0,C.vec)(Xe.width/2,Xe.height/2));Ue({...Ge,pos:e})}},centerViewPort(){tt()},getViewPort:()=>Ge,clearSelection:()=>{lt()},requestNewInlineValue:()=>{Ae({type:"new-floating",pos:Qe.current})}})));const[pn,fn]=u.useState([]),mn=u.useCallback(((e,t)=>{const n=t.trim().substr(0,100),i=`Inline-value-${n.substr(0,15).replace(/["'`]/g,"")}`,s=(0,D.createInlineValueNode)({code:t,customView:n,nodeId:i,type:e});switch(ke.type){case"existing":{const[e]=Q.instances.filter((e=>e.id===ke.insId)).filter((e=>(0,l.isInlineNodeInstance)(e))).map((e=>e.node));if(!e)throw new Error("Unable to find inline node to save to");const t=(0,l.keys)(e.inputs),n=(0,l.keys)(s.inputs),i=new Set(S.default.difference(t,n)),r=(0,g.produce)(Q,(e=>{e.instances=e.instances.map((e=>e.id===ke.insId?(0,l.inlineNodeInstance)(e.id,s,e.inputConfig,e.pos):e)),e.connections=e.connections.filter((e=>!(e.to.insId===ke.insId&&i.has(e.to.pinId))))}));o(r,(0,O.functionalChange)("change inline value")),Ae(void 0);break}case"static-input":{let e;try{const n=t.replace(/^['`]/,'"').replace(/['`]$/,'"');e=JSON.parse(n)}catch(r){return void(0,P.toastMsg)("Input values must not be formulas or code")}const n=(0,g.produce)(Q,(t=>{t.instances.find((e=>e.id===ke.insId)).inputConfig[ke.pinId]=(0,l.staticInputPinConfig)(e)}));o(n,(0,O.functionalChange)("set static input value")),Ae(void 0);break}case"new-floating":{const e=(0,l.inlineNodeInstance)((0,l.createInsId)(s),s,{},ke.pos),t=(0,g.produce)(Q,(t=>{t.instances.push(e)}));o(t,(0,O.functionalChange)("new floating value")),Ae(void 0);break}case"new-output":{const{insId:e,pinId:t}=ke,n=Q.instances.find((t=>t.id===e));if(!n)throw new Error("Impossible state");const i=(0,l.inlineNodeInstance)((0,l.createInsId)(s),s,{},(0,C.vAdd)(n.pos,{x:-50,y:150})),r=(0,g.produce)(Q,(n=>{n.instances.push(i),n.connections.push({from:(0,l.connectionNode)(e,t),to:(0,l.connectionNode)(i.id,l.TRIGGER_PIN_ID)})}));o(r,(0,O.functionalChange)("new value connected to output")),Ae(void 0)}}re("addValue",{type:e,placeholdersCount:(0,l.keys)(s.inputs).length})}),[ke,o,Q,re]),gn=me.filter((e=>{const t=rn();return!t||!(0,l.connectionDataEquals)(t,e)})),vn=u.useCallback((()=>{Ve(void 0),nn(t.defaultBoardData)}),[]),hn=u.useCallback((e=>{const t=(0,g.produce)(Q,(t=>{const n=t.connections.find((t=>(0,l.connectionDataEquals)(t,e)));n.hidden=!n.hidden}));o(t,(0,O.functionalChange)("toggle connection hidden"))}),[o,Q]),In=u.useCallback((e=>{const t=(0,g.produce)(Q,(t=>{t.connections=t.connections.filter((t=>!(0,l.connectionDataEquals)(t,e)))}));o(t,(0,O.functionalChange)("remove connection"))}),[o,Q]),yn=u.useCallback(((e,t,n)=>{"input"===n?(console.log(e.id,t),Fe({to:(0,l.connectionNode)(e.id,t),from:void 0})):Fe({from:(0,l.connectionNode)(e.id,t),to:void 0})}),[]),bn=u.useCallback(((e,t,n)=>{Be&&(Be.from&&"input"===n?We(Be.from,(0,l.connectionNode)(e.id,t),"pinDrag"):Be.to&&"output"===n&&We((0,l.connectionNode)(e.id,t),Be.to,"pinDrag")),Fe(null)}),[Be,We]),Cn=u.useCallback(((e,t)=>{}),[]),_n=u.useCallback(((e,t)=>{Be&&(Be.from&&"output"===t?We(Be.from,(0,l.externalConnectionNode)(e),"nodeIoPinDrag"):Be.to&&"input"===t&&We((0,l.externalConnectionNode)(e),Be.to,"nodeIoPinDrag"))}),[Be,We]);try{return(0,a.jsxs)(y.ContextMenu,{className:(0,k.default)("visual-node-editor",e.className),"data-id":Q.id,content:Qt(),disabled:!Le.current,children:[(0,a.jsxs)("main",{className:"board-editor-inner",onMouseDown:Nt,onMouseUp:jt,onMouseMove:wt,onMouseLeave:Pt,ref:Ke,style:Zt,children:[(0,a.jsx)(u.Fragment,{children:(0,a.jsx)(j.LayoutDebugger,{vp:Ge,node:Q,extraDebug:m.emptyList,mousePos:Qe.current})}),(0,a.jsx)(d.ConnectionView,{resolvedNodes:ue,currentInsId:K,ancestorsInsIds:X,size:Xe,node:Q,boardPos:et,instances:fe,connections:gn,futureConnection:an(),onDblClick:l.noop,viewPort:Ge,parentVp:ae,selectedInstances:ce,toggleHidden:hn,removeConnection:In,lastMousePos:Qe.current,draggedSource:Be}),Lt(),fe.map((t=>{var n,o,i,s,r;return(0,a.jsx)(c.InstanceView,{onUngroup:Et,onExtractInlineNode:Dt,onDetachConstValue:St,onCopyConstValue:Mt,onPasteConstValue:Tt,copiedConstValue:Me,connectionsPerInput:Jt.current.get(t.id)||m.emptyObj,node:(0,F.safelyGetNodeDef)(t,ue),ancestorsInsIds:(0,l.fullInsIdPath)(K,X),onPinClick:it,onPinDblClick:Ut,onDragStart:ct,onDragEnd:pt,resolvedDeps:ue,onDragMove:dt,onDblClick:Ot,onSelect:vt,onToggleSticky:_t,selected:-1!==ce.indexOf(t.id),dragged:ye===t.id,onInspectPin:qe,selectedInput:pe&&(0,l.isInternalConnectionNode)(pe)&&pe.insId===t.id?pe.pinId:void 0,selectedOutput:de&&(0,l.isInternalConnectionNode)(de)&&de.insId===t.id?de.pinId:void 0,closestPin:Je&&Je.ins.id===t.id?Je:void 0,queuedInputsData:null!==(n=ne[t.id])&&void 0!==n?n:m.emptyObj,instance:t,connections:me,onTogglePinBreakpoint:l.noop,onTogglePinLog:l.noop,viewPort:Ge,onChangeVisibleInputs:un,onChangeVisibleOutputs:cn,onSetDisplayName:dn,onDeleteInstance:yt,forceShowMinimized:de||(null===(o=null==Be?void 0:Be.to)||void 0===o?void 0:o.insId)===t.id?"input":pe||(null===(i=null==Be?void 0:Be.from)||void 0===i?void 0:i.insId)===t.id?"output":void 0,isConnectedInstanceSelected:ce.some((e=>me.some((n=>{let{from:o,to:i}=n;return o.insId===t.id&&i.insId===e||o.insId===e&&i.insId===t.id})))),inlineGroupProps:sn(t),onCloseInlineEditor:vn,inlineEditorPortalDomNode:ze.current,onChangeStyle:ln,onGroupSelected:Ze,onPinMouseDown:yn,onPinMouseUp:bn,hadError:null!==(r=null===(s=e.instancesWithErrors)||void 0===s?void 0:s.has((0,l.fullInsIdPath)(t.id)))&&void 0!==r&&r},t.id)})),Ft(),Bt(),(0,a.jsx)(L.MainInstanceEventsIndicator,{currentInsId:K,ancestorsInsIds:X,viewPort:Ge}),De?(0,a.jsx)(_.QuickAddMenu,{targetNode:De.targetNode,pinId:De.pinId,pinType:De.pinType,pos:De.pos,resolvedDependencies:te,node:Q,onAdd:Kt,onClose:Yt}):null,(0,a.jsxs)("div",{className:"viewport-controls-and-help",children:[(0,a.jsx)(y.Button,{small:!0,onClick:tt,minimal:!0,intent:"primary",children:"Center"}),(0,a.jsx)(U,{min:.15,max:3,stepSize:.05,labelStepSize:10,labelRenderer:q,onChange:ut,value:Ge.zoom}),xe?(0,a.jsx)(B.HelpBubble,{}):null]}),ke?(0,a.jsx)(E.InlineCodeModal,{env:m.emptyObj,initialValue:ke.value,initialType:"existing"===ke.type?ke.templateType:void 0,onCancel:()=>Ae(void 0),onSubmit:mn}):null,(0,a.jsx)("div",{className:"inline-editor-portal-root"})]}),(0,a.jsx)(G.ActionsMenu,{showRunFlowOptions:xe,onAction:Gt,selectedInstances:ce,node:Q,resolvedNodes:ue,to:pe,from:de,hotkeysEnabled:Le})]})}catch(xn){return console.error(xn),(0,a.jsxs)("div",{children:["Error rendering board - ",xn.toString()]})}})));const W=(e,t)=>{const n=e.target.closest(".visual-node-editor");return n&&n.getAttribute("data-id")===t}},83234:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseNodeView=void 0;const a=n(35250),u=s(n(70079)),l=r(n(26372)),c=r(n(59349));t.BaseNodeView=function(e){const{dragged:t,viewPort:n,pos:o,onDragEnd:i,onDragMove:s,onDragStart:r,displayMode:d}=e,p=u.useCallback(((e,t)=>{r(e,t)}),[r]),f=u.useCallback(((e,t)=>{const s=o,r=(t.x-s.x)/n.zoom,a=(t.y-s.y)/n.zoom,u=s.x+r,l=s.y+a;i(e,{...t,x:u,y:l})}),[o,i,n]),m=u.useCallback(((e,t)=>{s(e,{x:t.x,y:t.y})}),[s]),g={transform:`scale(${n.zoom})`},v=(0,l.default)("base-node-view",e.className,{dragged:t,"display-mode":d}),h=o.x*n.zoom-n.pos.x*n.zoom,I=o.y*n.zoom-n.pos.y*n.zoom,y={transform:`translate(${h-o.x}px, ${I-o.y}px)`},b=(0,l.default)("base-node-view-vp-fixer",{"display-mode":d}),C=(0,a.jsx)("span",{className:"base-node-view-wrapper",children:(0,a.jsx)("div",{className:v,style:g,id:e.domId,children:e.children})});return(0,a.jsx)("div",{className:b,style:y,children:(0,a.jsx)(c.default,{onStop:f,onStart:p,onDrag:m,position:o,cancel:".no-drag",children:C})})}},80510:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleConnectionCloseEditorCommand=void 0;const i=n(74762),s=o(n(53865));t.handleConnectionCloseEditorCommand=(e,t)=>{let{from:n,to:o}=t;return(0,s.default)(e,(e=>{const t=e.connections.find((e=>{const t=(0,i.connectionNodeEquals)(n,e.from),s=(0,i.connectionNodeEquals)(o,e.to);return t&&s}));t?e.connections=e.connections.filter((e=>e!==t)):e.connections.push({from:n,to:o})}))}},1788:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleDetachConstEditorCommand=void 0;const i=n(74762),s=o(n(53865)),r=n(68371);t.handleDetachConstEditorCommand=(e,t,n)=>(0,s.default)(e,(e=>{const{instances:o}=e,s=o.find((e=>e.id===t));if(!s)throw new Error("Impossible state ins id with no matching instance");const a=s.inputConfig[n];if(!a)throw new Error("impossible state detaching const from unexistent config");if(!(0,i.isStaticInputPinConfig)(a))throw new Error("impossible state detaching const with no value");const u=JSON.stringify(a.value),l=(0,r.createInlineValueNode)({code:`${u}`,type:i.InlineValueNodeType.VALUE}),c=(0,i.inlineNodeInstance)(`value-${(0,i.randomInt)(999)}`,l,{},{x:s.pos.x,y:s.pos.y-100});if(!e.instances.find((e=>e.id===s.id)))throw new Error("impossible state instance not found");s.inputConfig[n]=(0,i.queueInputPinConfig)(),e.instances.push(c),e.connections.push((0,i.connectionData)(`${c.id}.value`,`${s.id}.${n}`))}))},2130:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleDuplicateSelectedEditorCommand=void 0;const i=n(74762),s=o(n(53865));t.handleDuplicateSelectedEditorCommand=(e,t)=>{const n=[];return{newNode:(0,s.default)(e,(o=>{const s=o.instances;t.forEach((t=>{const o=s.find((e=>e.id===t));if(!o)throw new Error("impossible state duplicate selected no matching instance");if(o){const{pos:t}=o,r={...o,pos:{x:t.x+20,y:t.y+20},id:(0,i.createInsId)(e)};s.push(r),n.push(r.id)}}))})),newInstances:n}}},25044:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.pasteInstancesCommand=void 0;const i=n(74762),s=o(n(53865));t.pasteInstancesCommand=(e,t,n)=>{const o=n.instances.map((n=>({...n,pos:t,id:(0,i.createInsId)(e)}))),r=new Map(o.map(((e,t)=>[n.instances[t].id,e.id])));return{newNode:(0,s.default)(e,(e=>{e.instances.push(...o);const t=n.connections.map((e=>{let{from:t,to:n}=e;return{from:{...t,insId:r.get(t.insId)||t.insId},to:{...n,insId:r.get(n.insId)||n.insId}}}));e.connections.push(...t)})),newInstances:o}}},65082:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionView=t.SingleConnectionView=void 0;const a=n(70079),u=n(35250),l=s(n(70079)),c=r(n(26372)),d=n(74762),p=n(18243),f=n(77852),m=n(74089),g=n(60190),v=n(50382),h=n(76064),I=n(41032);t.SingleConnectionView=e=>{const{isBrowser:t}=(0,f.useSsr)(),{connection:n,node:o,resolvedNodes:i,instances:s,type:r,viewPort:a,toggleHidden:l,parentSelected:m,removeConnection:y}=e,{from:b}=n,C=(0,d.isInternalConnectionNode)(b)&&s.find((e=>e.id===b.insId));if(!C&&(0,d.isInternalConnectionNode)(b))throw new Error(`impossible state  - "from instance id - [${b.insId}] does not exist"`);const _=((0,d.isInternalConnectionNode)(b)&&C?(0,I.safelyGetNodeDef)(C,i):o).outputs[b.pinId],x=_&&_.delayed,N=t?(0,p.calcStartPos)({...e,connectionNode:b}):{x:0,y:0},j=t?(0,p.calcTargetPos)({...e,connectionNode:n.to}):{x:0,y:0},{x:w,y:P}=(0,g.vDiv)(N,e.parentVp.zoom),{x:O,y:E}=(0,g.vDiv)(j,e.parentVp.zoom),D=(0,c.default)({delayed:x,hidden:n.hidden,"parent-selected":m},r),S=(0,u.jsxs)(v.Menu,{children:[(0,u.jsx)(v.MenuItem,{text:n.hidden?"Show connection":"Hide connection",onClick:()=>l(n)}),(0,u.jsx)(v.MenuItem,{text:"Remove connection",onClick:()=>y(n)})]});return(0,u.jsx)(v.ContextMenu,{content:S,children:e=>(0,u.jsx)(h.ConnectionViewPath,{className:D,from:{x:w,y:P},to:{x:O,y:E},dashed:"regular"!==r,zoom:a.zoom,onContextMenu:e.onContextMenu})})};t.ConnectionView=e=>{var n;const{viewPort:o,futureConnection:i,toggleHidden:s,selectedInstances:r,draggedSource:c}=e,[d,f]=l.useState(0),g=l.useCallback((e=>requestAnimationFrame((()=>{f((e=>(e+1)%9)),e>0&&g(e-1)}))),[]);l.useEffect((()=>{const e=g(10);return()=>{cancelAnimationFrame(e)}}),[g]),l.useEffect((()=>{const e=()=>{g(3)};return window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}}),[g,d]);const v=e.connections.map((n=>{const o=r.includes(n.from.insId)||r.includes(n.to.insId);return(0,a.createElement)(t.SingleConnectionView,{...e,connection:n,type:"regular",parentSelected:o,key:n.from.insId+n.from.pinId+n.to.insId+n.to.pinId})}));if(i&&v.push((0,a.createElement)(t.SingleConnectionView,{...e,connection:i.connection,type:i.type,toggleHidden:s,parentSelected:!1,key:"future"})),c){const t=(c.from?p.calcStartPos:p.calcTargetPos)({connectionNode:null!==(n=c.from)&&void 0!==n?n:c.to,viewPort:o,boardPos:e.boardPos,ancestorsInsIds:e.ancestorsInsIds,currentInsId:e.currentInsId});v.push((0,u.jsx)(h.ConnectionViewPath,{className:"dragged",from:t,to:(0,m.logicalPosToRenderedPos)(e.lastMousePos,o),zoom:o.zoom},"dragged"))}return(0,u.jsx)("span",{className:"connections-view",style:{opacity:o.zoom},children:(0,u.jsx)("svg",{style:{width:"100%"},children:v})})}},76064:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionViewPath=void 0;const i=n(35250),s=o(n(26372)),r=n(70079),a=n(23381);t.ConnectionViewPath=(0,r.forwardRef)(((e,t)=>{const{from:n,to:o,className:r,onContextMenu:u,zoom:l,dashed:c}=e,{x:d,y:p}=n,{x:f,y:m}=o,g=(0,a.calcBezierPath)({sourceX:d,sourceY:p,targetX:f,targetY:m,curvature:.15}),v=3*l,h=c?6*l:void 0;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:g,ref:t,className:(0,s.default)("connection",r),style:{strokeWidth:v,strokeDasharray:h},onContextMenu:u}),e.label?(0,i.jsx)("text",{className:"label",x:(d+f)/2,y:(p+m)/2,fontSize:"12px"}):null,(0,i.jsxs)("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,i.jsx)("stop",{offset:"0%"}),(0,i.jsx)("stop",{offset:"100%"})]})]})}))},23381:(e,t)=>{"use strict";var n;function o(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function i(e){let t,i,{pos:s,x1:r,y1:a,x2:u,y2:l,c:c}=e;switch(s){case n.Left:t=r-o(r-u,c),i=a;break;case n.Right:t=r+o(u-r,c),i=a;break;case n.Top:t=r,i=a-o(a-l,c);break;case n.Bottom:t=r,i=a+o(l-a,c)}return[t,i]}Object.defineProperty(t,"__esModule",{value:!0}),t.getBezierCenter=t.calcBezierPath=t.Position=void 0,function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(n=t.Position||(t.Position={}));t.calcBezierPath=e=>{let{sourceX:t,sourceY:o,sourcePosition:s=n.Bottom,targetX:r,targetY:a,targetPosition:u=n.Top,curvature:l=.25}=e;const[c,d]=i({pos:s,x1:t,y1:o,x2:r,y2:a,c:l}),[p,f]=i({pos:u,x1:r,y1:a,x2:t,y2:o,c:l});return`M${t},${o} C${c},${d} ${p},${f} ${r},${a}`},t.getBezierCenter=function(e){let{sourceX:t,sourceY:o,sourcePosition:s=n.Bottom,targetX:r,targetY:a,targetPosition:u=n.Top,curvature:l=.25}=e;const[c,d]=i({pos:s,x1:t,y1:o,x2:r,y2:a,c:l}),[p,f]=i({pos:u,x1:r,y1:a,x2:t,y2:o,c:l}),m=.125*t+.375*c+.375*p+.125*r,g=.125*o+.375*d+.375*f+.125*a;return[m,g,Math.abs(m-t),Math.abs(g-o)]}},18243:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcTargetPos=t.calcStartPos=t.calcPinPosition=void 0;const o=n(74762),i=n(30994),s={x:99999,y:99999};function r(e){const t=(0,i.getPinDomId)({fullInsIdPath:(0,o.fullInsIdPath)(e.insId,e.ancestorsInsIds),pinId:e.pinId,pinType:e.pinType,isMain:e.isMain});return((e,t,n,o)=>{if(!e)return console.warn(`Cannot find element ${n} to calculate position.`),s;const{x:i,y:r,width:a,height:u}=e.getBoundingClientRect(),l=r+u/2;return{x:i+a/2-t.x,y:l-t.y}})(document.getElementById(t),e.boardPos,t,e.viewPort)}t.calcPinPosition=r;t.calcStartPos=e=>{const{connectionNode:t,boardPos:n,ancestorsInsIds:i,viewPort:s,currentInsId:a}=e;return(0,o.isExternalConnectionNode)(t)?r({pinId:t.pinId,insId:a,ancestorsInsIds:i,isMain:!0,pinType:"input",boardPos:n,viewPort:s}):r({pinId:t.pinId,insId:t.insId,ancestorsInsIds:(0,o.fullInsIdPath)(a,i),isMain:!1,pinType:"output",boardPos:n,viewPort:s})};t.calcTargetPos=e=>{const{connectionNode:t,boardPos:n,ancestorsInsIds:i,viewPort:s,currentInsId:a}=e;return(0,o.isExternalConnectionNode)(t)?r({pinId:t.pinId,insId:a,ancestorsInsIds:i,isMain:!0,pinType:"output",boardPos:n,viewPort:s}):r({pinId:t.pinId,insId:t.insId,ancestorsInsIds:(0,o.fullInsIdPath)(a,i),isMain:!1,pinType:"input",boardPos:n,viewPort:s})}},30994:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPinDomId=t.getMainInstanceIndicatorDomId=t.getInstanceDomId=void 0;const o=n(74762);t.getInstanceDomId=(e,t)=>`ins:${(0,o.fullInsIdPath)(e,t)}`.replace(/\s+/g,"-");t.getMainInstanceIndicatorDomId=(e,t)=>`main-ins:${(0,o.fullInsIdPath)(e,t)}`.replace(/\s+/g,"-");t.getPinDomId=e=>{let{pinType:t,fullInsIdPath:n,pinId:o,isMain:i}=e;return`${i?"main-":""}pin:${t}:${n}:${o}`.replace(/\s+/g,"-")}},86553:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceView=t.getVisibleOutputs=t.getVisibleInputs=t.INSTANCE_INFO_TOOLTIP_DELAY=t.MAX_INSTANCE_WIDTH=t.MIN_WIDTH_PER_PIN=t.PIECE_CHAR_WIDTH=t.PIECE_HORIZONTAL_PADDING=void 0;const a=n(70079),u=n(35250),l=s(n(70079)),c=n(66074),d=n(74762),p=r(n(26372)),f=n(2036),m=n(74762),g=n(74762),v=n(53159),h=n(83234),I=n(74762),y=n(30994),b=n(63521),C=n(74089),_=n(50382),x=r(n(99581)),N=n(88593);t.PIECE_HORIZONTAL_PADDING=25,t.PIECE_CHAR_WIDTH=11,t.MIN_WIDTH_PER_PIN=40,t.MAX_INSTANCE_WIDTH=400,t.INSTANCE_INFO_TOOLTIP_DELAY=400;t.getVisibleInputs=(e,t,n)=>{const{visibleInputs:o}=e;if(o)return o;const i=(0,d.keys)((0,g.getNodeInputs)(t)).filter(((o,i)=>{var s;const r=n.some((t=>t.to.insId===e.id&&t.to.pinId===o)),a=t.inputs[o]&&"optional"===(null===(s=t.inputs[o])||void 0===s?void 0:s.mode);return r||!a&&o!==m.TRIGGER_PIN_ID}));return 0===i.length?[m.TRIGGER_PIN_ID]:i};t.getVisibleOutputs=(e,t,n)=>{const{visibleOutputs:o}=e;if(o)return o;const i=Object.keys(t.outputs);return n.some((t=>t.from.insId===e.id&&t.from.pinId===m.ERROR_PIN_ID))?[...i,m.ERROR_PIN_ID]:i};t.InstanceView=function(e){const{selected:n,selectedInput:o,selectedOutput:i,closestPin:s,dragged:r,onTogglePinLog:j,onTogglePinBreakpoint:w,onDetachConstValue:P,onCopyConstValue:O,onPasteConstValue:E,displayMode:D,connections:S,instance:M,viewPort:T,node:k,onPinClick:A,onPinDblClick:R,onDragStart:V,onDragEnd:z,onDragMove:$,onToggleSticky:H,onSelect:G,onDblClick:L,onChangeVisibleInputs:B,onChangeVisibleOutputs:F,onConvertConstToEnv:U,inlineGroupProps:q,onUngroup:W,onExtractInlineNode:Z,onGroupSelected:J,isConnectedInstanceSelected:Y,inlineEditorPortalDomNode:K,onChangeStyle:X,onDeleteInstance:Q,onSetDisplayName:ee,onPinMouseUp:te,onPinMouseDown:ne}=e,{id:oe}=M,ie=l.useMemo((()=>{const e=(0,d.randomInt)(6,1);return{icon:(0,d.pickRandom)([["fab","discord"],["fab","slack"],"bug","cube"]),color:e,size:(0,d.randomInt)(3,1),variation:(0,d.randomInt)(5,1)}}),[]),se=l.useRef(),re=l.useMemo((()=>M.style||k.defaultStyle||{}),[k,M]),ae=re.size||"regular",ue=l.useMemo((()=>new Map(S.filter((e=>{let{to:t}=e;return t.insId===oe})).map((e=>{let{to:t,hidden:n}=e;return[t.pinId,n]})))),[S,oe]),le=l.useMemo((()=>new Map(S.filter((e=>{let{from:t}=e;return t.insId===oe})).map((e=>{let{from:t,hidden:n}=e;return[t.pinId,n]})))),[S,oe]),ce=(0,C.usePrompt)(),de=l.useCallback((e=>A(M,e,"input")),[M,A]),pe=l.useCallback(((e,t)=>R(M,e,"input",t)),[M,R]),fe=l.useCallback(((e,t)=>R(M,e,"output",t)),[M,R]),me=l.useCallback((e=>A(M,e,"output")),[M,A]),ge=l.useCallback(((e,t)=>{V(M,e,t)}),[M,V]),ve=l.useCallback(((e,t)=>{const n=M.pos,o=(t.x-n.x)/T.zoom,i=(t.y-n.y)/T.zoom,s=n.x+o,r=n.y+i;z(M,e,{...t,x:s,y:r})}),[M,z,T.zoom]),he=l.useCallback(((e,t)=>{$(M,e,{x:t.x,y:t.y})}),[M,$]),Ie=l.useCallback((e=>H(M,e)),[M,H]),ye=l.useCallback((e=>P(M,e)),[M,P]),be=l.useCallback((e=>O(M,e)),[M,O]),Ce=l.useCallback((e=>E(M,e)),[M,E]),_e=l.useCallback((e=>G(M,e)),[M,G]),xe=l.useCallback((e=>L(M,e.shiftKey)),[M,L]),Ne=(0,d.entries)(k.inputs),{visibleInputs:je,visibleOutputs:we}=M;je&&Ne.sort(((e,t)=>je.indexOf(e[0])-je.indexOf(t[0])));const Pe=(0,d.entries)(k.outputs);we&&Pe.sort(((e,t)=>we.indexOf(e[0])-we.indexOf(t[0])));const Oe=(0,t.getVisibleInputs)(M,k,S),Ee=(0,t.getVisibleOutputs)(M,k,S);Ne.push([m.TRIGGER_PIN_ID,{...(0,d.nodeInput)(),description:"Use this pin to manually trigger the node. If not connected, the node will be triggered automatically when all required inputs have data."}]),Pe.push([m.ERROR_PIN_ID,{...(0,m.nodeOutput)(),description:"Use this pin to catch errors that happen inside this node. If not connected, errors will bubble up to the parent node."}]);const De=Ne.filter((e=>{let[t]=e;return Oe.includes(t)||(n||Y)&&ue.has(t)})),Se=Pe.filter((t=>{let[o]=t;return Ee.includes(o)||(n||Y)&&le.has(o)||o===m.ERROR_PIN_ID&&e.hadError})),Me=S.some((e=>e.from.insId===oe&&e.from.pinId===m.ERROR_PIN_ID)),Te=(0,p.default)("ins-view",{"no-inputs":0===Ne.length,"no-outputs":0===Pe.length,"display-mode":D,"force-minimized-input":"input"===e.forceShowMinimized||"both"===e.forceShowMinimized,"force-minimized-output":"output"===e.forceShowMinimized||"both"===e.forceShowMinimized,"inline-node-edited":!!q,"error-caught":Me}),ke=(0,p.default)({selected:n,dragged:r,closest:s&&s.ins.id===M.id},`size-${ae}`),Ae=new Set((0,d.entries)(k.inputs).filter((e=>{let[t,n]=e;return(0,m.isInputPinOptional)(n)})).map(d.pickFirst)),Re=(0,d.entries)(M.inputConfig).reduce(((e,t)=>{let[n,o]=t;return(0,m.isStickyInputPinConfig)(o)||o.sticky?{...e,[n]:!0}:e}),{}),Ve=(0,v.calcNodeContent)(M,k),ze=e=>{const t=M.inputConfig[e];if((0,I.isStaticInputPinConfig)(t))return t.value},$e=l.useCallback((async()=>{const e=(0,d.okeys)(k.inputs),t=await ce("New order?",(M.visibleInputs||e).join(","));t&&B(M,t.split(","))}),[k.inputs,ce,M,B]),He=l.useCallback((async()=>{const e=(0,d.okeys)(k.outputs),t=await ce("New order?",(M.visibleOutputs||e).join(","));t&&F(M,t.split(","))}),[k.outputs,ce,M,F]),Ge=l.useCallback((()=>{Q(M)}),[Q,M]),Le=l.useCallback((async()=>{const e=await ce("Set custom display name",M.displayName||k.id);ee(M,e)}),[ce,M,ee,k.id]),Be=Object.keys((0,g.getNodeInputs)(k)),Fe=Object.keys((0,d.getNodeOutputs)(k)),Ue=l.useCallback((e=>{U&&U(M,e)}),[M,U]),qe=l.useCallback(((e,t)=>{te&&te(M,e,t)}),[M,te]),We=l.useCallback(((e,t)=>{ne&&ne(M,e,t)}),[M,ne]),Ze=()=>(0,u.jsx)("div",{className:"inputs no-drag",children:De.map((t=>{let[i,r]=t;var a;return(0,u.jsx)(f.PinView,{type:"input",currentInsId:M.id,ancestorsInsIds:e.ancestorsInsIds,id:i,optional:Ae.has(i),connected:ue.has(i),isSticky:Re[i],minimized:!n&&1===De.length,onToggleSticky:Ie,onDetachConstValue:ye,onCopyConstValue:be,onPasteConstValue:Ce,copiedConstValue:e.copiedConstValue,selected:i===o,onClick:de,onDoubleClick:pe,isClosestToMouse:!!s&&"input"===s.type&&s.pin===i,onToggleLogged:j,onToggleBreakpoint:w,onInspect:e.onInspectPin,constValue:ze(i),onConvertConstToEnv:e.onConvertConstToEnv?Ue:void 0,description:r.description,queuedValues:null!==(a=e.queuedInputsData[i])&&void 0!==a?a:0,onMouseUp:qe,onMouseDown:We},i)}))}),Je=()=>(0,u.jsx)("div",{className:"outputs no-drag",children:Se.map((t=>{let[o,r]=t;return(0,u.jsx)(f.PinView,{currentInsId:M.id,ancestorsInsIds:e.ancestorsInsIds,connected:le.has(o),type:"output",id:o,minimized:!n&&1===Se.length,isClosestToMouse:!!s&&"output"===s.type&&s.pin===o,selected:o===i,onClick:me,onDoubleClick:fe,onToggleLogged:j,onToggleBreakpoint:w,onInspect:e.onInspectPin,description:r.description,onMouseUp:qe,onMouseDown:We},o)}))}),Ye=l.useCallback((e=>{X(M,e)}),[M,X]),Ke=l.useCallback((()=>{const e=[...Be.map((e=>{const t=Oe.includes(e),n=ue.has(e)&&!0!==ue.get(e),o=(0,d.getInputName)(e);return{text:t?n?`Hide input "${o}" (disconnect first)`:`Hide input "${o}"`:`Show input "${o}"`,onClick:()=>B(M,t?Oe.filter((t=>t!==e)):[...Oe,e]),disabled:n&&t}})),...Fe.map((e=>{const t=Ee.includes(e),n=le.has(e),o=(0,d.getOutputName)(e);return{text:t?n?`Hide output "${o}" (disconnect first)`:`Hide output "${o}"`:`Show output "${o}"`,onClick:()=>F(M,t?Ee.filter((t=>t!==e)):[...Ee,e]),disabled:n&&t}})),...(0,d.isInlineNodeInstance)(M)&&(0,g.isVisualNode)(M.node)?[{text:"Ungroup inline node",onClick:()=>W(M)}]:[],...(0,d.isInlineNodeInstance)(M)?[{text:"Extract inline node to file",onClick:()=>Z(M)}]:[],{text:"Reorder inputs",onClick:$e},{text:"Reorder outputs",onClick:He},{text:"Set display name",onClick:Le},{text:"Group selected instances",onClick:J},{text:"Delete instance",intent:"danger",onClick:Ge}];return(0,u.jsxs)(_.Menu,{children:[(0,u.jsx)(_.MenuItem,{text:"Style",children:(0,u.jsx)(N.NodeStyleMenu,{style:re,onChange:Ye,promptFn:ce})}),e.map(((e,t)=>(0,a.createElement)(_.MenuItem,{...e,key:t})))]})}),[Be,Fe,M,$e,He,Le,Ge,re,Ye,ce,Oe,ue,B,Ee,le,F,W,Z,J]),Xe={"--node-color":re.color,...re.cssOverride||{}},Qe=(0,y.getInstanceDomId)(M.id,e.ancestorsInsIds);return(0,u.jsx)("div",{className:Te,children:(0,u.jsx)(h.BaseNodeView,{pos:M.pos,viewPort:T,onDragStart:ge,onDragMove:he,onDragEnd:ve,upperRenderer:Ze,bottomRenderer:Je,displayMode:D,domId:Qe,children:(0,u.jsxs)(l.Fragment,{children:[Ze(),q?x.default.createPortal((0,u.jsxs)("div",{className:"inline-group-editor-container no-drag",children:[(0,u.jsxs)("header",{children:[Ve," ",(0,u.jsx)("button",{onClick:e.onCloseInlineEditor,children:"close"})]}),(0,u.jsx)(b.VisualNodeEditor,{...e.inlineGroupProps,className:"no-drag",ref:se})]}),K):(0,u.jsx)(_.ContextMenu,{className:(0,p.default)("ins-view-inner",ke,`size-${ie.size}`),onClick:_e,onDoubleClick:xe,content:Ke(),style:Xe,children:(0,u.jsx)(_.Tooltip,{content:k.description,children:(0,u.jsxs)(l.Fragment,{children:[re.icon?(0,u.jsx)(c.FontAwesomeIcon,{icon:re.icon}):null," ",Ve]})})}),Je()]})})})}},53568:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStyleMenu=t.nodeStylePresetColors=void 0;const r=n(35250),a=n(50382),u=s(n(70079)),l=n(84472);t.nodeStylePresetColors=[{name:"Amethyst",color:"#9b5de5"},{name:"Magenta",color:"#f15bb5"},{name:"Yellow",color:"#fee440"},{name:"Capri",color:"#00bbf9"},{name:"Sea Green",color:"#00f5d4"},{name:"Orange",color:"#ff7f00"}];const c={size:"regular"};t.NodeStyleMenu=e=>{var n;const{onChange:o,style:i}=e,s=i||c,d=e.promptFn,p=u.default.useCallback(((e,t)=>{o({...s,[e]:t})}),[s,o]),f=u.default.useCallback((async()=>{const e=await d("Icon name? (Font Awesome conventions)","rocket"),t=e.includes(",")?e.split(","):e;p("icon",t)}),[d,p]),m=(0,u.useCallback)((async()=>{const e=await d("Enter a custom style (valid JSON representing a React CSS object)",s.cssOverride?JSON.stringify(s.cssOverride):"");try{const t=JSON.parse(e);p("cssOverride",t)}catch(t){console.error(t),(0,l.toastMsg)("Invalid object","danger")}}),[d,p,s.cssOverride]);return(0,r.jsxs)(u.default.Fragment,{children:[(0,r.jsxs)(a.MenuItem,{text:"Color",children:[t.nodeStylePresetColors.map((e=>(0,r.jsx)(a.MenuItem,{text:e.name,onClick:()=>p("color",e.color)},e.name))),(0,r.jsx)(a.MenuDivider,{}),(0,r.jsx)(a.MenuItem,{text:"Remove Color",onClick:()=>p("color",void 0)})]}),(0,r.jsxs)(a.MenuItem,{text:`Size (${null!==(n=s.size)&&void 0!==n?n:"regular"})`,children:[(0,r.jsx)(a.MenuItem,{text:"Small",onClick:()=>p("size","small")}),(0,r.jsx)(a.MenuItem,{text:"Regular",onClick:()=>p("size","regular")}),(0,r.jsx)(a.MenuItem,{text:"Large",onClick:()=>p("size","large")})]}),(0,r.jsxs)(a.MenuItem,{text:"Icon",children:[(0,r.jsx)(a.MenuItem,{text:"Choose Icon",onClick:f}),(0,r.jsx)(a.MenuItem,{text:"Remove Icon",onClick:()=>p("icon",void 0)})]}),(0,r.jsx)(a.MenuItem,{text:"Custom Styling",onClick:m})]})}},88593:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(53568),t)},83651:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(86553),t)},53159:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.calcInstancePosition=t.calcNodeWidth=t.calcNodeContent=void 0;const i=n(74762),s=o(n(6576)),r=n(86553),a=n(61888),u=n(30994);t.calcNodeContent=(e,t)=>{if(e.displayName)return e.displayName;if(t.customViewCode)try{const n=Object.entries(e.inputConfig).filter((e=>{let[,t]=e;return(0,i.isStaticInputPinConfig)(t)})).reduce(((e,t)=>{let[n,o]=t;return{...e,[n]:o.value}}),{});return s.default.compile(t.customViewCode)({inputs:n}).trim()}catch(n){return console.error("Error with custom view",n),`Error in custom view [${t.id}]`}return t.id};t.calcNodeWidth=(e,n)=>{const o=(0,i.okeys)(n.inputs).length*r.MIN_WIDTH_PER_PIN,s=(0,t.calcNodeContent)(e,n),u=r.PIECE_CHAR_WIDTH;return(0,a.clamp)(s.length*u+2*r.PIECE_HORIZONTAL_PADDING,o,r.MAX_INSTANCE_WIDTH)};t.calcInstancePosition=(e,t,n)=>{const o=(0,u.getInstanceDomId)(e,t),i=document.getElementById(o);if(i){const{x:e,y:t,width:o,height:s}=i.getBoundingClientRect(),r=t+s/2;return{x:e+o/2-n.x,y:r-n.y}}return console.warn("Cannot find element to draw connection to",o),{x:99999,y:99999}}},17841:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LayoutDebugger=t.LayoutDebuggerItem=t.PosDebugger=void 0;const i=n(70079),s=n(35250),r=n(74762),a=o(n(70079)),u=n(7047),l=e=>{let{pos:t}=e;return(0,s.jsxs)("span",{children:[t.x.toFixed(1),", ",t.y.toFixed(1)]})};t.PosDebugger=e=>(0,s.jsx)("span",{className:"pos-debugger",children:(0,s.jsx)(l,{pos:e.pos})});t.LayoutDebuggerItem=e=>{const{pos:n,viewPort:o,size:i,color:r}=e,a=o.zoom,u=n.x*a-o.pos.x*a,l=n.y*a-o.pos.y*a,c={transform:`translate(${u-n.x}px, ${l-n.y}px)`},d={transform:`scale(${o.zoom})`},p={transform:`translate(${n.x}px, ${n.y}px)`},f={width:`${i.width}px`,height:`${i.height}px`,backgroundColor:r};return(0,s.jsx)("div",{className:"layout-debugger",style:c,children:(0,s.jsxs)("span",{className:"drag-sim",style:p,children:[(0,s.jsx)(t.PosDebugger,{pos:n}),(0,s.jsx)("div",{className:"layout-debugger-zoom-wrapper",style:d,children:(0,s.jsx)("div",{className:"layout-debugger-inner",style:f})})]})})};const c=(()=>{try{return"true"===localStorage.getItem("pos-debugger")}catch(e){return!1}})();t.LayoutDebugger=e=>{const{extraDebug:n,vp:o,node:d,mousePos:p}=e;if(!c)return null;const f=n.map(((e,n)=>(0,i.createElement)(t.LayoutDebuggerItem,{...e,key:n}))),m=[...d.instances.map((e=>e.pos)),...(0,r.values)(d.inputsPosition),...(0,r.values)(d.outputsPosition)].map((e=>(0,s.jsx)(t.LayoutDebuggerItem,{pos:e,viewPort:o,size:{width:0,height:0},color:"red"}))),g=(0,u.logicalPosToRenderedPos)(p,o),v=(0,s.jsxs)("div",{className:"viewport-data",children:[(0,s.jsxs)("div",{children:["Pos: ",(0,s.jsx)(l,{pos:o.pos})]}),(0,s.jsxs)("div",{children:["Zoom: ",o.zoom.toFixed(2)," "]}),(0,s.jsxs)("div",{children:["Mouse (logical): ",(0,s.jsx)(l,{pos:p})]}),(0,s.jsxs)("div",{children:["Rendered (rendered): ",(0,s.jsx)(l,{pos:g})]})]});return(0,s.jsxs)(a.default.Fragment,{children:[v,f,m]})}},44338:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(17841),t)},38259:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateInstancesWithSingleConstPinsMap=t.getLeafInstancesOfSelection=void 0;t.getLeafInstancesOfSelection=(e,t,n)=>e.reduce(((e,o)=>[...e,...n.filter((e=>e.to.insId===o.id)).map((e=>t.find((t=>t.id===e.from.insId)))).filter((e=>!!e))]),[]).filter((t=>1===n.filter((e=>e.from.insId===t.id||e.to.insId===t.id)).length&&!e.includes(t)));t.calculateInstancesWithSingleConstPinsMap=(e,t)=>{const{connections:n}=e;return n.filter((e=>t.has(e.from.insId))).reduce(((e,n)=>{const o=t.get(n.from.insId),i=n.to.insId,s=e.get(i)||new Map;return s.set(n.to.pinId,{val:o,insId:n.from.insId}),e.set(i,s),e}),new Map)}},37488:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeIoView=void 0;const a=n(35250),u=n(70079),l=s(n(70079)),c=n(74762),d=n(83234),p=r(n(26372)),f=n(50382),m=n(43490),g=n(66189),v=n(74762),h=n(30994);t.NodeIoView=l.memo((function(e){const{viewPort:t,selected:n,pos:o,type:i,id:s,onDblClick:r,onRename:I,onDelete:y,onChangeInputMode:b,inputMode:C,onSelect:_,closest:x,onSetDescription:N,description:j,onMouseUp:w,onMouseDown:P,currentInsId:O}=e,{history:E,resetHistory:D,refreshHistory:S}=(0,g.useHistoryHelpers)(O,s,i),M=(0,m.usePrompt)(),T=l.useCallback((async()=>{const e=await M("Description?",j);N(i,s,e)}),[M,j,N,i,s]),k=l.useCallback((()=>{y&&y(i,s)}),[i,s,y]),A=l.useCallback((()=>{I&&I(i,s)}),[i,s,I]),R=l.useCallback((e=>{b&&b(s,e)}),[s,b]),V=l.useCallback((()=>[{text:`Current mode - ${C}`,onClick:c.noop},{text:"Make required",onClick:()=>R("required")},{text:"Make optional",onClick:()=>R("optional")},{text:"Make required-if-connected",onClick:()=>R("required-if-connected")},{text:"Set description",onClick:T},...e.onRename?[{text:"Rename",onClick:A}]:[],...e.onDelete?[{text:"Delete",onClick:k}]:[]]),[T,C,R,k,A,e.onDelete,e.onRename]),z=l.useCallback((t=>{r&&r(e.id,t)}),[r,e.id]),$=l.useCallback((()=>{_(s,i)}),[s,i,_]),H=l.useCallback((()=>(0,a.jsx)(f.Menu,{children:V().map(((e,t)=>(0,u.createElement)(f.MenuItem,{...e,key:t})))})),[V]),G="input"===i?(0,v.getInputName)(s):(0,c.getOutputName)(s),L=l.useCallback((e=>{w(s,i,e)}),[s,w,i]),B=l.useCallback((e=>{P(s,i,e)}),[s,P,i]);return(0,a.jsx)(d.BaseNodeView,{className:(0,p.default)("node-io-view",i),pos:o,onDragEnd:(n,o)=>{const r=e.pos,a=(o.x-r.x)/t.zoom,u=(o.y-r.y)/t.zoom,l=r.x+a,c=r.y+u;e.onDragEnd(i,s,n,{...o,x:l,y:c})},onDragStart:(t,n)=>{e.onDragStart(s,t,n)},onDragMove:(n,o)=>{const r=e.pos,a=(o.x-r.x)/t.zoom,u=(o.y-r.y)/t.zoom,l=r.x+a,c=r.y+u;e.onDragMove(i,s,n,{...o,x:l,y:c})},viewPort:t,children:(0,a.jsx)(l.Fragment,{children:(0,a.jsx)(f.ContextMenu,{onMouseEnter:S,onMouseOut:D,onMouseUp:L,onMouseDown:B,"data-tip":"","data-html":!0,"data-for":s+e.currentInsId,className:(0,p.default)("node-io-view-inner",{closest:x,selected:n}),id:(0,h.getPinDomId)({fullInsIdPath:(0,c.fullInsIdPath)(e.currentInsId,e.ancestorInsIds),pinId:s,pinType:i,isMain:!0}),onClick:$,onDoubleClick:z,content:H(),children:(0,a.jsx)(f.Tooltip,{content:(()=>{const t=(0,g.calcHistoryContent)(E),n=e.description?(0,a.jsx)("em",{children:e.description}):"";return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:G})," (",i,")"," "]}),n,(0,a.jsx)("hr",{}),t]})})(),children:s})})})})}))},66005:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(37488),t)},83782:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcNodeIoWidth=t.MIN_WIDTH_PER_PIN=t.PIECE_CHAR_WIDTH=t.PIECE_HORIZONTAL_PADDING=void 0,t.PIECE_HORIZONTAL_PADDING=15,t.PIECE_CHAR_WIDTH=9,t.MIN_WIDTH_PER_PIN=40;t.calcNodeIoWidth=e=>Math.max(t.MIN_WIDTH_PER_PIN,e.length*t.PIECE_CHAR_WIDTH+2*t.PIECE_HORIZONTAL_PADDING)},99942:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.orderVisualNode=t.layoutToInstances=void 0;const i=n(63521),s=n(74762),r=n(90794),a=o(n(53865)),u=n(83782),l=n(60190),c=n(53159),d=n(41032);t.layoutToInstances=(e,t)=>(0,a.default)(t,(t=>{(0,s.entries)(e.nodes).forEach((e=>{let[n,o]=e;if(n.startsWith("ins-")){const e=n.replace("ins-",""),i=t.instances.find((t=>t.id===e));i?i.pos=o.p:console.warn("WAT")}if(n.startsWith("node-input-")){const e=n.replace("node-input-","");t.inputsPosition[e]=o.p}if(n.startsWith("node-output-")){const e=n.replace("node-output-","");t.outputsPosition[e]=o.p}}))}));t.orderVisualNode=(e,n,o,a)=>{const{instances:p,connections:f}=e,m={...p.reduce(((e,t)=>{const o=(0,l.size)((0,c.calcNodeWidth)(t,(0,d.safelyGetNodeDef)(t,n)),i.NODE_HEIGHT);return{...e,[`ins-${t.id}`]:{p:t.pos,s:o}}}),{}),...(0,s.okeys)(e.inputsPosition).reduce(((t,n)=>({...t,[`node-input-${n}`]:{p:e.inputsPosition[n],s:(0,l.size)((0,u.calcNodeIoWidth)(n),i.NODE_HEIGHT)}})),{}),...(0,s.okeys)(e.outputsPosition).reduce(((t,n)=>({...t,[`node-output-${n}`]:{p:e.outputsPosition[n],s:(0,l.size)((0,u.calcNodeIoWidth)(n),i.NODE_HEIGHT)}})),{})},g=f.map((e=>[(0,s.isExternalConnectionNode)(e.from)?`node-input-${e.from.pinId}`:`ins-${e.from.insId}`,(0,s.isExternalConnectionNode)(e.to)?`node-output-${e.to.pinId}`:`ins-${e.to.insId}`])),v=(0,r.orderLayout)({nodes:m,edges:g},o,((n,o)=>{a&&a((0,t.layoutToInstances)(n,e),o)}));return(0,t.layoutToInstances)(v,e)}},90794:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.orderLayout=void 0;const o=n(60190),i=400,s=e=>e.reduce(((e,t)=>{const n=(0,o.vSub)(t.p,(0,o.vec)(t.s.width/2,t.s.height/2));return{...e,[t.id]:{p:n,s:t.s}}}),{});t.orderLayout=(e,t,n)=>{let{nodes:r,edges:a}=e,u=Object.entries(r).map((e=>{let[t,n]=e;return{id:t,p:(0,o.vAdd)(n.p,(0,o.vec)(n.s.width/2,n.s.height/2)),f:(0,o.vec)(0,0),v:(0,o.vec)(0,0),m:1,s:n.s}})),l=0;for(;l<t&&(l<2||(0,o.totalEnergy)(u)>.01);){let e=u;for(let t=0;t<e.length;t++)for(let n=t+1;n<e.length;n++)if(t!==n){const s=e[t],r=e[n],a=(0,o.vSub)(s.p,r.p),u=Math.abs(a.x),l=Math.abs(a.y),c=s.id.startsWith("node-input"),d=s.id.startsWith("node-output"),p=r.id.startsWith("node-input"),f=r.id.startsWith("node-output");if(u<i&&l<80){const e=1e3*(i-u);s.f=(0,o.vAdd)(s.f,(0,o.vec)(.5*e,0)),r.f=(0,o.vAdd)(r.f,(0,o.vec)(-.5*e,0))}if(l<50){const e=100*a.y;s.f=(0,o.vAdd)(s.f,(0,o.vec)(0,.5*e)),r.f=(0,o.vAdd)(r.f,(0,o.vec)(0,-.5*e))}if(c&&f){const e=(0,o.vSub)(s.p,r.p).y;if(e<-500){const t=100*(i-e);s.f=(0,o.vAdd)(s.f,(0,o.vec)(0,-.5*t)),r.f=(0,o.vAdd)(r.f,(0,o.vec)(0,.5*t))}}else if(d&&p){const e=(0,o.vSub)(s.p,r.p).y;if(e<500){const t=100*(i-e);s.f=(0,o.vAdd)(s.f,(0,o.vec)(0,-.5*t)),r.f=(0,o.vAdd)(r.f,(0,o.vec)(0,.5*t))}}const m=(0,o.vSub)(s.p,(0,o.vec)(0,s.p.y)),g=(0,o.vLen)(m),v=(0,o.vMul)((0,o.vNorm)(m),-50*g);s.f=(0,o.vAdd)(s.f,v)}a.forEach((t=>{let n=e.find((e=>e.id===t[0])),i=e.find((e=>e.id===t[1]));if(!n||!i)return void console.warn("weoops",t[0],t[1]);const s=(0,o.vec)(0,-200),r=(0,o.vSub)(n.p,i.p),a=(0,o.vSub)(s,r),u=1e3*(0,o.vLen)(a),l=(0,o.vMul)((0,o.vNorm)(a),.5*u),c=(0,o.vMul)((0,o.vNorm)(a),-.5*u);n.f=(0,o.vAdd)(n.f,l),i.f=(0,o.vAdd)(i.f,c)})),e=e.map((e=>(0,o.itrPhysics)(15,e))),e=e.map((e=>{const t=(0,o.vMul)(e.v,.5),n=(0,o.vLen)(t)>100?(0,o.vMul)((0,o.vNorm)(t),100):t;return{...e,v:n}})),u=e,n&&n({nodes:s(e),edges:a},l),l++}return{nodes:s(u),edges:a,itrs:l,timeout:l>=t,total:(0,o.totalEnergy)(u)}}},2036:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PinView=t.PIN_HEIGHT=void 0;const a=n(35250),u=s(n(70079)),l=r(n(26372)),c=n(50382),d=n(18420),p=n(74762),f=n(30994),m=n(96233),g=n(66189);t.PIN_HEIGHT=23;t.PinView=u.memo((function(e){const{selected:t,type:n,connected:o,rotate:i,optional:s,currentInsId:r,isClosestToMouse:v,id:h,onMouseDown:I,onMouseUp:y}=e,{history:b,resetHistory:C,refreshHistory:_}=(0,g.useHistoryHelpers)(r,h,n),x="input"===n?(0,p.getInputName)(h):(0,p.getOutputName)(h),N="input"===e.type&&(0,d.isDefined)(e.constValue)?e.constValue:void 0,j=i&&"input"===n,w=u.useCallback((e=>{0===e.button&&I(h,n,e)}),[h,n,I]),P=u.useCallback((e=>{0===e.button&&y(h,n,e)}),[h,n,y]);return(0,a.jsxs)("div",{className:(()=>{if("input"===e.type){const{isSticky:r,constValue:a}=e;return(0,l.default)("pin",{sticky:r,selected:t,closest:v,optional:s,connected:o,rotate:i,"const-value":(0,d.isDefined)(a),"env-value":(0,d.isDefined)(a)&&(0,p.isEnvValue)(a),minimized:e.minimized},n)}return(0,l.default)("pin",{selected:t,connected:o,closest:v,rotate:i,optional:s,minimized:e.minimized,"error-pin":h===p.ERROR_PIN_ID},n,i)})(),"data-pin-id":h,children:[(0,a.jsx)(c.Tooltip,{className:"pin-info-tooltip",content:(()=>{const t=(0,g.calcHistoryContent)(b,"input"===n?e.queuedValues:void 0),o=e.description?(0,a.jsx)("em",{children:e.description}):"";return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:x})," (",n,")"," "]}),o,(0,a.jsx)("hr",{}),(0,d.isDefined)(N)?(0,a.jsxs)("div",{children:["Static value:"," ",(0,a.jsx)("strong",{children:(0,m.valuePreview)(N).substring(0,200)})]}):t]})})(),children:(0,a.jsxs)(c.ContextMenu,{onMouseEnter:_,onMouseOut:C,onMouseDown:w,onMouseUp:P,"data-tip":"","data-html":!0,"data-for":h+e.currentInsId,id:(0,f.getPinDomId)({fullInsIdPath:(0,p.fullInsIdPath)(e.currentInsId,e.ancestorsInsIds),pinId:h,pinType:n,isMain:!1}),"data-place":j?"bottom":null,onDoubleClick:t=>e.onDoubleClick&&e.onDoubleClick(h,t),className:"pin-inner",onClick:t=>{const{onShiftClick:o,onClick:i,id:s}=e;t.shiftKey&&o?o(s,t):i(s,n,t)},content:(()=>{const t=(0,a.jsx)(c.MenuItem,{onClick:()=>e.onInspect(e.currentInsId,{id:e.id,type:e.type}),text:"Inspect"});if("input"===e.type){const{onConvertConstToEnv:n}=e;return(0,d.isDefined)(N)?(0,a.jsxs)(c.Menu,{children:[(0,a.jsx)(c.MenuItem,{onClick:()=>e.onDetachConstValue(e.id),text:"Detach value"}),(0,a.jsx)(c.MenuItem,{onClick:()=>e.onCopyConstValue(e.id),text:"Copy value"}),(0,d.isDefined)(e.copiedConstValue)?(0,a.jsx)(c.MenuItem,{onClick:()=>e.onPasteConstValue(e.id),text:"Paste value"}):null,n?(0,a.jsx)(c.MenuItem,{onClick:()=>n(e.id),text:"Convert to Env Var"}):null]}):(0,a.jsxs)(c.Menu,{children:[(0,a.jsx)(c.MenuItem,{onClick:()=>e.onToggleSticky(e.id),text:"Toggle sticky (square means sticky)"}),t,(0,d.isDefined)(e.copiedConstValue)?(0,a.jsx)(c.MenuItem,{onClick:()=>e.onPasteConstValue(e.id),text:"Paste value"}):null]})}return(0,a.jsx)(c.Menu,{children:t})})(),children:[x," ",(0,d.isDefined)(N)?(0,a.jsxs)(u.Fragment,{children:[":",(0,a.jsx)("span",{className:"value",children:(0,d.toString)(N)})]}):null,"input"===e.type&&e.isSticky?(0,a.jsx)("span",{className:"suffix",children:"s"}):null,"input"===e.type&&e.queueSize?(0,a.jsxs)("span",{className:"suffix",children:[e.queueSize," in Q"]}):null]})}),(0,a.jsx)("div",{className:"wire"})]})}))},66189:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useHistoryHelpers=t.calcHistoryContent=void 0;const i=n(35250),s=n(96233),r=o(n(70079)),a=n(70079),u=n(98158);t.calcHistoryContent=(e,t)=>{if(e){const{total:n,lastSamples:o}=e,a=(0,i.jsxs)("strong",{children:["Activated ",n," times this session"]}),u=o.length>0?(0,i.jsxs)("div",{children:["Last value:"," ",(0,i.jsx)("strong",{children:(0,s.valuePreview)(o[0].val).substring(0,200)}),(0,i.jsx)("br",{}),(0,i.jsx)("em",{children:"Inspect instance for the full value"})]}):"",l=t?(0,i.jsx)(r.default.Fragment,{children:(0,i.jsxs)("div",{children:["Queued values: ",(0,i.jsx)("strong",{children:t})]})}):"";return(0,i.jsxs)(r.default.Fragment,{children:[a,u,l]})}return"Loading session data.."};t.useHistoryHelpers=(e,t,n)=>{const o=(0,a.useRef)(),{onRequestHistory:i}=(0,u.useDebuggerContext)(),[s,l]=(0,a.useState)();return{history:s,refreshHistory:(0,a.useCallback)((()=>{clearInterval(o.current),i(e,t,n).then((e=>{l(e)})),o.current=setInterval((()=>{i(e,t,n).then((e=>{l(e)}))}),500)}),[e,i,t,n]),resetHistory:r.default.useCallback((()=>{clearInterval(o.current),l(void 0)}),[])}}},89440:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.QuickAddMenu=void 0;const r=n(35250),a=s(n(70079)),u=n(74762),l=n(50382),c=n(70457),d=n(9958),p=n(86125),f=c.Select.ofType(),m=e=>{switch(e.type){case"node":return`${e.node.id}`;case"value":return"Add inline value or function";case"import":return`Import ${e.importableNode.node.id} from ${e.importableNode.module}`}},g=(e,t)=>{let{handleClick:n,modifiers:o,query:i}=t;if(!o.matchesPredicate)return null;const s=m(e);return"value"===e.type?(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)(l.MenuDivider,{}),(0,r.jsx)(l.MenuItem,{active:o.active,disabled:o.disabled,onClick:n,text:(0,d.highlightText)(s,i)},m(e))]}):(0,r.jsx)(l.MenuItem,{active:o.active,disabled:o.disabled,onClick:n,text:(0,d.highlightText)(s,i)},m(e))},v=(e,t,n,o)=>{const i=m(t).toLocaleLowerCase(),s=e.toLowerCase();return o?i===s:i.includes(s)};t.QuickAddMenu=e=>{const{resolvedDependencies:t,targetNode:n}=e,o={left:e.pos.x,top:e.pos.y},{onRequestImportables:i}=(0,p.useDependenciesContext)(),[s,c]=a.useState();a.useEffect((()=>{i().then((e=>c(e.importables)))}),[i]);const d=(0,u.values)({...t,[n.id]:n}),m=d.map((e=>({type:"node",node:e}))),h=new Set(d.map((e=>e.id))),I=s?s.filter((e=>!h.has(e.node.id))).map((e=>({type:"import",importableNode:e}))):[],y=m.concat(I).concat({type:"value"});return(0,r.jsx)("div",{className:"quick-add-menu",style:o,children:(0,r.jsx)(f,{className:"quick-add-nodes-select",items:y,itemPredicate:v,itemRenderer:g,inputProps:{className:"quick-add-input"},noResults:(0,r.jsx)(l.MenuItem,{disabled:!0,text:"No results."}),onItemSelect:t=>e.onAdd(t),popoverProps:{isOpen:!0,onClose:()=>e.onClose()}})})}},71033:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(89440),t)},73470:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRuntimePlayer=void 0;const o=n(74762),i=n(64955),s=(0,o.debugLogger)("runtime-player");t.createRuntimePlayer=()=>{let e=0,t=[];let n=!1,r=Date.now(),a=e;const u=()=>requestAnimationFrame((()=>{const l=Date.now();a=e,e+=l-r,r=l,((e,n)=>{const r=t;t=[],r.length&&s(`Playing ${r.length} events from`,e,n),r.forEach((e=>{s("Playing event",e),(0,i.playEvent)(e),e.insId===o.ROOT_INS_ID&&e.type===o.DebuggerEventType.PROCESSING_CHANGE&&!1===e.val&&(s("Main instance is done processing, clearing runtime UI",e),c())}))})(a,e),n&&u()})),l=()=>{n=!1},c=()=>{document.querySelectorAll("[data-runtime]").forEach((e=>{e.removeAttribute("data-runtime")})),document.querySelectorAll("[data-runtime-queue]").forEach((e=>{e.removeAttribute("data-runtime-queue")})),t=[]};return{stop:l,start:function(t){void 0===t&&(t=0),n=!0,e=t,r=Date.now(),u()},addEvents:e=>{t.push(...e)},destroy:()=>{l(),c()},clear:c,status:()=>({running:n,currDt:e,lastDt:a,queue:t,last:r})}}},64955:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.playEvent=t.cancelTimers=void 0;const o=n(74762),i=n(30994),s=5e3,r=(0,o.debugLogger)("runtime-player:play-event"),a=(e,t)=>e.type===o.DebuggerEventType.INPUT_CHANGE||e.type===o.DebuggerEventType.OUTPUT_CHANGE?`${(0,o.fullInsIdPath)(e.insId,e.ancestorsInsIds)}.${e.pinId}`:(0,o.fullInsIdPath)(e.insId,e.ancestorsInsIds);t.cancelTimers=new Map;t.playEvent=e=>{switch(e.type){case o.DebuggerEventType.INPUT_CHANGE:case o.DebuggerEventType.OUTPUT_CHANGE:{const{pinId:n,insId:u,ancestorsInsIds:l}=e,c=e.type===o.DebuggerEventType.INPUT_CHANGE?"input":"output",d=[(0,i.getPinDomId)({fullInsIdPath:(0,o.fullInsIdPath)(u,l),pinId:n,pinType:c,isMain:!0})];u!==o.ROOT_INS_ID&&d.push((0,i.getPinDomId)({fullInsIdPath:(0,o.fullInsIdPath)(u,l),pinId:n,pinType:c,isMain:!1})),d.forEach(((i,l)=>{const c=a(e);clearTimeout(t.cancelTimers.get(c));const d=document.getElementById(i),p=`${u}.${n}`,f=e.type===o.DebuggerEventType.OUTPUT_CHANGE?document.querySelectorAll(`[data-from-id="${p}"]`):[];if(d){clearTimeout(t.cancelTimers.get(c)),d.removeAttribute("data-runtime"),f.forEach((e=>{e.removeAttribute("data-runtime")})),setTimeout((()=>{d.setAttribute("data-runtime","active"),f.forEach((e=>{e.setAttribute("data-runtime","active")}))}),0);const n=setTimeout((()=>{d.removeAttribute("data-runtime"),f.forEach((e=>{e.removeAttribute("data-runtime")})),t.cancelTimers.delete(c)}),s);t.cancelTimers.set(a(e),n)}else console.warn(`No DOM element with Id [${i}] found to play event`),r(`No DOM element with Id [${i}] found to play event`,e)}));break}case o.DebuggerEventType.PROCESSING_CHANGE:{const{insId:n,ancestorsInsIds:u}=e,l=[(0,i.getMainInstanceIndicatorDomId)(n,u)];n!==o.ROOT_INS_ID&&l.push((0,i.getInstanceDomId)(n,u)),l.forEach(((n,o)=>{var i;const u=a(e),l=null===(i=document.getElementById(n))||void 0===i?void 0:i.parentElement;if(l)if(!0===e.val)l.setAttribute("data-runtime","processing"),clearTimeout(t.cancelTimers.get(u));else{l.removeAttribute("data-runtime"),setTimeout((()=>{"error"!==l.getAttribute("data-runtime")&&l.setAttribute("data-runtime","done")}),0);const e=setTimeout((()=>{l.removeAttribute("data-runtime"),t.cancelTimers.delete(u)}),s);t.cancelTimers.set(u,e)}else r(`No DOM element with Id [${n}] found to play event`,e)}));break}case o.DebuggerEventType.ERROR:{const{insId:n,ancestorsInsIds:u}=e,l=[(0,i.getMainInstanceIndicatorDomId)(n,u)];n!==o.ROOT_INS_ID&&l.push((0,i.getInstanceDomId)(n,u)),l.forEach(((n,o)=>{var i;const u=a(e),l=null===(i=document.getElementById(n))||void 0===i?void 0:i.parentElement;if(!l)return void r(`No DOM element with Id [${n}] found to play event`,e);clearTimeout(t.cancelTimers.get(u)),l.removeAttribute("data-runtime"),setTimeout((()=>{l.setAttribute("data-runtime","error")}));const c=setTimeout((()=>{l.removeAttribute("data-runtime"),t.cancelTimers.delete(u)}),s);t.cancelTimers.set(u,c)}));const c={...e,type:o.DebuggerEventType.OUTPUT_CHANGE,pinId:o.ERROR_PIN_ID};(0,t.playEvent)(c);break}case o.DebuggerEventType.INPUTS_STATE_CHANGE:(0,o.entries)(e.val).forEach((t=>{let[n,s]=t;const{insId:a,ancestorsInsIds:u}=e,l=(0,i.getPinDomId)({fullInsIdPath:(0,o.fullInsIdPath)(a,u),pinId:n,pinType:"input",isMain:!1}),c=document.getElementById(l);c?s>0?c.setAttribute("data-runtime-queue",`${s}`):c.removeAttribute("data-runtime-queue"):r(`No DOM element with Id [${l}] found to play event`,e)}))}}},25804:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDebounce=void 0;const o=n(70079);t.useDebounce=function(e,t){const[n,i]=(0,o.useState)(e);return(0,o.useEffect)((()=>{const n=setTimeout((()=>{i(e)}),t);return()=>{clearTimeout(n)}}),[e,t]),[n,i]}},7047:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.handleChangeNodeInputType=t.handleIoPinRename=t.handleInstanceDrag=t.getInstancesInRect=t.isJsxValue=t.getMiddleOfViewPort=t.fitViewPortToNode=t.centerBoardPosOnTarget=t.renderedPosToLogicalPos=t.logicalPosToRenderedPos=t.getEffectiveNodeDimensions=t.calcNodesPositions=t.calcSelectionBoxArea=t.animateViewPort=t.easeInOutNum=t.easeInOutPos=t.easeInOutQuad=t.center=t.distance=t.clamp=t.domToViewPort=t.roundNumber=t.createNewNodeInstance=t.createNewInlineNodeInstance=t.parseInputOutputTypes=t.parsePromptValue=t.getSelectionBoxRect=t.findClosestPin=t.changePinConfig=t.getInstancePinConfig=t.emptyList=t.emptyObj=void 0;const r=s(n(53865)),a=n(30721),u=n(63521),l=n(74762),c=n(18243),d=n(74762),p=n(53159),f=n(83782),m=n(60190),g=n(38259),v=n(83651),h=n(41032);t.emptyObj={},t.emptyList=[],t.getInstancePinConfig=function(e,n,o){var i;const s=e.instances.find((e=>e.id===n));if(!s)throw new Error(`Instance ${n} not found`);return null!==(i=(s.inputConfig||t.emptyObj)[o])&&void 0!==i?i:(0,l.queueInputPinConfig)()};t.changePinConfig=(e,t,n,o)=>r.produce(e,(e=>{var i;const{instances:s}=e,r=s.find((e=>e.id===t));if(!r)throw new Error("blah");const a=null!==(i=r.inputConfig)&&void 0!==i?i:{};a[n]=o,e.instances=s.map((e=>e===r?{...r,inputConfig:a}:e))}));t.findClosestPin=(e,t,n,o,i,s,r)=>{const a=(0,l.nodeInstance)(e.id,e.id),u=(0,d.okeys)(e.inputs).map((e=>({id:e,type:"input",pos:(0,c.calcPinPosition)({insId:i,ancestorsInsIds:s,pinId:e,pinType:"input",boardPos:o,viewPort:r,isMain:!0}),ins:a}))),p=(0,d.okeys)(e.outputs).map((e=>({id:e,type:"output",pos:(0,c.calcPinPosition)({insId:i,ancestorsInsIds:s,pinId:e,pinType:"output",boardPos:o,viewPort:r,isMain:!0}),ins:a}))),f=[...u,...e.instances.reduce(((n,a)=>{const u=(0,h.safelyGetNodeDef)(a,t),d=(0,v.getVisibleInputs)(a,u,e.connections),p=(0,v.getVisibleOutputs)(a,u,e.connections);return[...n,...d.map((e=>({ins:a,type:"input",pos:(0,c.calcPinPosition)({insId:a.id,ancestorsInsIds:(0,l.fullInsIdPath)(i,s),pinId:e,pinType:"input",boardPos:o,viewPort:r,isMain:!1}),id:e}))),...p.map((e=>({ins:a,type:"output",pos:(0,c.calcPinPosition)({insId:a.id,ancestorsInsIds:(0,l.fullInsIdPath)(i,s),pinId:e,pinType:"output",boardPos:o,viewPort:r,isMain:!1}),id:e})))]}),[]),...p];let m={dis:1e5,item:f[0]};return f.forEach((e=>{const t=e.pos.x-n.x,o=e.pos.y-n.y,i=Math.sqrt(t*t+o*o);i<m.dis&&(m.dis=i,m.item=e)})),m.item};t.getSelectionBoxRect=(e,t)=>{const n=Math.min(e.x,t.x),o=Math.min(e.y,t.y);return{x:n,y:o,w:Math.max(e.x,t.x)-n,h:Math.max(e.y,t.y)-o}};t.parsePromptValue=e=>{if(null===e)return;const t=parseInt(e,10);let n=e;return t.toString()!=e||isNaN(t)||(n=t),n};t.parseInputOutputTypes=e=>{const[,t,n]=e.match(/node\((.+)\|(.+)\)/)||[],o=(0,d.entries)(JSON.parse(t)).map((e=>{let[t,n]=e;const o={type:n,optional:(0,d.isOptionalType)(t)};return[t.replace(/\?$/,""),o]})),i=(0,d.entries)(JSON.parse(n)).map((e=>{let[t,n]=e;const o={type:n,optional:(0,d.isOptionalType)(t)};return[t.replace(/\?$/,""),o]}));return{inputs:(0,d.fromEntries)(o),outputs:(0,d.fromEntries)(i)}};t.createNewInlineNodeInstance=function(e,t,n){void 0===t&&(t=-1*u.NODE_HEIGHT*1.5);const o=(0,l.inlineNodeInstance)(`${e.id}-${(0,d.randomInt)(999)}`,e,{},{x:0,y:0}),i=(0,p.calcNodeWidth)(o,e),{x:s,y:r}=n,a={x:s-i/2,y:r+t};return{...o,pos:a}};t.createNewNodeInstance=function(e,t,n,o){void 0===t&&(t=-1*u.NODE_HEIGHT*1.5);const i="string"==typeof e?(0,h.safelyGetNodeDef)(e,o):e;if(!i)throw new Error(`${e} node not found in resolvedNodes`);const s=(0,d.entries)(i.inputs).reduce(((e,t)=>{let[n,o]=t;return o.defaultValue&&(e[n]=(0,l.staticInputPinConfig)(o.defaultValue)),e}),{}),r=(0,l.nodeInstance)((0,a.createId)(),i.id,s,{x:0,y:0}),c=(0,p.calcNodeWidth)(r,i),{x:f,y:m}=n,g={x:f-c/2,y:m+t};return{...r,pos:g}};t.roundNumber=e=>Math.round(100*e)/100;t.domToViewPort=(e,n,o)=>({x:(0,t.roundNumber)(n.pos.x+e.x/n.zoom/o.zoom),y:(0,t.roundNumber)(n.pos.y+e.y/n.zoom/o.zoom)});t.clamp=(e,t,n)=>Math.max(e,Math.min(t,n));t.distance=(e,t)=>{const n=t.x-e.x,o=t.y-e.y;return Math.sqrt(n*n+o*o)};t.center=(e,t,n)=>{let{zoom:o}=n;const i=e.x+e.w/2,s=e.y+e.h/2,{w:r,h:a}=t;return{x:i-r/o/2,y:s-a/o/2}};t.easeInOutQuad=e=>e<.5?2*e*e:(4-2*e)*e-1;t.easeInOutPos=(e,n,o,i,s)=>{const r=(0,t.clamp)(0,1,(s-o)/i),a=(0,t.easeInOutQuad)(r),u=n.x-e.x,l=n.y-e.y;return{x:e.x+u*a,y:e.y+l*a}};t.easeInOutNum=(e,n,o,i,s)=>{const r=(0,t.clamp)(0,1,(s-o)/i);return e+(n-e)*(0,t.easeInOutQuad)(r)};t.animateViewPort=(e,n,o,i)=>{const s=(0,t.distance)(e.pos,n.pos),r=Date.now(),a=o;if(0===s)return void i(e);const u=()=>{const o=Date.now(),s=(0,t.easeInOutPos)(e.pos,n.pos,r,a,o),l=(0,t.easeInOutNum)(e.zoom,n.zoom,r,a,o);o-r<a?(i({pos:s,zoom:l}),requestAnimationFrame(u)):i({pos:s,zoom:l})};requestAnimationFrame(u)};t.calcSelectionBoxArea=e=>{const n=(0,t.getSelectionBoxRect)(e.from,e.to);return n.h*n.w};const I=(e,t,n,o)=>({left:n.x,right:n.x+e,top:n.y,bottom:n.y+t,tag:o,center:(0,l.calcCenter)({w:e,h:t,...n})});t.calcNodesPositions=(e,t)=>[...e.instances.map((e=>{const n=(0,p.calcNodeWidth)(e,(0,h.safelyGetNodeDef)(e,t)),o=u.NODE_HEIGHT;return I(n,o,e.pos,e.id)})),...(0,d.okeys)(e.inputs).map((t=>{const n=(0,f.calcNodeIoWidth)(t),o=u.NODE_HEIGHT,i=e.inputsPosition[t]||{x:0,y:0};return I(n,o,i,"input_"+t)})),...(0,d.okeys)(e.outputs).map((t=>{const n=(0,f.calcNodeIoWidth)(t),o=u.NODE_HEIGHT,i=e.outputsPosition[t]||{x:0,y:0};return I(n,o,i,"output"+t)}))];t.getEffectiveNodeDimensions=(e,n)=>{const o=(0,t.calcNodesPositions)(e,n),i=o[0]||{left:0,right:0,top:0,bottom:0},s=o.reduce(((e,t)=>t.left<e?t.left:e),i.left),r=o.reduce(((e,t)=>t.right>e?t.right:e),i.right),a=o.reduce(((e,t)=>t.top<e?t.top:e),i.top),u=r-s,c=o.reduce(((e,t)=>t.bottom>e?t.bottom:e),i.bottom)-a,d={x:s,y:a};return{size:{width:u,height:c},pos:d,center:(0,l.calcCenter)({w:u,h:c,...d})}};t.logicalPosToRenderedPos=(e,t)=>{const n=(0,m.vSub)(e,t.pos);return(0,m.vMul)(n,t.zoom)};t.renderedPosToLogicalPos=(e,t)=>{const n=(0,m.vDiv)(e,t.zoom);return(0,m.vAdd)(t.pos,n)};t.centerBoardPosOnTarget=(e,n,o,i)=>{const s=(0,t.logicalPosToRenderedPos)(e,i),r=(0,t.renderedPosToLogicalPos)(s,{...i,zoom:o}),a=Math.max(e.x,r.x)-Math.min(e.x,r.x),u=Math.max(e.y,r.y)-Math.min(e.y,r.y);return{x:o>i.zoom?i.pos.x+a:i.pos.x-a,y:o>i.zoom?i.pos.y+u:i.pos.y-u}};t.fitViewPortToNode=function(e,n,o,i){void 0===i&&(i=[20,150]);const{size:s,center:r}=(0,t.getEffectiveNodeDimensions)(e,n),a=i[0],u=i[1],l=s.width+a,c=s.height+u,d=o.width/l,p=o.height/c,f=Math.min(d,p)/1.15,m=(0,t.clamp)(.3,1.2,f);return{zoom:m,pos:{x:r.x-o.width/2/m,y:r.y-o.height/2/m+40}}};t.getMiddleOfViewPort=(e,n)=>{const o={x:n.width/2,y:n.height/2};return(0,t.renderedPosToLogicalPos)(o,e)};t.isJsxValue=e=>{const t=e=>(0,d.isDefined)(e.ref)&&(0,d.isDefined)(e.type)&&(0,d.isDefined)(e.props);try{const n=JSON.parse(e);return t(n)||Array.isArray(n)&&t(n[0])}catch(n){return!1}};t.getInstancesInRect=(e,n,o,i,s,r,a)=>{const{from:c,to:d}=e,f=(0,t.getSelectionBoxRect)(c,d);return s.filter((e=>{const{pos:t}=e,i={...t,w:(0,p.calcNodeWidth)(e,(0,h.safelyGetNodeDef)(e,n))*o.zoom*a.zoom,h:u.NODE_HEIGHT*o.zoom*a.zoom};return console.log(e.id,i,"main",f),(0,l.intersectRect)(f,i)||(0,l.intersectRect)(i,f)})).map((e=>e.id))};t.handleInstanceDrag=(e,t,n,o,i,s)=>{o.preventDefault(),o.stopPropagation();const a=(0,m.vSub)(n,t.pos);let u;const l=r.produce(e,(e=>{const r=e.instances.find((e=>e.id===t.id));if(!r)throw new Error("impossible state dragging instance that does not exist");!o.shiftKey&&s&&(u=[s]);const l=e.instances.filter((e=>i.includes(e.id)&&e!==r)),c=[r,...l],d=(0,g.getLeafInstancesOfSelection)(c,e.instances,e.connections);[...l,...d].forEach((e=>{e.pos=(0,m.vAdd)(e.pos,a)})),r.pos=n,!o.shiftKey&&s&&(u=[s])}));return{newValue:l,newSelected:u}};t.handleIoPinRename=(e,t,n,o)=>r.produce(e,(e=>{"input"===t?(e.inputs[o]=e.inputs[n],e.inputsPosition[o]=e.inputsPosition[n],delete e.inputs[n],e.connections=e.connections.map((e=>(0,l.isExternalConnectionNode)(e.from)&&e.from.pinId===n?{...e,from:{...e.from,pinId:o}}:e))):(e.outputs[o]=e.outputs[n],e.outputsPosition[o]=e.outputsPosition[n],e.connections=e.connections.map((e=>(0,l.isExternalConnectionNode)(e.to)&&e.to.pinId===n?{...e,to:{...e.to,pinId:o}}:e)),e.completionOutputs=(e.completionOutputs||[]).map((e=>e.split("+").map((e=>e===n?o:n)).join("+"))),delete e.outputs[n])}));t.handleChangeNodeInputType=(e,t,n)=>r.produce(e,(e=>{const o=e.inputs[t];if(!o)throw new Error("Wat");o.mode=n}))},42403:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorClient=void 0;const i=n(74762),s=o(n(18706)),r=n(32048),a=n(31758),u=(0,i.debugLogger)("remote-debugger:editor-client");t.createEditorClient=(e,t)=>{const n=new URL(e),o=(0,r.io)(n.origin,{path:`${"/"===n.pathname?"":n.pathname}/socket.io/editor`,timeout:3e4});return o.emit("join-room-editor",t),{emitChange:e=>{o.emit(a.DebuggerServerEventType.CHANGE_EVENT_NAME,e)},emitBreakpointsChange:e=>{o.emit(a.DebuggerServerEventType.UPDATE_BREAKPOINTS,e)},interceptInput:e=>{o.emit(a.DebuggerServerEventType.INPUT_VALUE_OVERRIDE,e)},interceptOutput:e=>{o.emit(a.DebuggerServerEventType.OUTPUT_VALUE_OVERRIDE,e)},onRuntimeReady:e=>(o.on(a.DebuggerServerEventType.RUNTIME_READY,e),()=>o.off(a.DebuggerServerEventType.RUNTIME_READY,e)),onChangeAwk:e=>(o.on(a.DebuggerServerEventType.CHANGE_AWK,e),()=>o.off(a.DebuggerServerEventType.CHANGE_AWK,e)),onChangeError:e=>(o.on(a.DebuggerServerEventType.CHANGE_ERROR,e),()=>o.off(a.DebuggerServerEventType.CHANGE_ERROR,e)),onIsAlive:e=>(o.on(a.DebuggerServerEventType.IS_ALIVE,e),()=>o.off(a.DebuggerServerEventType.IS_ALIVE,e)),emitInputValue:(e,t)=>{u(`Emitting push input value to ${e} %o`,t),o.emit(a.DebuggerServerEventType.PUSH_INPUT_VALUE,{pinId:e,value:t})},destroy:()=>{o.disconnect(),(0,a.enumToArray)(a.DebuggerServerEventType).forEach((e=>o.off(e)))},onDisconnect:e=>(o.on("disconnect",e),()=>o.off("disconnect",e)),debugInfo:()=>`Remote debugger for ${e}`,onBatchedEvents:e=>(o.on(a.DebuggerServerEventType.EVENTS_BATCH,e),()=>o.off(a.DebuggerServerEventType.EVENTS_BATCH,e)),requestState:()=>s.default.get(`${e}/state`).then((e=>e.data.state)),getHistory:n=>s.default.get(`${e}/history`,{params:{insId:n.insId,pinId:n.pinId,limit:n.limit,executionId:t}}).then((e=>e.data)),clearHistory:()=>s.default.delete(`${e}/history`).then((()=>{})),triggerNode:(t,n)=>s.default.post(`${e}/trigger`,{nodeId:t,inputs:n}).then((e=>e.data))}}},58066:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeData=void 0;const o=n(74762),i=n(36783),s=(0,o.debugLogger)("remote-debugger:normalize-data");t.normalizeData=e=>{if(e instanceof Error)return(0,i.serializeError)(e);if("object"==typeof e&&null!==e){e={...e};const t=new WeakSet,n=e=>{if("bigint"==typeof e)return e.toString();if("object"!=typeof e||Array.isArray(e))return e;if(null===e)return e;if(t.has(e))return"[Circular]";try{t.add(e)}catch(o){s("Error adding to WeakSet","data:",e,"type:",typeof e,"error:",o)}if(Array.isArray(e))return e.map(n);if("object"==typeof e){const t={};for(const o in e)t[o]=n(e[o]);return t}return e};return n(e)}return e}},39641:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRuntimeClient=t.DEFAULT_DT_SCALE=void 0;const o=n(74762),i=n(32048),s=n(31758),r=n(58066),a=(0,o.debugLogger)("remote-debugger:runtime-client");t.DEFAULT_DT_SCALE=1;t.createRuntimeClient=(e,t)=>{const n=new URL(e),u=(0,i.io)(n.origin,{path:`${"/"===n.pathname?"":n.pathname}/socket.io/runtime`,timeout:1e3,reconnectionAttempts:3});u.emit("join-room-runtime",t),u.on("connection",(e=>{e.join(t)}));let l=new Set;u.on(s.DebuggerServerEventType.UPDATE_BREAKPOINTS,(e=>{l=new Set(e)}));const c=(0,o.cappedArrayDebounce)((e=>{a(`Emitting debounced batched events - ${e.length}`),u.emit(s.DebuggerServerEventType.EVENTS_BATCH,e)}),100,200);return{onChange:e=>(u.on(s.DebuggerServerEventType.CHANGE_EVENT_NAME,e),()=>u.off(s.DebuggerServerEventType.CHANGE_EVENT_NAME,e)),onInput:e=>(u.on(s.DebuggerServerEventType.PUSH_INPUT_VALUE,e),()=>u.off(s.DebuggerServerEventType.PUSH_INPUT_VALUE,e)),emitEvent:e=>{a(`Emitting event ${e.type} change event of ${e.insId}`),e.val=(0,r.normalizeData)(e.val),c.addItem({...e,time:Date.now()})},emitRuntimeReady:()=>{u.emit(s.DebuggerServerEventType.RUNTIME_READY,{})},emitChangeAwk:()=>{u.emit(s.DebuggerServerEventType.CHANGE_AWK,{})},emitChangeError:e=>{u.emit(s.DebuggerServerEventType.CHANGE_ERROR,{error:e})},emitIsAlive:e=>{u.emit(s.DebuggerServerEventType.IS_ALIVE,{time:e})},destroy:async()=>{c.pendingItems()&&(c.flush(),await(0,o.delay)(100)),(0,s.enumToArray)(s.DebuggerServerEventType).forEach((e=>u.off(e))),u.disconnect()},onDisconnect:e=>(u.on("disconnect",e),()=>u.off("disconnect",e)),waitForConnection:()=>new Promise(((e,t)=>{u.connected?e():(u.on("connect_error",(e=>{t(`Socket connect error: ${e}`)})),u.on("connect",(()=>{e()})))}))}}},31758:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebuggerServerEventType=t.enumToArray=t.isNumber=t.isSimpleType=t.valuePreview=t.toString=void 0;const o=n(36783);t.toString=e=>{if("object"===typeof e){if(e instanceof Error)return JSON.stringify((0,o.serializeError)(e));try{return JSON.stringify(e).substr(0,250)}catch(t){return"Object (cannot stringify)"}}return`${e}`.substr(0,250)};t.valuePreview=e=>(0,t.toString)(e).substr(0,100);t.isSimpleType=e=>["number","string","boolean"].includes(typeof e);t.isNumber=e=>!1===isNaN(Number(e)),t.enumToArray=function(e){return Object.keys(e).filter(t.isNumber).map((t=>e[t]))},function(e){e.RUNTIME_READY="runtime-ready",e.CHANGE_EVENT_NAME="change",e.PUSH_INPUT_VALUE="push-input-value",e.CHANGE_AWK="live-change-awk",e.CHANGE_ERROR="live-change-error",e.IS_ALIVE="is-alive",e.UPDATE_BREAKPOINTS="update-breakpoints",e.INPUT_VALUE_OVERRIDE="input-value-override",e.OUTPUT_VALUE_OVERRIDE="output-value-override",e.INPUT_VALUE_CHANGE="input-value-changed",e.OUTPUT_VALUE_CHANGE="output-value-changed",e.PROCESSING_CHANGE="processing-changed",e.INPUTS_STATE_CHANGE="inputs-state-changed",e.NODE_ERROR="node-error",e.EVENTS_BATCH="events-batch"}(t.DebuggerServerEventType||(t.DebuggerServerEventType={}))},96233:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(31758),t),i(n(42403),t),i(n(39641),t)},65645:(e,t,n)=>{"use strict";n.d(t,{Y:()=>f});var o=n(70079),i=n(11253),s=n(74089),r=n(74762),a=n(21766);var u=n(10831),l=n(61997);const c=(0,a.S)(),d=[0,0],p=e=>{let{flow:t,output:n,inputs:o,onError:s,debugDelay:a,dependencies:u,player:l}=e;const d=((e,t)=>{const n=new Set;return{onEvent:o=>{const i={...o,time:Date.now()};console.info("Got debugger event",o),t.addEvents([i]),e.addEvents([i]),n.forEach((e=>e([i])))},onBatchedEvents:e=>(n.add(e),()=>n.delete(e))}})(l,c);d.debugDelay=a;const p=(0,r.keys)(t.node.outputs)[0];return{executeResult:(0,r.execute)({node:t.node,inputs:o,outputs:{[p]:n},resolvedDeps:{...u,[t.node.id]:t.node},_debugger:d,onBubbleError:e=>{s(e)},extraContext:{PubSub:i}}),localDebugger:d}},f=e=>{const{debugDelay:t,onOutput:i,flowProps:a}=e,{flow:f,inputs:m,output:g}=a,v=(0,o.useRef)((0,s.createRuntimePlayer)()),[h,I]=(0,o.useState)(e.flowProps.dependencies),[y,b]=(0,o.useState)(),[C]=(0,s.useDebounce)(h,500),_=async(e,t)=>{const{node:o}=e,i=Object.values(await n.e(1381).then(n.t.bind(n,81381,23))).find((e=>(0,r.isBaseNode)(e)&&e.id===o.id));let a;I((e=>({...e,[i.id]:{...i,source:{path:"@flyde/stdlib/dist/all-browser",export:i.id}}})));const l=(0,u.ZP)(f,(n=>{if(t){const o=(0,s.vAdd)({x:0,y:0},t.pos);if(a=(0,s.createNewNodeInstance)(e.node,0,o,h),n.node.instances.push(a),t.connectTo){const{insId:e,outputId:o}=t.connectTo;n.node.connections.push({from:{insId:e,pinId:o},to:{insId:a.id,pinId:r.TRIGGER_PIN_ID}})}}}));await new Promise((e=>setTimeout(e,10)));const c=(0,u.ZP)(N,(e=>{e.flow=l,t?.selectAfterAdding&&a&&(e.boardData.selected=[a?.id])}));return j(c),(0,s.toastMsg)(`Node ${o.id} successfully imported from ${e.module}`),h},x=async()=>({importables:Object.values(await n.e(1381).then(n.t.bind(n,81381,23))).filter(r.isBaseNode).map((e=>({node:{...e,source:{path:"n/a",export:"n/a"}},module:"@flyde/stdlib"}))),errors:[]}),[N,j]=(0,o.useState)({flow:f,boardData:{viewPort:{pos:{x:0,y:0},zoom:1},lastMousePos:{x:0,y:0},selected:[]}});(0,o.useEffect)((()=>{j((e=>({...e,flow:f})))}),[f]),(0,o.useEffect)((()=>{I((e=>({...e,main:N.flow.node})))}),[N.flow.node]);const w={state:N,onChangeEditorState:j,hideTemplatingTips:!0,initialPadding:d,onExtractInlineNode:r.noop,disableScrolling:!0};(0,o.useEffect)((()=>{v.current.start()}),[]),(0,o.useEffect)((()=>{const{executeResult:n,localDebugger:o}=p({flow:N.flow,dependencies:h,output:g,inputs:m,onError:r.noop,debugDelay:t,player:v.current}),s=e.flowProps.output.subscribe((e=>i(e)));return b(o),()=>{n(),s.unsubscribe()}}),[t,C]);const P=(0,o.useMemo)((()=>({resolvedDependencies:h,onImportNode:_,onRequestImportables:x})),[]),O=(0,o.useMemo)((()=>({debuggerClient:y,onRequestHistory:c.requestHistory})),[y]);return console.log({resolvedDeps:h}),o.createElement(l.Z,null,(()=>o.createElement(s.DependenciesContextProvider,{value:P},o.createElement(s.DebuggerContextProvider,{value:O},o.createElement(s.FlowEditor,w)))))}},21766:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var o=n(74762);const i=200,s=()=>{const e=new Map,t=new Map;return{requestHistory:async(n,s,r)=>{const a="input"===r?o.DebuggerEventType.INPUT_CHANGE:o.DebuggerEventType.OUTPUT_CHANGE;if(console.log({insId:n,pinId:s,type:a}),s){const t=`${n}.${s}.${a}`,o=e.get(t)||{total:0,lastSamples:[]},r=o.lastSamples.slice(0,i);return{...o,lastSamples:r}}{const e=t.get(n)||{total:0,lastSamples:[]},o=e.lastSamples.slice(0,i);return{...e,lastSamples:o}}},addEvents:n=>{n.forEach((n=>{if(n.type===o.DebuggerEventType.ERROR){const e=n;e.type=o.DebuggerEventType.OUTPUT_CHANGE,e.pinId=o.ERROR_PIN_ID}if(n.type===o.DebuggerEventType.INPUT_CHANGE||n.type===o.DebuggerEventType.OUTPUT_CHANGE){const{insId:o,type:s,pinId:r}=n;{const t=`${o}.${r}.${s}`,a=e.get(t)||{total:0,lastSamples:[]};a.lastSamples.unshift(n),a.lastSamples.length>i&&a.lastSamples.splice(i,a.lastSamples.length-i),a.total++,e.set(t,a)}{const s=t.get(o)||{total:0,lastSamples:[]};s.lastSamples.unshift(n),s.lastSamples.length>i&&s.lastSamples.splice(i,s.lastSamples.length-i),s.total++,e.set(o,s)}}}))}}}},4144:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});var o=n(10328),i=n(70079);const s=e=>i.createElement("li",{className:"log-item"},i.createElement("main",{className:"content"},e.value),i.createElement("aside",null,new Date(e.time).toLocaleTimeString())),r=e=>{const[t,n]=i.useState([]);return i.useEffect((()=>{e.output.subscribe((e=>{const t="object"==typeof e&&i.isValidElement(e)?e:`${e}`;n((e=>[...e,{value:t,time:Date.now()}]))}))}),[]),i.createElement("div",{className:"output-log"},i.createElement("header",null,"Output Log"," ",i.createElement("button",{className:"clear-btn button button--outline button--secondary button--sm",onClick:()=>n([])},"Clear")),i.createElement("main",null,i.createElement("ul",null,t.map(((e,t)=>i.createElement(s,(0,o.Z)({},e,{key:t}))))),0===t.length?i.createElement("div",{className:"empty-state"},"Nothing to show. Interact with the example to emit some outputs!"):null))}},79256:(e,t,n)=>{"use strict";n.d(t,{I:()=>p});var o=n(70079),i=(n(11253),n(65092)),s=n(19841),r=n(49794),a=(n(74762),n(21766)),u=n(73949),l=n(81098),c=n(65645);(0,a.S)();const d=[{title:"Hello World",key:"hello-world"},{title:"React Counter",key:"react-counter"},{title:"BMI Calculator",key:"bmi"},{title:"REST API Usage",key:"apis"},{title:"Debounce vs. Throttling",key:"debounce-throttling"},{title:"Fibonacci Seq.",key:"fibonacci"}],p=e=>{const[t,n]=(0,o.useState)(e.initWidth||500),[a,p]=(0,o.useState)(e.defaultDelay||0),[f,m]=(0,o.useState)(!1),g=(0,o.useCallback)(((e,t)=>{let{size:o}=t;n(o.width)}),[]),v=o.createElement("div",{className:"delay-container"},o.createElement("input",{type:"range",id:"volume",name:"delay",value:a,step:"100",min:"0",max:"300",onChange:e=>p(Number(e.target.value))}),o.createElement("label",{htmlFor:"volume"},"Debug Delay: ",a,"ms")),h=d.findIndex((t=>t.key===e.meta.key)),I=d[h+1],y=d[h-1];return o.createElement(i.Z,{title:`${e.meta.title} | Playground`,description:`Flyde Playground - ${e.meta.title} example`},o.createElement("header",{className:(0,s.default)("hero hero--primary",u.Z.heroBanner,"playground-hero")},o.createElement("div",{className:"container"},o.createElement("h1",{className:"hero__title"},"Welcome to Flyde's Online Playground"),o.createElement("p",{className:"hero__subtitle"},"Choose one of the examples below to get started. Feel free to play around with the canvas and see how your changes affect the result!"))),o.createElement("div",{className:"mobile-warning"},"Flyde is currently not optimized for mobile devices. Please"," ",o.createElement("strong",null,"use a desktop computer for the best experience"),"."),o.createElement("ul",{className:"examples__menu"},d.map((e=>o.createElement("li",{key:e.key},o.createElement(r.Z,{to:`/playground/${e.key}`,className:"button button--primary"},e.title))))),o.createElement("div",{className:"playground-container"},o.createElement("header",null,o.createElement("h2",{className:"playground-title"},e.meta.title),o.createElement("div",{className:"playground-description"},e.meta.description),f?o.createElement(o.Fragment,null,o.createElement("hr",null),o.createElement("div",{className:"playground-extra"},e.extraInfo||e.meta.extraInfo,o.createElement("div",{className:"star-hint"},o.createElement("span",null,"\xa0 PS: Did you like this example?"),"Please consider giving a \u2b50\ufe0f to the project"," ",o.createElement("span",{className:"star-wrapper"},o.createElement("iframe",{className:"gh-stars-frame",src:"https://ghbtns.com/github-btn.html?user=flydehq&repo=flyde&type=star&count=true&size=small",width:100,height:20,title:"GitHub Stars"}))))):null,e.prefixComponent),o.createElement("div",{className:"playground"},o.createElement("div",{className:"flow-container"},!0!==e.hideDelay?v:null,o.createElement(c.Y,{flowProps:e.flowProps,debugDelay:a,onOutput:()=>m(!0)})),o.createElement(l.Resizable,{height:0,width:t,onResize:g,axis:"x",handle:o.createElement("div",{className:"handle"}),resizeHandles:["w"]},o.createElement("div",{className:"output-container",style:{flexBasis:t}},e.children))),o.createElement("nav",{className:"pagination-nav"},o.createElement("div",{className:"pagination-nav__item"},y?o.createElement("a",{className:"pagination-nav__link",href:`/playground/${y.key}`},o.createElement("div",{className:"pagination-nav__sublabel"},"Previous Example"),o.createElement("div",{className:"pagination-nav__label"},y.title)):null),o.createElement("div",{className:"pagination-nav__item pagination-nav__item--next"},I?o.createElement("a",{className:"pagination-nav__link",href:`/playground/${I.key}`},o.createElement("div",{className:"pagination-nav__sublabel"},"Next Example"),o.createElement("div",{className:"pagination-nav__label"},I.title)):null))))}},26641:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(70079),i=n(74762),s=n(79256);const r={dependencies:[],flow:{imports:{"@flyde/stdlib":["IsGreater"]},node:{instances:[{pos:{x:-339.8445458984375,y:-298.6939727783203},id:"clal8c6ws00054664pn7mxwak",inputConfig:{},node:{id:"Inline-value-prompt(What is",inputs:{},outputs:{value:{type:"any",delayed:!1,optional:!1}},runFnRawCode:"const result = (prompt('What is your weight (in kilograms)?')); Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"prompt('What is your weight (in kilograms)?')",dataBuilderSource:"cHJvbXB0KCdXaGF0IGlzIHlvdXIgd2VpZ2h0IChpbiBraWxvZ3JhbXMpPycp",templateType:"value",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}}},{pos:{x:97.43304077148437,y:-298.35113525390625},id:"clal8cm19000b4664u3iz2pbb",inputConfig:{},node:{id:"Inline-value-prompt(What is",inputs:{},outputs:{value:{type:"any",delayed:!1,optional:!1}},runFnRawCode:"const result = (prompt('What is your height (in cm)?')); Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"prompt('What is your height (in cm)?')",dataBuilderSource:"cHJvbXB0KCdXaGF0IGlzIHlvdXIgaGVpZ2h0IChpbiBjbSk/Jyk=",templateType:"value",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}}},{pos:{x:-140.88708862304688,y:-123.31595092773438},id:"clal8dus5000j4664s9pwujgy",inputConfig:{},node:{id:"Inline-value-(inputs.weight ",inputs:{weight:{type:"any",mode:"required"},height:{type:"any",mode:"required"}},outputs:{value:{type:"any",delayed:!1,optional:!1}},runFnRawCode:"const result = ((inputs.weight / inputs.height**2)  * 10000); Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"(inputs.weight / inputs.height**2)  * 10000",dataBuilderSource:"KGlucHV0cy53ZWlnaHQgLyBpbnB1dHMuaGVpZ2h0KioyKSAgKiAxMDAwMA==",templateType:"value",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}}},{pos:{x:-122.89145629882813,y:6.26922607421875},id:"clal91glf00024664mfh47zbj",inputConfig:{},node:{id:"Inline-value-let range;\nif (",inputs:{bmi:{type:"any",mode:"required"}},outputs:{value:{type:"any",delayed:!1,optional:!1}},runFnRawCode:"const result = (function() { let range;\nif (inputs.bmi < 18.5) \n    range = 'overweight'\nelse if (inputs.bmi < 25) {\n    range = 'normal';\n} else if (inputs.bmi < 30) {\n    range = 'overweight';\n} else {\n    range = 'obese';\n}\n\nreturn `You are in the ${range} range`}());\n  Promise.resolve(result).then(val => outputs.value.next(val))",customViewCode:"let range;\nif (inputs.bmi < 18.5) \n    range = 'overweight'\nelse if (inputs.bmi < 25) {\n    range = ",dataBuilderSource:"bGV0IHJhbmdlOwppZiAoaW5wdXRzLmJtaSA8IDE4LjUpIAogICAgcmFuZ2UgPSAnb3ZlcndlaWdodCcKZWxzZSBpZiAoaW5wdXRzLmJtaSA8IDI1KSB7CiAgICByYW5nZSA9ICdub3JtYWwnOwp9IGVsc2UgaWYgKGlucHV0cy5ibWkgPCAzMCkgewogICAgcmFuZ2UgPSAnb3ZlcndlaWdodCc7Cn0gZWxzZSB7CiAgICByYW5nZSA9ICdvYmVzZSc7Cn0KCnJldHVybiBgWW91IGFyZSBpbiB0aGUgJHtyYW5nZX0gcmFuZ2Vg",templateType:"function",completionOutputs:["value"],defaultStyle:{size:"regular",icon:"code",cssOverride:{fontFamily:"monospace",fontWeight:"500"}}}}],connections:[{from:{insId:"clal8c6ws00054664pn7mxwak",pinId:"value"},to:{insId:"clal8dus5000j4664s9pwujgy",pinId:"weight"}},{from:{insId:"clal8cm19000b4664u3iz2pbb",pinId:"value"},to:{insId:"clal8dus5000j4664s9pwujgy",pinId:"height"}},{from:{insId:"clal8dus5000j4664s9pwujgy",pinId:"value"},to:{insId:"clal91glf00024664mfh47zbj",pinId:"bmi"}},{from:{insId:"clal91glf00024664mfh47zbj",pinId:"value"},to:{insId:"__this",pinId:"rename"}}],id:"BMI",inputs:{},outputs:{rename:{type:"any",optional:!1,delayed:!1}},inputsPosition:{},outputsPosition:{result:{x:24.354419059198683,y:165.7657006221402},r:{x:24.354419059198683,y:165.7657006221402},rename:{x:33.925163537262904,y:163.67737650172523}},completionOutputs:["rename"]}}};var a=n(4144);const u={title:"BMI Calculator",description:"Simple BMI calculator with a decision tree. There are many things that make sense done visually, and even more that don't. This example showcases Flyde's support for inline code. The BMI calculation uses a simple inline formula, and the final string uses a textual switch case. Flyde exposes dynamic arguments to your inline code automatically if you use the special \"inputs.\" object!",key:"bmi"},l="Try adding another prompt and another input to the formula!";function c(){const e=(0,o.useRef)((0,i.dynamicOutput)()),t=(0,o.useRef)({__trigger:(0,i.dynamicNodeInput)()}),[n,c]=(0,o.useState)({flow:r.flow,dependencies:r.dependencies,inputs:t.current,output:e.current}),d=o.createElement("button",{className:"button button--success ",onClick:()=>t.current.__trigger.subject.next("run")},"Run!");return o.createElement(s.I,{meta:u,flowProps:n,prefixComponent:d,initWidth:300,extraInfo:l,defaultDelay:500},o.createElement(a.V,{output:e.current}))}},73949:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={"flyde-flow-editor":"flyde-flow-editor_AAD4",_hj_feedback_container:"_hj_feedback_container_Af03"}},85721:(e,t,n)=>{var o={"./af":47654,"./af.js":47654,"./ar":61325,"./ar-dz":98344,"./ar-dz.js":98344,"./ar-kw":26230,"./ar-kw.js":26230,"./ar-ly":42524,"./ar-ly.js":42524,"./ar-ma":44119,"./ar-ma.js":44119,"./ar-sa":82625,"./ar-sa.js":82625,"./ar-tn":42182,"./ar-tn.js":42182,"./ar.js":61325,"./az":37093,"./az.js":37093,"./be":32721,"./be.js":32721,"./bg":59919,"./bg.js":59919,"./bm":95594,"./bm.js":95594,"./bn":563,"./bn-bd":41757,"./bn-bd.js":41757,"./bn.js":563,"./bo":73211,"./bo.js":73211,"./br":87438,"./br.js":87438,"./bs":83662,"./bs.js":83662,"./ca":61196,"./ca.js":61196,"./cs":5841,"./cs.js":5841,"./cv":85251,"./cv.js":85251,"./cy":24512,"./cy.js":24512,"./da":37539,"./da.js":37539,"./de":5059,"./de-at":53853,"./de-at.js":53853,"./de-ch":99378,"./de-ch.js":99378,"./de.js":5059,"./dv":91454,"./dv.js":91454,"./el":39651,"./el.js":39651,"./en-au":87953,"./en-au.js":87953,"./en-ca":98193,"./en-ca.js":98193,"./en-gb":61980,"./en-gb.js":61980,"./en-ie":14050,"./en-ie.js":14050,"./en-il":6502,"./en-il.js":6502,"./en-in":555,"./en-in.js":555,"./en-nz":11372,"./en-nz.js":11372,"./en-sg":26568,"./en-sg.js":26568,"./eo":69533,"./eo.js":69533,"./es":68327,"./es-do":17620,"./es-do.js":17620,"./es-mx":96467,"./es-mx.js":96467,"./es-us":83272,"./es-us.js":83272,"./es.js":68327,"./et":68523,"./et.js":68523,"./eu":19066,"./eu.js":19066,"./fa":59087,"./fa.js":59087,"./fi":96443,"./fi.js":96443,"./fil":93979,"./fil.js":93979,"./fo":90383,"./fo.js":90383,"./fr":56327,"./fr-ca":25610,"./fr-ca.js":25610,"./fr-ch":97274,"./fr-ch.js":97274,"./fr.js":56327,"./fy":67442,"./fy.js":67442,"./ga":44291,"./ga.js":44291,"./gd":77342,"./gd.js":77342,"./gl":96248,"./gl.js":96248,"./gom-deva":21404,"./gom-deva.js":21404,"./gom-latn":20833,"./gom-latn.js":20833,"./gu":9122,"./gu.js":9122,"./he":74623,"./he.js":74623,"./hi":60364,"./hi.js":60364,"./hr":30860,"./hr.js":30860,"./hu":70441,"./hu.js":70441,"./hy-am":90425,"./hy-am.js":90425,"./id":29672,"./id.js":29672,"./is":96150,"./is.js":96150,"./it":27852,"./it-ch":55603,"./it-ch.js":55603,"./it.js":27852,"./ja":16465,"./ja.js":16465,"./jv":20120,"./jv.js":20120,"./ka":87245,"./ka.js":87245,"./kk":21479,"./kk.js":21479,"./km":65038,"./km.js":65038,"./kn":63060,"./kn.js":63060,"./ko":85020,"./ko.js":85020,"./ku":90582,"./ku.js":90582,"./ky":34950,"./ky.js":34950,"./lb":94201,"./lb.js":94201,"./lo":87894,"./lo.js":87894,"./lt":70120,"./lt.js":70120,"./lv":4265,"./lv.js":4265,"./me":14030,"./me.js":14030,"./mi":9463,"./mi.js":9463,"./mk":25898,"./mk.js":25898,"./ml":64233,"./ml.js":64233,"./mn":47156,"./mn.js":47156,"./mr":34479,"./mr.js":34479,"./ms":24691,"./ms-my":6456,"./ms-my.js":6456,"./ms.js":24691,"./mt":81789,"./mt.js":81789,"./my":37452,"./my.js":37452,"./nb":91170,"./nb.js":91170,"./ne":87529,"./ne.js":87529,"./nl":81776,"./nl-be":24455,"./nl-be.js":24455,"./nl.js":81776,"./nn":34705,"./nn.js":34705,"./oc-lnc":36139,"./oc-lnc.js":36139,"./pa-in":17960,"./pa-in.js":17960,"./pl":1899,"./pl.js":1899,"./pt":31670,"./pt-br":29159,"./pt-br.js":29159,"./pt.js":31670,"./ro":55115,"./ro.js":55115,"./ru":45149,"./ru.js":45149,"./sd":81231,"./sd.js":81231,"./se":35397,"./se.js":35397,"./si":99786,"./si.js":99786,"./sk":39383,"./sk.js":39383,"./sl":68691,"./sl.js":68691,"./sq":34826,"./sq.js":34826,"./sr":40080,"./sr-cyrl":75673,"./sr-cyrl.js":75673,"./sr.js":40080,"./ss":54309,"./ss.js":54309,"./sv":52245,"./sv.js":52245,"./sw":8967,"./sw.js":8967,"./ta":10454,"./ta.js":10454,"./te":35204,"./te.js":35204,"./tet":81571,"./tet.js":81571,"./tg":15737,"./tg.js":15737,"./th":41786,"./th.js":41786,"./tk":50511,"./tk.js":50511,"./tl-ph":14828,"./tl-ph.js":14828,"./tlh":62422,"./tlh.js":62422,"./tr":97047,"./tr.js":97047,"./tzl":90792,"./tzl.js":90792,"./tzm":67730,"./tzm-latn":59963,"./tzm-latn.js":59963,"./tzm.js":67730,"./ug-cn":42535,"./ug-cn.js":42535,"./uk":33151,"./uk.js":33151,"./ur":22750,"./ur.js":22750,"./uz":61914,"./uz-latn":60231,"./uz-latn.js":60231,"./uz.js":61914,"./vi":55517,"./vi.js":55517,"./x-pseudo":64078,"./x-pseudo.js":64078,"./yo":70046,"./yo.js":70046,"./zh-cn":81832,"./zh-cn.js":81832,"./zh-hk":90953,"./zh-hk.js":90953,"./zh-mo":38236,"./zh-mo.js":38236,"./zh-tw":71001,"./zh-tw.js":71001};function i(e){var t=s(e);return n(t)}function s(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}i.keys=function(){return Object.keys(o)},i.resolve=s,e.exports=i,i.id=85721}}]);