export const macroBundlesContent = {"CodeExpression":"LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkidXNlIHN0cmljdCI7Ci8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi9zcmMvVmFsdWVzL0NvZGVFeHByZXNzaW9uLnRzeCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvVmFsdWVzL0NvZGVFeHByZXNzaW9uLnRzeCAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59KTtcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5jb25zdCBjb3JlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAYmx1ZXByaW50anMvY29yZSAqLyBcIkBibHVlcHJpbnRqcy9jb3JlXCIpO1xuY29uc3QgcmVhY3RfMSA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdCAqLyBcInJlYWN0XCIpKTtcbmNvbnN0IGdldElubGluZVZhcmlhYmxlc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9nZXRJbmxpbmVWYXJpYWJsZXMgKi8gXCIuL3NyYy9WYWx1ZXMvZ2V0SW5saW5lVmFyaWFibGVzLnRzXCIpO1xuY29uc3QgQ29kZUV4cHJlc3Npb25FZGl0b3IgPSBmdW5jdGlvbiBDb2RlRXhwcmVzc2lvbkVkaXRvcihwcm9wcykge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCB7IHZhbHVlLCBvbkNoYW5nZSB9ID0gcHJvcHM7XG4gICAgY29uc3QgY2hhbmdlVmFsdWUgPSAoMCwgcmVhY3RfMS51c2VDYWxsYmFjaykoKF92YWwpID0+IHtcbiAgICAgICAgb25DaGFuZ2UoeyAuLi52YWx1ZSwgdmFsdWU6IF92YWwgfSk7XG4gICAgfSwgW3ZhbHVlLCBvbkNoYW5nZV0pO1xuICAgIGNvbnN0IHZhcnMgPSAoMCwgZ2V0SW5saW5lVmFyaWFibGVzXzEuZ2V0VmFyaWFibGVzKSgoX2EgPSB2YWx1ZS52YWx1ZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogXCJcIik7XG4gICAgcmV0dXJuIChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcImRpdlwiLCBudWxsLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGhlbHBlclRleHQ6IGBBY2NlcHRzIGFueSB2YWxpZCBKUyBjb2RlIHRoYXQgcmV0dXJucyBhbiBleHByZXNzaW9uYCB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLlRleHRBcmVhLCB7IHZhbHVlOiB2YWx1ZS52YWx1ZSwgZmlsbDogdHJ1ZSwgb25DaGFuZ2U6IChlKSA9PiBjaGFuZ2VWYWx1ZShlLnRhcmdldC52YWx1ZSkgfSkpLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcImRpdlwiLCBudWxsLCB2YXJzLmxlbmd0aCA+IDAgPyAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJzbWFsbFwiLCBudWxsLFxuICAgICAgICAgICAgXCJFeHRlcm5hbCBpbnB1dHMgZXhwb3NlZCBmcm9tIHRoaXMgZXhwcmVzc2lvbjpcIixcbiAgICAgICAgICAgIFwiIFwiLFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJlbVwiLCBudWxsLCB2YXJzLmpvaW4oXCIsIFwiKSkpKSA6IChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcInNtYWxsXCIsIG51bGwsIFwiRXhwb3NlIGV4dGVybmFsIGlucHV0cyBieSB1c2luZyB0aGUgXFxcImlucHV0c1xcXCIgb2JqZWN0LiBGb3IgZXhhbXBsZSwgXFxcImlucHV0cy5hICsgaW5wdXRzLmJcXFwiIHdpbGwgZXhwb3NlIDIgaW5wdXRzLCBhIGFuZCBiLCBhbmQgc3VtIHRoZW0uXCIpKSkpKTtcbn07XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IENvZGVFeHByZXNzaW9uRWRpdG9yO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL19fTWFjcm9Ob2RlX19Db2RlRXhwcmVzc2lvbi8uL3NyYy9WYWx1ZXMvQ29kZUV4cHJlc3Npb24udHN4PyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi9zcmMvVmFsdWVzL2dldElubGluZVZhcmlhYmxlcy50cyI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvVmFsdWVzL2dldElubGluZVZhcmlhYmxlcy50cyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cykgPT4gewoKZXZhbCgiXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsICh7IHZhbHVlOiB0cnVlIH0pKTtcbmV4cG9ydHMuZ2V0VmFyaWFibGVzID0gdm9pZCAwO1xuY29uc3QgZ2V0VmFyaWFibGVzID0gKGNvZGUpID0+IHtcbiAgICByZXR1cm4gKGNvZGUubWF0Y2goL2lucHV0c1xcLihbYS16QS1aXVxcdyopL2cpIHx8IFtdKS5tYXAoKHYpID0+IHYucmVwbGFjZSgvaW5wdXRzXFwuLywgXCJcIikpO1xufTtcbmV4cG9ydHMuZ2V0VmFyaWFibGVzID0gZ2V0VmFyaWFibGVzO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL19fTWFjcm9Ob2RlX19Db2RlRXhwcmVzc2lvbi8uL3NyYy9WYWx1ZXMvZ2V0SW5saW5lVmFyaWFibGVzLnRzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiQGJsdWVwcmludGpzL2NvcmUiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiBleHRlcm5hbCAiQmx1ZXByaW50IiAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgobW9kdWxlKSA9PiB7Cgptb2R1bGUuZXhwb3J0cyA9IHdpbmRvd1siQmx1ZXByaW50Il07CgovKioqLyB9KSwKCi8qKiovICJyZWFjdCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogZXh0ZXJuYWwgIlJlYWN0IiAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChtb2R1bGUpID0+IHsKCm1vZHVsZS5leHBvcnRzID0gd2luZG93WyJSZWFjdCJdOwoKLyoqKi8gfSkKCi8qKioqKiovIAl9KTsKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCXZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTsKLyoqKioqKi8gCQovKioqKioqLyAJLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb24KLyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQl2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTsKLyoqKioqKi8gCQlpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHsKLyoqKioqKi8gCQkJcmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzOwovKioqKioqLyAJCX0KLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0gewovKioqKioqLyAJCQkvLyBubyBtb2R1bGUuaWQgbmVlZGVkCi8qKioqKiovIAkJCS8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkCi8qKioqKiovIAkJCWV4cG9ydHM6IHt9Ci8qKioqKiovIAkJfTsKLyoqKioqKi8gCQovKioqKioqLyAJCS8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbgovKioqKioqLyAJCV9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pOwovKioqKioqLyAJCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9Ci8qKioqKiovIAkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gCQovKioqKioqLyAJLy8gc3RhcnR1cAovKioqKioqLyAJLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzCi8qKioqKiovIAkvLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZAovKioqKioqLyAJdmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIuL3NyYy9WYWx1ZXMvQ29kZUV4cHJlc3Npb24udHN4Iik7Ci8qKioqKiovIAl3aW5kb3cuX19NYWNyb05vZGVfX0NvZGVFeHByZXNzaW9uID0gX193ZWJwYWNrX2V4cG9ydHNfXzsKLyoqKioqKi8gCQovKioqKioqLyB9KSgpCjs=","Collect":"LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkidXNlIHN0cmljdCI7Ci8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi9zcmMvTGlzdHMvQ29sbGVjdC9Db2xsZWN0LnRzeCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvTGlzdHMvQ29sbGVjdC9Db2xsZWN0LnRzeCAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuY29uc3QgY29yZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQGJsdWVwcmludGpzL2NvcmUgKi8gXCJAYmx1ZXByaW50anMvY29yZVwiKTtcbmNvbnN0IHJlYWN0XzEgPSBfX2ltcG9ydERlZmF1bHQoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCJyZWFjdFwiKSk7XG5jb25zdCBDb25maWd1cmFibGVJbnB1dEVkaXRvcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vLi4vbGliL0NvbmZpZ3VyYWJsZUlucHV0RWRpdG9yICovIFwiLi9zcmMvbGliL0NvbmZpZ3VyYWJsZUlucHV0RWRpdG9yLnRzeFwiKTtcbmNvbnN0IGRlZmF1bHRWYWx1ZVBlclN0cmF0ZWd5ID0ge1xuICAgIGNvdW50OiB7XG4gICAgICAgIHN0cmF0ZWd5OiBcImNvdW50XCIsXG4gICAgICAgIGNvdW50OiB7IG1vZGU6IFwic3RhdGljXCIsIHZhbHVlOiAyIH0sXG4gICAgfSxcbiAgICB0aW1lOiB7XG4gICAgICAgIHN0cmF0ZWd5OiBcInRpbWVcIixcbiAgICAgICAgdGltZTogeyBtb2RlOiBcInN0YXRpY1wiLCB2YWx1ZTogMjAwMCB9LFxuICAgIH0sXG4gICAgdHJpZ2dlcjoge1xuICAgICAgICBzdHJhdGVneTogXCJ0cmlnZ2VyXCIsXG4gICAgfSxcbn07XG5jb25zdCBDb2xsZWN0RWRpdG9yID0gZnVuY3Rpb24gQ29sbGVjdEVkaXRvcih7IHZhbHVlLCBvbkNoYW5nZSwgfSkge1xuICAgIGNvbnN0IGhhbmRsZVN0cmF0ZWd5Q2hhbmdlID0gcmVhY3RfMS5kZWZhdWx0LnVzZUNhbGxiYWNrKChlKSA9PiB7XG4gICAgICAgIGNvbnN0IHN0cmF0ZWd5ID0gZS5jdXJyZW50VGFyZ2V0LnZhbHVlO1xuICAgICAgICBjb25zdCBkZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWVQZXJTdHJhdGVneVtzdHJhdGVneV07XG4gICAgICAgIG9uQ2hhbmdlKGRlZmF1bHRWYWx1ZSk7XG4gICAgfSwgW29uQ2hhbmdlLCB2YWx1ZV0pO1xuICAgIGNvbnN0IGlubmVyRWRpdG9yID0gcmVhY3RfMS5kZWZhdWx0LnVzZU1lbW8oKCkgPT4ge1xuICAgICAgICBzd2l0Y2ggKHZhbHVlLnN0cmF0ZWd5KSB7XG4gICAgICAgICAgICBjYXNlIFwiY291bnRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KENvbmZpZ3VyYWJsZUlucHV0RWRpdG9yXzEuQ29uZmlndXJhYmxlSW5wdXRFZGl0b3IsIHsgdmFsdWU6IHZhbHVlLmNvdW50LCBvbkNoYW5nZTogKGNvdW50KSA9PiBvbkNoYW5nZSh7IC4uLnZhbHVlLCBjb3VudCB9KSwgdmFsdWVSZW5kZXJlcjogKHByb3BzKSA9PiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJDb3VudDpcIiwgaW5saW5lOiB0cnVlIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuTnVtZXJpY0lucHV0LCB7IHZhbHVlOiBwcm9wcy52YWx1ZSwgb25WYWx1ZUNoYW5nZTogKGUpID0+IG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50OiB7IG1vZGU6IFwic3RhdGljXCIsIHZhbHVlOiBlIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSkpKSwgbW9kZUxhYmVsOiBcIkNvdW50IG1vZGU6XCIsIGRlZmF1bHRTdGF0aWNWYWx1ZTogMiB9KSk7XG4gICAgICAgICAgICBjYXNlIFwidGltZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29uZmlndXJhYmxlSW5wdXRFZGl0b3JfMS5Db25maWd1cmFibGVJbnB1dEVkaXRvciwgeyB2YWx1ZTogdmFsdWUudGltZSwgb25DaGFuZ2U6ICh0aW1lKSA9PiBvbkNoYW5nZSh7IC4uLnZhbHVlLCB0aW1lIH0pLCB2YWx1ZVJlbmRlcmVyOiAocHJvcHMpID0+IChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIlRpbWU6XCIsIGlubGluZTogdHJ1ZSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLk51bWVyaWNJbnB1dCwgeyB2YWx1ZTogcHJvcHMudmFsdWUsIG9uVmFsdWVDaGFuZ2U6IChlKSA9PiBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lOiB7IG1vZGU6IFwic3RhdGljXCIsIHZhbHVlOiBlIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSkpKSwgbW9kZUxhYmVsOiBcIlRpbWUgbW9kZTpcIiwgZGVmYXVsdFN0YXRpY1ZhbHVlOiAyMDAwIH0pKTtcbiAgICAgICAgfVxuICAgIH0sIFt2YWx1ZSwgb25DaGFuZ2VdKTtcbiAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KHJlYWN0XzEuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLlJhZGlvR3JvdXAsIHsgbGFiZWw6IFwiQ29sbGVjdGlvbiBzdHJhdGVneTpcIiwgb25DaGFuZ2U6IGhhbmRsZVN0cmF0ZWd5Q2hhbmdlLCBzZWxlY3RlZFZhbHVlOiB2YWx1ZS5zdHJhdGVneSwgaW5saW5lOiB0cnVlIH0sXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuUmFkaW8sIHsgbGFiZWw6IFwiQ291bnRcIiwgdmFsdWU6IFwiY291bnRcIiB9KSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5SYWRpbywgeyBsYWJlbDogXCJUaW1lXCIsIHZhbHVlOiBcInRpbWVcIiB9KSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5SYWRpbywgeyBsYWJlbDogXCJEeW5hbWljXCIsIHZhbHVlOiBcInRyaWdnZXJcIiB9KSksXG4gICAgICAgIGlubmVyRWRpdG9yKSk7XG59O1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBDb2xsZWN0RWRpdG9yO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL19fTWFjcm9Ob2RlX19Db2xsZWN0Ly4vc3JjL0xpc3RzL0NvbGxlY3QvQ29sbGVjdC50c3g/Iik7CgovKioqLyB9KSwKCi8qKiovICIuL3NyYy9saWIvQ29uZmlndXJhYmxlSW5wdXRFZGl0b3IudHN4IjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuL3NyYy9saWIvQ29uZmlndXJhYmxlSW5wdXRFZGl0b3IudHN4ICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoZnVuY3Rpb24oX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV2YWwoIlxudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLmNyZWF0ZUNvbmZpZ3VyYWJsZUlucHV0RWRpdG9yID0gZXhwb3J0cy5Db25maWd1cmFibGVJbnB1dEVkaXRvciA9IHZvaWQgMDtcbmNvbnN0IGNvcmVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIEBibHVlcHJpbnRqcy9jb3JlICovIFwiQGJsdWVwcmludGpzL2NvcmVcIik7XG5jb25zdCByZWFjdF8xID0gX19pbXBvcnREZWZhdWx0KF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0ICovIFwicmVhY3RcIikpO1xuY29uc3QgQ29uZmlndXJhYmxlSW5wdXRFZGl0b3IgPSBmdW5jdGlvbiAoeyB2YWx1ZSwgb25DaGFuZ2UsIHZhbHVlUmVuZGVyZXI6IFZhbHVlUmVuZGVyZXIsIGRlZmF1bHRTdGF0aWNWYWx1ZSwgbW9kZUxhYmVsLCB9KSB7XG4gICAgY29uc3QgaGFuZGxlTW9kZUNoYW5nZSA9IChlKSA9PiB7XG4gICAgICAgIG9uQ2hhbmdlKHtcbiAgICAgICAgICAgIG1vZGU6IGUuY3VycmVudFRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBlLmN1cnJlbnRUYXJnZXQudmFsdWUgPT09IFwic3RhdGljXCIgPyBkZWZhdWx0U3RhdGljVmFsdWUgOiB1bmRlZmluZWQsXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY29uc3QgaGFuZGxlVmFsdWVDaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgICAgb25DaGFuZ2Uoe1xuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICBtb2RlOiBcInN0YXRpY1wiLFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgICBjb25zdCBNZW1vVmFsdWVSZW5kZXJlciA9IHJlYWN0XzEuZGVmYXVsdC51c2VNZW1vKCgpID0+IFZhbHVlUmVuZGVyZXIsIFtdKTtcbiAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KHJlYWN0XzEuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLlJhZGlvR3JvdXAsIHsgbGFiZWw6IG1vZGVMYWJlbCwgb25DaGFuZ2U6IGhhbmRsZU1vZGVDaGFuZ2UsIHNlbGVjdGVkVmFsdWU6IHZhbHVlLm1vZGUsIGlubGluZTogdHJ1ZSB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLlJhZGlvLCB7IGxhYmVsOiBcIlN0YXRpY1wiLCB2YWx1ZTogXCJzdGF0aWNcIiB9KSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5SYWRpbywgeyBsYWJlbDogXCJEeW5hbWljXCIsIHZhbHVlOiBcImR5bmFtaWNcIiB9KSksXG4gICAgICAgIHZhbHVlLm1vZGUgPT09IFwic3RhdGljXCIgPyAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTWVtb1ZhbHVlUmVuZGVyZXIsIHsgdmFsdWU6IHZhbHVlLnZhbHVlLCBvbkNoYW5nZTogaGFuZGxlVmFsdWVDaGFuZ2UgfSkpIDogbnVsbCkpO1xufTtcbmV4cG9ydHMuQ29uZmlndXJhYmxlSW5wdXRFZGl0b3IgPSBDb25maWd1cmFibGVJbnB1dEVkaXRvcjtcbmNvbnN0IGNyZWF0ZUNvbmZpZ3VyYWJsZUlucHV0RWRpdG9yID0gKHZhbHVlUmVuZGVyZXIpID0+IHtcbiAgICByZXR1cm4gKHByb3BzKSA9PiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoZXhwb3J0cy5Db25maWd1cmFibGVJbnB1dEVkaXRvciwgeyAuLi5wcm9wcywgdmFsdWVSZW5kZXJlcjogdmFsdWVSZW5kZXJlciB9KSk7XG59O1xuZXhwb3J0cy5jcmVhdGVDb25maWd1cmFibGVJbnB1dEVkaXRvciA9IGNyZWF0ZUNvbmZpZ3VyYWJsZUlucHV0RWRpdG9yO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL19fTWFjcm9Ob2RlX19Db2xsZWN0Ly4vc3JjL2xpYi9Db25maWd1cmFibGVJbnB1dEVkaXRvci50c3g/Iik7CgovKioqLyB9KSwKCi8qKiovICJAYmx1ZXByaW50anMvY29yZSI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIGV4dGVybmFsICJCbHVlcHJpbnQiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChtb2R1bGUpID0+IHsKCm1vZHVsZS5leHBvcnRzID0gd2luZG93WyJCbHVlcHJpbnQiXTsKCi8qKiovIH0pLAoKLyoqKi8gInJlYWN0IjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiBleHRlcm5hbCAiUmVhY3QiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSB3aW5kb3dbIlJlYWN0Il07CgovKioqLyB9KQoKLyoqKioqKi8gCX0pOwovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9OwovKioqKioqLyAJCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCXZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdOwovKioqKioqLyAJCWlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkgewovKioqKioqLyAJCQlyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAkJfQovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCS8vIG5vIG1vZHVsZS5pZCBuZWVkZWQKLyoqKioqKi8gCQkJLy8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWQKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLyAJCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJX193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovIAkKLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8gCQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJCi8qKioqKiovIAkvLyBzdGFydHVwCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCS8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkCi8qKioqKiovIAl2YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oIi4vc3JjL0xpc3RzL0NvbGxlY3QvQ29sbGVjdC50c3giKTsKLyoqKioqKi8gCXdpbmRvdy5fX01hY3JvTm9kZV9fQ29sbGVjdCA9IF9fd2VicGFja19leHBvcnRzX187Ci8qKioqKiovIAkKLyoqKioqKi8gfSkoKQo7","Comment":"LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkidXNlIHN0cmljdCI7Ci8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi9zcmMvTWlzYy9Db21tZW50LnRzeCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvTWlzYy9Db21tZW50LnRzeCAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59KTtcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLkNvbW1lbnRFZGl0b3IgPSB2b2lkIDA7XG5jb25zdCByZWFjdF8xID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0ICovIFwicmVhY3RcIikpO1xuY29uc3QgY29yZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQGJsdWVwcmludGpzL2NvcmUgKi8gXCJAYmx1ZXByaW50anMvY29yZVwiKTtcbmNvbnN0IENvbW1lbnRFZGl0b3IgPSAoeyB2YWx1ZSwgb25DaGFuZ2UsIH0pID0+IHtcbiAgICBjb25zdCBbY29udGVudCwgc2V0Q29udGVudF0gPSAoMCwgcmVhY3RfMS51c2VTdGF0ZSkodmFsdWUuY29udGVudCk7XG4gICAgKDAsIHJlYWN0XzEudXNlRWZmZWN0KSgoKSA9PiB7XG4gICAgICAgIG9uQ2hhbmdlKHsgY29udGVudCB9KTtcbiAgICB9LCBbY29udGVudCwgb25DaGFuZ2VdKTtcbiAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIG51bGwsXG4gICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwidGV4dGFyZWFcIiwgeyB2YWx1ZTogY29udGVudCwgb25DaGFuZ2U6IChlKSA9PiBzZXRDb250ZW50KGUudGFyZ2V0LnZhbHVlKSwgcGxhY2Vob2xkZXI6IFwiRW50ZXIgeW91ciBjb21tZW50IGhlcmUgKEhUTUwgc3VwcG9ydGVkKVwiLCByb3dzOiAxMCwgc3R5bGU6IHsgd2lkdGg6IFwiMTAwJVwiLCBwYWRkaW5nOiBcIjhweCA2cHhcIiB9IH0pLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuQ2FsbG91dCwgeyBpbnRlbnQ6IFwicHJpbWFyeVwiLCBpY29uOiBudWxsIH0sIFwiSFRNTCBmb3JtYXR0aW5nIGlzIHN1cHBvcnRlZFwiKSkpO1xufTtcbmV4cG9ydHMuQ29tbWVudEVkaXRvciA9IENvbW1lbnRFZGl0b3I7XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IGV4cG9ydHMuQ29tbWVudEVkaXRvcjtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9fX01hY3JvTm9kZV9fQ29tbWVudC8uL3NyYy9NaXNjL0NvbW1lbnQudHN4PyIpOwoKLyoqKi8gfSksCgovKioqLyAiQGJsdWVwcmludGpzL2NvcmUiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiBleHRlcm5hbCAiQmx1ZXByaW50IiAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgobW9kdWxlKSA9PiB7Cgptb2R1bGUuZXhwb3J0cyA9IHdpbmRvd1siQmx1ZXByaW50Il07CgovKioqLyB9KSwKCi8qKiovICJyZWFjdCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogZXh0ZXJuYWwgIlJlYWN0IiAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChtb2R1bGUpID0+IHsKCm1vZHVsZS5leHBvcnRzID0gd2luZG93WyJSZWFjdCJdOwoKLyoqKi8gfSkKCi8qKioqKiovIAl9KTsKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gCS8vIFRoZSBtb2R1bGUgY2FjaGUKLyoqKioqKi8gCXZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTsKLyoqKioqKi8gCQovKioqKioqLyAJLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb24KLyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUKLyoqKioqKi8gCQl2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTsKLyoqKioqKi8gCQlpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHsKLyoqKioqKi8gCQkJcmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzOwovKioqKioqLyAJCX0KLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQovKioqKioqLyAJCXZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0gewovKioqKioqLyAJCQkvLyBubyBtb2R1bGUuaWQgbmVlZGVkCi8qKioqKiovIAkJCS8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkCi8qKioqKiovIAkJCWV4cG9ydHM6IHt9Ci8qKioqKiovIAkJfTsKLyoqKioqKi8gCQovKioqKioqLyAJCS8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbgovKioqKioqLyAJCV9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pOwovKioqKioqLyAJCi8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGUKLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAl9Ci8qKioqKiovIAkKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKioqKi8gCQovKioqKioqLyAJLy8gc3RhcnR1cAovKioqKioqLyAJLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzCi8qKioqKiovIAkvLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZAovKioqKioqLyAJdmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKCIuL3NyYy9NaXNjL0NvbW1lbnQudHN4Iik7Ci8qKioqKiovIAl3aW5kb3cuX19NYWNyb05vZGVfX0NvbW1lbnQgPSBfX3dlYnBhY2tfZXhwb3J0c19fOwovKioqKioqLyAJCi8qKioqKiovIH0pKCkKOw==","Conditional":"LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3B1YnN1Yi1qc0AxLjkuNC9ub2RlX21vZHVsZXMvcHVic3ViLWpzL3NyYy9wdWJzdWIuanMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuLi9ub2RlX21vZHVsZXMvLnBucG0vcHVic3ViLWpzQDEuOS40L25vZGVfbW9kdWxlcy9wdWJzdWItanMvc3JjL3B1YnN1Yi5qcyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCmV2YWwoIi8qIG1vZHVsZSBkZWNvcmF0b3IgKi8gbW9kdWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXy5ubWQobW9kdWxlKTtcbi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDEwLDIwMTEsMjAxMiwyMDEzLDIwMTQgTW9yZ2FuIFJvZGVyaWNrIGh0dHA6Ly9yb2Rlcmljay5ka1xuICogTGljZW5zZTogTUlUIC0gaHR0cDovL21yZ25yZHJjay5taXQtbGljZW5zZS5vcmdcbiAqXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbXJvZGVyaWNrL1B1YlN1YkpTXG4gKi9cblxuKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgUHViU3ViID0ge307XG5cbiAgICBpZiAocm9vdC5QdWJTdWIpIHtcbiAgICAgICAgUHViU3ViID0gcm9vdC5QdWJTdWI7XG4gICAgICAgIGNvbnNvbGUud2FybihcIlB1YlN1YiBhbHJlYWR5IGxvYWRlZCwgdXNpbmcgZXhpc3RpbmcgdmVyc2lvblwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByb290LlB1YlN1YiA9IFB1YlN1YjtcbiAgICAgICAgZmFjdG9yeShQdWJTdWIpO1xuICAgIH1cbiAgICAvLyBDb21tb25KUyBhbmQgTm9kZS5qcyBtb2R1bGUgc3VwcG9ydFxuICAgIGlmICh0cnVlKXtcbiAgICAgICAgaWYgKG1vZHVsZSAhPT0gdW5kZWZpbmVkICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgICAgICAgICBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBQdWJTdWI7IC8vIE5vZGUuanMgc3BlY2lmaWMgYG1vZHVsZS5leHBvcnRzYFxuICAgICAgICB9XG4gICAgICAgIGV4cG9ydHMuUHViU3ViID0gUHViU3ViOyAvLyBDb21tb25KUyBtb2R1bGUgMS4xLjEgc3BlY1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHMgPSBQdWJTdWI7IC8vIENvbW1vbkpTXG4gICAgfVxuICAgIC8vIEFNRCBzdXBwb3J0XG4gICAgLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cbiAgICBlbHNlIHt9XG5cbn0oKCB0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JyAmJiB3aW5kb3cgKSB8fCB0aGlzLCBmdW5jdGlvbiAoUHViU3ViKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgbWVzc2FnZXMgPSB7fSxcbiAgICAgICAgbGFzdFVpZCA9IC0xLFxuICAgICAgICBBTExfU1VCU0NSSUJJTkdfTVNHID0gJyonO1xuXG4gICAgZnVuY3Rpb24gaGFzS2V5cyhvYmope1xuICAgICAgICB2YXIga2V5O1xuXG4gICAgICAgIGZvciAoa2V5IGluIG9iail7XG4gICAgICAgICAgICBpZiAoIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgdGhyb3dzIHRoZSBwYXNzZWQgZXhjZXB0aW9uLCBmb3IgdXNlIGFzIGFyZ3VtZW50IGZvciBzZXRUaW1lb3V0XG4gICAgICogQGFsaWFzIHRocm93RXhjZXB0aW9uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHsgT2JqZWN0IH0gZXggQW4gRXJyb3Igb2JqZWN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gdGhyb3dFeGNlcHRpb24oIGV4ICl7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiByZVRocm93RXhjZXB0aW9uKCl7XG4gICAgICAgICAgICB0aHJvdyBleDtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYWxsU3Vic2NyaWJlcldpdGhEZWxheWVkRXhjZXB0aW9ucyggc3Vic2NyaWJlciwgbWVzc2FnZSwgZGF0YSApe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc3Vic2NyaWJlciggbWVzc2FnZSwgZGF0YSApO1xuICAgICAgICB9IGNhdGNoKCBleCApe1xuICAgICAgICAgICAgc2V0VGltZW91dCggdGhyb3dFeGNlcHRpb24oIGV4ICksIDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FsbFN1YnNjcmliZXJXaXRoSW1tZWRpYXRlRXhjZXB0aW9ucyggc3Vic2NyaWJlciwgbWVzc2FnZSwgZGF0YSApe1xuICAgICAgICBzdWJzY3JpYmVyKCBtZXNzYWdlLCBkYXRhICk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsaXZlck1lc3NhZ2UoIG9yaWdpbmFsTWVzc2FnZSwgbWF0Y2hlZE1lc3NhZ2UsIGRhdGEsIGltbWVkaWF0ZUV4Y2VwdGlvbnMgKXtcbiAgICAgICAgdmFyIHN1YnNjcmliZXJzID0gbWVzc2FnZXNbbWF0Y2hlZE1lc3NhZ2VdLFxuICAgICAgICAgICAgY2FsbFN1YnNjcmliZXIgPSBpbW1lZGlhdGVFeGNlcHRpb25zID8gY2FsbFN1YnNjcmliZXJXaXRoSW1tZWRpYXRlRXhjZXB0aW9ucyA6IGNhbGxTdWJzY3JpYmVyV2l0aERlbGF5ZWRFeGNlcHRpb25zLFxuICAgICAgICAgICAgcztcblxuICAgICAgICBpZiAoICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoIG1lc3NhZ2VzLCBtYXRjaGVkTWVzc2FnZSApICkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChzIGluIHN1YnNjcmliZXJzKXtcbiAgICAgICAgICAgIGlmICggT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHN1YnNjcmliZXJzLCBzKSl7XG4gICAgICAgICAgICAgICAgY2FsbFN1YnNjcmliZXIoIHN1YnNjcmliZXJzW3NdLCBvcmlnaW5hbE1lc3NhZ2UsIGRhdGEgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZURlbGl2ZXJ5RnVuY3Rpb24oIG1lc3NhZ2UsIGRhdGEsIGltbWVkaWF0ZUV4Y2VwdGlvbnMgKXtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGRlbGl2ZXJOYW1lc3BhY2VkKCl7XG4gICAgICAgICAgICB2YXIgdG9waWMgPSBTdHJpbmcoIG1lc3NhZ2UgKSxcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHRvcGljLmxhc3RJbmRleE9mKCAnLicgKTtcblxuICAgICAgICAgICAgLy8gZGVsaXZlciB0aGUgbWVzc2FnZSBhcyBpdCBpcyBub3dcbiAgICAgICAgICAgIGRlbGl2ZXJNZXNzYWdlKG1lc3NhZ2UsIG1lc3NhZ2UsIGRhdGEsIGltbWVkaWF0ZUV4Y2VwdGlvbnMpO1xuXG4gICAgICAgICAgICAvLyB0cmltIHRoZSBoaWVyYXJjaHkgYW5kIGRlbGl2ZXIgbWVzc2FnZSB0byBlYWNoIGxldmVsXG4gICAgICAgICAgICB3aGlsZSggcG9zaXRpb24gIT09IC0xICl7XG4gICAgICAgICAgICAgICAgdG9waWMgPSB0b3BpYy5zdWJzdHIoIDAsIHBvc2l0aW9uICk7XG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSB0b3BpYy5sYXN0SW5kZXhPZignLicpO1xuICAgICAgICAgICAgICAgIGRlbGl2ZXJNZXNzYWdlKCBtZXNzYWdlLCB0b3BpYywgZGF0YSwgaW1tZWRpYXRlRXhjZXB0aW9ucyApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkZWxpdmVyTWVzc2FnZShtZXNzYWdlLCBBTExfU1VCU0NSSUJJTkdfTVNHLCBkYXRhLCBpbW1lZGlhdGVFeGNlcHRpb25zKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoYXNEaXJlY3RTdWJzY3JpYmVyc0ZvciggbWVzc2FnZSApIHtcbiAgICAgICAgdmFyIHRvcGljID0gU3RyaW5nKCBtZXNzYWdlICksXG4gICAgICAgICAgICBmb3VuZCA9IEJvb2xlYW4oT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKCBtZXNzYWdlcywgdG9waWMgKSAmJiBoYXNLZXlzKG1lc3NhZ2VzW3RvcGljXSkpO1xuXG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtZXNzYWdlSGFzU3Vic2NyaWJlcnMoIG1lc3NhZ2UgKXtcbiAgICAgICAgdmFyIHRvcGljID0gU3RyaW5nKCBtZXNzYWdlICksXG4gICAgICAgICAgICBmb3VuZCA9IGhhc0RpcmVjdFN1YnNjcmliZXJzRm9yKHRvcGljKSB8fCBoYXNEaXJlY3RTdWJzY3JpYmVyc0ZvcihBTExfU1VCU0NSSUJJTkdfTVNHKSxcbiAgICAgICAgICAgIHBvc2l0aW9uID0gdG9waWMubGFzdEluZGV4T2YoICcuJyApO1xuXG4gICAgICAgIHdoaWxlICggIWZvdW5kICYmIHBvc2l0aW9uICE9PSAtMSApe1xuICAgICAgICAgICAgdG9waWMgPSB0b3BpYy5zdWJzdHIoIDAsIHBvc2l0aW9uICk7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IHRvcGljLmxhc3RJbmRleE9mKCAnLicgKTtcbiAgICAgICAgICAgIGZvdW5kID0gaGFzRGlyZWN0U3Vic2NyaWJlcnNGb3IodG9waWMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHB1Ymxpc2goIG1lc3NhZ2UsIGRhdGEsIHN5bmMsIGltbWVkaWF0ZUV4Y2VwdGlvbnMgKXtcbiAgICAgICAgbWVzc2FnZSA9ICh0eXBlb2YgbWVzc2FnZSA9PT0gJ3N5bWJvbCcpID8gbWVzc2FnZS50b1N0cmluZygpIDogbWVzc2FnZTtcblxuICAgICAgICB2YXIgZGVsaXZlciA9IGNyZWF0ZURlbGl2ZXJ5RnVuY3Rpb24oIG1lc3NhZ2UsIGRhdGEsIGltbWVkaWF0ZUV4Y2VwdGlvbnMgKSxcbiAgICAgICAgICAgIGhhc1N1YnNjcmliZXJzID0gbWVzc2FnZUhhc1N1YnNjcmliZXJzKCBtZXNzYWdlICk7XG5cbiAgICAgICAgaWYgKCAhaGFzU3Vic2NyaWJlcnMgKXtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICggc3luYyA9PT0gdHJ1ZSApe1xuICAgICAgICAgICAgZGVsaXZlcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2V0VGltZW91dCggZGVsaXZlciwgMCApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFB1Ymxpc2hlcyB0aGUgbWVzc2FnZSwgcGFzc2luZyB0aGUgZGF0YSB0byBpdCdzIHN1YnNjcmliZXJzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQGFsaWFzIHB1Ymxpc2hcbiAgICAgKiBAcGFyYW0geyBTdHJpbmcgfSBtZXNzYWdlIFRoZSBtZXNzYWdlIHRvIHB1Ymxpc2hcbiAgICAgKiBAcGFyYW0ge30gZGF0YSBUaGUgZGF0YSB0byBwYXNzIHRvIHN1YnNjcmliZXJzXG4gICAgICogQHJldHVybiB7IEJvb2xlYW4gfVxuICAgICAqL1xuICAgIFB1YlN1Yi5wdWJsaXNoID0gZnVuY3Rpb24oIG1lc3NhZ2UsIGRhdGEgKXtcbiAgICAgICAgcmV0dXJuIHB1Ymxpc2goIG1lc3NhZ2UsIGRhdGEsIGZhbHNlLCBQdWJTdWIuaW1tZWRpYXRlRXhjZXB0aW9ucyApO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQdWJsaXNoZXMgdGhlIG1lc3NhZ2Ugc3luY2hyb25vdXNseSwgcGFzc2luZyB0aGUgZGF0YSB0byBpdCdzIHN1YnNjcmliZXJzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQGFsaWFzIHB1Ymxpc2hTeW5jXG4gICAgICogQHBhcmFtIHsgU3RyaW5nIH0gbWVzc2FnZSBUaGUgbWVzc2FnZSB0byBwdWJsaXNoXG4gICAgICogQHBhcmFtIHt9IGRhdGEgVGhlIGRhdGEgdG8gcGFzcyB0byBzdWJzY3JpYmVyc1xuICAgICAqIEByZXR1cm4geyBCb29sZWFuIH1cbiAgICAgKi9cbiAgICBQdWJTdWIucHVibGlzaFN5bmMgPSBmdW5jdGlvbiggbWVzc2FnZSwgZGF0YSApe1xuICAgICAgICByZXR1cm4gcHVibGlzaCggbWVzc2FnZSwgZGF0YSwgdHJ1ZSwgUHViU3ViLmltbWVkaWF0ZUV4Y2VwdGlvbnMgKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlcyB0aGUgcGFzc2VkIGZ1bmN0aW9uIHRvIHRoZSBwYXNzZWQgbWVzc2FnZS4gRXZlcnkgcmV0dXJuZWQgdG9rZW4gaXMgdW5pcXVlIGFuZCBzaG91bGQgYmUgc3RvcmVkIGlmIHlvdSBuZWVkIHRvIHVuc3Vic2NyaWJlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQGFsaWFzIHN1YnNjcmliZVxuICAgICAqIEBwYXJhbSB7IFN0cmluZyB9IG1lc3NhZ2UgVGhlIG1lc3NhZ2UgdG8gc3Vic2NyaWJlIHRvXG4gICAgICogQHBhcmFtIHsgRnVuY3Rpb24gfSBmdW5jIFRoZSBmdW5jdGlvbiB0byBjYWxsIHdoZW4gYSBuZXcgbWVzc2FnZSBpcyBwdWJsaXNoZWRcbiAgICAgKiBAcmV0dXJuIHsgU3RyaW5nIH1cbiAgICAgKi9cbiAgICBQdWJTdWIuc3Vic2NyaWJlID0gZnVuY3Rpb24oIG1lc3NhZ2UsIGZ1bmMgKXtcbiAgICAgICAgaWYgKCB0eXBlb2YgZnVuYyAhPT0gJ2Z1bmN0aW9uJyl7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBtZXNzYWdlID0gKHR5cGVvZiBtZXNzYWdlID09PSAnc3ltYm9sJykgPyBtZXNzYWdlLnRvU3RyaW5nKCkgOiBtZXNzYWdlO1xuXG4gICAgICAgIC8vIG1lc3NhZ2UgaXMgbm90IHJlZ2lzdGVyZWQgeWV0XG4gICAgICAgIGlmICggIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCggbWVzc2FnZXMsIG1lc3NhZ2UgKSApe1xuICAgICAgICAgICAgbWVzc2FnZXNbbWVzc2FnZV0gPSB7fTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZvcmNpbmcgdG9rZW4gYXMgU3RyaW5nLCB0byBhbGxvdyBmb3IgZnV0dXJlIGV4cGFuc2lvbnMgd2l0aG91dCBicmVha2luZyB1c2FnZVxuICAgICAgICAvLyBhbmQgYWxsb3cgZm9yIGVhc3kgdXNlIGFzIGtleSBuYW1lcyBmb3IgdGhlICdtZXNzYWdlcycgb2JqZWN0XG4gICAgICAgIHZhciB0b2tlbiA9ICd1aWRfJyArIFN0cmluZygrK2xhc3RVaWQpO1xuICAgICAgICBtZXNzYWdlc1ttZXNzYWdlXVt0b2tlbl0gPSBmdW5jO1xuXG4gICAgICAgIC8vIHJldHVybiB0b2tlbiBmb3IgdW5zdWJzY3JpYmluZ1xuICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgfTtcblxuICAgIFB1YlN1Yi5zdWJzY3JpYmVBbGwgPSBmdW5jdGlvbiggZnVuYyApe1xuICAgICAgICByZXR1cm4gUHViU3ViLnN1YnNjcmliZShBTExfU1VCU0NSSUJJTkdfTVNHLCBmdW5jKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlcyB0aGUgcGFzc2VkIGZ1bmN0aW9uIHRvIHRoZSBwYXNzZWQgbWVzc2FnZSBvbmNlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQGFsaWFzIHN1YnNjcmliZU9uY2VcbiAgICAgKiBAcGFyYW0geyBTdHJpbmcgfSBtZXNzYWdlIFRoZSBtZXNzYWdlIHRvIHN1YnNjcmliZSB0b1xuICAgICAqIEBwYXJhbSB7IEZ1bmN0aW9uIH0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIGEgbmV3IG1lc3NhZ2UgaXMgcHVibGlzaGVkXG4gICAgICogQHJldHVybiB7IFB1YlN1YiB9XG4gICAgICovXG4gICAgUHViU3ViLnN1YnNjcmliZU9uY2UgPSBmdW5jdGlvbiggbWVzc2FnZSwgZnVuYyApe1xuICAgICAgICB2YXIgdG9rZW4gPSBQdWJTdWIuc3Vic2NyaWJlKCBtZXNzYWdlLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gYmVmb3JlIGZ1bmMgYXBwbHksIHVuc3Vic2NyaWJlIG1lc3NhZ2VcbiAgICAgICAgICAgIFB1YlN1Yi51bnN1YnNjcmliZSggdG9rZW4gKTtcbiAgICAgICAgICAgIGZ1bmMuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFB1YlN1YjtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2xlYXJzIGFsbCBzdWJzY3JpcHRpb25zXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBhbGlhcyBjbGVhckFsbFN1YnNjcmlwdGlvbnNcbiAgICAgKi9cbiAgICBQdWJTdWIuY2xlYXJBbGxTdWJzY3JpcHRpb25zID0gZnVuY3Rpb24gY2xlYXJBbGxTdWJzY3JpcHRpb25zKCl7XG4gICAgICAgIG1lc3NhZ2VzID0ge307XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENsZWFyIHN1YnNjcmlwdGlvbnMgYnkgdGhlIHRvcGljXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBhbGlhcyBjbGVhckFsbFN1YnNjcmlwdGlvbnNcbiAgICAgKiBAcmV0dXJuIHsgaW50IH1cbiAgICAgKi9cbiAgICBQdWJTdWIuY2xlYXJTdWJzY3JpcHRpb25zID0gZnVuY3Rpb24gY2xlYXJTdWJzY3JpcHRpb25zKHRvcGljKXtcbiAgICAgICAgdmFyIG07XG4gICAgICAgIGZvciAobSBpbiBtZXNzYWdlcyl7XG4gICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1lc3NhZ2VzLCBtKSAmJiBtLmluZGV4T2YodG9waWMpID09PSAwKXtcbiAgICAgICAgICAgICAgICBkZWxldGUgbWVzc2FnZXNbbV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICAgQ291bnQgc3Vic2NyaXB0aW9ucyBieSB0aGUgdG9waWNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQGFsaWFzIGNvdW50U3Vic2NyaXB0aW9uc1xuICAgICAqIEByZXR1cm4geyBBcnJheSB9XG4gICAgKi9cbiAgICBQdWJTdWIuY291bnRTdWJzY3JpcHRpb25zID0gZnVuY3Rpb24gY291bnRTdWJzY3JpcHRpb25zKHRvcGljKXtcbiAgICAgICAgdmFyIG07XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuICAgICAgICB2YXIgdG9rZW47XG4gICAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICAgIGZvciAobSBpbiBtZXNzYWdlcykge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtZXNzYWdlcywgbSkgJiYgbS5pbmRleE9mKHRvcGljKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGZvciAodG9rZW4gaW4gbWVzc2FnZXNbbV0pIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAgIEdldHMgc3Vic2NyaXB0aW9ucyBieSB0aGUgdG9waWNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQGFsaWFzIGdldFN1YnNjcmlwdGlvbnNcbiAgICAqL1xuICAgIFB1YlN1Yi5nZXRTdWJzY3JpcHRpb25zID0gZnVuY3Rpb24gZ2V0U3Vic2NyaXB0aW9ucyh0b3BpYyl7XG4gICAgICAgIHZhciBtO1xuICAgICAgICB2YXIgbGlzdCA9IFtdO1xuICAgICAgICBmb3IgKG0gaW4gbWVzc2FnZXMpe1xuICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtZXNzYWdlcywgbSkgJiYgbS5pbmRleE9mKHRvcGljKSA9PT0gMCl7XG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKG0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHN1YnNjcmlwdGlvbnNcbiAgICAgKlxuICAgICAqIC0gV2hlbiBwYXNzZWQgYSB0b2tlbiwgcmVtb3ZlcyBhIHNwZWNpZmljIHN1YnNjcmlwdGlvbi5cbiAgICAgKlxuXHQgKiAtIFdoZW4gcGFzc2VkIGEgZnVuY3Rpb24sIHJlbW92ZXMgYWxsIHN1YnNjcmlwdGlvbnMgZm9yIHRoYXQgZnVuY3Rpb25cbiAgICAgKlxuXHQgKiAtIFdoZW4gcGFzc2VkIGEgdG9waWMsIHJlbW92ZXMgYWxsIHN1YnNjcmlwdGlvbnMgZm9yIHRoYXQgdG9waWMgKGhpZXJhcmNoeSlcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQGFsaWFzIHN1YnNjcmliZU9uY2VcbiAgICAgKiBAcGFyYW0geyBTdHJpbmcgfCBGdW5jdGlvbiB9IHZhbHVlIEEgdG9rZW4sIGZ1bmN0aW9uIG9yIHRvcGljIHRvIHVuc3Vic2NyaWJlIGZyb21cbiAgICAgKiBAZXhhbXBsZSAvLyBVbnN1YnNjcmliaW5nIHdpdGggYSB0b2tlblxuICAgICAqIHZhciB0b2tlbiA9IFB1YlN1Yi5zdWJzY3JpYmUoJ215dG9waWMnLCBteUZ1bmMpO1xuICAgICAqIFB1YlN1Yi51bnN1YnNjcmliZSh0b2tlbik7XG4gICAgICogQGV4YW1wbGUgLy8gVW5zdWJzY3JpYmluZyB3aXRoIGEgZnVuY3Rpb25cbiAgICAgKiBQdWJTdWIudW5zdWJzY3JpYmUobXlGdW5jKTtcbiAgICAgKiBAZXhhbXBsZSAvLyBVbnN1YnNjcmliaW5nIGZyb20gYSB0b3BpY1xuICAgICAqIFB1YlN1Yi51bnN1YnNjcmliZSgnbXl0b3BpYycpO1xuICAgICAqL1xuICAgIFB1YlN1Yi51bnN1YnNjcmliZSA9IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgICAgdmFyIGRlc2NlbmRhbnRUb3BpY0V4aXN0cyA9IGZ1bmN0aW9uKHRvcGljKSB7XG4gICAgICAgICAgICAgICAgdmFyIG07XG4gICAgICAgICAgICAgICAgZm9yICggbSBpbiBtZXNzYWdlcyApe1xuICAgICAgICAgICAgICAgICAgICBpZiAoIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtZXNzYWdlcywgbSkgJiYgbS5pbmRleE9mKHRvcGljKSA9PT0gMCApe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYSBkZXNjZW5kYW50IG9mIHRoZSB0b3BpYyBleGlzdHM6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpc1RvcGljICAgID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiAoIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtZXNzYWdlcywgdmFsdWUpIHx8IGRlc2NlbmRhbnRUb3BpY0V4aXN0cyh2YWx1ZSkgKSxcbiAgICAgICAgICAgIGlzVG9rZW4gICAgPSAhaXNUb3BpYyAmJiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnLFxuICAgICAgICAgICAgaXNGdW5jdGlvbiA9IHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJyxcbiAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlLFxuICAgICAgICAgICAgbSwgbWVzc2FnZSwgdDtcblxuICAgICAgICBpZiAoaXNUb3BpYyl7XG4gICAgICAgICAgICBQdWJTdWIuY2xlYXJTdWJzY3JpcHRpb25zKHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoIG0gaW4gbWVzc2FnZXMgKXtcbiAgICAgICAgICAgIGlmICggT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKCBtZXNzYWdlcywgbSApICl7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2VzW21dO1xuXG4gICAgICAgICAgICAgICAgaWYgKCBpc1Rva2VuICYmIG1lc3NhZ2VbdmFsdWVdICl7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBtZXNzYWdlW3ZhbHVlXTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRva2VucyBhcmUgdW5pcXVlLCBzbyB3ZSBjYW4ganVzdCBzdG9wIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlzRnVuY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICggdCBpbiBtZXNzYWdlICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1lc3NhZ2UsIHQpICYmIG1lc3NhZ2VbdF0gPT09IHZhbHVlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgbWVzc2FnZVt0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xufSkpO1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL19fTWFjcm9Ob2RlX19Db25kaXRpb25hbC8uLi9ub2RlX21vZHVsZXMvLnBucG0vcHVic3ViLWpzQDEuOS40L25vZGVfbW9kdWxlcy9wdWJzdWItanMvc3JjL3B1YnN1Yi5qcz8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIi4vc3JjL0NvbnRyb2xGbG93L0NvbmRpdGlvbmFsLmZseWRlLnRzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvQ29udHJvbEZsb3cvQ29uZGl0aW9uYWwuZmx5ZGUudHMgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoidXNlIHN0cmljdCI7CmV2YWwoIlxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLkNvbmRpdGlvbmFsID0gZXhwb3J0cy5Db25kaXRpb25UeXBlID0gdm9pZCAwO1xudmFyIENvbmRpdGlvblR5cGU7XG4oZnVuY3Rpb24gKENvbmRpdGlvblR5cGUpIHtcbiAgICBDb25kaXRpb25UeXBlW1wiRXF1YWxcIl0gPSBcIkVRVUFMXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIk5vdEVxdWFsXCJdID0gXCJOT1RfRVFVQUxcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiR3JlYXRlclRoYW5cIl0gPSBcIkdSRUFURVJfVEhBTlwiO1xuICAgIENvbmRpdGlvblR5cGVbXCJHcmVhdGVyVGhhbk9yRXF1YWxcIl0gPSBcIkdSRUFURVJfVEhBTl9PUl9FUVVBTFwiO1xuICAgIENvbmRpdGlvblR5cGVbXCJMZXNzVGhhblwiXSA9IFwiTEVTU19USEFOXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIkxlc3NUaGFuT3JFcXVhbFwiXSA9IFwiTEVTU19USEFOX09SX0VRVUFMXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIkNvbnRhaW5zXCJdID0gXCJDT05UQUlOU1wiO1xuICAgIENvbmRpdGlvblR5cGVbXCJOb3RDb250YWluc1wiXSA9IFwiTk9UX0NPTlRBSU5TXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIlJlZ2V4TWF0Y2hlc1wiXSA9IFwiUkVHRVhfTUFUQ0hFU1wiO1xuICAgIENvbmRpdGlvblR5cGVbXCJJc0VtcHR5XCJdID0gXCJJU19FTVBUWVwiO1xuICAgIENvbmRpdGlvblR5cGVbXCJJc05vdEVtcHR5XCJdID0gXCJJU19OT1RfRU1QVFlcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiSXNOdWxsXCJdID0gXCJJU19OVUxMXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIklzTm90TnVsbFwiXSA9IFwiSVNfTk9UX05VTExcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiSXNVbmRlZmluZWRcIl0gPSBcIklTX1VOREVGSU5FRFwiO1xuICAgIENvbmRpdGlvblR5cGVbXCJJc05vdFVuZGVmaW5lZFwiXSA9IFwiSVNfTk9UX1VOREVGSU5FRFwiO1xuICAgIENvbmRpdGlvblR5cGVbXCJIYXNQcm9wZXJ0eVwiXSA9IFwiSEFTX1BST1BFUlRZXCI7XG4gICAgQ29uZGl0aW9uVHlwZVtcIkxlbmd0aEVxdWFsXCJdID0gXCJMRU5HVEhfRVFVQUxcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiTGVuZ3RoTm90RXF1YWxcIl0gPSBcIkxFTkdUSF9OT1RfRVFVQUxcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiTGVuZ3RoR3JlYXRlclRoYW5cIl0gPSBcIkxFTkdUSF9HUkVBVEVSX1RIQU5cIjtcbiAgICBDb25kaXRpb25UeXBlW1wiTGVuZ3RoTGVzc1RoYW5cIl0gPSBcIkxFTkdUSF9MRVNTX1RIQU5cIjtcbiAgICBDb25kaXRpb25UeXBlW1wiVHlwZUVxdWFsc1wiXSA9IFwiVFlQRV9FUVVBTFNcIjtcbiAgICBDb25kaXRpb25UeXBlW1wiRXhwcmVzc2lvblwiXSA9IFwiRVhQUkVTU0lPTlwiO1xufSkoQ29uZGl0aW9uVHlwZSB8fCAoZXhwb3J0cy5Db25kaXRpb25UeXBlID0gQ29uZGl0aW9uVHlwZSA9IHt9KSk7XG5mdW5jdGlvbiBjb25kaXRpb25hbENvbmZpZ1RvRGlzcGxheU5hbWUoY29uZmlnKSB7XG4gICAgY29uc3QgeyB0eXBlIH0gPSBjb25maWcuY29uZGl0aW9uO1xuICAgIGNvbnN0IGNvbXBhcmVUbyA9IGNvbmZpZy5jb21wYXJlVG8ubW9kZSA9PT0gXCJzdGF0aWNcIlxuICAgICAgICA/IEpTT04uc3RyaW5naWZ5KGNvbmZpZy5jb21wYXJlVG8udmFsdWUpXG4gICAgICAgIDogXCJgY29tcGFyZVRvYFwiO1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuRXF1YWw6XG4gICAgICAgICAgICByZXR1cm4gYEVxdWFscyAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTm90RXF1YWw6XG4gICAgICAgICAgICByZXR1cm4gYERvZXMgbm90IGVxdWFsICR7Y29tcGFyZVRvfWA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5HcmVhdGVyVGhhbjpcbiAgICAgICAgICAgIHJldHVybiBgR3JlYXRlciB0aGFuICR7Y29tcGFyZVRvfWA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5HcmVhdGVyVGhhbk9yRXF1YWw6XG4gICAgICAgICAgICByZXR1cm4gYEdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTGVzc1RoYW46XG4gICAgICAgICAgICByZXR1cm4gYExlc3MgdGhhbiAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTGVzc1RoYW5PckVxdWFsOlxuICAgICAgICAgICAgcmV0dXJuIGBMZXNzIHRoYW4gb3IgZXF1YWwgdG8gJHtjb21wYXJlVG99YDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkNvbnRhaW5zOlxuICAgICAgICAgICAgcmV0dXJuIGBDb250YWlucyAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTm90Q29udGFpbnM6XG4gICAgICAgICAgICByZXR1cm4gYERvZXMgbm90IGNvbnRhaW4gJHtjb21wYXJlVG99YDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLlJlZ2V4TWF0Y2hlczpcbiAgICAgICAgICAgIHJldHVybiBgTWF0Y2hlcyByZWdleCAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuSXNFbXB0eTpcbiAgICAgICAgICAgIHJldHVybiBgSXMgZW1wdHlgO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuSXNOb3RFbXB0eTpcbiAgICAgICAgICAgIHJldHVybiBgSXMgbm90IGVtcHR5YDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLklzTnVsbDpcbiAgICAgICAgICAgIHJldHVybiBgSXMgbnVsbGA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Jc05vdE51bGw6XG4gICAgICAgICAgICByZXR1cm4gYElzIG5vdCBudWxsYDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLklzVW5kZWZpbmVkOlxuICAgICAgICAgICAgcmV0dXJuIGBJcyB1bmRlZmluZWRgO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuSXNOb3RVbmRlZmluZWQ6XG4gICAgICAgICAgICByZXR1cm4gYElzIG5vdCB1bmRlZmluZWRgO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuSGFzUHJvcGVydHk6XG4gICAgICAgICAgICByZXR1cm4gYEhhcyBwcm9wZXJ0eSAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTGVuZ3RoRXF1YWw6XG4gICAgICAgICAgICByZXR1cm4gYExlbmd0aCBlcXVhbHMgJHtjb21wYXJlVG99YDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkxlbmd0aE5vdEVxdWFsOlxuICAgICAgICAgICAgcmV0dXJuIGBMZW5ndGggZG9lcyBub3QgZXF1YWwgJHtjb21wYXJlVG99YDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkxlbmd0aEdyZWF0ZXJUaGFuOlxuICAgICAgICAgICAgcmV0dXJuIGBMZW5ndGggZ3JlYXRlciB0aGFuICR7Y29tcGFyZVRvfWA7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5MZW5ndGhMZXNzVGhhbjpcbiAgICAgICAgICAgIHJldHVybiBgTGVuZ3RoIGxlc3MgdGhhbiAke2NvbXBhcmVUb31gO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuVHlwZUVxdWFsczpcbiAgICAgICAgICAgIHJldHVybiBgVHlwZSBlcXVhbHMgJHtjb21wYXJlVG99YDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkV4cHJlc3Npb246XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnLmNvbmRpdGlvbi5kYXRhO1xuICAgIH1cbn1cbmV4cG9ydHMuQ29uZGl0aW9uYWwgPSB7XG4gICAgaWQ6IFwiQ29uZGl0aW9uYWxcIixcbiAgICBuYW1lc3BhY2U6IFwiQ29udHJvbCBGbG93XCIsXG4gICAgZGVzY3JpcHRpb246IFwiRXZhbHVhdGVzIGEgY29uZGl0aW9uIGFuZCBlbWl0cyB0aGUgdmFsdWUgb2YgdGhlIG1hdGNoaW5nIGNhc2VcIixcbiAgICBkZWZhdWx0U3R5bGU6IHtcbiAgICAgICAgaWNvbjogXCJjaXJjbGUtcXVlc3Rpb25cIixcbiAgICB9LFxuICAgIHJ1bkZuQnVpbGRlcjogKGNvbmZpZykgPT4ge1xuICAgICAgICByZXR1cm4gKGlucHV0cywgb3V0cHV0cywgYWR2KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IGNvbXBhcmVUbzogYXJnVHlwZSwgcHJvcGVydHlQYXRoLCBjb25kaXRpb24sIHRydWVWYWx1ZSwgZmFsc2VWYWx1ZSwgfSA9IGNvbmZpZztcbiAgICAgICAgICAgIGNvbnN0IHsgdHJ1ZTogdHJ1ZU91dHB1dCwgZmFsc2U6IGZhbHNlT3V0cHV0IH0gPSBvdXRwdXRzO1xuICAgICAgICAgICAgY29uc3QgY29tcGFyZWRWYWx1ZSA9IGFyZ1R5cGUubW9kZSA9PT0gXCJzdGF0aWNcIiA/IGFyZ1R5cGUudmFsdWUgOiBpbnB1dHMuY29tcGFyZVRvO1xuICAgICAgICAgICAgY29uc3QgbGVmdFNpZGUgPSBwcm9wZXJ0eVBhdGhcbiAgICAgICAgICAgICAgICA/IGdldFByb3BlcnR5KGlucHV0cy52YWx1ZSwgcHJvcGVydHlQYXRoKVxuICAgICAgICAgICAgICAgIDogaW5wdXRzLnZhbHVlO1xuICAgICAgICAgICAgY29uc3QgcmlnaHRTaWRlID0gY29uZmlnLmNvbXBhcmVUby5tb2RlID09PSBcImR5bmFtaWNcIiAmJiBjb25maWcuY29tcGFyZVRvLnByb3BlcnR5UGF0aFxuICAgICAgICAgICAgICAgID8gZ2V0UHJvcGVydHkoY29tcGFyZWRWYWx1ZSwgY29uZmlnLmNvbXBhcmVUby5wcm9wZXJ0eVBhdGgpXG4gICAgICAgICAgICAgICAgOiBjb21wYXJlZFZhbHVlO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gY2FsY3VsYXRlQ29uZGl0aW9uKGxlZnRTaWRlLCByaWdodFNpZGUsIGNvbmRpdGlvbik7XG4gICAgICAgICAgICBjb25zdCBvdXRwdXRUb1VzZSA9IHJlc3VsdCA/IHRydWVPdXRwdXQgOiBmYWxzZU91dHB1dDtcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpZ1RvVXNlID0gcmVzdWx0ID8gdHJ1ZVZhbHVlIDogZmFsc2VWYWx1ZTtcbiAgICAgICAgICAgIGlmIChjb25maWdUb1VzZS50eXBlID09PSBcInZhbHVlXCIpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRUb1VzZS5uZXh0KGlucHV0cy52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjb25maWdUb1VzZS50eXBlID09PSBcImNvbXBhcmVUb1wiKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0VG9Vc2UubmV4dChjb21wYXJlZFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbmZpZ1RvVXNlLnR5cGUgPT09IFwiZXhwcmVzc2lvblwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXhwcmVzc2lvbiA9IGNvbmZpZ1RvVXNlLmRhdGE7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm5TdHIgPSBgKHZhbHVlLCBjb21wYXJlVG8pID0+ICR7ZXhwcmVzc2lvbn1gO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmbiA9IGV2YWwoZm5TdHIpO1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXRUb1VzZS5uZXh0KGZuKGlucHV0cy52YWx1ZSwgY29tcGFyZWRWYWx1ZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICBhZHYub25FcnJvcihlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdHlwZSAke2NvbmZpZ1RvVXNlLnR5cGV9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSxcbiAgICBkZWZpbml0aW9uQnVpbGRlcjogKGNvbmZpZykgPT4ge1xuICAgICAgICBjb25zdCBpbnB1dHMgPSBbXCJ2YWx1ZVwiXTtcbiAgICAgICAgaWYgKGNvbmZpZy5jb21wYXJlVG8ubW9kZSA9PT0gXCJkeW5hbWljXCIpIHtcbiAgICAgICAgICAgIGlucHV0cy5wdXNoKFwiY29tcGFyZVRvXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG91dHB1dHMgPSB7XG4gICAgICAgICAgICB0cnVlOiB7XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRW1pdHMgdGhlIHZhbHVlIGlmIHRoZSBjb25kaXRpb24gaXMgdHJ1ZVwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZhbHNlOiB7XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRW1pdHMgdGhlIHZhbHVlIGlmIHRoZSBjb25kaXRpb24gaXMgZmFsc2VcIixcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogY29uZGl0aW9uYWxDb25maWdUb0Rpc3BsYXlOYW1lKGNvbmZpZyksXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJFdmFsdWF0ZXMgYSBjb25kaXRpb24gYW5kIGVtaXRzIHRoZSB2YWx1ZSBvZiB0aGUgbWF0Y2hpbmcgY2FzZVwiLFxuICAgICAgICAgICAgaW5wdXRzOiBPYmplY3QuZnJvbUVudHJpZXMoaW5wdXRzLm1hcCgoaW5wdXQpID0+IFtpbnB1dCwge31dKSksXG4gICAgICAgICAgICBvdXRwdXRzLFxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZGVmYXVsdERhdGE6IHtcbiAgICAgICAgY29tcGFyZVRvOiB7IG1vZGU6IFwiZHluYW1pY1wiLCBwcm9wZXJ0eVBhdGg6IFwiXCIgfSxcbiAgICAgICAgcHJvcGVydHlQYXRoOiBcIlwiLFxuICAgICAgICBjb25kaXRpb246IHtcbiAgICAgICAgICAgIHR5cGU6IENvbmRpdGlvblR5cGUuRXF1YWwsXG4gICAgICAgIH0sXG4gICAgICAgIHRydWVWYWx1ZToge1xuICAgICAgICAgICAgdHlwZTogXCJ2YWx1ZVwiLFxuICAgICAgICB9LFxuICAgICAgICBmYWxzZVZhbHVlOiB7XG4gICAgICAgICAgICB0eXBlOiBcInZhbHVlXCIsXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICBlZGl0b3JDb25maWc6IHtcbiAgICAgICAgdHlwZTogXCJjdXN0b21cIixcbiAgICAgICAgZWRpdG9yQ29tcG9uZW50QnVuZGxlUGF0aDogXCIuLi8uLi9kaXN0L3VpL0NvbmRpdGlvbmFsLmpzXCIsXG4gICAgfSxcbn07XG5mdW5jdGlvbiBjYWxjdWxhdGVDb25kaXRpb24odmFsMSwgdmFsMiwgY29uZGl0aW9uKSB7XG4gICAgc3dpdGNoIChjb25kaXRpb24udHlwZSkge1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuRXF1YWw6XG4gICAgICAgICAgICByZXR1cm4gdmFsMSA9PT0gdmFsMjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLk5vdEVxdWFsOlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEgIT09IHZhbDI7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5HcmVhdGVyVGhhbjpcbiAgICAgICAgICAgIHJldHVybiB2YWwxID4gdmFsMjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkdyZWF0ZXJUaGFuT3JFcXVhbDpcbiAgICAgICAgICAgIHJldHVybiB2YWwxID49IHZhbDI7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5MZXNzVGhhbjpcbiAgICAgICAgICAgIHJldHVybiB2YWwxIDwgdmFsMjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkxlc3NUaGFuT3JFcXVhbDpcbiAgICAgICAgICAgIHJldHVybiB2YWwxIDw9IHZhbDI7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Db250YWluczpcbiAgICAgICAgICAgIHJldHVybiB2YWwxLmluY2x1ZGVzKHZhbDIpO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTm90Q29udGFpbnM6XG4gICAgICAgICAgICByZXR1cm4gIXZhbDEuaW5jbHVkZXModmFsMik7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Jc0VtcHR5OlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEgPT09IFwiXCI7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Jc05vdEVtcHR5OlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEgIT09IFwiXCI7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Jc051bGw6XG4gICAgICAgICAgICByZXR1cm4gdmFsMSA9PT0gbnVsbDtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLklzTm90TnVsbDpcbiAgICAgICAgICAgIHJldHVybiB2YWwxICE9PSBudWxsO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuSXNVbmRlZmluZWQ6XG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbDEgPT09IFwidW5kZWZpbmVkXCI7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5Jc05vdFVuZGVmaW5lZDpcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsMSAhPT0gXCJ1bmRlZmluZWRcIjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkhhc1Byb3BlcnR5OlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEuaGFzT3duUHJvcGVydHkodmFsMik7XG4gICAgICAgIGNhc2UgQ29uZGl0aW9uVHlwZS5MZW5ndGhFcXVhbDpcbiAgICAgICAgICAgIHJldHVybiB2YWwxLmxlbmd0aCA9PT0gdmFsMjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLkxlbmd0aE5vdEVxdWFsOlxuICAgICAgICAgICAgcmV0dXJuIHZhbDEubGVuZ3RoICE9PSB2YWwyO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTGVuZ3RoR3JlYXRlclRoYW46XG4gICAgICAgICAgICByZXR1cm4gdmFsMS5sZW5ndGggPiB2YWwyO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuTGVuZ3RoTGVzc1RoYW46XG4gICAgICAgICAgICByZXR1cm4gdmFsMS5sZW5ndGggPCB2YWwyO1xuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuVHlwZUVxdWFsczpcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsMSA9PT0gdmFsMjtcbiAgICAgICAgY2FzZSBDb25kaXRpb25UeXBlLlJlZ2V4TWF0Y2hlczoge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAodmFsMSkudGVzdCh2YWwyKTtcbiAgICAgICAgfVxuICAgICAgICBjYXNlIENvbmRpdGlvblR5cGUuRXhwcmVzc2lvbjoge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBmblN0ciA9IGAodmFsdWUsIGNvbXBhcmVUbykgPT4gJHtjb25kaXRpb24uZGF0YX1gO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZuID0gZXZhbChmblN0cik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuKHZhbDEsIHZhbDIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGdldFByb3BlcnR5KG9iaiwgcGF0aCkge1xuICAgIGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdChcIi5cIikuZmlsdGVyKChwKSA9PiBwICE9PSBcIlwiKTtcbiAgICBsZXQgY3VyciA9IG9iajtcbiAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMpIHtcbiAgICAgICAgaWYgKHBhcnQpIHtcbiAgICAgICAgfVxuICAgICAgICBjdXJyID0gY3VycltwYXJ0XTtcbiAgICB9XG4gICAgcmV0dXJuIGN1cnI7XG59XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vX19NYWNyb05vZGVfX0NvbmRpdGlvbmFsLy4vc3JjL0NvbnRyb2xGbG93L0NvbmRpdGlvbmFsLmZseWRlLnRzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi9zcmMvQ29udHJvbEZsb3cvQ29uZGl0aW9uYWwudHN4IjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4vc3JjL0NvbnRyb2xGbG93L0NvbmRpdGlvbmFsLnRzeCAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoZnVuY3Rpb24oX191bnVzZWRfd2VicGFja19tb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKZXZhbCgiXG52YXIgX19jcmVhdGVCaW5kaW5nID0gKHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG4gICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgIGRlc2MgPSB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0KSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCB2KSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xufSkgOiBmdW5jdGlvbihvLCB2KSB7XG4gICAgb1tcImRlZmF1bHRcIl0gPSB2O1xufSk7XG52YXIgX19pbXBvcnRTdGFyID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydFN0YXIpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuY29uc3QgY29yZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQGJsdWVwcmludGpzL2NvcmUgKi8gXCJAYmx1ZXByaW50anMvY29yZVwiKTtcbmNvbnN0IENvbnRyb2xGbG93X2ZseWRlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISAuL0NvbnRyb2xGbG93LmZseWRlICovIFwiLi9zcmMvQ29udHJvbEZsb3cvQ29udHJvbEZsb3cuZmx5ZGUudHNcIik7XG5jb25zdCByZWFjdF8xID0gX19pbXBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0ICovIFwicmVhY3RcIikpO1xuY29uc3QgU2ltcGxlSnNvbkVkaXRvcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi4vbGliL1NpbXBsZUpzb25FZGl0b3IgKi8gXCIuL3NyYy9saWIvU2ltcGxlSnNvbkVkaXRvci50c3hcIik7XG5jb25zdCBjb25kaXRpb25FbnVtVG9MYWJlbCA9IHtcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLkVxdWFsXTogXCJFcXVhbFwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuTm90RXF1YWxdOiBcIk5vdCBFcXVhbFwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuR3JlYXRlclRoYW5dOiBcIkdyZWF0ZXIgVGhhblwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuR3JlYXRlclRoYW5PckVxdWFsXTogXCJHcmVhdGVyIFRoYW4gT3IgRXF1YWxcIixcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLkxlc3NUaGFuXTogXCJMZXNzIFRoYW5cIixcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLkxlc3NUaGFuT3JFcXVhbF06IFwiTGVzcyBUaGFuIE9yIEVxdWFsXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5FeHByZXNzaW9uXTogXCJKUyBFeHByZXNzaW9uXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5SZWdleE1hdGNoZXNdOiBcIlJlZ2V4IE1hdGNoZXNcIixcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLkNvbnRhaW5zXTogXCJDb250YWluc1wiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuTm90Q29udGFpbnNdOiBcIk5vdCBDb250YWluc1wiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuSXNFbXB0eV06IFwiSXMgRW1wdHlcIixcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLklzTm90RW1wdHldOiBcIklzIE5vdCBFbXB0eVwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuSXNOdWxsXTogXCJJcyBOdWxsXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5Jc05vdE51bGxdOiBcIklzIE5vdCBOdWxsXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5Jc1VuZGVmaW5lZF06IFwiSXMgVW5kZWZpbmVkXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5Jc05vdFVuZGVmaW5lZF06IFwiSXMgTm90IFVuZGVmaW5lZFwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuSGFzUHJvcGVydHldOiBcIkhhcyBQcm9wZXJ0eVwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuTGVuZ3RoRXF1YWxdOiBcIkxlbmd0aCBFcXVhbFwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuTGVuZ3RoTm90RXF1YWxdOiBcIkxlbmd0aCBOb3QgRXF1YWxcIixcbiAgICBbQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLkxlbmd0aEdyZWF0ZXJUaGFuXTogXCJMZW5ndGggR3JlYXRlciBUaGFuXCIsXG4gICAgW0NvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5MZW5ndGhMZXNzVGhhbl06IFwiTGVuZ3RoIExlc3MgVGhhblwiLFxuICAgIFtDb250cm9sRmxvd19mbHlkZV8xLkNvbmRpdGlvblR5cGUuVHlwZUVxdWFsc106IFwiVHlwZSBFcXVhbHNcIixcbn07XG5jb25zdCBDb25kaXRpb25hbEVkaXRvciA9IGZ1bmN0aW9uIENvbmRpdGlvbmFsRWRpdG9yKHByb3BzKSB7XG4gICAgY29uc3QgeyB2YWx1ZSwgb25DaGFuZ2UgfSA9IHByb3BzO1xuICAgIGNvbnN0IFt1c2VQcm9wUGF0aFZhbHVlLCBzZXRVc2VQcm9wUGF0aFZhbHVlXSA9IHJlYWN0XzEuZGVmYXVsdC51c2VTdGF0ZSh2YWx1ZS5wcm9wZXJ0eVBhdGggIT09IFwiXCIpO1xuICAgIGNvbnN0IFt1c2VQcm9wUGF0aENvbXBhcmVUbywgc2V0VXNlUHJvcFBhdGhDb21wYXJlVG9dID0gcmVhY3RfMS5kZWZhdWx0LnVzZVN0YXRlKHZhbHVlLmNvbXBhcmVUby5tb2RlID09PSBcImR5bmFtaWNcIiAmJiB2YWx1ZS5jb21wYXJlVG8ucHJvcGVydHlQYXRoICE9PSBcIlwiKTtcbiAgICBjb25zdCBtYXliZUNvbXBhcmVUb0VkaXRvciA9ICgwLCByZWFjdF8xLnVzZU1lbW8pKCgpID0+IHtcbiAgICAgICAgaWYgKHZhbHVlLmNvbXBhcmVUby5tb2RlICE9PSBcInN0YXRpY1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHZhbHVlLmNvbXBhcmVUby50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFwic3RyaW5nXCI6IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgbGFiZWw6IFwiRXhwZWN0ZWQgdmFsdWVcIiB9LFxuICAgICAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuSW5wdXRHcm91cCwgeyB2YWx1ZTogdmFsdWUuY29tcGFyZVRvLnZhbHVlLCBvbkNoYW5nZTogKGUpID0+IG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wYXJlVG86IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZTogXCJzdGF0aWNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSB9KSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBcIm51bWJlclwiOiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIkV4cGVjdGVkIHZhbHVlXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLk51bWVyaWNJbnB1dCwgeyB2YWx1ZTogdmFsdWUuY29tcGFyZVRvLnZhbHVlLCBvblZhbHVlQ2hhbmdlOiAoZSkgPT4gb25DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhcmVUbzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiBcInN0YXRpY1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgXCJqc29uXCI6IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgbGFiZWw6IFwiRXhwZWN0ZWQgdmFsdWVcIiwgaGVscGVyVGV4dDogYEFueSBKUyBleHByZXNzaW9uIGlzIHZhbGlkIGhlcmUuIFlvdSBtYXkgdXNlIFwidmFsdWVcIiBhbmQgXCJjb21wYXJlVG9cIiB2YXJpYWJsZXMgaW4geW91ciBleHByZXNzaW9uLmAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoU2ltcGxlSnNvbkVkaXRvcl8xLlNpbXBsZUpzb25FZGl0b3IsIHsgdmFsdWU6IHZhbHVlLmNvbXBhcmVUby52YWx1ZSwgb25DaGFuZ2U6ICh2YWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wYXJlVG86IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6IFwic3RhdGljXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImpzb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBsYWJlbDogXCJFeHBlY3RlZCBWYWx1ZVwiIH0pKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCBbdmFsdWVdKTtcbiAgICByZXR1cm4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KHJlYWN0XzEuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJDb25kaXRpb24gVHlwZVwiLCBpbmxpbmU6IHRydWUgfSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5IVE1MU2VsZWN0LCB7IGZpbGw6IHRydWUsIHZhbHVlOiB2YWx1ZS5jb25kaXRpb24udHlwZSwgb25DaGFuZ2U6IChlKSA9PiBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBjb25kaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZS50YXJnZXQudmFsdWUgPT09IENvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5FeHByZXNzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcInZhbHVlIC8gY29tcGFyZVRvID09PSA0MlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSkgfSwgT2JqZWN0LmVudHJpZXMoY29uZGl0aW9uRW51bVRvTGFiZWwpLm1hcCgoW3ZhbHVlLCBsYWJlbF0pID0+IChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiLCB7IGtleTogdmFsdWUsIHZhbHVlOiB2YWx1ZSB9LCBsYWJlbCkpKSkpLFxuICAgICAgICB2YWx1ZS5jb25kaXRpb24udHlwZSA9PT0gQ29udHJvbEZsb3dfZmx5ZGVfMS5Db25kaXRpb25UeXBlLkV4cHJlc3Npb24gJiYgKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgbGFiZWw6IFwiQ29uZGl0aW9uIGV4cHJlc3Npb25cIiwgaGVscGVyVGV4dDogYEFueSBKUyBleHByZXNzaW9uIGlzIHZhbGlkIGhlcmUuIFlvdSBtYXkgdXNlIFwidmFsdWVcIiBhbmQgXCJjb21wYXJlVG9cIiB2YXJpYWJsZXMgaW4geW91ciBleHByZXNzaW9uLmAgfSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5JbnB1dEdyb3VwLCB7IHZhbHVlOiB2YWx1ZS5jb25kaXRpb24uZGF0YSwgb25DaGFuZ2U6IChlKSA9PiBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBjb25kaXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IENvbnRyb2xGbG93X2ZseWRlXzEuQ29uZGl0aW9uVHlwZS5FeHByZXNzaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZS50YXJnZXQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSkgfSkpKSxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkRpdmlkZXIsIG51bGwpLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIlZhbHVlIHRvIGNvbXBhcmUgbW9kZTpcIiwgaW5saW5lOiB0cnVlIH0sXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuSFRNTFNlbGVjdCwgeyB2YWx1ZTogdmFsdWUuY29tcGFyZVRvLm1vZGUsIG9uQ2hhbmdlOiAoZSkgPT4gb25DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAuLi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgY29tcGFyZVRvOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlLnRhcmdldC52YWx1ZSA9PT0gXCJzdGF0aWNcIiA/IFwiXCIgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBlLnRhcmdldC52YWx1ZSA9PT0gXCJzdGF0aWNcIiA/IFwic3RyaW5nXCIgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSkgfSxcbiAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiLCB7IHZhbHVlOiBcInN0YXRpY1wiIH0sIFwiU3RhdGljXCIpLFxuICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHsgdmFsdWU6IFwiZHluYW1pY1wiIH0sIFwiRHluYW1pYyAodmlhIGlucHV0KVwiKSkpLFxuICAgICAgICB2YWx1ZS5jb21wYXJlVG8ubW9kZSA9PT0gXCJzdGF0aWNcIiAmJiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJWYWx1ZSB0byBjb21wYXJlIHR5cGU6XCIsIGlubGluZTogdHJ1ZSB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkhUTUxTZWxlY3QsIHsgdmFsdWU6IHZhbHVlLmNvbXBhcmVUby50eXBlLCBvbkNoYW5nZTogKGUpID0+IG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbXBhcmVUbzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZTogXCJzdGF0aWNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlLnRhcmdldC52YWx1ZSA9PT0gXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogZS50YXJnZXQudmFsdWUgPT09IFwibnVtYmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJ2YWx1ZSAvIDQyID4gY29tcGFyZVRvXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KSB9LFxuICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHsgdmFsdWU6IFwic3RyaW5nXCIgfSwgXCJTdHJpbmdcIiksXG4gICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJudW1iZXJcIiB9LCBcIk51bWJlclwiKSxcbiAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiLCB7IHZhbHVlOiBcImV4cHJlc3Npb25cIiB9LCBcIkpTIEV4cHJlc3Npb25cIikpKSksXG4gICAgICAgIG1heWJlQ29tcGFyZVRvRWRpdG9yLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRGl2aWRlciwgbnVsbCksXG4gICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgbGFiZWw6IFwiVmFsdWUgdG8gZW1pdCBpZiB0cnVlXCIsIGlubGluZTogdHJ1ZSB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkhUTUxTZWxlY3QsIHsgZmlsbDogdHJ1ZSwgdmFsdWU6IHZhbHVlLnRydWVWYWx1ZS50eXBlLCBvbkNoYW5nZTogKGUpID0+IG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIHRydWVWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogZS50YXJnZXQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBlLnRhcmdldC52YWx1ZSA9PT0gXCJleHByZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwidmFsdWUgLyBjb21wYXJlVG8gPT09IDQyID8gJ3llcycgOiAnbm8nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KSB9LFxuICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHsgdmFsdWU6IFwidmFsdWVcIiB9LCBcIlZhbHVlXCIpLFxuICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHsgdmFsdWU6IFwiY29tcGFyZVRvXCIgfSwgXCJDb21wYXJlIHRvIHZhbHVlXCIpLFxuICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHsgdmFsdWU6IFwiZXhwcmVzc2lvblwiIH0sIFwiQ3VzdG9tIGV4cHJlc3Npb25cIikpKSxcbiAgICAgICAgdmFsdWUudHJ1ZVZhbHVlLnR5cGUgPT09IFwiZXhwcmVzc2lvblwiICYmIChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIkV4cHJlc3Npb24gdG8gdXNlIGlmIHRydWU6XCIsIGhlbHBlclRleHQ6IFwiQW55IEpTIGV4cHJlc3Npb24gaXMgdmFsaWQgaGVyZS4gWW91IG1heSB1c2UgJ3ZhbHVlJyBhbmQgJ2NvbXBhcmVUbycgdmFyaWFibGVzIGluIHlvdXIgZXhwcmVzc2lvbi5cIiB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdmFsdWU6IHZhbHVlLnRydWVWYWx1ZS5kYXRhLCBvbkNoYW5nZTogKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnVlVmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImV4cHJlc3Npb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gfSkpKSxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJWYWx1ZSB0byBlbWl0IGlmIGZhbHNlXCIsIGlubGluZTogdHJ1ZSB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkhUTUxTZWxlY3QsIHsgZmlsbDogdHJ1ZSwgdmFsdWU6IHZhbHVlLmZhbHNlVmFsdWUudHlwZSwgb25DaGFuZ2U6IChlKSA9PiBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBmYWxzZVZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGUudGFyZ2V0LnZhbHVlID09PSBcImV4cHJlc3Npb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gXCJ2YWx1ZSAvIGNvbXBhcmVUbyA9PT0gNDIgPyAneWVzJyA6ICdubydcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pIH0sXG4gICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJ2YWx1ZVwiIH0sIFwiVmFsdWVcIiksXG4gICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJjb21wYXJlVG9cIiB9LCBcIkNvbXBhcmUgdG8gdmFsdWVcIiksXG4gICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJleHByZXNzaW9uXCIgfSwgXCJDdXN0b20gZXhwcmVzc2lvblwiKSkpLFxuICAgICAgICB2YWx1ZS5mYWxzZVZhbHVlLnR5cGUgPT09IFwiZXhwcmVzc2lvblwiICYmIChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIkV4cHJlc3Npb24gdG8gdXNlIGlmIGZhbHNlOlwiLCBoZWxwZXJUZXh0OiBcIkFueSBKUyBleHByZXNzaW9uIGlzIHZhbGlkIGhlcmUuIFlvdSBtYXkgdXNlICd2YWx1ZScgYW5kICdjb21wYXJlVG8nIHZhcmlhYmxlcyBpbiB5b3VyIGV4cHJlc3Npb24uXCIgfSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5JbnB1dEdyb3VwLCB7IHZhbHVlOiB2YWx1ZS5mYWxzZVZhbHVlLmRhdGEsIG9uQ2hhbmdlOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlVmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImV4cHJlc3Npb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gfSkpKSxcbiAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkRpdmlkZXIsIG51bGwpLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGhlbHBlclRleHQ6IFwiSWYgdGhlIGlucHV0IHZhbHVlIGlzIGFuIG9iamVjdCBvciBhIGxpc3QsIHlvdSBjYW4gc3BlY2lmeSBhIHBhdGggdG8gdGhlIHByb3BlcnR5IHRoYXQgdGhlIGNvbmRpdGlvbiB3aWxsIGJlIGFwcGxpZWQgdG9cIiB9LFxuICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkNoZWNrYm94LCB7IGxhYmVsOiBcIlVzZSBwcm9wZXJ0eSBwYXRoIGZvciBpbnB1dCB2YWx1ZVwiLCBjaGVja2VkOiB1c2VQcm9wUGF0aFZhbHVlLCBvbkNoYW5nZTogKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsID0gZS50YXJnZXQuY2hlY2tlZDtcbiAgICAgICAgICAgICAgICAgICAgc2V0VXNlUHJvcFBhdGhWYWx1ZSh2YWwpO1xuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5UGF0aDogdmFsID8gdmFsdWUucHJvcGVydHlQYXRoIDogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSB9KSksXG4gICAgICAgIHVzZVByb3BQYXRoVmFsdWUgJiYgKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgbGFiZWw6IFwiSW5wdXQgdmFsdWUgcHJvcGVydHkgcGF0aFwiLCBoZWxwZXJUZXh0OiBcIklmIHRoZSBpbnB1dCB2YWx1ZSBpcyBhbiBvYmplY3Qgb3IgYSBsaXN0LCB5b3UgY2FuIHNwZWNpZnkgYSBwYXRoIHRvIHRoZSBwcm9wZXJ0eSB0aGF0IHRoZSBjb25kaXRpb24gd2lsbCBiZSBhcHBsaWVkIHRvXCIgfSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5JbnB1dEdyb3VwLCB7IHZhbHVlOiB2YWx1ZS5wcm9wZXJ0eVBhdGgsIG9uQ2hhbmdlOiAoZSkgPT4gb25DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAuLi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlQYXRoOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICB9KSB9KSkpLFxuICAgICAgICB2YWx1ZS5jb21wYXJlVG8ubW9kZSA9PT0gXCJkeW5hbWljXCIgJiYgKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KHJlYWN0XzEuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5EaXZpZGVyLCBudWxsKSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgaGVscGVyVGV4dDogXCJJZiB0aGUgY29tcGFyZVRvIHZhbHVlIGlzIGFuIG9iamVjdCBvciBhIGxpc3QsIHlvdSBjYW4gc3BlY2lmeSBhIHBhdGggdG8gdGhlIHByb3BlcnR5IHRoYXQgdGhlIGNvbmRpdGlvbiB3aWxsIGJlIGFwcGxpZWQgdG9cIiB9LFxuICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5DaGVja2JveCwgeyBsYWJlbDogXCJVc2UgcHJvcGVydHkgcGF0aCBmb3IgY29tcGFyZVRvIHZhbHVlXCIsIGNoZWNrZWQ6IHVzZVByb3BQYXRoQ29tcGFyZVRvLCBvbkNoYW5nZTogKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbCA9IGUudGFyZ2V0LmNoZWNrZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRVc2VQcm9wUGF0aENvbXBhcmVUbyh2YWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhcmVUbzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiBcImR5bmFtaWNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlQYXRoOiB2YWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdmFsdWUuY29tcGFyZVRvLm1vZGUgPT09IFwiZHluYW1pY1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB2YWx1ZS5jb21wYXJlVG8ucHJvcGVydHlQYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IH0pKSkpLFxuICAgICAgICB2YWx1ZS5jb21wYXJlVG8ubW9kZSA9PT0gXCJkeW5hbWljXCIgJiYgdXNlUHJvcFBhdGhDb21wYXJlVG8gJiYgKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5Gb3JtR3JvdXAsIHsgbGFiZWw6IFwiQ29tcGFyZSB0byB2YWx1ZSBwcm9wZXJ0eSBwYXRoXCIsIGhlbHBlclRleHQ6IFwiSWYgdGhlIGNvbXBhcmUgdG8gdmFsdWUgaXMgYW4gb2JqZWN0IG9yIGEgbGlzdCwgeW91IGNhbiBzcGVjaWZ5IGEgcGF0aCB0byB0aGUgcHJvcGVydHkgdGhhdCB0aGUgY29uZGl0aW9uIHdpbGwgYmUgYXBwbGllZCB0b1wiIH0sXG4gICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuSW5wdXRHcm91cCwgeyB2YWx1ZTogdmFsdWUuY29tcGFyZVRvLnByb3BlcnR5UGF0aCwgb25DaGFuZ2U6IChlKSA9PiBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBjb21wYXJlVG86IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6IFwiZHluYW1pY1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlQYXRoOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KSB9KSkpKSk7XG59O1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBDb25kaXRpb25hbEVkaXRvcjtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9fX01hY3JvTm9kZV9fQ29uZGl0aW9uYWwvLi9zcmMvQ29udHJvbEZsb3cvQ29uZGl0aW9uYWwudHN4PyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi9zcmMvQ29udHJvbEZsb3cvQ29udHJvbEZsb3cuZmx5ZGUudHMiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiAuL3NyYy9Db250cm9sRmxvdy9Db250cm9sRmxvdy5mbHlkZS50cyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwpldmFsKCJcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19leHBvcnRTdGFyID0gKHRoaXMgJiYgdGhpcy5fX2V4cG9ydFN0YXIpIHx8IGZ1bmN0aW9uKG0sIGV4cG9ydHMpIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGV4cG9ydHMsIHApKSBfX2NyZWF0ZUJpbmRpbmcoZXhwb3J0cywgbSwgcCk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLkVtaXRPblRyaWdnZXIgPSBleHBvcnRzLkJvb2xlYW5TcGxpdCA9IGV4cG9ydHMuU3Vic2NyaWJlID0gZXhwb3J0cy5QdWJsaXNoID0gZXhwb3J0cy5Sb3VuZFJvYmluID0gZXhwb3J0cy5MaW1pdFRpbWVzID0gdm9pZCAwO1xuX19leHBvcnRTdGFyKF9fd2VicGFja19yZXF1aXJlX18oLyohIC4vQ29uZGl0aW9uYWwuZmx5ZGUgKi8gXCIuL3NyYy9Db250cm9sRmxvdy9Db25kaXRpb25hbC5mbHlkZS50c1wiKSwgZXhwb3J0cyk7XG5fX2V4cG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgLi9Td2l0Y2guZmx5ZGUgKi8gXCIuL3NyYy9Db250cm9sRmxvdy9Td2l0Y2guZmx5ZGUudHNcIiksIGV4cG9ydHMpO1xuY29uc3QgUHViU3ViID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcHVic3ViLWpzICovIFwiLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3B1YnN1Yi1qc0AxLjkuNC9ub2RlX21vZHVsZXMvcHVic3ViLWpzL3NyYy9wdWJzdWIuanNcIik7XG5jb25zdCBuYW1lc3BhY2UgPSBcIkNvbnRyb2wgRmxvd1wiO1xuZXhwb3J0cy5MaW1pdFRpbWVzID0ge1xuICAgIGlkOiBcIkxpbWl0IFRpbWVzXCIsXG4gICAgbmFtZXNwYWNlLFxuICAgIGRlc2NyaXB0aW9uOiBcIkl0ZW0gd2lsbCBiZSBlbWl0dGVkIHVudGlsIHRoZSBsaW1pdCBpcyByZWFjaGVkXCIsXG4gICAgaW5wdXRzOiB7XG4gICAgICAgIGl0ZW06IHsgbW9kZTogXCJyZXF1aXJlZFwiLCBkZXNjcmlwdGlvbjogXCJUaGUgaXRlbSB0byBlbWl0XCIgfSxcbiAgICAgICAgdGltZXM6IHtcbiAgICAgICAgICAgIG1vZGU6IFwicmVxdWlyZWRcIixcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBudW1iZXIgb2YgdGltZXMgdG8gZW1pdCB0aGUgaXRlbVwiLFxuICAgICAgICB9LFxuICAgICAgICByZXNldDogeyBtb2RlOiBcIm9wdGlvbmFsXCIsIGRlc2NyaXB0aW9uOiBcIlJlc2V0IHRoZSBjb3VudGVyXCIgfSxcbiAgICB9LFxuICAgIG91dHB1dHM6IHsgb2s6IHt9IH0sXG4gICAgcmVhY3RpdmVJbnB1dHM6IFtcIml0ZW1cIiwgXCJyZXNldFwiXSxcbiAgICBjb21wbGV0aW9uT3V0cHV0czogW10sXG4gICAgcnVuOiBmdW5jdGlvbiAoaW5wdXRzLCBvdXRwdXRzLCBhZHYpIHtcbiAgICAgICAgLy8gbWFnaWMgaGVyZVxuICAgICAgICBjb25zdCB7IHN0YXRlIH0gPSBhZHY7XG4gICAgICAgIGNvbnN0IHsgaXRlbSwgdGltZXMsIHJlc2V0IH0gPSBpbnB1dHM7XG4gICAgICAgIGNvbnN0IHsgb2sgfSA9IG91dHB1dHM7XG4gICAgICAgIGlmICh0eXBlb2YgcmVzZXQgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIHN0YXRlLnNldChcInZhbFwiLCAwKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgY3VyciA9IHN0YXRlLmdldChcInZhbFwiKSB8fCAwO1xuICAgICAgICBjdXJyKys7XG4gICAgICAgIHN0YXRlLnNldChcInZhbFwiLCBjdXJyKTtcbiAgICAgICAgaWYgKGN1cnIgPj0gdGltZXMpIHtcbiAgICAgICAgICAgIGFkdi5vbkVycm9yKG5ldyBFcnJvcihgTGltaXQgb2YgJHt0aW1lc30gcmVhY2hlZGApKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG9rLm5leHQoaXRlbSk7XG4gICAgICAgIH1cbiAgICB9LFxufTtcbmV4cG9ydHMuUm91bmRSb2JpbiA9IHtcbiAgICBpZDogXCJSb3VuZFJvYmluXCIsXG4gICAgZGVmYXVsdFN0eWxlOiB7XG4gICAgICAgIGljb246IFwicm90YXRlXCIsXG4gICAgfSxcbiAgICBkaXNwbGF5TmFtZTogXCJSb3VuZCBSb2JpblwiLFxuICAgIG5hbWVzcGFjZSxcbiAgICBkZWZhdWx0RGF0YTogeyBjb3VudDogMyB9LFxuICAgIGRlZmluaXRpb25CdWlsZGVyOiAoeyBjb3VudCB9KSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogYFJvdW5kIFJvYmluICR7Y291bnR9YCxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgSXRlbSB3aWxsIGJlIGVtaXR0ZWQgdG8gb25lIG9mIHRoZSAke2NvdW50fSBvdXRwdXRzIGluIGEgcm91bmQgcm9iaW4gZmFzaGlvbmAsXG4gICAgICAgICAgICBpbnB1dHM6IHsgdmFsdWU6IHsgbW9kZTogXCJyZXF1aXJlZFwiLCBkZXNjcmlwdGlvbjogXCJUaGUgdmFsdWUgdG8gZW1pdFwiIH0gfSxcbiAgICAgICAgICAgIGNvbXBsZXRpb25PdXRwdXRzOiBbXSxcbiAgICAgICAgICAgIHJlYWN0aXZlSW5wdXRzOiBbXCJ2YWx1ZVwiXSxcbiAgICAgICAgICAgIG91dHB1dHM6IEFycmF5LmZyb20oeyBsZW5ndGg6IGNvdW50IH0pLnJlZHVjZSgob2JqLCBfLCBpKSA9PiAoe1xuICAgICAgICAgICAgICAgIC4uLm9iaixcbiAgICAgICAgICAgICAgICBbYHIke2kgKyAxfWBdOiB7XG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgVGhlICR7aSArIDF9IG91dHB1dCBpbiBvcmRlciB0byBlbWl0IHRoZSB2YWx1ZSByZWNlaXZlZC4gQWZ0ZXIgZW1pdHRpbmcgYSB2YWx1ZSwgaXQgbW92ZXMgdG8gXCJyJHsoaSArIDIpICUgY291bnR9XCIncyB0dXJuLmAsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pLCB7fSksXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBydW5GbkJ1aWxkZXI6ICh7IGNvdW50IH0pID0+IHtcbiAgICAgICAgcmV0dXJuIChpbnB1dHMsIF9vdXRwdXRzLCBhZHYpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgc3RhdGUgfSA9IGFkdjtcbiAgICAgICAgICAgIGNvbnN0IG91dHB1dHMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBjb3VudCB9KS5tYXAoKF8sIGkpID0+IF9vdXRwdXRzW2ByJHtpICsgMX1gXSk7XG4gICAgICAgICAgICBjb25zdCBjdXJyID0gc3RhdGUuZ2V0KFwiY3VyclwiKSB8fCAwO1xuICAgICAgICAgICAgY29uc3QgbyA9IG91dHB1dHNbY3Vycl07XG4gICAgICAgICAgICBjb25zdCBuZXh0Q3VyciA9IChjdXJyICsgMSkgJSBjb3VudDtcbiAgICAgICAgICAgIHN0YXRlLnNldChcImN1cnJcIiwgbmV4dEN1cnIpO1xuICAgICAgICAgICAgby5uZXh0KGlucHV0cy5pdGVtKTtcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGVkaXRvckNvbmZpZzoge1xuICAgICAgICB0eXBlOiBcInN0cnVjdHVyZWRcIixcbiAgICAgICAgZmllbGRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdHlwZToge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogXCJudW1iZXJcIixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNvbmZpZ0tleTogXCJjb3VudFwiLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBcIkNvdW50XCIsXG4gICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAzLFxuICAgICAgICAgICAgICAgIGFsbG93RHluYW1pYzogZmFsc2UsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgIH0sXG59O1xuZXhwb3J0cy5QdWJsaXNoID0ge1xuICAgIGlkOiBcIlB1Ymxpc2hcIixcbiAgICBuYW1lc3BhY2UsXG4gICAgZGVzY3JpcHRpb246IFwiUHVibGlzaGVzIGEgdmFsdWUgYnkgYSBrZXkgdG8gYWxsIGxpc3RlbmVycyBpbiB0aGUgY3VycmVudCBmbG93LiBVc2UgJ1N1YnNjcmliZScgdG8gbGlzdGVuIHRvIGV2ZW50cy5cIixcbiAgICBpbnB1dHM6IHtcbiAgICAgICAga2V5OiB7XG4gICAgICAgICAgICBtb2RlOiBcInJlcXVpcmVkXCIsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJBIGtleSB0byB1c2UgdG8gc3Vic2NyaWJlIHRvIHZhbHVlc1wiLFxuICAgICAgICB9LFxuICAgICAgICB2YWx1ZTogeyBtb2RlOiBcInJlcXVpcmVkXCIgfSxcbiAgICB9LFxuICAgIG91dHB1dHM6IHt9LFxuICAgIHJ1bjogZnVuY3Rpb24gKGlucHV0cywgXywgYWR2KSB7XG4gICAgICAgIC8vIG1hZ2ljIGhlcmVcbiAgICAgICAgY29uc3QgbnNLZXkgPSBgJHthZHYuYW5jZXN0b3JzSW5zSWRzfV9fJHtpbnB1dHMua2V5fWA7XG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKG5zS2V5LCBpbnB1dHMudmFsdWUpO1xuICAgIH0sXG59O1xuZXhwb3J0cy5TdWJzY3JpYmUgPSB7XG4gICAgaWQ6IFwiU3Vic2NyaWJlXCIsXG4gICAgbmFtZXNwYWNlLFxuICAgIGRlc2NyaXB0aW9uOiBcIlN1YnNjcmliZXMgdG8gYSB2YWx1ZSBwdWJsaXNoZWQgYnkgYSBrZXkuIFVzZSAnUHVibGlzaCcgdG8gcHVibGlzaCB2YWx1ZXMuXCIsXG4gICAgaW5wdXRzOiB7XG4gICAgICAgIGtleToge1xuICAgICAgICAgICAgbW9kZTogXCJyZXF1aXJlZFwiLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQSBrZXkgdG8gdXNlIHRvIHN1YnNjcmliZSB0byB2YWx1ZXNcIixcbiAgICAgICAgfSxcbiAgICAgICAgaW5pdGlhbDoge1xuICAgICAgICAgICAgbW9kZTogXCJyZXF1aXJlZC1pZi1jb25uZWN0ZWRcIixcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIklmIHBhc3NlZCB3aWxsIGJlIHB1Ymxpc2hlZCBoYXMgdGhlIGZpcnN0IHZhbHVlXCIsXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICBjb21wbGV0aW9uT3V0cHV0czogW10sXG4gICAgb3V0cHV0czogeyB2YWx1ZTogeyBkZXNjcmlwdGlvbjogXCJUaGUgdmFsdWUgcHVibGlzaGVkIGJ5IHRoZSBrZXlcIiB9IH0sXG4gICAgcnVuOiBmdW5jdGlvbiAoaW5wdXRzLCBvdXRwdXRzLCBhZHYpIHtcbiAgICAgICAgY29uc3QgeyB2YWx1ZSB9ID0gb3V0cHV0cztcbiAgICAgICAgY29uc3QgbnNLZXkgPSBgJHthZHYuYW5jZXN0b3JzSW5zSWRzfV9fJHtpbnB1dHMua2V5fWA7XG4gICAgICAgIGNvbnN0IHRva2VuID0gUHViU3ViLnN1YnNjcmliZShuc0tleSwgKF8sIGRhdGEpID0+IHtcbiAgICAgICAgICAgIHZhbHVlLm5leHQoZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodHlwZW9mIGlucHV0cy5pbml0aWFsICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB2YWx1ZS5uZXh0KGlucHV0cy5pbml0aWFsKTtcbiAgICAgICAgfVxuICAgICAgICBhZHYub25DbGVhbnVwKCgpID0+IHtcbiAgICAgICAgICAgIFB1YlN1Yi51bnN1YnNjcmliZSh0b2tlbik7XG4gICAgICAgIH0pO1xuICAgIH0sXG59O1xuZXhwb3J0cy5Cb29sZWFuU3BsaXQgPSB7XG4gICAgbmFtZXNwYWNlLFxuICAgIGlkOiBcIkJvb2xlYW4gU3BsaXRcIixcbiAgICBkZXNjcmlwdGlvbjogXCJTcGxpdHMgYSBib29sZWFuIHZhbHVlIGludG8gdHdvIG91dHB1dHNcIixcbiAgICBpbnB1dHM6IHtcbiAgICAgICAgdmFsdWU6IHsgbW9kZTogXCJyZXF1aXJlZFwiLCBkZXNjcmlwdGlvbjogXCJCb29sZWFuIHZhbHVlXCIgfSxcbiAgICAgICAgdHJ1ZVZhbHVlOiB7XG4gICAgICAgICAgICBtb2RlOiBcInJlcXVpcmVkLWlmLWNvbm5lY3RlZFwiLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVmFsdWUgdG8gZW1pdCBpZiB0aGUgaW5wdXQgaXMgdHJ1ZS4gRGVmYXVsdHMgdG8gdHJ1ZVwiLFxuICAgICAgICB9LFxuICAgICAgICBmYWxzZVZhbHVlOiB7XG4gICAgICAgICAgICBtb2RlOiBcInJlcXVpcmVkLWlmLWNvbm5lY3RlZFwiLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVmFsdWUgdG8gZW1pdCBpZiB0aGUgaW5wdXQgaXMgZmFsc2UuIERlZmF1bHRzIHRvIGZhbHNlXCIsXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICBvdXRwdXRzOiB7XG4gICAgICAgIHRydWU6IHsgZGVzY3JpcHRpb246IFwiVGhlIHZhbHVlIGlzIHRydWVcIiB9LFxuICAgICAgICBmYWxzZTogeyBkZXNjcmlwdGlvbjogXCJUaGUgdmFsdWUgaXMgZmFsc2VcIiB9LFxuICAgIH0sXG4gICAgcnVuOiBmdW5jdGlvbiAoaW5wdXRzLCBvdXRwdXRzKSB7XG4gICAgICAgIGNvbnN0IHsgdHJ1ZTogdHJ1ZU91dHB1dCwgZmFsc2U6IGZhbHNlT3V0cHV0IH0gPSBvdXRwdXRzO1xuICAgICAgICBjb25zdCB7IHZhbHVlLCB0cnVlVmFsdWUsIGZhbHNlVmFsdWUgfSA9IGlucHV0cztcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICB0cnVlT3V0cHV0Lm5leHQodHJ1ZVZhbHVlICE9PSBudWxsICYmIHRydWVWYWx1ZSAhPT0gdm9pZCAwID8gdHJ1ZVZhbHVlIDogdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmYWxzZU91dHB1dC5uZXh0KGZhbHNlVmFsdWUgIT09IG51bGwgJiYgZmFsc2VWYWx1ZSAhPT0gdm9pZCAwID8gZmFsc2VWYWx1ZSA6IGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0sXG59O1xuZXhwb3J0cy5FbWl0T25UcmlnZ2VyID0ge1xuICAgIG5hbWVzcGFjZSxcbiAgICBpZDogXCJFbWl0IG9uIFRyaWdnZXJcIixcbiAgICBkZXNjcmlwdGlvbjogXCJFbWl0cyB0aGUgdmFsdWUgd2hlbiB0aGUgdHJpZ2dlciBpbnB1dCByZWNlaXZlcyBhbnkgdmFsdWVcIixcbiAgICBpbnB1dHM6IHtcbiAgICAgICAgdmFsdWU6IHsgbW9kZTogXCJyZXF1aXJlZFwiLCBkZXNjcmlwdGlvbjogXCJUaGUgdmFsdWUgdG8gZW1pdFwiIH0sXG4gICAgICAgIHRyaWdnZXI6IHsgbW9kZTogXCJyZXF1aXJlZFwiLCBkZXNjcmlwdGlvbjogXCJUaGUgdHJpZ2dlciB0byBlbWl0IHRoZSB2YWx1ZVwiIH0sXG4gICAgfSxcbiAgICBvdXRwdXRzOiB7XG4gICAgICAgIHJlc3VsdDogeyBkZXNjcmlwdGlvbjogXCJUaGUgdmFsdWUgZW1pdHRlZFwiIH0sXG4gICAgfSxcbiAgICBydW46IGZ1bmN0aW9uIChpbnB1dHMsIG91dHB1dHMpIHtcbiAgICAgICAgY29uc3QgeyByZXN1bHQgfSA9IG91dHB1dHM7XG4gICAgICAgIGNvbnN0IHsgdmFsdWUsIHRyaWdnZXIgfSA9IGlucHV0cztcbiAgICAgICAgaWYgKHRyaWdnZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmVzdWx0Lm5leHQodmFsdWUpO1xuICAgICAgICB9XG4gICAgfSxcbn07XG5cblxuLy8jIHNvdXJjZVVSTD13ZWJwYWNrOi8vX19NYWNyb05vZGVfX0NvbmRpdGlvbmFsLy4vc3JjL0NvbnRyb2xGbG93L0NvbnRyb2xGbG93LmZseWRlLnRzPyIpOwoKLyoqKi8gfSksCgovKioqLyAiLi9zcmMvQ29udHJvbEZsb3cvU3dpdGNoLmZseWRlLnRzIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIC4vc3JjL0NvbnRyb2xGbG93L1N3aXRjaC5mbHlkZS50cyAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzKSA9PiB7CgoidXNlIHN0cmljdCI7CmV2YWwoIlxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLlN3aXRjaCA9IHZvaWQgMDtcbmV4cG9ydHMuU3dpdGNoID0ge1xuICAgIGlkOiBcIlN3aXRjaFwiLFxuICAgIG5hbWVzcGFjZTogXCJDb250cm9sIEZsb3dcIixcbiAgICBkZWZhdWx0U3R5bGU6IHtcbiAgICAgICAgaWNvbjogXCJzaXRlbWFwXCIsXG4gICAgfSxcbiAgICBkZXNjcmlwdGlvbjogXCJBbGxvd3MgeW91IHRvIHN3aXRjaCBiZXR3ZWVuIG11bHRpcGxlIG91dHB1dHMgYmFzZWQgb24gdGhlIHZhbHVlIG9mIG9uZSBpbnB1dCBvciBtb3JlLCB1c2luZyBjb2RlIGV4cHJlc3Npb25zXCIsXG4gICAgcnVuRm5CdWlsZGVyOiAoY29uZmlnKSA9PiB7XG4gICAgICAgIGZ1bmN0aW9uIGV2YWxFeHByZXNzaW9uKGV4cHJlc3Npb24sIGlucHV0cykge1xuICAgICAgICAgICAgcmV0dXJuIGV2YWwoYChpbnB1dHMpID0+ICgke2V4cHJlc3Npb259KWApKGlucHV0cyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChpbnB1dHMsIG91dHB1dHMsIGFkdikgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBkZWZhdWx0Q2FzZSwgY2FzZXM6IGNhc2VzIH0gPSBjb25maWc7XG4gICAgICAgICAgICBsZXQgZm91bmRDYXNlID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHsgbmFtZSwgY29uZGl0aW9uRXhwcmVzc2lvbiwgb3V0cHV0RXhwcmVzc2lvbiB9IG9mIGNhc2VzKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZGl0aW9uID0gZXZhbEV4cHJlc3Npb24oY29uZGl0aW9uRXhwcmVzc2lvbiwgaW5wdXRzKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coeyBjb25kaXRpb24sIGNvbmRpdGlvbkV4cHJlc3Npb24sIGlucHV0cyB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmRpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyg0MjQyLCBjb25kaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dHNbbmFtZV0ubmV4dChldmFsRXhwcmVzc2lvbihvdXRwdXRFeHByZXNzaW9uLCBpbnB1dHMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZENhc2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZHYub25FcnJvcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkdi5vbkVycm9yKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZm91bmRDYXNlICYmIGRlZmF1bHRDYXNlLmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRzLmRlZmF1bHQubmV4dChldmFsRXhwcmVzc2lvbihkZWZhdWx0Q2FzZS5vdXRwdXRFeHByZXNzaW9uLCBpbnB1dHMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGRlZmluaXRpb25CdWlsZGVyOiAoY29uZmlnKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgaW5wdXRzLCBjYXNlczogb3V0cHV0cywgZGVmYXVsdENhc2UgfSA9IGNvbmZpZztcbiAgICAgICAgY29uc3QgaW5wdXREZWZzID0gaW5wdXRzLm1hcCgobmFtZSwgaSkgPT4gKHtcbiAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogYFN3aXRjaCBpbnB1dCBuby4gJHtpICsgMX1gLFxuICAgICAgICB9KSk7XG4gICAgICAgIGNvbnN0IG91dHB1dERlZnMgPSBvdXRwdXRzLm1hcCgoeyBuYW1lIH0sIGkpID0+ICh7XG4gICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGBTd2l0Y2ggb3V0cHV0IG5vLiAke2kgKyAxfWAsXG4gICAgICAgIH0pKTtcbiAgICAgICAgaWYgKGRlZmF1bHRDYXNlLmVuYWJsZWQpIHtcbiAgICAgICAgICAgIG91dHB1dERlZnMucHVzaCh7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJkZWZhdWx0XCIsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3dpdGNoIGRlZmF1bHQgY2FzZSBvdXRwdXRcIixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpbnB1dHM6IGlucHV0RGVmcy5yZWR1Y2UoKGFjYywgeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSA9PiB7XG4gICAgICAgICAgICAgICAgYWNjW25hbWVdID0geyBkZXNjcmlwdGlvbiB9O1xuICAgICAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgICAgICB9LCB7fSksXG4gICAgICAgICAgICBvdXRwdXRzOiBvdXRwdXREZWZzLnJlZHVjZSgoYWNjLCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0pID0+IHtcbiAgICAgICAgICAgICAgICBhY2NbbmFtZV0gPSB7IGRlc2NyaXB0aW9uIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICAgIH0sIHt9KSxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBcIlN3aXRjaFwiLFxuICAgICAgICB9O1xuICAgIH0sXG4gICAgZGVmYXVsdERhdGE6IHtcbiAgICAgICAgaW5wdXRzOiBbXCJ2YWx1ZVwiXSxcbiAgICAgICAgY2FzZXM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiBcImNhc2UxXCIsXG4gICAgICAgICAgICAgICAgY29uZGl0aW9uRXhwcmVzc2lvbjogXCJcIixcbiAgICAgICAgICAgICAgICBvdXRwdXRFeHByZXNzaW9uOiBcImlucHV0cy52YWx1ZVwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgZGVmYXVsdENhc2U6IHtcbiAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICBvdXRwdXRFeHByZXNzaW9uOiBcImlucHV0LnZhbHVlXCIsXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICBlZGl0b3JDb25maWc6IHtcbiAgICAgICAgdHlwZTogXCJjdXN0b21cIixcbiAgICAgICAgZWRpdG9yQ29tcG9uZW50QnVuZGxlUGF0aDogXCIuLi8uLi9kaXN0L3VpL1N3aXRjaC5qc1wiLFxuICAgIH0sXG59O1xuXG5cbi8vIyBzb3VyY2VVUkw9d2VicGFjazovL19fTWFjcm9Ob2RlX19Db25kaXRpb25hbC8uL3NyYy9Db250cm9sRmxvdy9Td2l0Y2guZmx5ZGUudHM/Iik7CgovKioqLyB9KSwKCi8qKiovICIuL3NyYy9saWIvU2ltcGxlSnNvbkVkaXRvci50c3giOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvbGliL1NpbXBsZUpzb25FZGl0b3IudHN4ICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovIChmdW5jdGlvbihfX3VudXNlZF93ZWJwYWNrX21vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwpldmFsKCJcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59KTtcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5leHBvcnRzLlNpbXBsZUpzb25FZGl0b3IgPSBTaW1wbGVKc29uRWRpdG9yO1xuY29uc3QgY29yZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgQGJsdWVwcmludGpzL2NvcmUgKi8gXCJAYmx1ZXByaW50anMvY29yZVwiKTtcbmNvbnN0IHJlYWN0XzEgPSBfX2ltcG9ydFN0YXIoX193ZWJwYWNrX3JlcXVpcmVfXygvKiEgcmVhY3QgKi8gXCJyZWFjdFwiKSk7XG5mdW5jdGlvbiBTaW1wbGVKc29uRWRpdG9yKHByb3BzKSB7XG4gICAgY29uc3QgW3RlbXBEYXRhVmFsdWUsIHNldFRlbXBEYXRhVmFsdWVdID0gcmVhY3RfMS5kZWZhdWx0LnVzZVN0YXRlKEpTT04uc3RyaW5naWZ5KHByb3BzLnZhbHVlLCBudWxsLCAyKSk7XG4gICAgY29uc3QgW2RhdGFQYXJzZUVycm9yLCBzZXREYXRhUGFyc2VFcnJvcl0gPSByZWFjdF8xLmRlZmF1bHQudXNlU3RhdGUoKTtcbiAgICBjb25zdCBvblZhbHVlQ2hhbmdlID0gKDAsIHJlYWN0XzEudXNlQ2FsbGJhY2spKChlKSA9PiB7XG4gICAgICAgIHNldFRlbXBEYXRhVmFsdWUoZS50YXJnZXQudmFsdWUpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoZS50YXJnZXQudmFsdWUpO1xuICAgICAgICAgICAgc2V0RGF0YVBhcnNlRXJyb3IodW5kZWZpbmVkKTtcbiAgICAgICAgICAgIHByb3BzLm9uQ2hhbmdlKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBzZXREYXRhUGFyc2VFcnJvcihlLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfSwgW3Byb3BzXSk7XG4gICAgcmV0dXJuIChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBwcm9wcy5sYWJlbCwgaW50ZW50OiBkYXRhUGFyc2VFcnJvciA/IFwiZGFuZ2VyXCIgOiB1bmRlZmluZWQsIGhlbHBlclRleHQ6IGRhdGFQYXJzZUVycm9yIH0sXG4gICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5UZXh0QXJlYSwgeyB2YWx1ZTogdGVtcERhdGFWYWx1ZSwgZmlsbDogdHJ1ZSwgb25DaGFuZ2U6IG9uVmFsdWVDaGFuZ2UgfSkpKTtcbn1cblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9fX01hY3JvTm9kZV9fQ29uZGl0aW9uYWwvLi9zcmMvbGliL1NpbXBsZUpzb25FZGl0b3IudHN4PyIpOwoKLyoqKi8gfSksCgovKioqLyAiQGJsdWVwcmludGpzL2NvcmUiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiBleHRlcm5hbCAiQmx1ZXByaW50IiAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgobW9kdWxlKSA9PiB7CgoidXNlIHN0cmljdCI7Cm1vZHVsZS5leHBvcnRzID0gd2luZG93WyJCbHVlcHJpbnQiXTsKCi8qKiovIH0pLAoKLyoqKi8gInJlYWN0IjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiBleHRlcm5hbCAiUmVhY3QiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKInVzZSBzdHJpY3QiOwptb2R1bGUuZXhwb3J0cyA9IHdpbmRvd1siUmVhY3QiXTsKCi8qKiovIH0pCgovKioqKioqLyAJfSk7Ci8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307Ci8qKioqKiovIAkKLyoqKioqKi8gCS8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uCi8qKioqKiovIAlmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7Ci8qKioqKiovIAkJLy8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlCi8qKioqKiovIAkJdmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07Ci8qKioqKiovIAkJaWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7Ci8qKioqKiovIAkJCXJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCQl9Ci8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJaWQ6IG1vZHVsZUlkLAovKioqKioqLyAJCQlsb2FkZWQ6IGZhbHNlLAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovIAkKLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KLyoqKioqKi8gCQlfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKLyoqKioqKi8gCQovKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKLyoqKioqKi8gCQltb2R1bGUubG9hZGVkID0gdHJ1ZTsKLyoqKioqKi8gCQovKioqKioqLyAJCS8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlCi8qKioqKiovIAkJcmV0dXJuIG1vZHVsZS5leHBvcnRzOwovKioqKioqLyAJfQovKioqKioqLyAJCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIAkvKiB3ZWJwYWNrL3J1bnRpbWUvbm9kZSBtb2R1bGUgZGVjb3JhdG9yICovCi8qKioqKiovIAkoKCkgPT4gewovKioqKioqLyAJCV9fd2VicGFja19yZXF1aXJlX18ubm1kID0gKG1vZHVsZSkgPT4gewovKioqKioqLyAJCQltb2R1bGUucGF0aHMgPSBbXTsKLyoqKioqKi8gCQkJaWYgKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdOwovKioqKioqLyAJCQlyZXR1cm4gbW9kdWxlOwovKioqKioqLyAJCX07Ci8qKioqKiovIAl9KSgpOwovKioqKioqLyAJCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIAkKLyoqKioqKi8gCS8vIHN0YXJ0dXAKLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWQKLyoqKioqKi8gCXZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXygiLi9zcmMvQ29udHJvbEZsb3cvQ29uZGl0aW9uYWwudHN4Iik7Ci8qKioqKiovIAl3aW5kb3cuX19NYWNyb05vZGVfX0NvbmRpdGlvbmFsID0gX193ZWJwYWNrX2V4cG9ydHNfXzsKLyoqKioqKi8gCQovKioqKioqLyB9KSgpCjs=","InlineValue":"LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkidXNlIHN0cmljdCI7Ci8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi9zcmMvVmFsdWVzL0lubGluZVZhbHVlLnRzeCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvVmFsdWVzL0lubGluZVZhbHVlLnRzeCAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59KTtcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCAoeyB2YWx1ZTogdHJ1ZSB9KSk7XG5jb25zdCBjb3JlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAYmx1ZXByaW50anMvY29yZSAqLyBcIkBibHVlcHJpbnRqcy9jb3JlXCIpO1xuY29uc3QgcmVhY3RfMSA9IF9faW1wb3J0U3RhcihfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdCAqLyBcInJlYWN0XCIpKTtcbmNvbnN0IHR5cGVzID0gW1xuICAgIFwic3RyaW5nXCIsXG4gICAgXCJudW1iZXJcIixcbiAgICBcImpzb25cIixcbiAgICBcImJvb2xlYW5cIixcbl07XG5jb25zdCBkZWZhdWx0VmFsdWVQZXJUeXBlID0ge1xuICAgIHN0cmluZzogKGN1cnJWYWx1ZSkgPT4gYCR7Y3VyclZhbHVlfWAsXG4gICAgbnVtYmVyOiAoY3VyclZhbHVlKSA9PiBpc05hTihOdW1iZXIoY3VyclZhbHVlKSkgPyAwIDogTnVtYmVyKGN1cnJWYWx1ZSksXG4gICAganNvbjogKGN1cnJWYWx1ZSkgPT4gSlNPTi5zdHJpbmdpZnkoY3VyclZhbHVlKSxcbiAgICBib29sZWFuOiAoY3VyclZhbHVlKSA9PiAhIWN1cnJWYWx1ZSxcbn07XG5jb25zdCBJbmxpbmVWYWx1ZUVkaXRvciA9IGZ1bmN0aW9uIElubGluZVZhbHVlRWRpdG9yKHByb3BzKSB7XG4gICAgY29uc3QgeyB2YWx1ZSwgb25DaGFuZ2UgfSA9IHByb3BzO1xuICAgIGNvbnN0IGNoYW5nZVR5cGUgPSAoMCwgcmVhY3RfMS51c2VDYWxsYmFjaykoKHR5cGUpID0+IHtcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBkZWZhdWx0VmFsdWVQZXJUeXBlW3R5cGVdKHZhbHVlLnZhbHVlKTtcbiAgICAgICAgb25DaGFuZ2UoeyB2YWx1ZTogbmV3VmFsdWUsIHR5cGUgfSk7XG4gICAgfSwgW3ZhbHVlLCBvbkNoYW5nZV0pO1xuICAgIGNvbnN0IGNoYW5nZVZhbHVlID0gKDAsIHJlYWN0XzEudXNlQ2FsbGJhY2spKChfdmFsKSA9PiB7XG4gICAgICAgIG9uQ2hhbmdlKHsgLi4udmFsdWUsIHZhbHVlOiBfdmFsIH0pO1xuICAgIH0sIFt2YWx1ZSwgb25DaGFuZ2VdKTtcbiAgICBjb25zdCBlZGl0b3JQYW5lbCA9ICgwLCByZWFjdF8xLnVzZU1lbW8pKCgpID0+IHtcbiAgICAgICAgc3dpdGNoICh2YWx1ZS50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFwic3RyaW5nXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIlZhbHVlOlwiIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5JbnB1dEdyb3VwLCB7IHR5cGU6IFwidGV4dFwiLCB2YWx1ZTogdmFsdWUudmFsdWUsIG9uQ2hhbmdlOiAoZSkgPT4gY2hhbmdlVmFsdWUoZS50YXJnZXQudmFsdWUpIH0pKSk7XG4gICAgICAgICAgICBjYXNlIFwibnVtYmVyXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIlZhbHVlOlwiIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5OdW1lcmljSW5wdXQsIHsgdmFsdWU6IHZhbHVlLnZhbHVlLCBvblZhbHVlQ2hhbmdlOiAoZSkgPT4gY2hhbmdlVmFsdWUoZSkgfSkpKTtcbiAgICAgICAgICAgIGNhc2UgXCJqc29uXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIlZhbHVlOlwiIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5UZXh0QXJlYSwgeyB2YWx1ZTogdmFsdWUudmFsdWUsIG9uQ2hhbmdlOiAoZSkgPT4gY2hhbmdlVmFsdWUoZS50YXJnZXQudmFsdWUpIH0pKSk7XG4gICAgICAgICAgICBjYXNlIFwiYm9vbGVhblwiOlxuICAgICAgICAgICAgICAgIHJldHVybiAocmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBsYWJlbDogXCJWYWx1ZTpcIiB9LFxuICAgICAgICAgICAgICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuSFRNTFNlbGVjdCwgeyB2YWx1ZTogdmFsdWUudmFsdWUsIG9uQ2hhbmdlOiAoZSkgPT4gY2hhbmdlVmFsdWUoZS50YXJnZXQudmFsdWUgPT09IFwidHJ1ZVwiKSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJ0cnVlXCIgfSwgXCJ0cnVlXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhY3RfMS5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJmYWxzZVwiIH0sIFwiZmFsc2VcIikpKSk7XG4gICAgICAgIH1cbiAgICB9LCBbdmFsdWUsIGNoYW5nZVZhbHVlXSk7XG4gICAgcmV0dXJuIChyZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcImRpdlwiLCBudWxsLFxuICAgICAgICByZWFjdF8xLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIlZhbHVlIHR5cGU6XCIgfSxcbiAgICAgICAgICAgIHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5IVE1MU2VsZWN0LCB7IHZhbHVlOiB2YWx1ZS50eXBlLCBvbkNoYW5nZTogKGUpID0+IGNoYW5nZVR5cGUoZS50YXJnZXQudmFsdWUpIH0sIHR5cGVzLm1hcCgodHlwZSkgPT4gKHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIsIHsga2V5OiB0eXBlLCB2YWx1ZTogdHlwZSB9LCB0eXBlKSkpKSksXG4gICAgICAgIGVkaXRvclBhbmVsKSk7XG59O1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBJbmxpbmVWYWx1ZUVkaXRvcjtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9fX01hY3JvTm9kZV9fSW5saW5lVmFsdWUvLi9zcmMvVmFsdWVzL0lubGluZVZhbHVlLnRzeD8iKTsKCi8qKiovIH0pLAoKLyoqKi8gIkBibHVlcHJpbnRqcy9jb3JlIjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogZXh0ZXJuYWwgIkJsdWVwcmludCIgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSB3aW5kb3dbIkJsdWVwcmludCJdOwoKLyoqKi8gfSksCgovKioqLyAicmVhY3QiOgovKiEqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIGV4dGVybmFsICJSZWFjdCIgKioqIQogIFwqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKiovICgobW9kdWxlKSA9PiB7Cgptb2R1bGUuZXhwb3J0cyA9IHdpbmRvd1siUmVhY3QiXTsKCi8qKiovIH0pCgovKioqKioqLyAJfSk7Ci8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCi8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307Ci8qKioqKiovIAkKLyoqKioqKi8gCS8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uCi8qKioqKiovIAlmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7Ci8qKioqKiovIAkJLy8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlCi8qKioqKiovIAkJdmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07Ci8qKioqKiovIAkJaWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7Ci8qKioqKiovIAkJCXJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCQl9Ci8qKioqKiovIAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKLyoqKioqKi8gCQl2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHsKLyoqKioqKi8gCQkJLy8gbm8gbW9kdWxlLmlkIG5lZWRlZAovKioqKioqLyAJCQkvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZAovKioqKioqLyAJCQlleHBvcnRzOiB7fQovKioqKioqLyAJCX07Ci8qKioqKiovIAkKLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KLyoqKioqKi8gCQlfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKLyoqKioqKi8gCQovKioqKioqLyAJCS8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlCi8qKioqKiovIAkJcmV0dXJuIG1vZHVsZS5leHBvcnRzOwovKioqKioqLyAJfQovKioqKioqLyAJCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIAkKLyoqKioqKi8gCS8vIHN0YXJ0dXAKLyoqKioqKi8gCS8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cwovKioqKioqLyAJLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWQKLyoqKioqKi8gCXZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXygiLi9zcmMvVmFsdWVzL0lubGluZVZhbHVlLnRzeCIpOwovKioqKioqLyAJd2luZG93Ll9fTWFjcm9Ob2RlX19JbmxpbmVWYWx1ZSA9IF9fd2VicGFja19leHBvcnRzX187Ci8qKioqKiovIAkKLyoqKioqKi8gfSkoKQo7","Switch":"LyoKICogQVRURU5USU9OOiBUaGUgImV2YWwiIGRldnRvb2wgaGFzIGJlZW4gdXNlZCAobWF5YmUgYnkgZGVmYXVsdCBpbiBtb2RlOiAiZGV2ZWxvcG1lbnQiKS4KICogVGhpcyBkZXZ0b29sIGlzIG5laXRoZXIgbWFkZSBmb3IgcHJvZHVjdGlvbiBub3IgZm9yIHJlYWRhYmxlIG91dHB1dCBmaWxlcy4KICogSXQgdXNlcyAiZXZhbCgpIiBjYWxscyB0byBjcmVhdGUgYSBzZXBhcmF0ZSBzb3VyY2UgZmlsZSBpbiB0aGUgYnJvd3NlciBkZXZ0b29scy4KICogSWYgeW91IGFyZSB0cnlpbmcgdG8gcmVhZCB0aGUgb3V0cHV0IGZpbGUsIHNlbGVjdCBhIGRpZmZlcmVudCBkZXZ0b29sIChodHRwczovL3dlYnBhY2suanMub3JnL2NvbmZpZ3VyYXRpb24vZGV2dG9vbC8pCiAqIG9yIGRpc2FibGUgdGhlIGRlZmF1bHQgZGV2dG9vbCB3aXRoICJkZXZ0b29sOiBmYWxzZSIuCiAqIElmIHlvdSBhcmUgbG9va2luZyBmb3IgcHJvZHVjdGlvbi1yZWFkeSBvdXRwdXQgZmlsZXMsIHNlZSBtb2RlOiAicHJvZHVjdGlvbiIgKGh0dHBzOi8vd2VicGFjay5qcy5vcmcvY29uZmlndXJhdGlvbi9tb2RlLykuCiAqLwovKioqKioqLyAoKCkgPT4geyAvLyB3ZWJwYWNrQm9vdHN0cmFwCi8qKioqKiovIAkidXNlIHN0cmljdCI7Ci8qKioqKiovIAl2YXIgX193ZWJwYWNrX21vZHVsZXNfXyA9ICh7CgovKioqLyAiLi9zcmMvQ29udHJvbEZsb3cvU3dpdGNoLnRzeCI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiEqXAogICEqKiogLi9zcmMvQ29udHJvbEZsb3cvU3dpdGNoLnRzeCAqKiohCiAgXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKGZ1bmN0aW9uKF9fdW51c2VkX3dlYnBhY2tfbW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgpldmFsKCJcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgKHsgdmFsdWU6IHRydWUgfSkpO1xuY29uc3QgcmVhY3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oLyohIHJlYWN0ICovIFwicmVhY3RcIik7XG5jb25zdCBjb3JlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISBAYmx1ZXByaW50anMvY29yZSAqLyBcIkBibHVlcHJpbnRqcy9jb3JlXCIpO1xuY29uc3QgcmVhY3RfMiA9IF9faW1wb3J0RGVmYXVsdChfX3dlYnBhY2tfcmVxdWlyZV9fKC8qISByZWFjdCAqLyBcInJlYWN0XCIpKTtcbmNvbnN0IE1BWF9DQVNFUyA9IDY7XG5jb25zdCBTd2l0Y2hFZGl0b3IgPSBmdW5jdGlvbiBTd2l0Y2hFZGl0b3IocHJvcHMpIHtcbiAgICBjb25zdCB7IHZhbHVlLCBvbkNoYW5nZSB9ID0gcHJvcHM7XG4gICAgY29uc3QgaW5wdXRzRWxlbSA9ICgwLCByZWFjdF8xLnVzZU1lbW8pKCgpID0+IHtcbiAgICAgICAgY29uc3QgaW5wdXRzID0gdmFsdWUuaW5wdXRzLm1hcCgoaW5wdXQsIGkpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAocmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBrZXk6IGksIGxhYmVsOiBgSW5wdXQgbmFtZSBuby4gJHtpICsgMX06YCwgaW5saW5lOiB0cnVlIH0sXG4gICAgICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdmFsdWU6IGlucHV0LCBvbkNoYW5nZTogKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0lucHV0cyA9IFsuLi52YWx1ZS5pbnB1dHNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3SW5wdXRzW2ldID0gZS50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSh7IC4uLnZhbHVlLCBpbnB1dHM6IG5ld0lucHV0cyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgcmlnaHRFbGVtZW50OiB2YWx1ZS5pbnB1dHMubGVuZ3RoID4gMSA/IChyZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuQnV0dG9uLCB7IHNtYWxsOiB0cnVlLCBtaW5pbWFsOiB0cnVlLCBpbnRlbnQ6IFwiZGFuZ2VyXCIsIG9uQ2xpY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdJbnB1dHMgPSBbLi4udmFsdWUuaW5wdXRzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdJbnB1dHMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHsgLi4udmFsdWUsIGlucHV0czogbmV3SW5wdXRzIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSB9LCBcIlhcIikpIDogbnVsbCB9KSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIChyZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChyZWFjdF8yLmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsXG4gICAgICAgICAgICBpbnB1dHMsXG4gICAgICAgICAgICBpbnB1dHMubGVuZ3RoIDwgNiA/IChyZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuQnV0dG9uLCB7IG9uQ2xpY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3SW5wdXRzID0gWy4uLnZhbHVlLmlucHV0c107XG4gICAgICAgICAgICAgICAgICAgIG5ld0lucHV0cy5wdXNoKGB2YWx1ZSR7bmV3SW5wdXRzLmxlbmd0aCArIDF9YCk7XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHsgLi4udmFsdWUsIGlucHV0czogbmV3SW5wdXRzIH0pO1xuICAgICAgICAgICAgICAgIH0gfSwgXCJBZGQgaW5wdXRcIikpIDogbnVsbCkpO1xuICAgIH0sIFtvbkNoYW5nZSwgdmFsdWVdKTtcbiAgICBjb25zdCBjYXNlc0VsZW0gPSAoMCwgcmVhY3RfMS51c2VNZW1vKSgoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhc2VzID0gdmFsdWUuY2FzZXMubWFwKChjYXNlXywgaSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIChyZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChyZWFjdF8yLmRlZmF1bHQuRnJhZ21lbnQsIG51bGwsXG4gICAgICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBrZXk6IGksIGxhYmVsOiBgQ2FzZSBuby4gJHtpICsgMX0gbmFtZTpgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlYWN0XzIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5JbnB1dEdyb3VwLCB7IHZhbHVlOiBjYXNlXy5uYW1lLCByaWdodEVsZW1lbnQ6IHZhbHVlLmNhc2VzLmxlbmd0aCA+IDEgJiYgKHJlYWN0XzIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5CdXR0b24sIHsgc21hbGw6IHRydWUsIG1pbmltYWw6IHRydWUsIGludGVudDogXCJkYW5nZXJcIiwgb25DbGljazogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDYXNlcyA9IFsuLi52YWx1ZS5jYXNlc107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0Nhc2VzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2UoeyAuLi52YWx1ZSwgY2FzZXM6IG5ld0Nhc2VzIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gfSwgXCJYXCIpKSwgb25DaGFuZ2U6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Q2FzZXMgPSBbLi4udmFsdWUuY2FzZXNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0Nhc2VzW2ldID0geyAuLi5uZXdDYXNlc1tpXSwgbmFtZTogZS50YXJnZXQudmFsdWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSh7IC4uLnZhbHVlLCBjYXNlczogbmV3Q2FzZXMgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IH0pKSxcbiAgICAgICAgICAgICAgICByZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGtleTogaSwgbGFiZWw6IGBDYXNlIG5vLiAke2kgKyAxfSBjb25kaXRpb24gZXhwcmVzc2lvbjpgLCBoZWxwZXJUZXh0OiBcIlRoZSBjb25kaXRpb24gdG8gZXZhbHVhdGUgdG8gY2hlY2sgd2hldGhlciB0aGlzIGNhc2Ugc2hvdWxkIGJlIGFjdGl2YXRlZC4gYW55IEpTIGV4cHJlc3Npb24uIFlvdSBjYW4gYWNjZXNzIHRoZSBpbnB1dHMgZGF0YSB1c2luZyB0aGUgaW5wdXRzIG9iamVjdC4gRm9yIGV4YW1wbGUsIGBpbnB1dHMubmFtZSAhPT0gaW5wdXRzWydjaXR5IG9mIGJpcnRoJ11gXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdmFsdWU6IGNhc2VfLmNvbmRpdGlvbkV4cHJlc3Npb24sIG9uQ2hhbmdlOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0Nhc2VzID0gWy4uLnZhbHVlLmNhc2VzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDYXNlc1tpXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4ubmV3Q2FzZXNbaV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbkV4cHJlc3Npb246IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2UoeyAuLi52YWx1ZSwgY2FzZXM6IG5ld0Nhc2VzIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSB9KSksXG4gICAgICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkZvcm1Hcm91cCwgeyBrZXk6IGksIGxhYmVsOiBgQ2FzZSBuby4gJHtpICsgMX0gb3V0cHV0IGV4cHJlc3Npb246YCwgaGVscGVyVGV4dDogXCJUaGUgZXhwcmVzc2lvbiB0byBvdXRwdXQgaWYgdGhpcyBjYXNlIGlzIGFjdGl2YXRlZC4gQWNjZXB0cyBhbnkgSlMgZXhwcmVzc2lvbi4gWW91IGNhbiBhY2Nlc3MgdGhlIGlucHV0cyBkYXRhIHVzaW5nIHRoZSBpbnB1dHMgb2JqZWN0LiBGb3IgZXhhbXBsZSwgYGlucHV0cy5uYW1lYFwiIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlYWN0XzIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5JbnB1dEdyb3VwLCB7IHZhbHVlOiBjYXNlXy5vdXRwdXRFeHByZXNzaW9uLCBvbkNoYW5nZTogKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDYXNlcyA9IFsuLi52YWx1ZS5jYXNlc107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2FzZXNbaV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLm5ld0Nhc2VzW2ldLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRFeHByZXNzaW9uOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHsgLi4udmFsdWUsIGNhc2VzOiBuZXdDYXNlcyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gfSkpKSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gKHJlYWN0XzIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KHJlYWN0XzIuZGVmYXVsdC5GcmFnbWVudCwgbnVsbCxcbiAgICAgICAgICAgIGNhc2VzLFxuICAgICAgICAgICAgY2FzZXMubGVuZ3RoIDwgTUFYX0NBU0VTID8gKHJlYWN0XzIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KGNvcmVfMS5CdXR0b24sIHsgb25DbGljazogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDYXNlcyA9IFsuLi52YWx1ZS5jYXNlc107XG4gICAgICAgICAgICAgICAgICAgIG5ld0Nhc2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYGNhc2Uke25ld0Nhc2VzLmxlbmd0aCArIDF9YCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbkV4cHJlc3Npb246IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRFeHByZXNzaW9uOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2UoeyAuLi52YWx1ZSwgY2FzZXM6IG5ld0Nhc2VzIH0pO1xuICAgICAgICAgICAgICAgIH0gfSwgXCJBZGQgY2FzZVwiKSkgOiBudWxsKSk7XG4gICAgfSwgW29uQ2hhbmdlLCB2YWx1ZV0pO1xuICAgIHJldHVybiAocmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQocmVhY3RfMi5kZWZhdWx0LkZyYWdtZW50LCBudWxsLFxuICAgICAgICBpbnB1dHNFbGVtLFxuICAgICAgICByZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRGl2aWRlciwgbnVsbCksXG4gICAgICAgIGNhc2VzRWxlbSxcbiAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkRpdmlkZXIsIG51bGwpLFxuICAgICAgICByZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCBudWxsLFxuICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLkNoZWNrYm94LCB7IGNoZWNrZWQ6IHZhbHVlLmRlZmF1bHRDYXNlLmVuYWJsZWQsIGxhYmVsOiBcIkVuYWJsZSBkZWZhdWx0IGNhc2UgKGlmIG5vIGNhc2UgaXMgYWN0aXZhdGVkKS4gSWYgZGlzYWJsZWQsIHJlYWNoaW5nIGEgY2FzZSB0aGF0IGlzIG5vdCBhY3RpdmF0ZWQgd2lsbCBvdXRwdXQgYW4gZXJyb3IuXCIsIG9uQ2hhbmdlOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmFibGVkID0gZS50YXJnZXQuY2hlY2tlZDtcbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Q2FzZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0RXhwcmVzc2lvbjogZW5hYmxlZCA/IFwiXCIgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IH0pKSxcbiAgICAgICAgdmFsdWUuZGVmYXVsdENhc2UuZW5hYmxlZCA/IChyZWFjdF8yLmRlZmF1bHQuY3JlYXRlRWxlbWVudChjb3JlXzEuRm9ybUdyb3VwLCB7IGxhYmVsOiBcIkRlZmF1bHQgY2FzZSBvdXRwdXQgZXhwcmVzc2lvbjpcIiwgaGVscGVyVGV4dDogXCJUaGUgZXhwcmVzc2lvbiB0byBvdXRwdXQgaWYgbm8gY2FzZSBpcyBhY3RpdmF0ZWQuIEFjY2VwdHMgYW55IEpTIGV4cHJlc3Npb24uIFlvdSBjYW4gYWNjZXNzIHRoZSBpbnB1dHMgZGF0YSB1c2luZyB0aGUgaW5wdXRzIG9iamVjdC4gRm9yIGV4YW1wbGUsIGBpbnB1dHMubmFtZWBcIiB9LFxuICAgICAgICAgICAgcmVhY3RfMi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoY29yZV8xLklucHV0R3JvdXAsIHsgdmFsdWU6IHZhbHVlLmRlZmF1bHRDYXNlLm91dHB1dEV4cHJlc3Npb24sIG9uQ2hhbmdlOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRDYXNlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRFeHByZXNzaW9uOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gfSkpKSA6IG51bGwpKTtcbn07XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IFN3aXRjaEVkaXRvcjtcblxuXG4vLyMgc291cmNlVVJMPXdlYnBhY2s6Ly9fX01hY3JvTm9kZV9fU3dpdGNoLy4vc3JjL0NvbnRyb2xGbG93L1N3aXRjaC50c3g/Iik7CgovKioqLyB9KSwKCi8qKiovICJAYmx1ZXByaW50anMvY29yZSI6Ci8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlwKICAhKioqIGV4dGVybmFsICJCbHVlcHJpbnQiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLyoqKi8gKChtb2R1bGUpID0+IHsKCm1vZHVsZS5leHBvcnRzID0gd2luZG93WyJCbHVlcHJpbnQiXTsKCi8qKiovIH0pLAoKLyoqKi8gInJlYWN0IjoKLyohKioqKioqKioqKioqKioqKioqKioqKioqISpcCiAgISoqKiBleHRlcm5hbCAiUmVhY3QiICoqKiEKICBcKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqLyAoKG1vZHVsZSkgPT4gewoKbW9kdWxlLmV4cG9ydHMgPSB3aW5kb3dbIlJlYWN0Il07CgovKioqLyB9KQoKLyoqKioqKi8gCX0pOwovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9OwovKioqKioqLyAJCi8qKioqKiovIAkvLyBUaGUgcmVxdWlyZSBmdW5jdGlvbgovKioqKioqLyAJZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkgewovKioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQovKioqKioqLyAJCXZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdOwovKioqKioqLyAJCWlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkgewovKioqKioqLyAJCQlyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7Ci8qKioqKiovIAkJfQovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7Ci8qKioqKiovIAkJCS8vIG5vIG1vZHVsZS5pZCBuZWVkZWQKLyoqKioqKi8gCQkJLy8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWQKLyoqKioqKi8gCQkJZXhwb3J0czoge30KLyoqKioqKi8gCQl9OwovKioqKioqLyAJCi8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uCi8qKioqKiovIAkJX193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7Ci8qKioqKiovIAkKLyoqKioqKi8gCQkvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZQovKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKLyoqKioqKi8gCX0KLyoqKioqKi8gCQovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKioqKioqLyAJCi8qKioqKiovIAkvLyBzdGFydHVwCi8qKioqKiovIAkvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHMKLyoqKioqKi8gCS8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkCi8qKioqKiovIAl2YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oIi4vc3JjL0NvbnRyb2xGbG93L1N3aXRjaC50c3giKTsKLyoqKioqKi8gCXdpbmRvdy5fX01hY3JvTm9kZV9fU3dpdGNoID0gX193ZWJwYWNrX2V4cG9ydHNfXzsKLyoqKioqKi8gCQovKioqKioqLyB9KSgpCjs="};